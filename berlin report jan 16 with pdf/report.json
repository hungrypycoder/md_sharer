{
  "report_id": "0c89493c-8601-4ae1-ad90-6602c7cd089e",
  "spec_source": "838576b0-1da9-498e-bcd3-b1f1d46287fc",
  "analysis_timestamp": "2026-01-16T03:19:08.625514",
  "total_requirements": 217,
  "gaps": [
    {
      "gap_id": "GAP_0001",
      "requirement": {
        "requirement_id": "ATOM_106",
        "requirement_text": "The X-Request-ID header SHALL be mandatory for all payment retrieval requests and contain a unique UUID",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0001_1",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_2",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_3",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_4",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_5",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly enforce the `X-Request-ID` header as mandatory for all payment retrieval requests with a unique UUID format. While the `x-fapi-interaction-id` header, which serves a similar purpose as a correlation ID, is present in API specifications and is marked as required in responses, it is not consistently marked as a mandatory request header for payment retrieval.\\n\\n### Implementation Details\\n\\nThe OpenAPI specifications for Payment Initiation APIs, such as `payment-initiation-openapi.yaml`, define various endpoints related to payments. For payment retrieval requests, specifically the `GET /payments/{paymentId}` endpoint, the `x-fapi-interaction-id` header is listed as a parameter . However, it is marked as `required: false` for requests . In contrast, for responses, the `x-fapi-interaction-id` header is consistently marked as `required: true` . This suggests that while the system generates and returns this ID, it does not strictly require it in incoming requests for payment retrieval.\\n\\nSimilarly, for Confirmation of Funds APIs, the `x-fapi-interaction-id` header is also present in the OpenAPI specification `funds-confirmation-openapi.yaml` , and is marked as `required: false` for requests .\\n\\nIn the `DefaultConsentManageHandler.java`, which handles consent management operations, if the `ConsentExtensionConstants.INTERACTION_ID_HEADER` (which maps to `x-fapi-interaction-id`) is not present in the request headers, a new UUID is generated and set as the response header . This further indicates that the header is not mandatory for incoming requests at this level of the system.\\n\\n### Configuration Options\\n\\nThe `Overview` wiki page mentions \"Configuration Management\" through the `financial-services.xml` file and `FinancialServicesConfigParser` . However, there is no explicit configuration option mentioned in the provided context to enforce the `X-Request-ID` or `x-fapi-interaction-id` header as mandatory for incoming requests.\\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoints for payment retrieval are defined in the OpenAPI specification `payment-initiation-openapi.yaml`. Specifically, the `GET /payments/{paymentId}` endpoint is used for retrieving payment information . As noted above, the `x-fapi-interaction-id` header is a parameter for this endpoint but is not marked as required for requests .\\n\\nThe `fs-integration-test-suite` includes test payloads that contain an `x-request-id` header with a UUID value . This suggests that while not enforced by the API specification, the system is designed to handle and potentially utilize such a header. The `TestUtil.groovy` also contains a `generateUUID()` method, which indicates that UUID generation is a supported utility within the framework .\\n\\n### Documentation References\\n\\nThe `Overview` wiki page provides a high-level description of the WSO2 Financial Services Accelerator and its components . It also references API specifications for Account Information, Payment Initiation, and Confirmation of Funds APIs . The `Consent Management` wiki page details the consent management system, including idempotency support and external service integration . While these documents describe the overall architecture and API capabilities, they do not explicitly state that `X-Request-ID` is a mandatory request header for payment retrieval.\\n\\n## Notes\\n\\nThe prompt specifically asks about the `X-Request-ID` header. In the provided codebase, the equivalent header for correlation is `x-fapi-interaction-id`. While this header is present in the API specifications and test cases, it is not consistently marked as a mandatory request header for payment retrieval endpoints. The system appears to generate a UUID for this header if it\\'s not provided in the request, indicating it\\'s not strictly enforced as a mandatory input. To enforce this requirement, modifications to the API gateway or validation logic would be necessary.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3be040bf-d94d-4067-96dc-14cec3be7596\\n', 'id': 'lc_fb4703e2-8b1b-4f1c-996d-99d65a24dca2'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0002",
      "requirement": {
        "requirement_id": "ATOM_118",
        "requirement_text": "Account Information Service SHALL enforce the multiplicity of access (one-off or recurring) as specified in the consent",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0002_1",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_2",
          "text": "#### Add CustomerCareOfficerRole Role\n\nCustomerCareOfficerRole is required for bank users to log into the Consent Manager Portal and search for the consents granted by any user.\n\n1. Go to **Roles** under the **User Management** tab in the left pane.\n\n2. Click on **+ New Role**.<br/> \n![roles](../assets/img/learn/consent-manager/roles.png)\n\n3. Enter following details and click on Next button.\n    - Role Name: CustomerCareOfficerRole\n    - Role audience: Organization<br/> \n![create-cc-role](../assets/img/learn/consent-manager/create-cc-role.png)\n\n4. Select the created **API Resource** under the **Permission Selection** section.\n\n5. Add the **consents:read_all** permission from the API resource separately.<br/> \n![create-role-step2](../assets/img/learn/consent-manager/create-role-step2.png)\n\n6. Click on the **Finish** button.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_3",
          "text": "## Shareable and payable accounts \n   \nSome bank customers may have a certain number of bank accounts in a particular bank, but not all these accounts have \nthe ability to be shared externally or to make a payment online. These accounts are known as shareable and payable \naccounts respectively. In a bank, the list of shareable accounts and the payable accounts can either be the same or \ndifferent.\n   \nThe WSO2 Open Banking solution expects at least two APIs from the bank that return shareable and payable accounts when \nthe `user_id` is provided. The response must be in the JSON format and it will automatically load the accounts list on \nthe consent page during the consent authorization flow. \n\n![consent-page-with-accounts](../assets/img/learn/integration/list-of-accounts.png)\n\nThe responses of shareable and payable accounts APIs depend on your open banking specification and what you need to \ndisplay on the consent page. You can configure customized steps for retrieval by following the \n[Consent Authorize endpoint](https://ob.docs.wso2.com/en/latest/develop/consent-management-authorize/#configuration) \ndocumentation.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_4",
          "text": "## Persist\n\nThe second endpoint of the Consent Authorize component is the Persist Flow. The Persistent Steps are engaged once the \nuser approves/denies the consent via an API invocation made from the consent page. When the `/persist` endpoint is \ninvoked, the steps to persist are also invoked and the data required for persistence will be provided to these steps.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_5",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports consent management, which includes the ability to define and enforce the multiplicity of access (one-off or recurring) for Account Information Services. The system allows for the configuration of consent purposes with validity periods, which can be used to control access after initial use or allow multiple accesses within a specified timeframe.\\n\\n### Implementation Details\\nThe consent management framework in WSO2 Identity Server is designed to collect, store, and manage user consent for processing personal data, aligning with privacy regulations . The core components include PII Categories, Purposes, Purpose Categories, and Consent Receipts .\\n\\nThe `SelfSignUpConsentTest.java` integration test demonstrates how purposes are added and how consent is collected during self-registration . Specifically, the `addPurpose` method is used to define a consent purpose with a name, description, group, and group type . The `getConsentReqBody` method constructs the consent request body, which includes a `validity` field that can be set to `DATE_UNTIL:INDEFINITE` . This `validity` field is crucial for defining whether a consent is \"one-off\" or \"recurring\" based on a specified validity period.\\n\\nConsent decisions influence how user information is shared, with only consented attributes being included in tokens and API responses . The `sendApprovalPostWithConsent` method in `OAuth2ServiceAbstractIntegrationTest.java` is responsible for sending the approval post request with consent, which includes a `sessionDataKeyConsent` and `consentClaims` . The `OAuth2CommonClient.java` also contains a `sendOAuthConsentApprovePost` method that handles \"Approve Once\" or \"Approve Always\" or \"Deny\" consent submissions for OAuth .\\n\\n### Configuration Options\\nThe `default-identity.xml` configuration file contains settings related to consent management . Specifically, the `<Consent>` section includes an `<EnableSSOConsentManagement>` flag, which when set to `true`, enables consent management during SSO .\\n\\nAdditionally, the `<UserConsentEnabledGrantTypes>` section defines which grant types will filter user claims based on user consent in their responses, such as `id_token` or user info response . By default, `authorization_code` and `implicit` grant types are configured to enforce user consent .\\n\\n### API Endpoints or Features\\nThe following API endpoints are relevant to consent management:\\n*   `/api/identity/consent-mgt/v1.0/consents`: This endpoint is used for managing consents . The `SelfSignUpConsentTest` uses `CONSNT_ENDPOINT_SUFFIX` which resolves to `/api/identity/consent-mgt/v1.0/consents` .\\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/(.*)`: This endpoint is used to retrieve consent receipts . The `getConsent` method in `SelfSignUpConsentTest` demonstrates fetching a consent receipt using this endpoint .\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes(.*)`: This endpoint is used for managing consent purposes, including adding, retrieving, and deleting them . The `addPurpose` method in `SelfSignUpConsentTest` uses this endpoint to add a new purpose .\\n\\n### Documentation References\\nThe \"Advanced Features\" wiki page provides an overview of consent management, including its purpose and how it integrates with OAuth2/OIDC for custom scopes and claims . It highlights that consent decisions affect token issuance and API responses, ensuring only consented attributes are shared .\\n\\n## Notes\\nThe provided context primarily consists of integration tests and configuration files. While these demonstrate the existence and basic functionality of consent management, they do not explicitly detail the internal mechanisms for enforcing \"one-off\" versus \"recurring\" access based on consent validity periods beyond the `validity` field in the consent request body. The test criteria mentioned in the prompt (\"Verify that one-off consents deny access after first use and recurring consents allow multiple accesses within validity period\") would likely be handled by the underlying consent enforcement logic, which is not directly visible in the provided snippets. The `validity` field in the `getConsentReqBody` method  is the most direct indication of how recurring access might be managed.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_4c8b9fd3-fde5-4824-9e7c-c91c7b7bbbae\\n', 'id': 'lc_6ae92406-70f7-44e1-8a5d-19c7fba05e70'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_5a88cae0-82b5-4e7a-80a8-a4a25811d47b'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0003",
      "requirement": {
        "requirement_id": "ATOM_163",
        "requirement_text": "The system SHALL support reading card account balance data from a given card account addressed by account-id via GET /v1/card-accounts/{account-id}/balances endpoint",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0003_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_2",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_3",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_4",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_5",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports reading account balance data via a `GET /accounts/{AccountId}/balances` endpoint, which is part of its Account Information APIs.  This functionality is defined in the OpenAPI specification and has a corresponding demo backend implementation and integration tests.  \\n\\n## Implementation Details\\n\\nThe `GET /accounts/{AccountId}/balances` endpoint is specified in the `account-info-swagger.yaml` file.  This endpoint requires an `AccountId` as a path parameter and expects several headers, including `Authorization`, `x-fapi-auth-date`, `x-fapi-customer-ip-address`, and `x-fapi-interaction-id`.  A successful response (HTTP 200) will return balance data conforming to the `OBReadBalance1` schema.  \\n\\nA demo backend implementation for this endpoint is found in the `AccountService.java` file.  The `getAccountBalance` method handles the GET request, extracts the `AccountId` from the path, and returns a hardcoded JSON response containing balance information.  The response includes an `AccountId`, `Amount` (with `Amount` and `Currency`), `CreditDebitIndicator`, `Type`, `DateTime`, and `CreditLine` details.  It also sets the `x-fapi-interaction-id` header in the response. \\n\\n## Configuration Options\\n\\nThe `account-info-swagger.yaml` defines the security requirements for accessing the balances endpoint, specifying `PSUOAuth2Security` with the `accounts` scope.  This indicates that OAuth 2.0 with the `accounts` scope is required for authentication and authorization. \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `GET /accounts/{AccountId}/balances`.  This endpoint is part of the Account Information APIs, which also include endpoints for retrieving all accounts and transactions for a specific account.  \\n\\n## Documentation References\\n\\nThe OpenAPI specification for the Account Information APIs, including the balances endpoint, is detailed in `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml`.  This file describes the endpoint path, HTTP method, parameters, expected responses, and security requirements. \\n\\n## Test Criteria\\n\\nThe `EndToEndAccountFlowTest.groovy` file contains an integration test case specifically for verifying the retrieval of account balances.  The test method `Verify Accounts balances Retrieval Request for a Authorised Consent` sets the `accountsPath` to `ConnectorTestConstants.BALANCES_SINGLE_PATH` and asserts that the `retrievalResponse.statusCode()` is `200`.  The `ConnectorTestConstants.BALANCES_SINGLE_PATH` is defined as `ACCOUNTS_PATH + \"/\" + accountID + \"/balances\"`, which corresponds to the `/accounts/{AccountId}/balances` endpoint. \\n\\n## Notes\\n\\nThe user\\'s prompt refers to `/v1/card-accounts/{account-id}/balances`. While the codebase uses `/accounts/{AccountId}/balances` , the functionality described (reading account balance data addressed by account-id) is directly supported. The term \"card account\" is not explicitly used in the provided snippets, but the general \"account\" context implies support for various account types, including card accounts. The versioning in the prompt (`/v1/`) also differs from the codebase\\'s `/accounts/` path, but this is a minor difference in API path structure rather than a lack of functionality.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4b3d4e1d-5705-477f-afaa-62f35349d41c\\n', 'id': 'lc_1739f6f3-2135-42b3-9192-f07874446a63'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0004",
      "requirement": {
        "requirement_id": "ATOM_131",
        "requirement_text": "ASPSP SHALL offer consent extension for both Detailed and Global Consent models if offered for one of these models",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "unknown",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0004_1",
          "text": "## Setting up Consent manager app",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0004_2",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0004_3",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0004_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0004_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0005",
      "requirement": {
        "requirement_id": "ATOM_195",
        "requirement_text": "The Headers parameter must conditionally include psu-corporate-id if and only if PSU-Corporate-ID is included as a header of the HTTP-Request",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0005_1",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0005_2",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0005_3",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to have explicit support for conditionally including a `psu-corporate-id` header based on the presence of a `PSU-Corporate-ID` header in the HTTP request. The provided code snippets primarily deal with OAuth2/OIDC and SAML configurations, application management, and general REST client functionalities. There are no direct references to `psu-corporate-id` or `PSU-Corporate-ID` in the provided context.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nBased on the provided codebase context, there are no implementation details, configuration options, or API endpoints that directly address the conditional inclusion of a `psu-corporate-id` header. The `RestBaseClient.java`  class provides methods for sending HTTP requests with custom headers, such as `getResponseOfHttpPost`  and `getResponseOfHttpGet` , where headers are passed as a `Header[]` array. However, the logic for conditionally adding specific headers like `psu-corporate-id` would need to be implemented at the point of calling these methods, and such an implementation is not visible in the provided snippets.\\n\\nThe `OAuth2DPopTestCase.java`    and `SCIM2RestClient.java`  files show examples of constructing HTTP headers, including `Authorization`   and `Content-Type` , but none of these examples demonstrate the conditional logic for `psu-corporate-id`.\\n\\nThe `oidc-fapi-conformance-tests/constants_fapi.py`  file defines a `HEADERS_WITH_AUTH` dictionary, which includes `Content-Type` and `Authorization` headers, but again, there\\'s no mention of `psu-corporate-id`.\\n\\n## Documentation References\\n\\nThe \"Application Management\" wiki page   provides an overview of application management, including supported protocols and configuration options. While it discusses various aspects of OAuth2/OIDC configuration, such as \"Token Binding\" , there is no specific documentation or configuration option related to the conditional inclusion of `psu-corporate-id` in HTTP request headers.\\n\\n## Notes\\n\\nThe prompt specifically asks about the conditional inclusion of a `psu-corporate-id` header. While the codebase contains general HTTP client functionality and header manipulation, there is no explicit code or configuration that implements the specific conditional logic described in the prompt. The provided snippets are primarily integration tests and REST client utilities, which demonstrate how headers are generally handled, but not the specific business logic for `psu-corporate-id`.\\n\\nWiki pages you might want to explore:\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_174c7a01-070f-4f9b-ae8a-0e5f88b221a4\\n', 'id': 'lc_060cf6ca-c14e-4dd2-a967-de4e9cfda057'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0005_4",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports conditionally adding headers to requests. The core mechanism for this is through \"mediation policies\" which can be configured to add headers based on certain conditions. Specifically, the `addHeader` policy allows you to define a header name and value to be added to a request.   \\n\\n## Implementation Details\\n\\nThe `addHeader` policy is defined in JSON specification files such as `addHeader_v2.json` . These files describe the policy\\'s attributes, including `headerName` and `headerValue` . The policy is applicable to \"request\", \"response\", and \"fault\" flows and is supported by the \"Synapse\" gateway .\\n\\nThe system uses a \"header mediator\" to manipulate headers . This mediator can either \"Set\" or \"Remove\" a header, and its value can be a static value or an XPath expression . This XPath expression capability is crucial for conditional header inclusion, as it allows the header\\'s presence and value to be determined dynamically based on the incoming message.\\n\\nFor example, to dynamically change an endpoint, a header mediator can be used with an XPath expression to calculate the new \\'To\\' address . This suggests that similar logic could be applied to conditionally add other headers.\\n\\nThe `HeaderCondition` class and `HeaderConditionDTO` are used to define header-based conditions, typically for throttling policies  . While these are primarily for throttling, the concept of defining conditions based on header names and values is relevant.\\n\\n## Configuration Options\\n\\nThe `addHeader` policy can be configured with `headerName` and `headerValue` . To achieve conditional inclusion of `psu-corporate-id` based on the presence of `PSU-Corporate-ID` in the HTTP request, you would likely use an XPath expression within the `headerValue` to check for the existence of the `PSU-Corporate-ID` header.\\n\\nThe `CustomHeaderTestCase.java` demonstrates how custom authorization headers can be set and tested . This test case sets a custom header `Test-Custom-Header`  and verifies its behavior. While this example directly sets a header, the underlying mechanism would allow for conditional logic.\\n\\n## API Endpoints or Features\\n\\nThe `addHeader` policy is a feature that can be applied to API flows . This means it can be configured for specific APIs to modify request or response headers. The `api_product_template.xml` and `prototype_template.xml` show how sequences and endpoints are defined within API configurations, where such policies would be applied  .\\n\\n## Documentation References\\n\\nThe `header.xml` documentation describes the header mediator, its actions (Set/Remove), and how to use XPath expressions for dynamic values . This document would be the primary reference for implementing conditional header logic. Additionally, the `faq.xml` mentions using a header mediator to dynamically change endpoints using XPath expressions, which reinforces the capability of dynamic header manipulation .\\n\\n## Notes\\n\\nThe provided snippets indicate that the WSO2 API Manager (APIM) platform, which this repository is part of, uses Synapse mediation for request/response flows. The `addHeader` policy, combined with the ability to use XPath expressions in the header mediator, provides the necessary functionality to conditionally include headers. The `HeaderCondition` and `HeaderConditionDTO` classes, while primarily for throttling, demonstrate the system\\'s capability to define conditions based on header properties. To verify the specific requirement, you would need to configure an `addHeader` policy with an XPath expression that checks for the presence of the `PSU-Corporate-ID` header and, if present, sets the `psu-corporate-id` header.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b73b1793-878c-4db2-bcde-33649c51a40d\\n', 'id': 'lc_be2033f4-3fef-4ce4-8f81-af8347170d6f'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0006",
      "requirement": {
        "requirement_id": "ATOM_040",
        "requirement_text": "The ASPSP SHALL include mandatory messageCode field in additional error information responses",
        "strength": "SHALL",
        "capability": "Error Handling",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0006_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of a `code` field in additional error information responses. The `code` field is a mandatory component of the standardized error response format used by the Server APIs.  This is evident from the `validateErrorResponse` method in `RESTTestBase.java`, which explicitly checks for the presence and value of the `code` field in error responses. \\n\\n## Implementation Details\\n\\nThe core implementation for validating error responses, including the `code` field, resides in the `RESTTestBase.java` file.  The `validateErrorResponse` method is a protected method used across various API integration tests to ensure consistent error handling. \\n\\nThe `validateErrorResponse` method performs the following checks:\\n*   It validates the HTTP status code of the response using `validateHttpStatusCode`. \\n*   It asserts that the response contains a `code` element and that its value matches the expected `errorCode` using `validateResponseElement`. \\n*   It also checks for a `traceId` field, ensuring it is not null. \\n*   Finally, it validates the `message` and `description` fields against entries in `RESTAPIErrors.properties`. \\n\\nAn example of how `validateErrorResponse` is used can be seen in `ApplicationManagementFailureTest.java`, where it\\'s called to verify error responses for application creation failures.    Similarly, `AuthenticatorFailureTest.java` and `IdPFailureTest.java` also utilize this method to validate error responses, confirming the consistent enforcement of the `code` field.  \\n\\nThe `validateFailedBasicAuthenticationResponseBody` method in `ApplicationNativeAuthentication2FATestCase.java` also explicitly checks for the presence of `CODE`, `MESSAGE`, `DESCRIPTION`, and `TRACE_ID` in the JSON response body, further reinforcing the mandatory nature of these fields in error responses. \\n\\n## Configuration Options\\n\\nThe error codes and their corresponding messages and descriptions are managed in the `RESTAPIErrors.properties` file.  This file allows for the configuration of error messages associated with specific error codes.  For instance, `CMT-50016.message` and `CMT-50016.description` define the message and description for the `CMT-50016` error code. \\n\\n## API Endpoints or Features\\n\\nThe Server APIs, as described in the \"Server APIs\" wiki page, are RESTful interfaces that use JSON for requests and responses.  These APIs consistently return error responses that include the `code` field when an error occurs.  This behavior is observed across various API categories, including Application Management, Identity Provider Management, and Authenticator Management, as demonstrated by their respective failure tests.   \\n\\n## Documentation References\\n\\nThe \"Server APIs\" wiki page provides an overview of the API architecture and error handling mechanisms.  It mentions that the Server APIs use a standardized error handling mechanism through exception mappers.  While the wiki doesn\\'t explicitly state \"messageCode\", the `RESTTestBase.java` and various failure test cases confirm that a `code` field is a standard part of the error response structure. \\n\\n## Test Criteria\\n\\nThe test criteria \"Verify that error responses containing additional error information include required messageCode field\" is directly addressed by the integration tests within the repository.  The `validateErrorResponse` method is specifically designed to assert the presence and correctness of the `code` field in error responses. \\n\\n## Notes\\n\\nThe term \"messageCode\" in the prompt directly corresponds to the \"code\" field in the error response structure within this repository.  The codebase consistently uses \"code\" to identify specific errors. \\n\\nWiki pages you might want to explore:\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ff32ef50-515a-4bd6-8c6a-3799a3432474\\n', 'id': 'lc_312dd1c6-f112-46d2-8a32-f40add7c014f'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0006_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the inclusion of a `code` field in error responses. The OpenAPI specifications for various APIs within this repository define an `Error` schema that mandates the presence of a `code` field.   Additionally, the system uses internal properties like `ERROR_CODE` to handle error messages during fault mediation. \\n\\n## Implementation Details\\n\\nThe `Error` schema, which is referenced by various API endpoints for their error responses, explicitly lists `code` as a required property.  This schema is defined in multiple OpenAPI specification files across different modules, such as `gateway-api.yaml` , `admin-api.yaml` , `publisher-api.yaml` , and `service-catalog-api.yaml` . The `code` property is defined as an integer with a description \"Error code\". \\n\\nFor example, in `gateway-api.yaml`, the `BadRequest` and `NotFound` error responses both reference the `Error` schema and include an example with a `code` field.  \\n\\nInternally, the system uses a Synapse message context property named `ERROR_CODE` to store error message codes during a fault.  This property is of type `String`.  The `jsonFault_v1.j2` template, used for generating JSON fault responses, explicitly retrieves the `ERROR_CODE` from the message context and includes it in the fault payload.  \\n\\n## Configuration Options\\n\\nThe `ERROR_CODE` property can be set programmatically within Synapse configurations. For instance, a custom error code can be assigned using a property mediator: `<property name=\"ERROR_CODE\" value=\"100100\"/>`.  This allows for custom error codes to be included in fault responses.\\n\\n## API Endpoints or Features\\n\\nThe `code` field is a mandatory part of the `Error` object returned by various API endpoints in case of errors. This is evident in the OpenAPI definitions for:\\n*   **Gateway API**: Error responses like `BadRequest` and `NotFound` include the `code` field.  \\n*   **Admin API**: Error responses for various operations, such as adding a Global Mediation Policy, include the `code` field. \\n*   **Publisher API**: Error responses for operations like creating a new API or updating an API include the `code` field.  \\n*   **Service Catalog API**: Error responses such as `BadRequest`, `InternalServerError`, `NotFound`, `Conflict`, `Unauthorized`, and `UnsupportedMediaType` all define an `example` that includes a `code` field. \\n*   **Store API**: Error responses for operations like retrieving API comments or adding a comment also include the `code` field.  \\n\\n## Documentation References\\n\\nThe documentation for Synapse properties, specifically in `all-in-one-apim/docs/xdoc/mediators/property.xml` , `traffic-manager/docs/xdoc/configuration_language.xml` , and `gateway/docs/xdoc/mediators/property.xml` , explicitly mentions `ERROR_CODE` as a well-defined property that is set to any error message code encountered during a fault. The `traffic-manager/docs/xdoc/properties_guide.xml`  further elaborates that this property can be used to set a custom error code and is automatically populated if Synapse encounters an error.\\n\\n## Notes\\n\\nThe `messageCode` field mentioned in the prompt appears to correspond to the `code` field in the OpenAPI definitions and the `ERROR_CODE` Synapse property. The requirement strength \"SHALL\" is met as the `code` field is marked as `required: true` in the OpenAPI schemas.  The test criteria can be verified by checking that error responses containing additional error information indeed include the `code` field, as demonstrated by the `example` sections in the OpenAPI specifications. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6fd9a644-5a08-4017-bd1c-5394dc0f709d\\n', 'id': 'lc_9fcc83b5-cfad-412c-9c1a-169117350de2'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0007",
      "requirement": {
        "requirement_id": "ATOM_062",
        "requirement_text": "The system MUST support consent status 'revokedByPsu' when consent has been revoked by the PSU.",
        "strength": "MUST",
        "capability": "Consent Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0007_1",
          "text": "### revokeConsent method\n\nThis method lets you revoke a consent by performing the following: \n\n - Retrieves the consent for status validation\n - Updates the existing status of the consent\n - Creates an audit record for the consent update\n - Updates the account mapping status as inactive\n\n``` java\nboolean revokeConsent(String consentID, String revokedConsentStatus) throws ConsentManagementException;\n```\n\nTo revoke tokens related to a consent, invoke the method by setting the `shouldRevokeTokens` flag `true`.\n\n``` java\nboolean revokeConsent(String consentID, String revokedConsentStatus, String userID, boolean shouldRevokeTokens) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_2",
          "text": "### Revoking a consent\n\n- To revoke a consent, review the details and click **Stop Sharing**. \n    \n    ![consent details](../assets/img/learn/consent-manager/stop-sharing.png)\n    \n- Revoking a consent consists of 2 steps:\n\n    - Step 1: The first step shows the impact of withdrawing the consent.\n    \n        ![stop sharing step 1](../assets/img/learn/consent-manager/stop-sharing-step1.png)\n    \n    - Step 2: Displays the information the consent has access to. \n    \n        ![stop sharing step 2](../assets/img/learn/consent-manager/stop-sharing-step2.png)\n    \n- Once you click **Stop Sharing**, the status of the consent changes to `withdrawn`. You can find this consent in the \n**Withdrawn** tab now.\n\n<!-- !!!note\n    To learn about customizing the Consent Manager Portal, see the [Customize the Consent Manager Portal](../develop/customize-consent-manager-portal.md) documentation. -->",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_3",
          "text": "### revokeExistingApplicableConsents method\n\nThis method lets you revoke existing consents for a given combination of `clientID`, `userID`, `consent type`, and \n`status` parameters. It also revokes any tokens related to the consents if the `shouldRevokeTokens` flag is set to `true`.\n\n``` java\nboolean revokeExistingApplicableConsents(String clientID, String userID, String consentType, String applicableStatusToRevoke, String revokedConsentStatus, boolean shouldRevokeTokens) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_4",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_5",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support consent management, including the revocation of consent. However, the specific consent status `revokedByPsu` is not explicitly mentioned in the provided code snippets. The system does have mechanisms for revoking tokens and managing consent, which could be related to a PSU-initiated revocation.\\n\\n### Implementation Details\\nThe `wso2/product-is` repository includes integration tests related to consent management and token revocation. The `SelfSignUpConsentTest` class   demonstrates how consent is collected during self-registration. The `getConsentReqBody` method in this class constructs a JSON request body for consent, which includes `purposeId`, `piiCategoryId`, and `validity` information . While this snippet focuses on granting consent, the presence of consent management APIs suggests that revocation functionality would also be handled through similar mechanisms.\\n\\nToken revocation is explicitly tested in several classes. For instance, `OAuth2TokenRevocationWithRevokedAccessToken` tests the behavior of OAuth token revocation flow, including revoking an access token and then attempting to revoke it again . This test verifies that after revocation, the token is no longer active . Another test, `OAuth2TokenRevocationAfterAccountDisablingTestCase`, checks if access tokens are revoked when a user account is disabled . The `OAuth2ServiceJWTGrantTestCase` also includes a test for access token revocation flow for JWT bearer grants .\\n\\nThe `MeAuthorizedAppsScopeTest` class demonstrates that when authorized applications are deleted, their corresponding access tokens are revoked . This indicates a system-wide mechanism for invalidating tokens based on user actions.\\n\\n### Configuration Options\\nThe `default-identity.xml` configuration file contains a `<Consent>` section with an `<EnableSSOConsentManagement>` flag . Setting this to `true` enables consent management during SSO. This suggests that consent is an integral part of the authentication and authorization process.\\n\\n### API Endpoints or Features\\nThe `SelfSignUpConsentTest` class references the `CONSNT_ENDPOINT_SUFFIX` constant, which points to `/api/identity/consent-mgt/v1.0/consents` . This endpoint is used to retrieve consent receipts . The `default-identity.xml` also defines resources for consent management APIs, including endpoints for managing purposes, PII categories, and purpose categories . These APIs support `POST`, `GET`, and `DELETE` operations, implying that consent can be added, retrieved, and removed. The `DELETE` operations on these resources could be the mechanism through which a PSU initiates consent revocation.\\n\\nThe `OAuth2ServiceAbstractIntegrationTest` class includes methods like `sendApprovalPostWithConsent`  which are used to approve consent. While there isn\\'t a direct `revokeConsent` method visible in the provided snippets, the presence of `DELETE` operations on consent resources in the REST API configuration suggests that revocation is handled via these endpoints.\\n\\n### Documentation References\\nThe provided wiki page on \"Integration Tests\" mentions \"Self-Registration and Consent Tests\" and specifically refers to `SelfSignUpConsentTest` for validating user self-registration functionality and consent management . This wiki page also outlines the purpose of these tests, which includes consent collection during self-registration .\\n\\n## Notes\\nThe term `revokedByPsu` is not explicitly found in the provided code snippets. However, the system clearly supports consent management and token revocation. It is highly probable that a PSU-initiated revocation would be handled through the existing consent management APIs, likely via a `DELETE` operation on a consent resource, which would then internally update the consent status. The integration tests demonstrate that token revocation leads to tokens becoming inactive, which aligns with the outcome of a consent revocation. The exact status string `revokedByPsu` might be an internal representation or a specific value used in a different part of the system not covered by these snippets.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9b94c5ee-5eae-47d1-b941-5fb123ef1a38\\n', 'id': 'lc_8a5433b9-b9e7-41d1-88e2-a4fb0ecc7c81'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_e4a95b31-9be0-4c78-85cd-c609ddb3198e'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0008",
      "requirement": {
        "requirement_id": "ATOM_164",
        "requirement_text": "The system SHALL ensure account-id remains constant at least throughout the lifecycle of a given consent",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0008_1",
          "text": "## Persist\n\nThe second endpoint of the Consent Authorize component is the Persist Flow. The Persistent Steps are engaged once the \nuser approves/denies the consent via an API invocation made from the consent page. When the `/persist` endpoint is \ninvoked, the steps to persist are also invoked and the data required for persistence will be provided to these steps.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_2",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_3",
          "text": "## **Usage** **>> consent-cleanup.sql** This is a consent data cleanup script with batch wise delete, This procedure includes the cleanup of consents from the respective tables of *FS_CONSENT* , *FS_CONSENT_AUTH_RESOURCE* , *FS_CONSENT_MAPPING* , *FS_CONSENT_FILE* , *FS_CONSENT_ATTRIBUTE* , *FS_CONSENT_STATUS_AUDIT* 1. Compile the stored procedure. 2. Execute the compiled store procedure. **Data retention feature:** - If enabled, all the purged consents will be stored in temporary retention tables in the consent database. *- Logical condition and configs used for consent purging and data retention.* *CONSENT DATA PURGING PARAMETERS* - `consentTypes` - consent_types which should be eligible for purging. (ex : 'accounts,payments', leave as empty to skip) - `clientIds` - client_ids which should be eligible for purging. (leave as empty to skip) - `consentStatuses` - consent_statuses which should be eligible for purging. (ex : 'expired,revoked') - `purgeConsentsOlderThanXNumberOfDays` - time period to delete consents older than `n` days. (check below for more info.) - `lastUpdatedTime` - last_updated_time for purging, (if consent's updated time is older than this value then it's eligible for purging, check below for more info.) - Here if we wish to purge consents with last updated_time older than 31 days (1 month), we can configure `purgeConsentsOlderThanXNumberOfDays` = `31` this value is in no. of days. - If we wish to configure exact timestamp of the `lastUpdatedTime` rather than a time period, we can ignore configuring `purgeConsentsOlderThanXNumberOfDays` = `NULL`, and only configure lastUpdatedTime with exact unix timestamp. - `ex : lastupdatedtime = 1660737878;` *CONSENT DATA RETENTION PARAMETERS* - `enableDataRetention` - set true for enable data retention (archive purged data, default : false) - Note: When running backup procedure (consent-cleanup-restore.sql) to restore back the purged data with the retention feature enabled, make sure to clean retention tables to avoid duplicates when purging again. Note: below data retention parameters need to set in the scripts before compiling, Ignore if data retention is not enabled. - `enableDataRetentionForAuthResourceAndMapping` - enable storing auth resource and consent mapping tables for retention data. - `enableDataRetentionForFsConsentFile` - enable storing fs_consent_file table for retention data. - `enableDataRetentionForFsConsentAttribute` - enable storing fs_consent_attribute table for retention data. - `enableDataRetentionForFsConsentStatusAudit` - enable storing fs_consent_status_audit table for retention data. *OTHER PARAMETERS* - `backupTables` - enable the backup table to restore later at a later stage. (Please note this backup tables will be overwritten every time you run the cleanup script.). - Also, this would not capture the consents which were created in between the backup task and the cleanup iteration, hence if consents created after the backup task will not be able to restore if its get deleted from the cleanup iteration. - `enableAudit` - By setting this parameter to true, will log each of deleted consents in the auditlog_fs_consent_cleanup table for track them in a later time. Once compiled the stored procedure, We can execute the procedure with input parameters as in below example. (for mysql) ``` WSO2_FS_CONSENT_CLEANUP_SP( consentTypes, clientIds, consentStatuses, purgeConsentsOlderThanXNumberOfDays, lastUpdatedTime, backupTables, enableAudit, analyzeTables, enableDataRetention ); ``` ``` Ex: mysql> call WSO2_FS_CONSENT_CLEANUP_SP('accounts,payments', 'clientId1,clientId2', 'expired,revoked', 31, NULL, TRUE, TRUE, TRUE, FALSE); ``` Please refer the README.md file on each DB type for more information. *CONFIGURABLE",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_4",
          "text": "### reAuthorizeExistingAuthResource method\n\nThis method lets you update the account mappings in consent reauthorization scenarios. \n\n - The account mappings are updated according to the additions/removals in the new authorization \n - Updates the status of a consent with a provided status \n - Amends accounts\n\n``` java\nboolean reAuthorizeExistingAuthResource(String consentID, String authID, String userID, Map<String, ArrayList<String>> accountIDsMapWithPermissions, String currentConsentStatus, String newConsentStatus) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_5",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the requirement that the `account-id` remains constant throughout the lifecycle of a given consent. This is primarily handled within the Consent Management framework, which is a core feature of WSO2 Identity Server  . The system ensures this by associating consent receipts with a `piiPrincipalId`, which represents the user\\'s account ID .\\n\\n## Implementation Details\\n\\nThe Consent Management framework in WSO2 Identity Server is designed to collect, store, and manage user consent for personal data processing . When a user provides consent, a consent receipt is generated and stored . This receipt includes a `piiPrincipalId`, which is the identifier for the user (account-id) for whom the consent is given .\\n\\nThe `SelfSignUpConsentTest.java` integration test demonstrates this by:\\n1.  Enabling self-registration and adding a financial purpose for consent .\\n2.  Performing a self-registration with a specific username (e.g., \"EBONY\") . This `selfRegister` method constructs a JSON request body that explicitly includes the `piiPrincipalId` (username) within the consent object .\\n3.  Retrieving the consents for the registered user using the `getConsents` method, which queries the consent endpoint with the `piiPrincipalId`  .\\n4.  Asserting that the retrieved consent receipt contains the correct `consentReceiptID` and `collectionMethod` .\\n\\nThe `piiPrincipalId` is directly embedded in the consent request body when a consent is created . This ensures that the consent is always tied to that specific identifier.\\n\\n## Configuration Options\\n\\nThe `default-identity.xml` file contains configuration related to consent management . Specifically, the `<Consent>` section includes `<EnableSSOConsentManagement>` which, when set to `true`, enables consent management during Single Sign-On (SSO) . While this option enables the overall consent flow, it doesn\\'t directly configure the immutability of the `account-id` within a consent, as that is an inherent design principle of how consents are linked to users.\\n\\n## API Endpoints or Features\\n\\nThe following API endpoints are relevant to consent management and implicitly ensure the constancy of the `account-id` through the `piiPrincipalId` parameter:\\n*   `/api/identity/consent-mgt/v1.0/consents`: This endpoint is used to manage consents . The `SelfSignUpConsentTest` uses a similar endpoint `CONSNT_ENDPOINT_SUFFIX = \"/api/identity/consent-mgt/v1.0/consents\"` to retrieve consents for a given user  .\\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/{receiptId}`: This endpoint is used to retrieve a specific consent receipt by its ID . The `SelfSignUpConsentTest` uses this to fetch a detailed consent receipt . The `piiPrincipalId` is part of the consent receipt, ensuring the link to the original account ID.\\n\\nThe `OIDCSSOConsentTestCase` also demonstrates consent management during OIDC SSO flows, where consent is prompted and approved for specific claims  . The `sessionDataKeyConsent` is used to manage the consent flow during authentication  .\\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, highlighting its purpose in collecting, storing, and managing user consent for personal data processing . It also mentions key consent components like PII Categories, Purposes, Purpose Categories, and Consent Receipts . The enforcement section explains that only attributes with consent are included in tokens and API responses, which implies a strong link between the consent and the user\\'s identity (account-id) .\\n\\n## Notes\\n\\nThe term \"account-id\" in the prompt directly maps to `piiPrincipalId` in the context of consent management within this codebase . The system\\'s design ensures that this identifier, once associated with a consent receipt, remains constant, as demonstrated by the integration tests that retrieve and verify consent details based on this ID . The codebase does not explicitly define a separate \"account-id\" concept distinct from the user\\'s principal ID used in consent.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_456c915a-b640-4e38-8579-024f0b5c316e\\n', 'id': 'lc_2131f710-4add-4903-a26b-11368f31256a'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_3e9feef0-a64a-47eb-8fcf-5c89ed62a7e5'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0009",
      "requirement": {
        "requirement_id": "ATOM_028",
        "requirement_text": "All API methods addressing dynamically created resources SHALL only apply to resources created by the same TPP",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0009_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the requirement that API methods addressing dynamically created resources only apply to resources created by the same TPP (Third Party Provider). This is primarily enforced through multi-tenancy and organization-based access control mechanisms, ensuring that resources are isolated to their creating tenant or organization.  \\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server\\'s API Layer is designed with multi-tenancy and organization support, which inherently restricts access to resources based on the tenant or organization that created them. \\n\\n### Multi-tenancy Enforcement\\nThe system uses tenant-qualified URLs, meaning that API requests are routed to the appropriate tenant\\'s resources based on the tenant domain in the URL.  For example, an application created within `tenant1.com` cannot be accessed or modified by a request made to `tenant2.com`. \\n\\nThe `OAuthAppsWithSameClientIdTestCase.java` integration test demonstrates this by creating OAuth applications with the same client ID in two different tenants (`TENANT_1_DOMAIN` and `TENANT_2_DOMAIN`).  It then verifies that:\\n*   Retrieving an application by client ID from `TENANT_1_DOMAIN` only returns the application created in `TENANT_1_DOMAIN`. \\n*   Updating inbound configurations of an application in `TENANT_1_DOMAIN` does not affect the application in `TENANT_2_DOMAIN`. \\n*   Deleting an application in `TENANT_1_DOMAIN` does not delete the application in `TENANT_2_DOMAIN`. \\n*   Login attempts with a user from a different tenant fail, reinforcing the isolation. \\n\\n### Organization Support\\nSimilar to multi-tenancy, the API Layer also supports organization-based multi-tenancy using organization-qualified URLs.  This means resources created within a specific organization are accessible only within that organization\\'s context. \\n\\nThe `APIResourceInheritanceTestCase.java` demonstrates that system, tenant, and console feature APIs are not inherited by sub-organizations, ensuring isolation.  However, custom API resources created in a root organization can be inherited by sub-organizations, but modifications to these inherited resources are not allowed directly within the sub-organization.   This indicates a controlled inheritance model rather than free modification.\\n\\n## Configuration Options\\n\\nAccess control for API resources is managed through the `ResourceAccessControl` configuration in `default-identity.xml` and `encrypt-decrypt-persistence-enabled-identity.xml`.   These files define which API endpoints are secured and what permissions are required to access them.  For dynamically created resources, such as OAuth2 DCR (Dynamic Client Registration) endpoints, specific permissions like `/permission/admin/manage/identity/applicationmgt/create`, `/delete`, `/update`, and `/view` are assigned to control their lifecycle. \\n\\n## API Endpoints and Features\\n\\nThe API Layer provides distinct endpoints for managing resources, categorized into Server APIs and User APIs. \\n\\n### Application Management API\\nThe `Application Management API` (`/api/server/v1/applications`) allows administrators to perform CRUD operations on applications.  The tests confirm that these operations are tenant-specific. \\n\\n### API Resource Management Endpoints\\nThe `APIResourceManagementClient` interacts with API resource management endpoints, which are also tenant-aware. \\n*   `createAPIResource`: Creates an API resource within the context of the authenticated tenant/organization. \\n*   `getAPIResourcesWithFiltering`: Retrieves API resources, with filtering capabilities, specific to the tenant/organization. \\n*   `updateAPIResource`: Updates an existing API resource. \\n*   `deleteAPIResource`: Deletes an API resource. \\n\\nThese methods, as seen in `OAuth2RestClient.java` and `APIResourceManagementClient.java`, operate on resources identified by an `apiId` which is implicitly tied to the tenant/organization context of the authenticated request.  \\n\\n## Documentation References\\n\\nThe \"API Layer\" wiki page provides an overview of the API architecture, including API organization, versioning, and authentication/authorization mechanisms.  It explicitly mentions multi-tenancy support through tenant-qualified URLs and organization support through organization-qualified URLs, which are key to enforcing resource ownership. \\n\\n## Notes\\n\\nThe provided code snippets primarily consist of integration tests and configuration files. While these strongly indicate the intended behavior and enforcement of resource ownership by TPPs (through tenants and organizations), the core logic for this enforcement would reside within the server-side API implementation, which is not directly visible in the provided context. The tests, however, serve as strong evidence that the system is designed and verified to uphold this requirement. The term \"TPP\" is not explicitly used in the code, but the concept of a \"tenant\" or \"organization\" creating and owning resources aligns with the spirit of the requirement.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_47b71a4f-cb80-42df-93e6-041008da53d8\\n', 'id': 'lc_0f12af1c-45e7-45a9-933a-d311e6befe70'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0009_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the requirement that API methods addressing dynamically created resources only apply to resources created by the same TPP (Third Party Provider) through its multi-tenancy and role-based access control features. This is primarily demonstrated through integration tests that verify resource isolation between different tenants and users within the same tenant.   \\n\\n## Implementation Details\\n\\nThe WSO2 API Manager enforces resource isolation primarily through its tenant-aware architecture and fine-grained permission system. \\n\\n### Multi-Tenancy\\nThe system supports multiple tenants, where each tenant operates in an isolated environment.  Integration tests like `CrossTenantSubscriptionTestCase.java` explicitly verify that resources (APIs, Applications, Subscription Policies) created by one tenant are not accessible or modifiable by another tenant, unless explicitly shared.  For example, `testApplicationPolicyAvailabilityInTenant2` asserts that `Tenant1AppPolicy` is not found when queried by `apiStoreRestClientTenant2`, while `Tenant2AppPolicy` is found.  Similarly, `testCreateApplicationInTenant1FromTenant2UserNegative` and `testCreateApplicationInTenant2FromTenant1UserNegative` demonstrate that an application cannot be created using another tenant\\'s application policy, resulting in a `400` HTTP status code. \\n\\n### Role-Based Access Control (RBAC)\\nWithin a tenant, access to resources is controlled by user roles and permissions.  The `APICreationForTenantsTestCase` demonstrates how specific permissions, such as `/permission/admin/manage/api/create`, are required to create APIs.  If a user lacks the necessary permissions, API creation will fail with a response code other than `200 OK`. \\n\\nThe `CrossTenantSubscriptionTestCase` also illustrates how subscription policies can be restricted to specific roles.  For instance, `createSubscriptionPolicyForTenant1RoleRestricted` creates a policy that only allows users with \"role1\" to subscribe.  Attempts to subscribe to an API with a restricted policy by an unauthorized user result in a `403 Forbidden` error, as shown in `testCreateSubscriptionFromTenant2AppToTenant1APIRestrictedPolicy`. \\n\\n## API Endpoints and Features\\n\\nThe WSO2 API Manager\\'s Publisher and Store APIs are designed to enforce these access controls. \\n\\n*   **API Visibility**: APIs can be configured with different visibility levels, including `PUBLIC`, `PRIVATE`, and `RESTRICTED`.  The `APIVisibilityByDomainTestCase` verifies that APIs with private visibility are not visible to users in other domains (tenants). \\n*   **Subscription Availability**: APIs can specify `subscriptionAvailability` as `current_tenant`, ensuring that subscriptions are only available within the API\\'s tenant. \\n*   **`X-WSO2-Tenant` Header**: The `ApIsApi.java` client for the Publisher API includes an `X-WSO2-Tenant` header for cross-tenant invocations, allowing the system to retrieve resources from a specified tenant domain.  This header is used to explicitly target resources within a particular tenant. \\n\\n## Configuration Options\\n\\nThe `api-manager.xml` configuration file contains settings related to API Publisher and Store behavior, including access control.  The `<EnableAccessControl>` property within the `<APIPublisher>` section, when set to `true`, enables publisher access control support, which is crucial for enforcing resource ownership. \\n\\n## Documentation References\\n\\nThe `sample9/README.md` provides a business story and use cases for API Governance, including persona-driven governance models (\"who can do what when?\").  This aligns with the requirement of restricting resource access to the creating TPP.  It also mentions the need for separate tenants and custom throttling policies for different departments, further supporting the concept of isolated resource management. \\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests, which are excellent indicators of implemented functionality and how the system is expected to behave. The tests cover scenarios involving different tenants and users, explicitly verifying that resources created by one entity are not accessible or modifiable by another without proper authorization or sharing mechanisms. The `mistral-def.json` file contains a `created_by_me` query parameter, which is relevant to filtering resources based on the creator, but it\\'s a definition for an AI API and not directly related to the core API management resource ownership enforcement. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_5f1c39b5-ac0b-4c13-80e2-762504a89283\\n', 'id': 'lc_b1dd4887-042f-49c2-ba6d-288f60616513'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0010",
      "requirement": {
        "requirement_id": "ATOM_111",
        "requirement_text": "The API SHALL return HTTP response code 204 when DELETE is sufficient for cancelling the payment",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0010_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0010_2",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0010_3",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0010_4",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0010_5",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0010_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports returning an HTTP response code `204 No Content` when a `DELETE` operation successfully cancels a payment or consent.   This behavior is defined in the OpenAPI specifications for various API endpoints and is confirmed by integration tests.   \\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` repository defines API endpoints using OpenAPI specifications.  \\n\\n### API Endpoints and Features\\n\\n*   **Funds Confirmation Consents**: The `DELETE /funds-confirmation-consents/{ConsentId}` endpoint is designed to delete a funds confirmation consent.  Upon successful deletion, this API is specified to return an HTTP `204` status code.  The response `204FundsConfirmationConsentsConsentIdDeleted` is explicitly defined for this scenario. \\n*   **Account Access Consents**: Similarly, the `DELETE /account-access-consents/{ConsentId}` endpoint for account access consents also specifies a `204` response for successful deletion. \\n*   **Internal Consent Management**: An internal consent management endpoint, `DELETE /manage`, also returns a `204` status code for successful deletion operations.  Additionally, the `DELETE /admin/revoke` endpoint for revoking consents also returns `204` on success. \\n\\n### Configuration Options\\n\\nThe `ResponseStatus` enum in `org.wso2.financial.services.accelerator.consent.mgt.extensions.common` defines `NO_CONTENT` with a value of `204`, indicating that this status code is a recognized and supported response within the accelerator\\'s framework. \\n\\n### Documentation References\\n\\nThe `README.md` for the `consent.mgt.endpoint` module explicitly lists the `DELETE /admin/revoke` and `DELETE /manage` endpoints, both of which are documented to return `204` for successful operations. \\n\\n## Test Criteria Verification\\n\\nIntegration tests within the `fs-integration-test-suite` confirm that `DELETE` operations for consents return `204`.  For example, the `EndToEndAccountFlowTest.groovy` includes a test case \"Revoke a Created Consent\" which asserts that the `consentRevocationResponse.getStatusCode()` is equal to `ConnectorTestConstants.STATUS_CODE_204`.  The `ConnectorTestConstants.groovy` file defines `STATUS_CODE_204` as `204`. \\n\\nThe `doConsentRevocation` method in `FSAPIMConnectorTest.groovy` performs the actual `DELETE` request for consent revocation and returns the response, which is then asserted in the test cases.  Similar assertions for `204` status codes are present in tests related to Dynamic Client Registration (DCR) deletion.  \\n\\n## Notes\\n\\nThe provided context primarily focuses on the deletion of \"consents\" (e.g., `Funds Confirmation Consent`, `Account Access Consents`) rather than direct \"payment cancellation.\"   However, in Open Banking and financial services, cancelling a payment often involves revoking the associated consent. The `204 No Content` response for successful `DELETE` operations on these consent resources aligns with the requirement for successful cancellation without additional authorization.  \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e3663742-97a7-469e-9568-a6bc761bbf2d\\n', 'id': 'lc_79715d34-6428-4519-ab9c-be4a8a8293c6'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0011",
      "requirement": {
        "requirement_id": "ATOM_061",
        "requirement_text": "The system MUST support consent status 'expired' when consent has exceeded its validity period such as 90 days.",
        "strength": "MUST",
        "capability": "Consent Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0011_1",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0011_2",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0011_3",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0011_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0011_5",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0012",
      "requirement": {
        "requirement_id": "ATOM_098",
        "requirement_text": "Payment status request SHALL include mandatory X-Request-ID header with UUID format",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0012_1",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0012_2",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0012_3",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0012_4",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0012_5",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0012_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the requirement for payment status requests to include a mandatory `X-Request-ID` header in UUID format. This is primarily handled through the OpenAPI specifications for Payment Initiation APIs and is reflected in the demo backend service.  \\n\\n## Implementation Details\\n\\nThe OpenAPI specification for Payment Initiation APIs, specifically `payment-initiation-openapi.yaml`, defines `x-fapi-interaction-id` as a header parameter.  This header is described as \"An RFC4122 UID used as a correlation id.\"  While the `required` field for `x-fapi-interaction-id` is set to `false` in the parameter definition,  it is marked as `required: true` in the headers of various response schemas, such as `201PaymentsCreated` and `200PaymentsPaymentIdRead`.   This suggests that while the request might not strictly enforce it at the OpenAPI level, the responses consistently provide it, implying its importance for correlation.\\n\\nIn the demo backend service, `PaymentService.java`, the `getPaymentTypeFundsConfirmation` method explicitly sets the `x-fapi-interaction-id` header in the response with a newly generated UUID.  Similarly, the `paymentSubmission` method checks if the `x-fapi-interaction-id` header (`fid`) is present in the incoming request; if not, it generates a new UUID for it before including it in the response.   The `getPaymentTypePayment` method also includes a hardcoded `x-fapi-interaction-id` in its response. \\n\\nThe `FinancialServicesUtils.java` file contains a utility method `startsWithUUID` that uses a regular expression (`FinancialServicesConstants.UUID_REGEX`) to check if an input string starts with a UUID.  This indicates that UUID format validation is a recognized requirement within the codebase.\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoints for payment status requests are defined in `payment-initiation-openapi.yaml`  and include:\\n*   `GET /payment-consents/{consentId}`: To get payment consents. \\n*   `GET /payment-consents/{consentId}/funds-confirmation`: To get payment consents funds confirmation. \\n*   `GET /payments/{paymentId}`: To retrieve the status of a specific payment. \\n\\nThese endpoints are expected to handle the `x-fapi-interaction-id` header, which serves as the `X-Request-ID` for correlation. \\n\\n## Configuration Options\\n\\nWhile there isn\\'t an explicit configuration option to *mandate* the `X-Request-ID` header for payment status requests in the provided snippets, the consistent inclusion and generation of `x-fapi-interaction-id` in the `PaymentService.java`   and its definition as a required response header in the OpenAPI specification  suggests it\\'s a de facto requirement. The `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, handles general configuration for the accelerator, but specific header enforcement for `X-Request-ID` is not detailed in the provided context. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page mentions that the WSO2 Financial Services Accelerator implements regulatory standards for secure API access and compliance with financial industry requirements.  The OpenAPI specifications, such as `payment-initiation-openapi.yaml`, serve as documentation for the API contracts, including required headers like `x-fapi-interaction-id`. \\n\\n## Test Criteria\\n\\nThe integration test framework includes `PaymentRequestPayloads.groovy` and `RequestPayloads.groovy` which define test payloads.   These payloads explicitly include an `x-request-id` header with a UUID value (e.g., `\"1b91e649-3d06-4e16-ada7-bf5af2136b44\"`).   This indicates that the test suite verifies the presence and format of this header in requests. The `ConsentRequestBuilder.groovy` also explicitly sets the `X_FAPI_INTERACTION_ID` header with a randomly generated UUID for requests.  This confirms that the system is tested for the inclusion of a UUID-formatted `X-Request-ID` (referred to as `x-fapi-interaction-id` or `x-request-id` in the tests) in relevant API calls.\\n\\n## Notes\\n\\nThe prompt uses \"X-Request-ID\" while the codebase primarily uses \"x-fapi-interaction-id\" for the same purpose of a correlation ID in UUID format.   These terms appear to be interchangeable in this context. While the OpenAPI specification marks `x-fapi-interaction-id` as `required: false` for incoming requests, the demo backend and test cases strongly suggest that it is expected and handled, either by being present in the request or generated if missing.   The `x-idempotency-key` header is also defined as a required header in the OpenAPI specification for Payments, which is distinct from the `X-Request-ID` or `x-fapi-interaction-id`. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_ad2f482e-75f4-4426-8f57-7c0d0dd4330f\\n', 'id': 'lc_e56d64f3-f501-47b5-9a63-4202dfe016c9'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0013",
      "requirement": {
        "requirement_id": "ATOM_196",
        "requirement_text": "The Headers parameter must conditionally include tpp-redirect-uri if and only if TPP-Redirect-URI is included as a header of the HTTP-Request",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0013_1",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_2",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_3",
          "text": "# redirect_endpoint config defines the user's succesfull authorisations redirect endpoint. This page displays the succesful CIBA flow completions.\nredirect_endpoint = \"https://localhost:9446/authenticationendpoint/ciba.jsp\"",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_4",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the conditional inclusion of `tpp-redirect-uri` in a `Headers` parameter based on the presence of a `TPP-Redirect-URI` header in the HTTP request. The provided code snippets and wiki pages primarily focus on OAuth2/OIDC flows, application management, and DPoP (Demonstrating Proof-of-Possession) token binding, but do not show explicit handling or configuration options for a `tpp-redirect-uri` header.\\n\\n## Implementation Details and Configuration Options\\n\\nThe codebase includes `OAuth2RestClient.java`  which is a test client for OAuth2 operations. It contains methods for obtaining access tokens using authorization code grant types  and initiating authentication requests . The `initiateAuthRequest` method constructs query parameters for the authorization request, including `redirectUrl` . However, there is no indication of a `tpp-redirect-uri` being conditionally added to the request headers based on an incoming `TPP-Redirect-URI` header.\\n\\nThe `OAuth2DPopTestCase.java`  demonstrates the use of DPoP tokens, where a `DPOP_HEADER` is explicitly added to the request . While this shows header manipulation, it\\'s specific to DPoP and does not relate to `tpp-redirect-uri`.\\n\\nThe `OAuth2ServiceAuthCodeGrantTestCase.java`  and `OAuth2ServiceAuthCodeGrantCacheDisabledTestCase.java`  test cases also deal with authorization code grants and `redirect_uri` parameters, but again, there\\'s no mention of `tpp-redirect-uri` as a header or a conditional parameter.\\n\\nThe `Application Management` wiki page  and `OAuth2 and OpenID Connect` wiki page  describe various OAuth2/OIDC configurations, including `Callback URLs`  which are equivalent to `redirect_uri`. However, neither of these documents specifies a mechanism for handling `TPP-Redirect-URI` as an incoming HTTP header that would then conditionally add `tpp-redirect-uri` to a `Headers` parameter.\\n\\n## API Endpoints or Features\\n\\nThe API endpoints described in the `Application Management` wiki page  are for managing applications and their inbound protocols. While these APIs allow for configuration of OAuth2/OIDC applications, they do not expose a specific feature or endpoint related to the conditional handling of `tpp-redirect-uri` as described in your query.\\n\\n## Documentation References\\n\\nThe provided wiki pages and code comments do not contain any direct documentation references for the specific requirement of conditionally including `tpp-redirect-uri` based on the `TPP-Redirect-URI` HTTP header.\\n\\n## Notes\\n\\nThe term \"tpp-redirect-uri\" is often associated with Open Banking and Financial-grade API (FAPI) standards, where \"TPP\" stands for Third-Party Provider. While the `wso2/product-is` repository does mention FAPI conformance , the provided snippets do not contain specific implementation details for the conditional header handling you described. It\\'s possible that this functionality exists within the broader codebase but is not covered by the provided context.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d1fc5f34-217d-40cf-8b36-4489ffb7b487\\n', 'id': 'lc_211bbf7c-6bd0-4725-8872-a1cf168d7c9e'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_5",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports conditional inclusion of headers based on the presence of other headers in the HTTP request through its throttling policies. Specifically, you can define a `HeaderCondition` as part of a `ThrottleCondition` to check for a specific header and value.  This mechanism can be used to conditionally include `tpp-redirect-uri` if `TPP-Redirect-URI` is present in the request. \\n\\n## Implementation Details\\n\\nThe core of this functionality lies within the throttling policy definitions. The `admin-api.yaml` file defines the `HeaderCondition` schema, which includes `headerName` and `headerValue` properties.  This `HeaderCondition` is a type of `ThrottleCondition`  and can be part of a `ConditionalGroupDTO` for advanced throttling policies. \\n\\nThe `HeaderConditionDTO` Java class represents this header condition programmatically, with methods to set and retrieve the `headerName` and `headerValue`.    The `DtoFactory` class provides a utility method `createHeaderConditionDTO` to instantiate this object. \\n\\nThe `addHeader_v2.json` policy definition indicates that a policy named \"addHeader\" exists, which allows adding a new header to the request.  This policy takes `headerName` and `headerValue` as attributes.  This policy can be applied to \"request\", \"response\", and \"fault\" flows. \\n\\n## Configuration Options\\n\\nTo achieve the conditional inclusion of `tpp-redirect-uri`, you would configure a throttling policy with a `HeaderCondition`.  This policy would check for the presence of the `TPP-Redirect-URI` header.  If the condition is met, an \"addHeader\" policy can be triggered to include `tpp-redirect-uri` in the Headers parameter. \\n\\nThe `proxy_samples.xml` files demonstrate how conditional routing can be set up based on header matching using `<match type=\"header\" source=\"foo\" regex=\"bar.*\"/>`.  While this example shows conditional routing, the underlying mechanism of header matching can be adapted for conditional header addition.\\n\\n## API Endpoints or Features\\n\\nThe `admin-api.yaml` defines the structure for `ThrottleCondition` and `HeaderCondition`, indicating that these are exposed via an administrative API.  This suggests that you can manage these conditional header policies through API calls.\\n\\nThe `addHeader` policy is a mediation policy  that can be applied to API flows. \\n\\n## Documentation References\\n\\nThe `admin-api.yaml` file itself serves as a documentation reference for the API, detailing the schema for `HeaderCondition` and `ThrottleCondition`.  Additionally, the `addHeader_v2.json` files provide a description of the \"Add Header\" policy. \\n\\n## Notes\\n\\nThe provided snippets indicate that the system supports defining conditional logic based on HTTP headers for throttling purposes. While the examples primarily focus on throttling, the underlying mechanism of header condition evaluation and the existence of an \"addHeader\" policy suggest that the requirement of conditionally including a header can be met. The `invertCondition` property in `ThrottleConditionDTO`  could be used to implement the \"if and only if\" aspect of the requirement, by combining it with other conditions if necessary.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_037d0ff5-9cf1-4eb9-9e25-e5fb6e464cb6\\n', 'id': 'lc_cbfdb203-8849-4076-b06f-fb444de1b92d'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0014",
      "requirement": {
        "requirement_id": "ATOM_165",
        "requirement_text": "The system SHALL require X-Request-ID header as mandatory UUID for card account balance requests",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0014_1",
          "text": "## Writing a custom ID Token Builder\n\nThe default ID Token Builder in WSO2 Open Banking provides the pairwise subject calculation for authorization and token \nflow.\n\nIf the API consumer application supports the sector identifier URI parameter, the pairwise subject calculation is \nperformed using the **sector identifier URI**. Otherwise, the calculation is performed using the **callback URI**.\n\nGiven below is the Fully Qualified Name (FQN) of the default ID Token Builder: \n\n``` java\ncom.wso2.openbanking.accelerator.identity.idtoken.OBIDTokenBuilder\n```\n\nYou can implement a custom ID Token Builder for the **Authorization flow** by overriding the following method of this class:",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_2",
          "text": "## Writing a custom ID Token Builder\n\nThe default ID Token Builder in WSO2 Open Banking provides the pairwise subject calculation for authorization and token \nflow.\n\nIf the API consumer application supports the sector identifier URI parameter, the pairwise subject calculation is \nperformed using the **sector identifier URI**. Otherwise, the calculation is performed using the **callback URI**.\n\nGiven below is the Fully Qualified Name (FQN) of the default ID Token Builder: \n\n``` java\ncom.wso2.openbanking.accelerator.identity.idtoken.OBIDTokenBuilder\n```\n\nYou can implement a custom ID Token Builder for the **Token flow** by overriding the following method of this class:",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_3",
          "text": "### Account Information Service\n\nIf the API consumer application is aggregating account information on behalf of the bank user, the APP-to-APP redirection \nflow is as follows: \n\n[ ![](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Account Information Service, it is known as an Account Information Service Provider (AISP).\n\n| Implementation | Requirement | Participant |\n|----------------|-------------|-------------|\n| A- AISP requests the bank customer to identify the bank. | Required | AISP |\n| B- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | bank |\n| C- The customer consents to the accounts, which the AISP is allowed to have access | Required | Bank |\n| D- Confirms the completion of AIS request | Recommended | AISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_4",
          "text": "##Writing a Custom Request Object Validator\nA Request Object contains authentication and authorization request parameters in a self-contained JWT. It is used in the \nauthorization endpoint of WSO2 Identity Server. Banks can use this authorization endpoint \nto redirect the bank customer to authenticate and approve/deny consents before an API consumer accesses financial \ninformation. \n\nIn WSO2 Open Banking Accelerator, the Request Object validator uses its existing validation layer to enforce validations. By \ndefault, it consists of 3 validations:\n\n   - `@RequiredParameter` checks if the Request Object is signed.\n   - `@ValidScopeFormat` checks if the scope claim contains an OpenID Connect(OIDC) scope.\n   - `@ValidAudience` checks if the audience claim matches the token endpoint URL.\n   - `@ValidSigningAlgorithm` checks if the correct signing algorithm is used.\n\nFor more information on the validation layer in WSO2 Open Banking Accelerator, see [Validation Layer](../develop/validation-layer.md).\n\nYou can extend the default validations in WSO2 Open Banking Accelerator and add more validations according to your open \nbanking requirement:\n\n1. To implement a custom Request Object validator, extend the following class:\n``` java\ncom.wso2.openbanking.accelerator.identity.auth.extensions.request.validator.OBRequestObjectValidator\n``` \n\n2. Add the required validations as annotations to the model. \n\n    !!!note\n        For annotations, you can use:\n    \n        - Hibernate Validator Library\n        - WSO2 Open Banking Accelerator\n        - Custom annotations\n    \n3. Extend `OBRequestObjectValidator` and create your own class.\n\n###validateOBConstraints method\nThis method performs the custom validations you add. Given below is the method signature:\n``` java\npublic ValidationResponse validateOBConstraints(OBRequestObject obRequestObject, Map<String, Object> dataMap) \n```\n\n!!!note\n    The `dataMap` parameter contains data related to scope validation at the moment. This `dataMap` parameter provides \n    the scope registered for the service provider application. Therefore, this can be used to validate the scopes given \n    in the Request Object according to your requirement.      \n \n- Type cast `OBRequestObject` to your own model using the following sample:\n  ```\n    UKRequestObject ukRequestObject = new UKRequestObject(obRequestObject);\n  ```\n   \n4. To make sure the default validations of the Request Object executes, validate your new model, which is inherited \nfrom `obRequestObject` as follows:\n``` java\nString error = OpenBankingValidator.getInstance().getFirstViolation(yourInheritedNewModel);\n```\n\n##Configuring a custom Request Object Validator \n1. Make sure the following configuration exists in `<IS_HOME>/repository/conf/deployment.toml`:\n``` java\n[oauth.oidc.extensions]\nrequest_object_validator = \"com.wso2.openbanking.accelerator.identity.auth.extensions.request.validator.OBRequestObjectValidationExtension\"\n```\n\n2. Update the following configuration in `<IS_HOME>/repository/conf/deployment.toml` with your extended class: \n``` java \n[open_banking.identity.extensions]\nrequest_object_validator = \"your.extended.class\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_5",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to explicitly support a mandatory `X-Request-ID` header as a UUID for \"card account balance requests\" based on the provided code snippets. The codebase primarily focuses on Identity and Access Management (IAM) functionalities, including OAuth2/OIDC, SAML, user management, and API management. While there are mentions of UUID generation and handling of `X-Fapi-Interaction-Id` in a conformance test, there\\'s no direct evidence of a system-wide enforcement or configuration for a mandatory `X-Request-ID` header for specific financial transactions like card account balance requests.\\n\\n### Implementation Details and API Endpoints\\n\\nThe provided code snippets do not contain any direct implementation details or API endpoints that specifically enforce a mandatory `X-Request-ID` header as a UUID for \"card account balance requests\" <cite/>. The `wso2/product-is` repository is an Identity and Access Management (IAM) solution .\\n\\nThere is a `UUID Generator feature` mentioned in the `modules/p2-profile-gen/pom.xml` file . This indicates that the system has the capability to generate UUIDs, but it does not imply a mandatory `X-Request-ID` header requirement for specific API calls.\\n\\nIn the `oidc-fapi-conformance-tests/resource-server/resource-server.py` file, there is a Flask application that handles an `X-Fapi-Interaction-Id` header . If this header is not present, a new UUID is generated and assigned to it . This is within a conformance test for Financial-grade API (FAPI)  and demonstrates a pattern of using UUIDs for interaction IDs, but it\\'s not a general enforcement for all requests or specifically for \"card account balance requests\" <cite/>. The `resource-server.py` file is part of `oidc-fapi-conformance-tests`, which suggests it\\'s a testing utility rather than a core product feature .\\n\\n### Configuration Options\\n\\nNo configuration options were found in the provided snippets that would allow for the enforcement of a mandatory `X-Request-ID` header as a UUID for \"card account balance requests\" <cite/>. The `Configuration System` described in the architecture wiki page outlines how WSO2 Identity Server handles dynamic configuration . However, none of the listed configuration components (`default.json`, `infer.json`, `key-mappings.json`, `validator.json`, `deployment.toml`) or their descriptions indicate support for such a specific header requirement .\\n\\n### Documentation References\\n\\nThe provided context does not include any documentation references that describe the requirement for a mandatory `X-Request-ID` header as a UUID for \"card account balance requests\" <cite/>. The \"Architecture\" wiki page provides a high-level overview of the system , but it does not delve into such specific API header requirements.\\n\\n## Notes\\n\\nThe user\\'s query specifically asks about \"card account balance requests,\" which implies a financial services context. While the `wso2/product-is` repository includes support for Financial-grade API (FAPI) , the provided snippets do not show any direct implementation or configuration for enforcing an `X-Request-ID` header for such specific requests. The `X-Fapi-Interaction-Id` handling in `resource-server.py` is a relevant example of using UUIDs for interaction IDs in a FAPI context , but it\\'s part of a conformance test and not a general system-wide enforcement. The `UUID Generator feature`  indicates the capability to generate UUIDs, but not a mandate for their use in a specific header for particular requests.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_7851dda5-4cad-4c8e-aa74-ead6e3452db0\\n', 'id': 'lc_ab2c52d8-689b-4c06-9867-9250158b2164'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_70db9c73-b6f1-40d6-a572-a3f64ea0ae76'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0015",
      "requirement": {
        "requirement_id": "ATOM_148",
        "requirement_text": "Standing order details MUST include frequency and execution rule information",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f30dd2c91d5e",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0015_1",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports standing order details including frequency and execution rule information. This is evident in the test framework\\'s payload definitions for domestic standing orders  . The `Frequency` field is explicitly included in these payloads, and while `executionRule` is not directly present, the `Authorisation` block with `AuthorisationType` and `CompletionDateTime` fields   serves a similar purpose in defining how the standing order is executed.\\n\\n## Implementation Details\\n\\nThe implementation details are primarily found within the test framework, specifically in the `PaymentRequestPayloads.groovy`  and `RequestPayloads.groovy`  files. These files define the JSON structures used for initiating various payment requests, including domestic standing orders.\\n\\n### Standing Order Payload Structure\\n\\nThe `initiationPayloadDomesticStandingOrderPayment` method in `PaymentRequestPayloads.groovy`  and `initiationPaymentPayloadWithCustomValues` in `RequestPayloads.groovy`  demonstrate the expected structure for standing order initiation. Key fields related to the user\\'s query are:\\n\\n*   **`Data.Initiation.Frequency`**: This field is used to specify the frequency of the standing order  .\\n*   **`Data.Authorisation.AuthorisationType`**: This field, along with `CompletionDateTime`, defines the execution rule or authorization details for the standing order  .\\n\\nThe `getParameterValue` method   is used to dynamically populate these fields from a `parameterMap` or fall back to default values defined in `defaultValueMap`  .\\n\\n## Configuration Options\\n\\nThe `defaultValueMap`   provides default values for various parameters, including `Frequency` (e.g., \"EvryDay\")  and `AuthorisationType` (e.g., \"Any\") . These can be overridden by providing a `parameterMap` to the payload generation methods.\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint for domestic standing order consents is `/open-banking/v3.1/pisp/domestic-standing-order-consents` . For submitting domestic standing orders, the endpoint is `/open-banking/v3.1/pisp/domestic-standing-orders` . These endpoints are defined as constants in `ConnectorTestConstants.groovy`  .\\n\\n## Documentation References\\n\\nThe provided code snippets are part of the `fs-integration-test-suite`      , which suggests that these structures are used for testing the functionality of the Financial Services Accelerator. The presence of these fields in test payloads indicates that the underlying system is designed to handle and process them.\\n\\n## Notes\\n\\nThe user\\'s query specifically mentions `additionalInformationStructured.standingOrderDetails` with `frequency` and `executionRule` fields. While the provided code snippets show `Frequency` directly under `Initiation`  , the `Authorisation` block   within the `Data` object likely fulfills the \"execution rule information\" requirement, even if the exact field name `executionRule` is not used. The `TestConstants.java` file also contains similar payment initiation and submission payloads with `Frequency` and other payment details .\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-s_74585ff9-e5d6-4534-b43d-461f44c0ca0f\\n', 'id': 'lc_cec9521a-912d-412c-a532-8595a06aceb7'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0016",
      "requirement": {
        "requirement_id": "ATOM_005",
        "requirement_text": "The TPP certificate content SHALL be compliant with EBA-RTS requirements.",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0016_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports aspects related to certificate handling, particularly within the context of OAuth2 and JWKS endpoints. While there isn\\'t explicit mention of \"EBA-RTS requirements\" or \"TPP certificate content\" in the provided snippets, the codebase demonstrates the ability to process and validate X.509 certificates, which are fundamental to such requirements. The system can extract and validate certificate thumbprints, which is a common requirement for certificate compliance.\\n\\n### Implementation Details\\nThe `wso2/product-is` repository includes functionality to handle X.509 certificates, specifically for validating JSON Web Key Sets (JWKS) endpoints. The `Oauth2JWKSEndpointTestCase.java` file contains methods that retrieve public key sets from JWKS endpoints, extract X.509 certificates, and calculate their SHA256 thumbprints for validation . The `getX509CertSHA256Thumbprint` method parses a base64 encoded certificate string into an `X509Certificate` object and then uses the Nimbus JOSE+JWT library to compute the SHA256 thumbprint . The `parseCertificate` method handles the base64 decoding and certificate factory instantiation for X.509 certificates .\\n\\nThe `PreUpdatePasswordActionFailureTest.java` file also indicates that certificate content can be validated, as it includes a test case for an \"invalid password sharing certificate\" which results in a `BAD_REQUEST` status code and a description stating \"Certificate content is invalid.\" . This suggests that there are underlying mechanisms to check the validity of certificate content.\\n\\n### Configuration Options\\nWhile explicit configuration options for EBA-RTS compliance are not detailed, the system does allow for the configuration of certificates. The `AdvancedApplicationConfiguration.java` file includes a `Certificate` object as part of advanced application configurations . This suggests that applications can be configured with specific certificates.\\n\\nThe `identity-skipuserconsent.xml` file shows a `UserTrustedRPStore` configuration, which specifies the location, type (PKCS12), and passwords for a keystore containing trusted relying party certificates . This indicates that the system can be configured to trust specific certificates.\\n\\n### API Endpoints or Features\\nThe `Oauth2JWKSEndpointTestCase.java` tests the `/oauth2/jwks` endpoint for both super tenant and tenant contexts  . This endpoint exposes the public keys in JWKS format, which would include X.509 certificate chains (`x5c`) and SHA256 thumbprints (`x5t#S256`) . The presence of these fields and their validation in the test case implies that the system provides these details through its API.\\n\\nThe `Features and Capabilities` wiki page also mentions \"Financial-grade API (FAPI) Support\" <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" wiki=\"Features and Capabilities\" start=\"1.2\" end=\"1.2\" />. FAPI is a set of security profiles that build on OAuth 2.0 and OpenID Connect, often requiring advanced certificate handling and validation, which aligns with EBA-RTS requirements for strong customer authentication and secure communication. The `oidc-fapi-conformance-tests/constants_fapi.py` file defines various FAPI-related application configurations, including `jwks_uri` for client applications . This further supports the idea that the system is designed to handle certificate-based security in a financial context.\\n\\n### Documentation References\\nThe `Features and Capabilities` wiki page provides a high-level overview of the WSO2 Identity Server\\'s capabilities, including support for OAuth 2.0, OpenID Connect, and Financial-grade API (FAPI) <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" wiki=\"Features and Capabilities\" start=\"1.2\" end=\"1.2\" />. While it doesn\\'t directly mention EBA-RTS, FAPI support is a strong indicator of compliance with such regulations, as FAPI profiles often incorporate requirements similar to those found in EBA-RTS for secure API access and strong customer authentication.\\n\\n## Notes\\nThe provided code snippets and wiki page do not explicitly mention \"EBA-RTS requirements\" or \"TPP certificate content.\" However, the presence of robust certificate handling, JWKS endpoint support, and Financial-grade API (FAPI) capabilities strongly suggests that the WSO2 Identity Server is designed to meet the underlying technical requirements for secure certificate usage in regulated environments like those specified by EBA-RTS. The system\\'s ability to validate certificate content and thumbprints is a key aspect of ensuring compliance with certificate structure and field specifications.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_969d22b6-c977-46a5-bca7-2cf3ccd1bdc5\\n', 'id': 'lc_88fd83fb-0851-4017-946f-0c140b07be27'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0016_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, provides functionalities for managing client and endpoint certificates, but it does not explicitly support or validate TPP certificate content against EBA-RTS requirements. The provided code snippets primarily deal with the uploading, retrieving, updating, and deleting of certificates, without specific checks for EBA-RTS compliance. \\n\\n## Implementation Details\\n\\nThe codebase includes API clients for managing both client certificates and endpoint certificates. \\n\\n### Client Certificates\\nThe `ClientCertificatesApi.java`  class provides methods to interact with client certificates:\\n*   `addAPIClientCertificate`: Uploads a new client certificate for an API, requiring `apiId`, `certificate` file, `alias`, and `tier`. \\n*   `getAPIClientCertificateContentByAlias`: Downloads a client certificate by its alias. \\n*   `getAPIClientCertificateContentByKeyTypeAndAlias`: Downloads a client certificate by alias and key type. \\n*   `updateAPIClientCertificateByAlias`: Updates an existing client certificate. \\n\\n### Endpoint Certificates\\nThe `EndpointCertificatesApi.java`  class handles endpoint certificates:\\n*   `addEndpointCertificate`: Uploads a new certificate for an endpoint, requiring a `certificate` file, `alias`, and `endpoint`. \\n*   `deleteEndpointCertificateByAlias`: Deletes an uploaded certificate using its alias. \\n*   `getEndpointCertificateByAlias`: Retrieves information about a certificate using its alias. \\n*   `getEndpointCertificateContentByAlias`: Downloads a certificate by its alias. \\n*   `getEndpointCertificates`: Retrieves and searches for uploaded certificates based on `limit`, `offset`, `alias`, and `endpoint`. \\n*   `updateEndpointCertificateByAlias`: Updates an uploaded certificate. \\n\\nThe `APIEndpointCertificateTestCase.java`  demonstrates how these endpoint certificate APIs are used in integration tests, including assertions on certificate status, subject, and validity. \\n\\n## Configuration Options\\n\\nThe provided snippets do not show explicit configuration options for EBA-RTS compliance. The `deployment.toml`  file indicates keystore configurations, but these are general settings for TLS and not specific to TPP certificate content validation. \\n\\n## API Endpoints or Features\\n\\nThe API endpoints related to certificate management are exposed through the `ClientCertificatesApi`  and `EndpointCertificatesApi`  classes. These APIs allow for the programmatic management of certificates. However, there are no specific API endpoints or features mentioned that directly perform EBA-RTS compliance checks on the content of TPP certificates.\\n\\n## Documentation References\\n\\nThe `ClientCertificatesApi.md`  file provides documentation for the `ClientCertificatesApi`, including examples of how to use the API to download certificates.  This documentation describes the available operations and their parameters. \\n\\n## Conclusion\\n\\nBased on the provided codebase, there is no explicit support or validation for TPP certificate content to be compliant with EBA-RTS requirements. The existing certificate management features focus on the lifecycle of certificates (upload, retrieve, update, delete) without specific checks for regulatory compliance standards like EBA-RTS. \\n\\n## Notes\\n\\nThe `APIComplianceTestCase.java`  file exists in the codebase and mentions \"APIM Governance\" and \"PolicyAdherenceWithRulesetsDTO\" , which might suggest some form of compliance checking. However, the provided snippet does not contain details about EBA-RTS or TPP certificates, so it\\'s not directly relevant to the user\\'s query. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_78e5cbda-9bec-47e1-a9af-d3d479cbd54c\\n', 'id': 'lc_c998a8cd-268f-44d6-9be8-d41e69459ce4'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0017",
      "requirement": {
        "requirement_id": "ATOM_024",
        "requirement_text": "The API SHALL support payment cancellation through a two-step process: DELETE the resource and optionally start authorisation for cancellation",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0017_1",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_3",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_4",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_5",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts | [account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments | [payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds | [funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/).\n\n    Use **aut** as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n    \n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    \n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports payment cancellation through a DELETE operation on consent resources, which can optionally trigger an authorization for cancellation. This functionality is primarily handled within the Consent Management system, specifically by the `DefaultConsentManageHandler` and exposed via the `ConsentManageEndpoint`  .\\n\\n## Implementation Details\\n\\nThe core logic for payment cancellation resides within the `handleDelete` method of the `DefaultConsentManageHandler` class . This method processes DELETE requests for consent resources.\\n\\n1.  **Consent ID Extraction and Validation**: The `handleDelete` method first extracts the `consentId` from the request path and validates its format .\\n2.  **Consent Retrieval**: It then retrieves the `ConsentResource` associated with the provided `consentId` using `consentCoreService.getConsent(consentId, false)` .\\n3.  **Client ID Validation**: The system verifies that the client attempting to delete the consent is the owner of that consent .\\n4.  **External Service Integration for Pre-Revocation**: If external extensions are enabled (`isExtensionsEnabled` and `isExternalPreConsentRevocationEnabled` are true), an external service call is made using `ExternalAPIConsentManageUtils.callExternalService` before the actual revocation . This external service can determine if token revocation is required (`shouldRevokeTokens`) and provide a specific `revocationStatusName` .\\n5.  **Internal Revocation Logic**: If external extensions are not enabled, the system checks for consent type mismatch and if the consent is already revoked or rejected . Token revocation is set to true if the current consent status is `AUTHORIZED_STATUS` .\\n6.  **Consent Revocation**: Finally, `consentCoreService.revokeConsent` is called to revoke the consent, updating its status and optionally revoking associated tokens .\\n\\nThe `ConsentCoreService` interface defines the `revokeConsent` method, which is responsible for the actual revocation process .\\n\\n## Configuration Options\\n\\nThe behavior of payment cancellation, particularly the optional authorization step, can be configured through the Financial Services Accelerator\\'s configuration.\\n\\n*   **External Service Extensions**: The `isExternalPreConsentRevocationEnabled` flag, likely configured in `financial-services.xml` and parsed by `FinancialServicesConfigParser`, determines if an external service should be invoked before revoking a consent . This allows for an optional authorization step for cancellation. The `Overview` wiki page mentions that the system uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class .\\n*   **Service Extension Types**: The `PRE_PROCESS_CONSENT_REVOKE` extension point is specifically designed for pre-consent revocation processing by external services . This is part of the broader external service integration framework described in the `Overview` wiki page .\\n\\n## API Endpoints or Features\\n\\nThe API supports payment cancellation through the following endpoints:\\n\\n*   **DELETE /manage/{path}**: This endpoint, handled by the `ConsentManageEndpoint`\\'s `manageDelete` method, is used to delete consent resources . The `{path}` typically includes the `consentId` to be revoked.\\n*   **DELETE /admin/revoke**: An administrative endpoint is also available for revoking consents, requiring `consentID` and optionally `userID` as query parameters . This endpoint is exposed via the `AdminApi` as `revokeConsents` .\\n\\nThe `funds-confirmation-openapi.yaml` also defines a DELETE operation for `/funds-confirmation-consents/{ConsentId}`, indicating support for deleting funds confirmation consents . Similarly, `account-info-swagger.yaml` shows a DELETE operation for `/account-access-consents/{ConsentId}` .\\n\\n## Documentation References\\n\\n*   **Consent Management Wiki**: The `Consent Management` wiki page provides a detailed overview of the consent management architecture, including authorization flows, management APIs, and extension mechanisms . It specifically mentions `handleDelete()` for Consent Revocation .\\n*   **`accelerator-extensions-v1.0.0.yaml`**: This OpenAPI specification defines the `/pre-process-consent-revoke` endpoint, which is used to handle pre-consent revocation validations when a TPP calls consent DELETE .\\n*   **`consent_internal.yaml`**: This OpenAPI specification defines the `/admin/revoke` endpoint for revoking consents .\\n*   **`README.md` for `consent.mgt.endpoint`**: This README provides documentation for API endpoints, including `manageDelete` for the `ManageApi` and `revokeConsents` for the `AdminApi`, both of which are DELETE operations  .\\n*   **Test Framework**: The `FSAPIMConnectorTest.groovy` and `FSConnectorTest.groovy` files contain test cases for consent revocation, demonstrating how the DELETE operation is used for this purpose  .\\n\\n## Notes\\n\\nThe term \"payment cancellation\" in the prompt directly maps to \"consent revocation\" in the codebase\\'s terminology, particularly for payment-related consents. The two-step process described in the prompt is supported by the external service integration framework, where the DELETE operation triggers a pre-revocation external service call that can initiate an optional authorization for cancellation. The `shouldRevokeTokens` and `revocationStatusName` parameters returned by the external service allow for flexible handling of the cancellation authorization.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_750eb73a-799b-4eb4-9694-ea80ff3970c3\\n', 'id': 'lc_2dced99f-f8e7-4115-9a1f-522ed316c822'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0018",
      "requirement": {
        "requirement_id": "ATOM_166",
        "requirement_text": "The system SHALL include PSU-IP-Address header conditionally when the request was actively initiated by the PSU",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0018_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0018_2",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the conditional inclusion of a `PSU-IP-Address` header based on whether a request was actively initiated by a PSU (Payment Service User). There are no explicit references to \"PSU-IP-Address\", \"PSU-initiated\", or similar concepts within the provided code snippets or the architectural overview. <cite/>\\n\\nThe codebase does include mechanisms for handling and configuring IP addresses and request headers, which might be relevant for implementing such a feature. \\n\\n## Implementation Details\\n\\nThe `wso2/product-is` repository utilizes a `RemoteIpValve` in its Tomcat configuration, which is responsible for extracting client IP addresses from request headers.  This valve can be configured to identify internal proxies and the header that contains the real client IP address. \\n\\nSpecifically, the `RemoteIpValve` has properties such as `internalProxies`, `remoteIpHeader`, `protocolHeader`, `proxiesHeader`, and `trustedProxies`.  While this valve can process IP-related headers, there\\'s no direct indication of logic to conditionally add a `PSU-IP-Address` header based on PSU initiation. <cite/>\\n\\n## Configuration Options\\n\\nThe `RemoteIpValve` is configured within the `catalina-server.xml.j2` template.  Its enablement is controlled by the `catalinaValves.remoteIpValve.enable` parameter.  The properties of this valve, such as `internalProxies` and `remoteIpHeader`, are also configurable. \\n\\nTo implement the `PSU-IP-Address` header requirement, it would likely involve:\\n1.  **Identifying PSU-initiated requests**: This would require custom logic to determine if a request originates from a PSU. <cite/>\\n2.  **Adding a custom Valve or Filter**: A new Tomcat Valve or a custom servlet filter would need to be developed to inspect requests, apply the PSU-initiated logic, and then conditionally add the `PSU-IP-Address` header. <cite/> The `catalina-server.xml.j2` template allows for the inclusion of additional valves, as seen with the `{% for valve in catalina.valves %}` loop. \\n\\n## API Endpoints or Features\\n\\nThe provided context does not reveal any specific API endpoints or features directly related to the `PSU-IP-Address` header or the concept of PSU-initiated requests. <cite/> The `Architecture` wiki page mentions an \"API Layer\" with \"Server APIs\" and \"User APIs\" , but the details do not include this specific functionality. <cite/>\\n\\n## Documentation References\\n\\nThe provided wiki page on `Architecture`  gives a high-level overview of the system but does not contain specific documentation regarding the `PSU-IP-Address` header or PSU-initiated requests. <cite/>\\n\\n## Notes\\n\\nThe `RESTTestBase.java` file  shows how HTTP requests are made in integration tests, including setting headers. This could be a reference point for how to programmatically add headers if a custom implementation is developed.  However, it does not indicate existing support for the `PSU-IP-Address` header. <cite/> The `axis2-default.xml` file  discusses network configuration parameters like `localMemberHost` and `localMemberPort`,   but these are related to internal clustering and not directly to client-facing request headers. <cite/>\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_a18e651a-028f-4b95-ac2d-b5f3ef6f7f3a\\n', 'id': 'lc_5e9f0c65-054d-45d5-b629-4800a36b7877'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0018_3",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_f59c1ca7-5c9b-4c89-8292-5f6dc35b8826'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0019",
      "requirement": {
        "requirement_id": "ATOM_058",
        "requirement_text": "The system MUST transform payment initiation transaction status to 'CANC' (Cancelled) after successful cancellation and maintain this status while resource remains addressable.",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0019_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0019_2",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0019_3",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports the cancellation of payment initiation transactions and the updating of their status to \\'CANC\\' (Cancelled) through its consent management services. The system provides an API endpoint for revoking consents, which in turn updates the status of the associated payment.\\n\\n### Implementation Details\\nThe core functionality for revoking consents and updating their status resides within the `ConsentCoreService` and its implementation `ConsentCoreServiceImpl`  . The `revokeConsent` method in `ConsentCoreService` is responsible for updating the consent status and creating an audit record . This method internally calls `consentCoreDAO.updateConsentStatus` to change the status of the consent resource in the database . The `ConsentCoreDAO` interface defines the method `updateConsentStatus` which takes the `consentID` and the `consentStatus` as parameters to perform the update .\\n\\nThe `payment-initiation-openapi.yaml` file defines the possible statuses for a payment, which includes \"Rejected\" . While \\'CANC\\' is not explicitly listed, the system\\'s extensibility suggests it can be configured. The `PaymentService` in the demo backend sets the status to \"AcceptedSettlementCompleted\" for successful payments . This indicates that the status is managed programmatically and can be updated.\\n\\n### Configuration Options\\nThe system\\'s configuration is managed through `financial-services.xml` and parsed by `FinancialServicesConfigParser` . The `Identity Extensions` wiki page mentions `CONSENT_ID_CLAIM_NAME` and `APPEND_CONSENT_ID_TO_*` as configuration properties related to consent management . While there isn\\'t a direct configuration option for \\'CANC\\' status, the `ConsentCoreService.revokeConsent` method takes `revokedConsentStatus` as a parameter, implying that the status to be set upon revocation is configurable .\\n\\n### API Endpoints or Features\\nThe `Consent Management Endpoint` provides an API for revoking consents. Specifically, the `AdminApi` exposes a `revokeConsents` endpoint . This endpoint can be used to initiate the cancellation process for a payment initiation transaction by revoking the associated consent. The `revokeConsents` method takes `consentID` and `userID` as parameters .\\n\\n### Documentation References\\nThe `Overview` wiki page mentions \"Payment Initiation APIs\" and \"consent management\" as key features of the accelerator . The `Identity Extensions` wiki page also details how consent management integrates with OAuth/OIDC flows . The `payment-initiation-openapi.yaml` file defines the structure of payment initiation requests and responses, including the `Status` field for payments .\\n\\n## Notes\\nThe provided code snippets do not explicitly define \\'CANC\\' as a possible status for payment initiation transactions in `payment-initiation-openapi.yaml`. However, the `Status` field is a string and can be updated programmatically via the `ConsentCoreService.revokeConsent` method, which accepts a `revokedConsentStatus` parameter. This suggests that \\'CANC\\' could be a value passed to this method to represent a cancelled status. The `ErrorConstants.java` file lists various error messages but does not directly relate to payment transaction statuses . The `EndToEndPaymentsFlowTest.groovy` test case verifies payment initiation and authorization but does not cover cancellation scenarios .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Identity Extensions (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_eaa77fa8-d0b4-4899-80be-8e2e646e8296\\n', 'id': 'lc_f05577b4-b8de-43b9-b090-a8f6f4180903'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0020",
      "requirement": {
        "requirement_id": "ATOM_093",
        "requirement_text": "Payment initiation transaction status MUST progress through defined states (RCVD, PATC, ACTC) during multilevel SCA process",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0020_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_3",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_4",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_5",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports payment initiation transaction status progression, including `AcceptedSettlementCompleted` . While the specific states `RCVD`, `PATC`, and `ACTC` are not explicitly defined with these exact acronyms in the provided OpenAPI specification, the system does define a `Status` field for payments with various states such as `AcceptedCreditSettlementCompleted`, `AcceptedSettlementCompleted`, `AcceptedSettlementInProcess`, `AcceptedWithoutPosting`, `Pending`, and `Rejected` . For payment consents, the `Status` can be `Authorised`, `AwaitingAuthorisation`, `Consumed`, or `Rejected` . The system also supports a multi-authorization flow with statuses like `Authorised`, `AwaitingFurtherAuthorisation`, and `Rejected` .\\n\\n## Implementation Details\\n\\nThe payment initiation process involves creating payment consents and then submitting payments. The `PaymentInitiationAPI` defines endpoints for these operations .\\n\\n### Payment Consent Creation\\nA payment consent is initiated by a `POST` request to the `/payment-consents` endpoint . The request body uses the `obWriteConsent4` schema . Upon successful creation, a `201` response is returned . The consent status can be retrieved, and initially, it is `AwaitingAuthorisation` . After authorization, the status transitions to `Authorised` .\\n\\n### Payment Submission\\nOnce a consent is authorized, a payment can be submitted via a `POST` request to the `/payments` endpoint . The request body uses the `obWritePayment2` schema . A successful payment submission returns a `201` status code . The `PaymentService.java` in the demo backend sets the payment status to `AcceptedSettlementCompleted` .\\n\\n### Multilevel SCA Process\\nThe `obWritePaymentResponse5` schema includes a `MultiAuthorisation` object, which describes the status of a multi-authorization flow . This object contains a `Status` field that can be `Authorised`, `AwaitingFurtherAuthorisation`, or `Rejected` . It also tracks `NumberRequired` and `NumberReceived` authorizations .\\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, manages configurations related to consent management and identity server extensions . The `wso2is-7.0.0-deployment.toml` and `wso2is-7.1.0-deployment.toml` files contain deployment-specific configurations, including `financial_services.extensions.endpoint` settings that define allowed extensions and security types for external service integration . These extensions can be used to customize consent processing and authorization flows.\\n\\n## API Endpoints or Features\\n\\nThe primary API endpoints for payment initiation are:\\n*   `POST /payment-consents`: Used to create payment consents .\\n*   `GET /payment-consents/{ConsentId}`: Used to retrieve the status of a payment consent .\\n*   `POST /payments`: Used to submit payments based on an authorized consent .\\n*   `GET /payments/{paymentId}`: Used to retrieve the status of a submitted payment .\\n\\nThe `obWritePaymentResponse5` schema defines the possible `Status` values for payments, which include `AcceptedCreditSettlementCompleted`, `AcceptedSettlementCompleted`, `AcceptedSettlementInProcess`, `AcceptedWithoutPosting`, `Pending`, and `Rejected` . The `obWritePaymentConsentResponse5` schema defines `Status` values for payment consents: `Authorised`, `AwaitingAuthorisation`, `Consumed`, and `Rejected` .\\n\\n## Documentation References\\n\\nThe `Overview` wiki page provides a high-level understanding of the WSO2 Financial Services Accelerator, including its architecture and core components . It also references API specifications for payment initiation . The `payment-initiation-openapi.yaml` file serves as the primary documentation for the Payment Initiation API, detailing the request and response schemas, including the `Status` fields for both payment consents and payments .\\n\\n## Notes\\n\\nThe provided code snippets and wiki page indicate that the WSO2 Financial Services Accelerator supports payment initiation with defined status transitions. While the exact acronyms `RCVD`, `PATC`, and `ACTC` are not used, equivalent statuses like `AwaitingAuthorisation`, `Authorised`, and `AcceptedSettlementCompleted` are present. The system also explicitly supports multilevel authorization through the `MultiAuthorisation` object in the payment response schema. The `EndToEndPaymentsFlowTest.groovy` integration test demonstrates the flow from consent initiation to payment submission and retrieval, verifying status changes .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_cec916bd-4a41-4db9-93c4-8108016d4b78\\n', 'id': 'lc_acbfbcf3-4c5f-4988-bc91-1301980d2df4'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0021",
      "requirement": {
        "requirement_id": "ATOM_125",
        "requirement_text": "ASPSP SHALL deny access if the actual access does not match the consented duration or frequency",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0021_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports consent management, which includes the ability to define and enforce consent for sharing user attributes with applications . However, based on the provided code snippets and wiki pages, there is no explicit support for denying access based on *consented duration or frequency limits* for access attempts . The existing consent management primarily focuses on controlling the sharing of Personally Identifiable Information (PII) categories and purposes .\\n\\n### Implementation Details\\nThe consent management framework in WSO2 Identity Server allows for the collection, storage, and management of user consent for processing personal data . This is primarily handled during self-registration and authentication flows . The system stores consent receipts, which record user consent decisions related to PII categories and purposes . Consent enforcement ensures that only attributes with user consent are included in tokens or API responses .\\n\\n### Configuration Options\\nThe `default-identity.xml` configuration file contains a `<Consent>` section with an `<EnableSSOConsentManagement>` flag, which can be set to `true` to enable consent management during SSO . Additionally, the `<UserConsentEnabledGrantTypes>` section specifies which OAuth grant types will filter user claims based on user consent . By default, `authorization_code` and `implicit` grant types are configured to respect user consent .\\n\\n### API Endpoints or Features\\nThe system exposes REST API endpoints for managing consents, purposes, and PII categories . For instance, `/api/identity/consent-mgt/v1.0/consents` is used for general consent management, and `/api/identity/consent-mgt/v1.0/consents/receipts/(.*)` is used to retrieve consent receipts . These APIs allow for programmatic interaction with the consent management system.\\n\\n### Documentation References\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, detailing its purpose, key components (PII Categories, Purposes, Purpose Categories, Consent Receipts), and the consent collection and enforcement processes . It also mentions integration with OAuth2/OIDC for custom scopes and claims .\\n\\n## Notes\\nThe current consent management functionality focuses on data sharing and access to specific attributes based on user consent. There is no direct evidence in the provided snippets of features that specifically deny access based on *consented duration or frequency limits* for access attempts. While token validity periods are configurable in `default-identity.xml` , these are general token expiry settings and not tied to user-consented duration or frequency for access. The `IDENTITY6777OAuth2TokenExpiryTestCase`  tests token expiration but not against a user-defined consent duration.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_7d5c86ae-22b1-432e-a854-4d4131c987fa\\n', 'id': 'lc_fc58207c-de0b-4f05-82a6-e57eacabd321'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0021_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Yes, this repository supports denying access if the actual access does not match the consented duration or frequency through its throttling mechanisms.   The WSO2 API Manager (APIM) uses a \"throttle mediator\" to enforce policies that restrict request counts and concurrency.  When a request exceeds the defined limits, access is denied. \\n\\n## Implementation Details\\n\\nThe core of this functionality lies in the `throttle` mediator, which is configured within a Synapse sequence.   This mediator evaluates incoming requests against a defined policy. \\n\\nThe `throttle` mediator has two main branches: `onAccept` and `onReject`. \\n*   **`onAccept`**: If a request adheres to the throttling policy, it proceeds through the `onAccept` sequence.  In the provided examples, this typically involves logging the acceptance and sending the request to the backend service.  \\n*   **`onReject`**: If a request violates the throttling policy, it is routed to the `onReject` sequence.  This sequence typically logs the denial, generates a SOAP fault indicating \"Access Denied\", and drops the message.   \\n\\n## Configuration Options\\n\\nThrottling policies are defined within the `<policy>` tag of the `throttle` mediator.  These policies use the `throttle` XML namespace (`http://www.wso2.org/products/wso2commons/throttle`). \\n\\nKey configuration elements include:\\n*   **`throttle:MaximumCount`**: Specifies the maximum number of requests allowed within a given `UnitTime`. \\n*   **`throttle:UnitTime`**: Defines the time period (in milliseconds) for which `MaximumCount` is applicable. \\n*   **`throttle:ProhibitTimePeriod`**: An optional element that specifies how long further requests should be prohibited after the `MaximumCount` is exceeded. \\n*   **`throttle:ID`**: Used to define throttling rules based on specific identifiers, such as IP addresses. \\n\\nFor example, in `Sample 371`, a policy is configured to allow 4 requests within 800,000 milliseconds for \"other\" IP addresses, and 5 requests within 800,000 milliseconds for the IP range \"10.100.1.160 - 10.100.1.165\". \\n\\nAnother configuration option is `throttle:MaximumConcurrentAccess`, which limits the number of concurrent requests. \\n\\nPolicies can also be loaded from external XML files using the `policy key` attribute, as shown in `Sample 372`. \\n\\n## API Endpoints or Features\\n\\nThe `wso2/product-apim` repository includes administrative APIs for managing deny policies. \\n*   **`throttlingDenyPoliciesGet`**: This API endpoint allows retrieval of all existing deny policies.  It supports querying by `conditionType` and `conditionValue` to filter blocking conditions. \\n*   **`throttlingDenyPolicyConditionIdPatch`**: This API allows updating the status of a specific blocking condition identified by `conditionId`. \\n\\nThese APIs are part of the Admin client, specifically within the `org.wso2.am.integration.clients.admin.api` package. \\n\\n## Documentation References\\n\\nThe documentation for these features can be found in the `docs/xdoc/samples/advanced_mediation_samples.xml` files across various modules like `traffic-manager`, `all-in-one-apim`, `gateway`, and `api-control-plane`.     Specifically, \"Sample 371: Restricting requests based on policies\" and \"Sample 372: Use of both concurrency throttling and request rate based throttling\" provide detailed examples and explanations of how to configure and use the throttle mediator for frequency and concurrency-based access denial.  \\n\\n## Test Criteria\\n\\nThe provided samples demonstrate the denial of access when frequency limits are exceeded.  For instance, in Sample 371, after four successful requests, the fifth request is denied, resulting in an \"Access Denied\" fault.   This directly verifies that access attempts beyond consented frequency limits are denied. \\n\\n## Notes\\n\\nThe provided snippets primarily focus on the `throttle` mediator within the WSO2 API Manager context. While the term \"ASPSP\" is not explicitly mentioned in the code, the functionality described (denying access based on frequency and duration) is a common requirement for financial services providers (ASPSPs) to comply with regulations like PSD2. The `throttle` mediator provides the underlying mechanism to implement such requirements. The \"Deny Policies\" APIs suggest a more programmatic way to manage these blocking conditions, which could be used to dynamically enforce consented durations or frequencies.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_a7f7dee1-c4ef-4576-b5e4-a515d389a8e1\\n', 'id': 'lc_add85bd1-d38b-4f2f-a227-dcac04dd8ffc'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0022",
      "requirement": {
        "requirement_id": "ATOM_114",
        "requirement_text": "The API SHALL support GET /v1/{payment-service}/{payment-product}/{paymentId}/cancellation-authorisations for retrieving cancellation authorization sub-resources",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0022_1",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_2",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_3",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts |[account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments |[payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds |[funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/) as an Operational Policy.\n\n    Use aut as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n\n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n\n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_4",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts | [account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments | [payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds | [funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/).\n\n    Use **aut** as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n    \n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    \n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_5",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support a `GET /v1/{payment-service}/{payment-product}/{paymentId}/cancellation-authorisations` endpoint for retrieving cancellation authorization sub-resources. The provided OpenAPI specifications for Payments  and Confirmation of Funds  do not define such an endpoint.\\n\\nHowever, the system does have a robust consent management service that handles authorizations, including the ability to search for and manage authorization resources.\\n\\n### API Endpoints and Features\\n\\nThe `wso2/financial-services-accelerator` repository includes OpenAPI specifications for payment initiation, which defines endpoints such as `GET /payment-consents/{consentId}` and `GET /payments/{paymentId}`  . These specifications do not include an endpoint specifically for \"cancellation-authorisations\".\\n\\nThe `ConsentCoreService` interface and its implementation, `ConsentCoreServiceImpl`, provide methods for managing consent and authorization resources . For instance, the `searchAuthorizations` method in `ConsentCoreServiceImpl` can retrieve authorization resources based on a consent ID . This method is tested in `ConsentMgtCoreServiceTests` to ensure it returns a list of `AuthorizationResource` objects .\\n\\nThe `accelerator-extensions-v1.0.0.yaml` file defines schemas related to consent resources, including an `authorizations` array within `DetailedConsentResourceData` . This indicates that authorization data is part of the consent resource model.\\n\\n### Implementation Details\\n\\nThe `ConsentCoreService` interface defines methods like `createAuthorizableConsent` and `createExclusiveConsent` which handle the creation of consent and authorization resources  . The `reAuthorizeConsentWithNewAuthResource` method in `ConsentCoreServiceImpl` demonstrates how existing authorizations can be updated and new ones created, including updating authorization statuses and creating audit records . This method explicitly searches for consent authorizations using `consentCoreDAO.searchConsentAuthorizations` .\\n\\nThe `ExternalAPIUtil` class contains a helper method `buildConsentMappingResources` which processes authorization DTOs and maps them to `ConsentMappingResource` objects, indicating how authorization data is structured and handled internally .\\n\\n### Configuration Options\\n\\nThe `IdentityExtensionsDataHolder` manages various services, including `OAuth2Service` and `RequestObjectService`, which are crucial for handling OAuth flows and request objects that might contain authorization-related information . The `Overview` wiki page also mentions that the system uses a centralized configuration approach through the `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, which includes configuration for consent management .\\n\\n### Documentation References\\n\\nThe `Overview` wiki page provides a high-level overview of the WSO2 Financial Services Accelerator, mentioning its support for consent management and secure API access . It also details the API specifications for Payment Initiation APIs . The `Identity Extensions` wiki page further elaborates on OAuth/OIDC customizations and consent management integration .\\n\\n## Notes\\n\\nWhile a direct `GET /v1/{payment-service}/{payment-product}/{paymentId}/cancellation-authorisations` endpoint is not explicitly defined in the provided OpenAPI specifications, the underlying `ConsentCoreService` has the capability to search and manage authorization resources. It is possible that cancellation authorizations are handled as a type of authorization within the existing consent management framework, and a specific API endpoint for retrieving them might be exposed through a different path or as part of a broader consent retrieval mechanism. To fully meet the requirement, a new API endpoint would likely need to be implemented that leverages the existing consent management services to filter and return cancellation-specific authorizations.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Identity Extensions (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f6b92a4b-305a-4ac5-9d9e-43654eb8abc5\\n', 'id': 'lc_c8ed44b4-0573-47d8-af25-75837d3e63fc'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0023",
      "requirement": {
        "requirement_id": "ATOM_167",
        "requirement_text": "The system SHALL require Consent-ID header as mandatory for card account balance requests",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0023_1",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms.\n\n\n      - ??? tip \"Click here to see a sample request object...\"\n            - Given below is a sample request object in the JWT format:\n      \n            ``` jwt tab='Sample'\n                 eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n            ```\n                 \n            ``` tab='Format'\n                 {\n                   \"kid\": \"<The KID value of the signing jwk set>\",\n                   \"alg\": \"<SUPPORTED_ALGORITHM>\",\n                   \"typ\": \"JWT\"\n                 }\n                 {\n                   \"max_age\": 86400,\n                   \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n                   \"scope\": \"accounts openid\",\n                   \"iss\": \"<CLIENT_ID>\",\n                   \"claims\": {\n                     \"id_token\": {\n                       \"acr\": {\n                         \"values\": [\n                           \"urn:openbanking:psd2:sca\",\n                           \"urn:openbanking:psd2:ca\"\n                         ],\n                         \"essential\": true\n                       },\n                       \"openbanking_intent_id\": {\n                         \"value\": \"<CONSENTID>\",\n                         \"essential\": true\n                       }\n                     },\n                     \"userinfo\": {\n                       \"openbanking_intent_id\": {\n                         \"value\": \"<CONSENTID>\",\n                         \"essential\": true\n                       }\n                     }\n                   },\n                   \"response_type\": \"code id_token\",  \n                   \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n                   \"state\": \"YWlzcDozMTQ2\",\n                   \"exp\": <The expiration time of the request object in Epoch format>,\n                   \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n                   \"client_id\": \"<CLIENT_ID>\"\n                 }\n            ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API\n   consumer wishes to access. This request is in the format of a URL as follows:\n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n\n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n\n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role.\n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../../assets/img/learn/consent-manager/consent-page-confirm.png)\n\n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click\n   **Confirm** to grant these permissions.\n\n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample\n      given below:\n\n      The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n       ```\n       https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n       &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n       &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n       &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n       ```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0023_2",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0023_3",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms.\n\n\n      - ??? tip \"Click here to see a sample request object...\"\n            - Given below is a sample request object in the JWT format:\n      \n            ``` jwt tab='Sample'\n                 eyJraWQiOiJzQ2VrTmdTV0lhdVEzNGtsUmhER3Fmd3BqYzQiLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc1Njc4Mjk2NSwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIiwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJpZEh2SGNVNUdIbTd3ZnNEMDZwd2xQcWZWNVFhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3d3dy5nb29nbGUuY29tL3JlZGlyZWN0cy9yZWRpcmVjdDEiLCJzdGF0ZSI6IjhkYTZmNmVmLThjZjktNDY1MS1iNTdmLTljNGNjNzlkZGE4OCIsImV4cCI6MTc1Njc4NjQ0NSwibm9uY2UiOiIzZThlMzllZC01Yzc0LTQ2ZmQtYjYyOS01YzAxYTMyMzViZWMiLCJjbGllbnRfaWQiOiJpZEh2SGNVNUdIbTd3ZnNEMDZwd2xQcWZWNVFhIn0.hqt_HhsYVcqACFudUq8Z58EnLaMyMTMvdroGBWyx7zNELU-nSx5-SYj6qUYOzHyAWsgwGkVO-ZMZcAU_xxaU1MJai1JGpBRDOqFbcmfondsxHqQYQuSm0AEK2JYHVQjlGsg8ynIrC__QCzOKl8KflhiTPF7hu4l5pm15QDgNR2dVz4XBcKNc8q2pqYotu3K65eJDRdv-En9G3yTpyE56u-9aTupYTKCn4nUYhH5DF6zsz6RNsq_W8LxWyr53SNJxkKZyAZVUmCuZnfEoYERtngh90S4QuLOdYrnG76Yh9VhbrU7D6bFI4tv-Uerg4RzdkxkURmLutVdppfIYQ14TOg\n            ```\n                 \n            ``` tab='Format'\n                 {\n                   \"kid\": \"<The KID value of the signing jwk set>\",\n                   \"alg\": \"<SUPPORTED_ALGORITHM>\",\n                   \"typ\": \"JWT\"\n                 }\n                 {\n                   \"max_age\": 86400,\n                   \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n                   \"scope\": \"accounts openid\",\n                   \"iss\": \"<CLIENT_ID>\",\n                   \"claims\": {\n                     \"id_token\": {\n                       \"acr\": {\n                         \"values\": [\n                           \"urn:openbanking:psd2:sca\",\n                           \"urn:openbanking:psd2:ca\"\n                         ],\n                         \"essential\": true\n                       }\n                     }\n                   },\n                   \"response_type\": \"code id_token\",  \n                   \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n                   \"state\": \"YWlzcDozMTQ2\",\n                   \"exp\": <The expiration time of the request object in Epoch format>,\n                   \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n                   \"client_id\": \"<CLIENT_ID>\"\n                 }\n            ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API\n   consumer wishes to access. This request is in the format of a URL as follows:\n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJzQ2VrTmdTV0lhdVEzNGtsUmhER3Fmd3BqYzQiLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc1Njc4Mjk2NSwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIiwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJpZEh2SGNVNUdIbTd3ZnNEMDZwd2xQcWZWNVFhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3d3dy5nb29nbGUuY29tL3JlZGlyZWN0cy9yZWRpcmVjdDEiLCJzdGF0ZSI6IjhkYTZmNmVmLThjZjktNDY1MS1iNTdmLTljNGNjNzlkZGE4OCIsImV4cCI6MTc1Njc4NjQ0NSwibm9uY2UiOiIzZThlMzllZC01Yzc0LTQ2ZmQtYjYyOS01YzAxYTMyMzViZWMiLCJjbGllbnRfaWQiOiJpZEh2SGNVNUdIbTd3ZnNEMDZwd2xQcWZWNVFhIn0.hqt_HhsYVcqACFudUq8Z58EnLaMyMTMvdroGBWyx7zNELU-nSx5-SYj6qUYOzHyAWsgwGkVO-ZMZcAU_xxaU1MJai1JGpBRDOqFbcmfondsxHqQYQuSm0AEK2JYHVQjlGsg8ynIrC__QCzOKl8KflhiTPF7hu4l5pm15QDgNR2dVz4XBcKNc8q2pqYotu3K65eJDRdv-En9G3yTpyE56u-9aTupYTKCn4nUYhH5DF6zsz6RNsq_W8LxWyr53SNJxkKZyAZVUmCuZnfEoYERtngh90S4QuLOdYrnG76Yh9VhbrU7D6bFI4tv-Uerg4RzdkxkURmLutVdppfIYQ14TOg&scope=openid accounts&response_type=code id_token&redirect_uri=https://www.google.com/redirects/redirect1&state=8b028d5e-f149-49a9-977a-c204fd330446&nonce=nonce&client_id=idHvHcU5GHm7wfsD06pwlPqfV5Qa\n    ```\n\n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n\n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role.\n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../../assets/img/try-out/scope-based-consent-screen.png)\n\n6. Data requested by the consent such as scopes and expiration date are displayed. Click **Confirm** to grant these permissions.\n\n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample\n   given below:\n\n   The authorization code from the below URL is in the code parameter (`code=144060b4-4d8c-3a0b-a44e-66baf58651f1`).\n\n   ```\n       https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJjZmNONHdac21NMWxtOXBXX2xFUl9LS3ZwRmMiLCJraWQiOiJPV0ptTnpneU5UTmhNR05pTXpFMU5HUTNaall4WlRVellUSTJNbVpoWlRFeVl6SmtZVGRsTURCallqSTJNRE5sWldJeFltUTJNRGt6WVdZNU9ERm1aUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiI0OTcyZjc1YzRjNTBiNTZiYWY1NmJhYzI4MGNiNDFkMWUxYjk5MmRhYTgzNTFiMWE3NGZiZWFiOGJmNDMyOWQzIiwic3ViIjoiMGE0ZmI0ZDgtNGMwMy00MGQ5LWI1MWItNmE1NGRlZDNmNzFlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiIzZThlMzllZC01Yzc0LTQ2ZmQtYjYyOS01YzAxYTMyMzViZWMiLCJzaWQiOiIzMzViM2UzYS05YTI2LTRhYzUtYjdlMy0wZmRiMGIyMzFmNjYiLCJhdWQiOiJpZEh2SGNVNUdIbTd3ZnNEMDZwd2xQcWZWNVFhIiwiYWNyIjoidXJuOm1hY2U6aW5jb21tb246aWFwOnNpbHZlciIsImNfaGFzaCI6IjJYZDcxWGxGVGowcmJrSF9LeWFNenciLCJ1c2VyX29yZyI6IjEwMDg0YThkLTExM2YtNDIxMS1hMGQ1LWVmZTM2YjA4MjIxMSIsInNfaGFzaCI6Ikg2ODhGZkNJZkFBdEg4YUhBUXVwREEiLCJhenAiOiJpZEh2SGNVNUdIbTd3ZnNEMDZwd2xQcWZWNVFhIiwib3JnX2lkIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwiZXhwIjoxNzU2Nzg2NTkzLCJvcmdfbmFtZSI6IlN1cGVyIiwiaWF0IjoxNzU2NzgyOTkzLCJqdGkiOiJhNjNkOGJhMC01MzdlLTQ5YmQtODI0OC1kMTFjMzJmMjYwNmQiLCJjb25zZW50X2lkIjoiNWRlMzhiZGMtZGNmZS00ODUxLWFkMDAtMDM0NjkyYjYzMzgzIn0.O7wVUa239KyF7uswwHDptwlb5rqkyF4mNE5ZS-pD0-oiF08kDimy4f6HGmtCZ93oWVVM4ItCR4z3AeSyi_gIHsqf8Lo3XS5bfODONnvuhtt0vZahxy_G6jiHSaeuiAM5TMasFys_nVOC6T7dAlo_FAI5J6sCHB18bynuYEyPSotz5ZalOl2JeVdUueDIMzhgXuJGeX6_a4E5VrX8c-hm3kytN2vt0HPxPEdkKfFuxHql84OIwn2yhJuPJ1uBhRxsu-V58a8F4qslnqVs2pmd4-V4nfTlLWpSi-w71ycYQB3PZsH2UglRVxksITzDc4YpxKQ0fTHL3m2BdwdfXxwDcg&code=144060b4-4d8c-3a0b-a44e-66baf58651f1&session_state=643f531cef2255b3fd44b1144dad89153282eae20e95fa33d5891ffac114a515.AWErsW9ia1w7Pi11KK_H-w&state=8da6f6ef-8cf9-4651-b57f-9c4cc79dda88\n   ```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0023_4",
          "text": "## Account-Request-Information header\n   \nThe WSO2 Open Banking solution manages the initiation and authorisation of a consent. When an API consumer application \nmakes a request to retrieve any account information, the solution validates the consent against the request. Upon \nsuccessful validation, consent-related information is directed to the core banking system in the form of a header. This\nheader is known as `Account-Request-Information`.\n   \nThe `Account-Request-Information` header is a signed JWT, which needs to be decoded by the core banking system. \n \n??? Note \"Click here to see the decoded format of a sample header\"\n    The decoded JWT header is in JSON format and looks as follows:\n    \n    ``` json\n    {\n       \"clientId\":\"EkpvjD6O8P8Px8RrBYJx1mMw78Ua\",\n       \"currentStatus\":\"authorized\",\n       \"createdTimestamp\":1621616438,\n       \"recurringIndicator\":false,\n       \"authorizationResources\":[\n          {\n             \"updatedTime\":1621616455,\n             \"consentId\":\"b10a4458-0354-4fde-b259-5bbd3066d445\",\n             \"authorizationId\":\"5d290705-dd5c-43f2-98a0-3afc58e1c4bc\",\n             \"authorizationType\":\"authorization\",\n             \"userId\":\"admin@wso2.com@carbon.super\",\n             \"authorizationStatus\":\"authorized\"\n          }\n       ],\n       \"updatedTimestamp\":1621616455,\n       \"validityPeriod\":0,\n       \"consentAttributes\":{\n          \n       },\n       \"consentId\":\"b10a4458-0354-4fde-b259-5bbd3066d445\",\n       \"consentMappingResources\":[\n          {\n             \"mappingId\":\"e5fe1b24-05f1-4f52-be10-55cb4b58b2a9\",\n             \"mappingStatus\":\"active\",\n             \"accountId\":\"30080012343456\",\n             \"authorizationId\":\"5d290705-dd5c-43f2-98a0-3afc58e1c4bc\",\n             \"permission\":\"30080012343456\"\n          }\n       ],\n       \"consentType\":\"accounts\",\n       \"receipt\":{\n          \"Risk\":{\n             \n          },\n          \"Data\":{\n             \"TransactionToDateTime\":\"2021-05-24T22:30:32.995+05:30\",\n             \"ExpirationDateTime\":\"2021-05-26T22:30:32.936+05:30\",\n             \"Permissions\":[\n                \"ReadAccountsBasic\",\n                \"ReadAccountsDetail\",\n                \"ReadBalances\",\n                \"ReadBeneficiariesBasic\",\n                \"ReadBeneficiariesDetail\",\n                \"ReadDirectDebits\",\n                \"ReadProducts\",\n                \"ReadStandingOrdersBasic\",\n                \"ReadStandingOrdersDetail\",\n                \"ReadTransactionsBasic\",\n                \"ReadTransactionsCredits\",\n                \"ReadTransactionsDebits\",\n                \"ReadTransactionsDetail\",\n                \"ReadStatementsBasic\",\n                \"ReadStatementsDetail\",\n                \"ReadOffers\",\n                \"ReadParty\",\n                \"ReadPartyPSU\",\n                \"ReadScheduledPaymentsBasic\",\n                \"ReadScheduledPaymentsDetail\",\n                \"ReadPAN\"\n             ],\n             \"TransactionFromDateTime\":\"2021-05-21T22:30:32.995+05:30\"\n          }\n       },\n       \"consentFrequency\":0\n    }\n    ```\n    \n    Given below is a brief description of the fields in the header:\n    \n    |Field|Description|\n    |-----|-----------|\n    |clientId| The unique ID of the API consumer application.|\n    |currentStatus| The current status of the consent. |\n    |createdTimestamp|The date and time when the consent was created. | \n    |recurringIndicator| Specifies if this is a recurring transaction. |\n    |authorizationResources| Contains details regarding the consent authorization. |\n    |updatedTimestamp| The last date and time the consent was updated. |\n    |validityPeriod| The validity period of the consent in seconds. |\n    |consentAttributes| Extra attributes related to the consent. |\n    |consentId| The unique ID of the consent that is being authorized. |\n    |consentMappingResources| The details of the accounts that the consent is bound to. |\n    |consentType| The type of the consent. For example, accounts, payments. |\n    |receipt| Details of the consent, such as expiration time, permissions. |\n    |consentFrequency| The maximum frequency for access without customer involvement per day. |\n\nThe core banking system will perform all required validations and build a response. This response needs to adhere to \nthe requirements in your open banking standard.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0023_5",
          "text": "### Endpoint\n``` xml\nhttps://<IS_HOST>:9446/api/openbanking/consent/validate\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0023_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, includes features for Consent Management, which is relevant to your query about requiring a `Consent-ID` header for requests. The system supports consent handling, particularly in the context of user self-registration and OAuth2/OIDC flows. However, there is no direct evidence in the provided snippets that explicitly enforces a `Consent-ID` header as mandatory for \"card account balance requests\" or any specific API endpoint. The existing consent mechanisms are more focused on user data sharing and privacy regulations.\\n\\n### Implementation Details\\nThe `wso2/product-is` repository implements Consent Management as a framework to collect, store, and manage user consent for processing personal data . This is primarily handled during processes like self-registration and authentication flows . The system records user consent decisions in \"Consent Receipts\" .\\n\\nThe `SelfSignUpConsentTest.java` file demonstrates how consent is managed during self-registration, including retrieving consent receipts for a user . The `getConsent` method in this file shows how a consent receipt can be retrieved using a `receiptId` and includes an `Authorization` header for authentication .\\n\\n### Configuration Options\\nThe `default-identity.xml` configuration file indicates that consent management can be enabled during SSO by setting `<EnableSSOConsentManagement>` to `true` . Additionally, specific grant types like `authorization_code` and `implicit` can be configured to filter user claims based on user consent in their responses .\\n\\n### API Endpoints or Features\\nThe system exposes REST API endpoints for consent management. Specifically, the following endpoints are secured and handle consent-related operations:\\n*   `(.*)/api/identity/consent-mgt/v1.0/consents` for general consent operations .\\n*   `(.*)/api/identity/consent-mgt/v1.0/consents/receipts/(.*)` for retrieving specific consent receipts .\\n*   Endpoints for managing purposes, PII categories, and purpose categories are also available under `/api/identity/consent-mgt/v1.0/consents/` .\\n\\nThe `CONSNT_ENDPOINT_SUFFIX` constant in `SelfSignUpConsentTest.java` defines the base path for the consent management API as `/api/identity/consent-mgt/v1.0/consents` .\\n\\n### Documentation References\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, describing its purpose, key components (PII Categories, Purposes, Purpose Categories, Consent Receipts), and how consent is collected and enforced . It also mentions the integration with OAuth2/OIDC for custom scopes and claims .\\n\\n## Notes\\nThe provided codebase snippets and wiki pages discuss consent management in the context of user data privacy and OAuth2/OIDC flows. While there are mechanisms for managing consent and retrieving consent receipts, there is no explicit mention or implementation detail regarding a mandatory `Consent-ID` header for \"card account balance requests\" or any specific financial API. The existing consent framework focuses on user attribute sharing and privacy regulations rather than enforcing a specific header for transactional requests. Therefore, the system, as described by the provided context, does not directly support the requirement of a mandatory `Consent-ID` header for card account balance requests.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b7b52ce7-02d0-4238-b5a1-e2291d1623ee\\n', 'id': 'lc_a2fc590e-041a-4823-98aa-422c68598738'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0023_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_1ea8b2e8-4b5c-41e6-a31c-b60370519440'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0024",
      "requirement": {
        "requirement_id": "ATOM_014",
        "requirement_text": "ASPSPs SHALL accept at minimum the basic character set including letters, numbers, and specified symbols.",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0024_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports character set validation for usernames and other fields through regular expressions defined in configuration files. Specifically, it allows for the configuration of accepted characters for usernames in different user store types and for OTPs and security question answers.\\n\\n### Implementation Details\\nThe character set acceptance is primarily implemented through regular expressions defined in configuration files. For instance, the `infer.json` file contains `UsernameJavaRegEx` properties for various user store types . These regular expressions dictate the allowed characters for usernames. Similarly, for One-Time Passwords (OTPs) and security question answers, regular expressions are used to define the acceptable character sets  .\\n\\n### Configuration Options\\nThe configuration options for character sets are available in the `infer.json` and `default.json` files, as well as within the governance configurations exposed via API responses.\\n\\n*   **Username Regular Expressions**:\\n    *   For `database` and `database_unique_id` user stores, the `UsernameJavaRegEx` is `^[^\\\\\\\\s*?%]{3,50}$`  . This regex allows any character except whitespace, asterisk, question mark, or percentage sign, with a length between 3 and 50 characters.\\n    *   For `read_only_ldap`, `read_only_ldap_unique_id`, `read_write_ldap`, `read_write_ldap_unique_id`, `active_directory`, and `active_directory_unique_id` user stores, the `UsernameJavaRegEx` is `[a-zA-Z0-9._\\\\\\\\-|//]{3,50}$` . This regex specifically allows alphanumeric characters, periods, underscores, hyphens, and forward slashes, with a length between 3 and 50 characters.\\n    *   A general `UsernameJavaScriptRegEx` is also defined as `^[^\\\\\\\\s*?%]{3,50}$` in `default.json` .\\n*   **OTP Character Sets**:\\n    *   For password recovery SMS OTPs, the `Recovery.Notification.Password.smsOtp.Regex` property defines the allowed characters and length. The default value is `[a-zA-Z0-9]{6}`, meaning alphanumeric characters and a length of 6 .\\n    *   Similarly, for self-registration SMS OTPs, `SelfRegistration.SMSOTP.Regex` is configured with `[a-zA-Z0-9]{6}` .\\n    *   There are also options to include uppercase, lowercase, and numbers in OTPs via `Recovery.Notification.Password.OTP.UseUppercaseCharactersInOTP`, `Recovery.Notification.Password.OTP.UseLowercaseCharactersInOTP`, and `Recovery.Notification.Password.OTP.UseNumbersInOTP` .\\n*   **Security Question Answer Regex**:\\n    *   The `Recovery.Question.Answer.Regex` property is set to `.*`, which means any character is currently accepted for security question answers . This can be configured to a more restrictive regex if needed.\\n\\n### API Endpoints or Features\\nThe character set configurations are part of the Identity Governance features. These features are typically managed through REST APIs. The provided JSON snippets are examples of responses from such APIs, specifically for retrieving governance categories and their properties  . For example, the `CREATE_USER_ENDPOINT` at `/scim2/Users` is used for user creation, where these character set policies would be enforced .\\n\\nThe `RoleNamingViolationSCIM2TestCase` demonstrates that the system enforces character set and length constraints for roles created via SCIM2, returning a `400 Bad Request` if these constraints are violated . This indicates that similar validation mechanisms are in place for other entities like usernames.\\n\\n### Documentation References\\nThe \"Security Configuration\" wiki page provides an overview of security configuration options, including identity governance security policies . While it doesn\\'t explicitly detail character set validation, it points to the broader context of security governance features, under which character set policies fall .\\n\\n## Notes\\nThe provided snippets indicate that the system uses regular expressions for character set validation. To fully meet the requirement of accepting \"a-z, A-Z, 0-9, /-?:().,\\'+, and space\", the configured regular expressions for relevant fields (e.g., usernames) would need to be updated to explicitly include these characters. The current `UsernameJavaRegEx` for database user stores (`^[^\\\\\\\\s*?%]{3,50}$`) excludes whitespace, asterisk, question mark, and percentage, which might need adjustment depending on the exact interpretation of \"specified symbols\" . The `UsernameJavaRegEx` for LDAP/Active Directory user stores (`[a-zA-Z0-9._\\\\\\\\-|//]{3,50}$`) is more restrictive and would need significant modification to include all the specified symbols and space . The `Recovery.Question.Answer.Regex` is currently `.*`, which accepts all characters, but this might be too permissive for some contexts .\\n\\nWiki pages you might want to explore:\\n- [Security Configuration (wso2/product-is)](/wiki/wso2/product-is#5.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_4fe9af6f-1f2d-4e0d-95ae-a6505a2d1c26\\n', 'id': 'lc_3d311d59-c169-4b91-9130-3f2e3c65a6b9'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0024_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, demonstrates support for a basic character set in various contexts, including API resource names, endpoint security passwords, and URI template parameters. The codebase includes integration tests that specifically verify the acceptance and correct handling of letters, numbers, and a range of specified symbols.\\n\\n## Implementation Details\\n\\n### API Resource Names\\nThe system supports special characters in API resource names. The test case `APIResourceWithSpecialCharactersInvocation.java`  verifies that API resources can contain characters like comma (`,`), hyphen (`-`), period (`.`), underscore (`_`), and tilde (`~`) without being incorrectly split or parsed. For example, the test creates an API with the resource path `/special,-._~resource`  and successfully invokes it, asserting that the response data contains the expected string .\\n\\n### Endpoint Security Passwords\\nThe system allows complex passwords for endpoint security, including various symbolic characters. The `ChangeEndPointSecurityOfAPITestCase.java`  test iterates through an array of symbolic characters such as `!`, `@`, `#`, `$`, `%`, `^`, `&`, `*`, `(`, `)`, `_`, `-`, `+`, `=`, `{`, `[`, `}`, `]`, `|`, `:`, `;`, `\\'`, `<`, `,`, `>`, `.`, `?`, and `/` . It then constructs an endpoint password using these characters and verifies that the API invocation with such a password is successful  .\\n\\n### URI Template Parameters\\nThe system handles reserved characters in URI template parameters, including percent-encoded characters and the `+` character. The `UriTemplateReservedCharacterEncodingTest.java`  test confirms that query parameters containing characters like `!`, `@`, `%` are correctly percent-decoded at the message context property level  . Similarly, it verifies that the `+` character in query parameters is handled correctly  .\\n\\n## Configuration Options\\n\\nWhile the provided snippets do not explicitly detail configuration options for character sets, the presence of integration tests that validate special characters in various contexts suggests that the system is designed to handle a broad range of characters by default.\\n\\n## API Endpoints or Features\\n\\nThe API endpoints and features that demonstrate support for the basic character set include:\\n\\n*   **API Resource Paths**: As seen in `APIResourceWithSpecialCharactersInvocation.java`, API resource paths can include special characters .\\n*   **Endpoint Security**: The `endpoint_security` configuration for APIs, as shown in `ChangeEndPointSecurityOfAPITestCase.java`, accepts passwords containing a wide array of symbolic characters .\\n*   **URI Template Parameters**: API invocations with URI template parameters containing reserved characters are handled, as demonstrated in `UriTemplateReservedCharacterEncodingTest.java` .\\n\\n## Documentation References\\n\\nThe test case `APIResourceWithSpecialCharactersInvocation.java`  refers to RFC 3986, specifically section 2.2, for non-reserved special characters. This indicates an adherence to standard URI syntax for character handling.\\n\\n## Notes\\n\\nThe provided snippets primarily consist of integration tests, which are valuable for demonstrating the system\\'s capabilities but do not directly expose the underlying implementation code for character set handling. However, the successful execution of these tests strongly suggests that the WSO2 API Manager (`wso2/product-apim`) supports the specified basic character set in the contexts tested. The `self-registration-with-verification.jsp` files  and  show a `unsafeCharPattern` regex `/[<>`\\\\\"]/` which restricts certain characters in user input fields, but this is for security against XSS and not a general character set restriction for API interactions. The `claim-config.xml` files , , and  define regular expressions for email validation, which is a specific input validation and not a general character set acceptance policy.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_b9649d71-48f0-4e6b-925d-b7e9ee699b3d\\n', 'id': 'lc_c9e9d0b0-3415-43e4-9e6c-ff1599ac1aa2'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0025",
      "requirement": {
        "requirement_id": "ATOM_199",
        "requirement_text": "The TPP signature header shall use the keyId format 'SN=<serial_number>,CA=<certificate_authority>' for certificate identification",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "4e52743eb3ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0025_1",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_2",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - 9ZzFFBxSLGEjPZogRAbvFd\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = BkHxeIHKyMKF6SgGwqYzLUvTQfk\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - _wYMMJDl96s6D8p93iO2ApHw1BE\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_3",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_4",
          "text": "### Run tests\n\n1. Use a tool and convert the private key (tpp.com.key) to a JWK. Use this JWK to update the value of the **keys** \n   array element in the JSON configuration.\n2. Log in to the test suite.\n3. Select the Open Banking test plan and client authentication type as follows:\n    - Test plan: `FAPI-CIBA-ID1: Authorization server test`\n    - Client Authentication Type `private_key_jwt` or `mtls`\n    - CIBA Mode: `poll`\n    - FAPI Profile: `plain_fapi`\n    - Client Registration Type: `static_client`\n    ![test_configuration](../assets/img/conformance/test-config.png)\n4. Copy the content in the modified JSON configuration file and paste it into the **JSON** tab. ![json_configuration](../assets/img/conformance/json-config.png)\n5. Click **Start Test Plan**.\n6. Run each given test in sequence. ![run_test](../assets/img/conformance/run-test.png)\n7. Refer to <https://openid.net/certification/instructions/> for more information.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_5",
          "text": "#Using Sample Resources\n\nFollowing configs can be used in test-config.xml to use sample SSA and keystores for DCR tests.\n\n    <DCR>\n        <SSAPath>Path.To.Directory/ssa.txt</SSAPath>\n        <!-- SSA SoftwareId -->\n        <SoftwareId>jFQuQ4eQbNCMSqdCog21nF</SoftwareId>\n        <!-- SSA Redirect Uri -->\n        <RedirectUri>https://www.google.com/redirects/redirect1</RedirectUri>\n    </DCR>\n\nUse signing.jks in 'signing-keystore' directory as the Application Keystore, and transport.jks in 'transport-keystore'\ndirectory as the Transport Keystore.\n\nSample Keystore information:\n\n- Signing Kid = 7eJ8S_ZgvlYxFAFSghV9xMJROvk\n\n- Signing keystore alias = tpp7-signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - 7x6UrhU-Yj1Aa9Ird03JJCcDurs\n\n- Transport keystore alias = tpp7-transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the TPP signature header with the `keyId` format \\'SN=<serial_number>,CA=<certificate_authority>\\' for certificate identification. The provided context primarily focuses on OAuth2 and OpenID Connect implementations, including JWKS endpoints and DPoP, but lacks specific details or configurations for the requested TPP signature header format. \\n\\n## Implementation Details and Configuration Options\\n\\nThe codebase includes functionality related to JWKS (JSON Web Key Set) endpoints, which are used to publish public keys for verifying signatures.  The `Oauth2JWKSEndpointTestCase.java` file tests the JWKS endpoint and validates the structure of the public key set, including fields like `kid` (thumbprint), `x5c` (X.509 certificate chain), and `x5t#S256` (SHA-256 thumbprint of the X.509 certificate).  However, this is for general JWKS functionality and does not specifically implement or configure the `SN=<serial_number>,CA=<certificate_authority>` format within a TPP signature header. \\n\\nThe `DPoPProofGenerator.java` file deals with Demonstrating Proof of Possession (DPoP) tokens and includes methods to extract key thumbprints from DPoP proofs.  This involves parsing signed JWTs and computing thumbprints of RSA or EC keys.  While this involves certificate-related operations, it is within the context of DPoP and not directly related to the TPP signature header format you specified. \\n\\nThe `oidc-metadata.json` file defines various options for token endpoint signature algorithms, request object signature algorithms, and encryption methods.  It also lists client authentication methods such as `private_key_jwt` and `tls_client_auth` (Mutual TLS).  Mutual TLS typically involves client certificate authentication, but the specific `keyId` format \\'SN=<serial_number>,CA=<certificate_authority>\\' is not explicitly mentioned or configured here. \\n\\n## API Endpoints or Features\\n\\nThe `OAuth2 and OpenID Connect` wiki page mentions \"Certificate\" as a token binding type, which implies support for certificate-based authentication or binding. <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"3.1\" end=\"3.1\" /> However, the details of how this certificate binding is implemented, especially regarding the `keyId` format in a TPP signature header, are not elaborated in the provided context. <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"3.1\" end=\"3.1\" /> The wiki also outlines various OAuth2/OIDC endpoints like `/oauth2/jwks` for public keys, but none explicitly address the TPP signature header with the specified `keyId` format. <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"3.1\" end=\"3.1\" />\\n\\n## Documentation References\\n\\nThe provided context includes a wiki page on \"OAuth2 and OpenID Connect\" <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"3.1\" end=\"3.1\" /> which gives a high-level overview of the OAuth2 and OIDC implementation. While it covers token management and standards compliance, it does not contain specific documentation or references for the TPP signature header with the `keyId` format \\'SN=<serial_number>,CA=<certificate_authority>\\'. <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"3.1\" end=\"3.1\" />\\n\\n## Notes\\n\\nThe term \"TPP signature header\" is not explicitly found within the provided code snippets or the wiki page. <cite /> The codebase does handle certificates and key identification, particularly through JWKS endpoints and DPoP, but the specific format \\'SN=<serial_number>,CA=<certificate_authority>\\' for `keyId` in a TPP signature header is not directly supported or referenced in the given context.  It is possible that this functionality exists elsewhere in the repository or is handled by an external component not included in the provided context. <cite />\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6a97e127-31a2-4ed1-a32c-1b78028df6d3\\n', 'id': 'lc_fed99ec5-e537-41c8-892d-12826f65a7ce'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"This repository, `wso2/product-apim`, does not appear to directly support the TPP signature header format 'SN=<serial_number>,CA=<certificate_authority>' for certificate identification. The provided code snippets primarily deal with general certificate management, JWT validation, and WS-Security policies, none of which explicitly implement or configure the specified TPP signature header format.\\n\\n## Implementation Details and Configuration Options\\n\\nThe codebase contains functionalities related to client certificate management and JWT signature validation. However, there is no direct implementation or configuration option for the specific TPP signature header format you described.\\n\\n*   **Client Certificate Management**: The `ClientCertificatesApi.java` file includes an `updateAPIClientCertificateByKeyTypeAndAlias` method . This method allows updating client certificates using a `keyType` and `alias`, but it does not specify how these certificates are used in a TPP signature header or if they support the 'SN=<serial_number>,CA=<certificate_authority>' format. This file was last modified by `kasunsw` in commit [11f4128](https://github.com/wso2/product-apim/commit/11f4128f21122122212221222122212221222122) on 2020-09-23. \\n*   **JWT Signature Validation**: The `APIMTestCaseUtils.java` file contains methods for decoding and validating JWTs, including `isJwtSignatureValid` . This validation process involves extracting a thumbprint (`x5t`) and signature algorithm from the JWT header to verify the signature against a stored certificate in a keystore . While it deals with certificate identification, it uses a thumbprint and not the 'SN=<serial_number>,CA=<certificate_authority>' format. This file was last modified by `nuwanz` in commit [11f4128](https://github.com/wso2/product-apim/commit/11f4128f21122122212221222122212221222122) on 2020-09-23. \\n*   **WS-Security Policies**: Several XML policy files (e.g., `scenario2-policy.xml`, `scenario9-policy.xml`)   indicate support for `sp:MustSupportRefIssuerSerial`   within WS-Security policies. This element suggests that the system can process certificates identified by issuer and serial number. However, this is within the context of SOAP-based WS-Security and not explicitly for a `TPP-Signature` HTTP header. These files were last modified by `nuwanz` in commit [11f4128](https://github.com/wso2/product-apim/commit/11f4128f21122122212221222122212221222122) on 2020-09-23. \\n\\n## API Endpoints or Features\\n\\nThere are no explicit API endpoints or features in the provided snippets that directly mention or implement the `TPP-Signature` header with the specified `keyId` format. <cite/>\\n\\n## Documentation References\\n\\nNo documentation references related to the `TPP-Signature` header or its `keyId` format were found within the provided codebase context. <cite/>\\n\\n## Notes\\n\\nThe provided snippets show capabilities for managing client certificates and validating JWT signatures using certificate thumbprints or issuer/serial information within WS-Security policies. However, none of these directly address the `TPP-Signature` header with the specific `keyId` format 'SN=<serial_number>,CA=<certificate_authority>'. It's possible this functionality exists elsewhere in the larger `wso2/product-apim` repository or in a related component not included in the provided context. Without further information, it cannot be confirmed that this repository supports the exact requirement.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b2b61dfc-ef0d-405f-8dd9-9c5a63ee40e0\\n\", 'id': 'lc_fff644b7-0b03-4b1e-9273-b48098106cde'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0026",
      "requirement": {
        "requirement_id": "ATOM_099",
        "requirement_text": "Authorization header SHALL be included when OAuth2 authentication was performed in a pre-step or during SCA",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0026_1",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0026_2",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0026_3",
          "text": "### setOauthAppProperties method\nThis method lets you enable OAuth 2.0 properties related to the application. For example, ID token encryption.\n\n``` java\npublic void setOauthAppProperties(boolean isRegulatoryApp, OAuthConsumerAppDTO oauthApplication, Map<String, Object> spMetaData)\nthrows OpenBankingException {\n\n  oauthApplication.setIdTokenEncryptionEnabled(true);\n  oauthApplication.setIdTokenEncryptionAlgorithm(\"RSA-OAEP\");\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0026_4",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0026_5",
          "text": "### preProcessRequest method\n\nThis method handles the requests before API Authentication.\n\n``` java\npublic void preProcessRequest(OBAPIRequestContext obapiRequestContext);\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0026_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of an `Authorization` header when OAuth2 authentication is performed. The `Authorization` header is used to carry either `Basic` authentication credentials or a `Bearer` token, depending on the context of the request. The codebase demonstrates this through various test cases and utility methods for making authenticated API calls.\\n\\n### Implementation Details\\n\\nThe `Authorization` header is explicitly set in HTTP requests within the integration tests for OAuth2 and REST APIs. For instance, in `OAuth2RoleClaimTestCase.java`, the `Authorization` header is set with `Basic` authentication for token requests, using the `consumerKey` and `consumerSecret` of the OAuth2 application . Similarly, when making token requests for refresh grants, the `Authorization` header is set with `Basic` authentication using the client ID and client secret .\\n\\nThe `OAuth2RestClient.java` utility class provides methods to construct headers, including `getHeaders()` for `Basic` authentication  and `getHeadersWithBearerToken(String accessToken)` for `Bearer` token authentication . These methods ensure that the `Authorization` header is correctly formatted and included in outgoing requests.\\n\\nThe `RESTTestBase.java` class, which serves as a base for REST API integration tests, includes methods like `getResponseOfGetWithOAuth2()`  and `getResponseOfPostWithOAuth2()`  that explicitly use an OAuth2 access token to set the `Authorization: Bearer` header.\\n\\n### Configuration Options\\n\\nThe configuration of supported grant types, which implicitly dictates when an `Authorization` header might be required, can be found in XML configuration files. For example, `identity-identitymgtlistener-enabled.xml`  and `IDENTITY6777-identity.xml`  define various `SupportedGrantType` elements, such as `refresh_token`, `client_credentials`, and `authorization_code`. These grant types often require client authentication via the `Authorization` header.\\n\\nThe `TestServer.xml` file also shows an `oauth2` inbound authentication configuration for an application, specifying `grantTypes` that include `refresh_token`, `client_credentials`, and `authorization_code` . This indicates that applications can be configured to use these grant types, which would necessitate the inclusion of an `Authorization` header for client authentication.\\n\\n### API Endpoints or Features\\n\\nThe API layer supports authentication mechanisms including OAuth2 Bearer Token authentication . The `ACCESS_TOKEN_ENDPOINT` is a key endpoint where `Authorization` headers are used for obtaining tokens . The `INTRO_SPEC_ENDPOINT` is used for token introspection, which also involves sending an `Authorization` header .\\n\\nThe `API Layer` wiki page describes that the API Layer supports OAuth2 Bearer Token authentication for both Server APIs and User APIs .\\n\\n### Documentation References\\n\\nThe \"API Layer\" wiki page provides an overview of the API architecture, including authentication and authorization mechanisms . It explicitly mentions OAuth2 Bearer Token authentication as one of the supported methods . The \"Organization Management\" wiki page also discusses API Authentication, including OAuth2 Bearer Token authentication and organization-switched M2M tokens for cross-organization operations .\\n\\n## Notes\\n\\nThe provided code snippets primarily consist of integration tests and utility classes for making HTTP requests. These tests demonstrate the *usage* of `Authorization` headers in various OAuth2 flows (e.g., client credentials, authorization code, refresh token) and when interacting with REST APIs. While the snippets confirm that the `Authorization` header is indeed included, they do not directly show the server-side implementation that *verifies* the presence and validity of this header. The prompt\\'s mention of \"SCA\" (Strong Customer Authentication) is not directly addressed in the provided context. The test criteria regarding the absence of the header when OAuth2 or SCA was *not* performed is also not explicitly covered by the provided snippets, which focus on scenarios where authentication *is* performed.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_f838b3fe-46bb-4214-8cd1-d9ccfaea6985\\n', 'id': 'lc_2e6a6680-a1c6-42d5-9a6b-07806f8dfbfd'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0026_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_5fdd1d66-cb57-4ea3-8ba9-ab6af30a787f'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0027",
      "requirement": {
        "requirement_id": "ATOM_042",
        "requirement_text": "Error responses must include a structured JSON format with type, title, detail, code, and optional additionalErrors fields.",
        "strength": "MUST",
        "capability": "Error Handling",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0027_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Yes, the WSO2 Identity Server repository supports structured JSON error responses that include `code`, `message`, and `description` fields, and in some cases, a `traceId`. While the prompt specifically asks for `type`, `title`, `detail`, `code`, and `additionalErrors`, the current implementation primarily uses `code`, `message`, and `description` for error details, with `traceId` also being present in some error responses.\\n\\n### Implementation Details\\nThe error handling mechanism for the Server APIs is configured through JAX-RS providers in the `web.xml` file . Specifically, `org.wso2.carbon.identity.api.dispatcher.core.APIErrorExceptionMapper`, `org.wso2.carbon.identity.api.dispatcher.core.InputValidationExceptionMapper`, and `org.wso2.carbon.identity.api.dispatcher.core.DefaultExceptionMapper` are responsible for mapping exceptions to appropriate error responses .\\n\\nThe `RESTTestBase.java` class contains utility methods for validating error responses in integration tests . The `validateErrorResponse` method asserts that the response contains a `code`, `message`, `description`, and `traceId` . There is also a `validateErrorResponseWithoutTraceId` method for scenarios where `traceId` is not expected .\\n\\n### API Endpoints or Features\\nError responses are consistently validated across various API endpoints. For example, in the `AuthenticatorFailureTest.java`, `OrganizationManagementFailureTest.java`, `ClaimManagementNegativeTest.java`, and `TenantFailureTest.java`, error responses are checked for the presence of `code`, `message`, and `description` fields    .\\n\\nExamples of error responses from integration tests:\\n*   **Authenticator Management API**: When creating an authenticator with a missing endpoint property, the API returns a `400 Bad Request` with a specific `code` (\"AUT-60011\"), `message` (\"Invalid endpoint configuration provided.\"), and `description` . Similarly, an invalid display name results in `code` \"AUT-60015\" . Invalid authentication types or endpoint URIs return `code` \"UE-10000\" with a generic \"Invalid Request.\" message and description  .\\n*   **Organization Management API**: Invalid filter operators or unsupported attributes result in `400 Bad Request` with specific error codes like `ERROR_CODE_UNSUPPORTED_FILTER_OPERATION` or `ERROR_CODE_UNSUPPORTED_FILTER_ATTRIBUTE`  .\\n*   **SCIM2 API**: The `scim2.yaml` OpenAPI definition defines various error response objects such as `ErrorIvalidInput`, `ErrorUnauthorized`, `ErrorForbidden`, `ErrorUserNotAvailable`, `ErrorInternalServerError`, and `ErrorNotimplemented` . These definitions include `status` (HTTP status code), `schemas`, `scimType`, and `detail` fields. The `scimType` field can be considered analogous to the `type` field in your requirement, and `detail` is similar to `detail`.\\n\\n### Documentation References\\nThe \"Server APIs\" wiki page provides an overview of the Server APIs, mentioning that they follow REST principles and use JSON for data format . It also highlights the standardized error handling mechanism through exception mappers .\\n\\n## Notes\\nThe current error response structure in the WSO2 Identity Server APIs, as evidenced by the provided code snippets and OpenAPI definitions, primarily includes `code`, `message`, `description`, and sometimes `traceId`. While this aligns with a structured JSON format, it does not strictly match all the field names (`type`, `title`, `detail`, `additionalErrors`) specified in your requirement. The `scim2.yaml` file uses `scimType` and `detail` which are similar to `type` and `detail` respectively  . There is no explicit `title` or `additionalErrors` field observed in the provided context. The `validateErrorResponse` method in `RESTTestBase.java` explicitly checks for `code`, `message`, `description`, and `traceId` .\\n\\nWiki pages you might want to explore:\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_ce41c1b2-161a-4763-b6a8-8932e7809fd4\\n', 'id': 'lc_0ae7ff19-a757-4570-ab82-9efc6b957f00'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0027_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Yes, the repository supports structured JSON error responses with `code`, `message`, `description`, `moreInfo`, and an `error` array for additional errors. The `type` and `title` fields mentioned in your query are mapped to `message` and `description` respectively, and `additionalErrors` is mapped to the `error` array.    \\n\\n## Implementation Details\\n\\nThe error response structure is defined in several OpenAPI/Swagger specification files across different modules.    \\n\\nThe primary error object is named `Error` and includes the following properties:\\n*   `code`: An integer representing the error code. \\n*   `message`: A string providing a concise error message.  This corresponds to the `type` field in your query.\\n*   `description`: A detailed description of the error message.  This corresponds to the `title` field in your query.\\n*   `moreInfo`: An optional URL with more details about the error. \\n*   `error`: An array of `ErrorListItem` objects, used to list multiple errors, such as validation errors for each field.  This corresponds to the `additionalErrors` field in your query.\\n\\nThe `ErrorListItem` object further defines individual errors with:\\n*   `code`: A string representing the individual error code. \\n*   `message`: A string describing the individual error. \\n*   `description`: An optional detailed description about the individual error. \\n\\nAn example of the `ErrorListItemDTO` Java class, generated from these OpenAPI specifications, can be found in `all-in-one-apim/modules/integration/tests-common/clients/publisher/src/gen/java/org/wso2/am/integration/clients/publisher/api/v1/dto/ErrorListItemDTO.java`.  This class contains fields for `code`, `message`, and `description`. \\n\\n## Configuration Options\\n\\nThe error response structure is defined within the OpenAPI specification files. There are no explicit configuration options mentioned in the provided snippets to alter this structure at runtime. The structure is part of the API contract. \\n\\n## API Endpoints or Features\\n\\nVarious API endpoints across different modules are designed to return error responses conforming to this structure. For instance, the `gateway-api.yaml` defines `BadRequest` and `NotFound` responses that reference the `Error` schema.  Similarly, `service-catalog-api.yaml` and `publisher/api/openapi.yaml` show examples of `BadRequest`, `InternalServerError`, `NotFound`, `Conflict`, `Unauthorized`, and `UnsupportedMediaType` responses, all adhering to the `Error` schema.  \\n\\n## Documentation References\\n\\nThe structure of the error responses is documented within the OpenAPI specification files themselves. For example, the `Error` definition includes descriptions for each field, such as \"Error message.\" for `message` and \"A detail description about the error message.\" for `description`.  The `ErrorListItem` also has descriptions for its `code` and `message` fields. \\n\\n## Test Criteria\\n\\nTo verify that error responses contain all required JSON fields and a properly formatted `additionalErrors` array, you would need to:\\n1.  Trigger various error conditions (e.g., bad requests, unauthorized access, not found resources) on the API endpoints. \\n2.  Inspect the JSON response body to ensure it contains `code`, `message`, `description`, and `moreInfo` fields. \\n3.  Check for the presence of the `error` array (corresponding to `additionalErrors`) and verify that its items conform to the `ErrorListItem` structure, including `code` and `message` for each individual error.  \\n\\n## Notes\\n\\nThe terms `type` and `title` from your query are not explicitly present as field names in the error response schemas. Instead, `message` is used for a concise error description (similar to `type`), and `description` provides a more detailed explanation (similar to `title`).  The `additionalErrors` field is represented by the `error` array, which contains `ErrorListItem` objects. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_1d1cd1a1-e5f4-43bb-ac61-879c259f58e1\\n', 'id': 'lc_f1dbc2ee-d521-4d59-a28d-9b7ab50a86d6'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0028",
      "requirement": {
        "requirement_id": "ATOM_126",
        "requirement_text": "ASPSP SHALL check access frequency per account that has been accessed and per PSU for list of accounts consent",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0028_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support checking access frequency per account and per PSU for list of accounts consent. The provided code snippets and wiki documentation primarily focus on consent management for personal identifiable information (PII) categories and purposes, as well as general OAuth2/OIDC and SAML consent flows. There is no explicit mention or implementation of frequency limiting mechanisms tied to account access or PSU consent within the given context.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThe codebase includes features for consent management, but these are related to user data sharing rather than access frequency limits.\\n\\n### Consent Management\\nThe `wso2/product-is` repository provides a Consent Management framework that allows for the collection, storage, and management of user consent for processing personal data <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"7.3\" end=\"7.3\" />. This framework involves:\\n*   **PII Categories**: Defining types of personal data <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"7.3\" end=\"7.3\" />.\\n*   **Purposes**: Specifying reasons for data collection <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"7.3\" end=\"7.3\" />.\\n*   **Consent Receipts**: Records of user consent decisions <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"7.3\" end=\"7.3\" />.\\n\\nConsent is collected during self-registration, authentication, and profile updates <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"7.3\" end=\"7.3\" />. The enforcement of consent ensures that only attributes with user consent are included in tokens and API responses <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"7.3\" end=\"7.3\" />.\\n\\nThe `SelfSignUpConsentTest.java` file demonstrates how consent is handled during self-registration, including adding purposes and categories, and retrieving consent receipts . The `getConsentReqBody` method constructs the request body for consent, specifying jurisdiction, collection method, PII principal ID, and purposes .\\n\\nThe `default-identity.xml` configuration file includes settings for `EnableSSOConsentManagement`, indicating that consent management can be enabled during SSO . It also defines REST API resources for managing consents, purposes, PII categories, and purpose categories .\\n\\n### Lack of Frequency Limiting\\nThe provided context does not contain any code or configuration related to checking access frequency per account or per PSU for consent. The existing consent mechanisms are focused on data sharing permissions rather than rate limiting or frequency control for access to accounts.\\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"7.3\" end=\"7.3\" />. However, it does not discuss frequency limits for account access. The \"Integration Tests\" wiki page also mentions consent tests, but again, without any reference to frequency limits <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"6.1\" end=\"6.1\" />.\\n\\n## Notes\\n\\nThe user\\'s query specifically asks about \"ASPSP SHALL check access frequency per account that has been accessed and per PSU for list of accounts consent\". While the repository has robust consent management features, these are primarily concerned with data privacy and sharing permissions. There is no evidence in the provided snippets or wiki pages to suggest that the system implements or supports frequency limiting for account access based on consent. The `ConsentMgtTestCase.java` and `SelfSignUpConsentTest.java` files, along with the `default-identity.xml` configuration, demonstrate the consent framework\\'s capabilities for managing user data consent, but not for enforcing access frequency limits.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_31e32741-9dd0-4c46-8f40-8a0f2101639f\\n', 'id': 'lc_f05ecabf-eb90-4463-885f-b57266f51df6'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0028_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, WSO2 API Manager, supports rate limiting and throttling policies that can be applied to APIs.  These policies can control API usage based on defined limits.  While the system provides mechanisms for defining subscription tiers and application-level throttling,    there is no explicit mention or direct implementation details within the provided snippets that specifically address \"access frequency per account that has been accessed and per PSU for list of accounts consent.\" <cite/>\\n\\n## Implementation Details\\n\\nThe WSO2 API Manager utilizes a Traffic Manager component to enforce rate limits and throttling policies.  The system allows for the definition of various throttling tiers, including `SubscriptionTierLimits`, `ApplicationTierLimits`, and `ResourceLevelTierLimits`.    These limits can be configured in the `api-manager.xml` file.   \\n\\nThe throttling mechanism involves a `DataPublisher` and `JMSConnectionDetails` to send throttle data, which is then processed by the Traffic Manager.    When a rate limit is exceeded, the Gateway can return a \"429 Too Many Requests\" response. \\n\\nAn example of configuring a subscription throttling policy is shown in `APIM5898.txt`, where a `PlatinumTier` is defined to allow 20 requests per minute.  This policy is then applied to a subscription. \\n\\n## Configuration Options\\n\\nThrottling configurations are primarily managed within the `ThrottlingConfigurations` section of the `api-manager.xml` file.    Key configurable elements include:\\n\\n*   **`SubscriptionTierLimits`**: Defines limits for different subscription tiers (e.g., Gold, Silver, Bronze, Unlimited). \\n*   **`ApplicationTierLimits`**: Sets limits at the application level. \\n*   **`ResourceLevelTierLimits`**: Configures limits for specific API resources. \\n*   **`EnableUnlimitedTier`**: A boolean flag to enable or disable an unlimited tier. \\n*   **`EnableHeaderConditions`**, **`EnableJWTClaimConditions`**, **`EnableQueryParamConditions`**: These flags allow for conditional throttling based on request headers, JWT claims, or query parameters. \\n\\nThe `TomlBasedConfigurationTestCase.java` file demonstrates how these throttling configurations are read and verified, indicating that they are indeed configurable. \\n\\n## API Endpoints or Features\\n\\nThe API Manager provides endpoints for managing throttling policies. For instance, the `APIMGetAllSubscriptionThrottlingPolicies.java` test case uses `restAPIPublisher.getSubscriptionPolicies(EVENT_COUNT_TYPE)` to retrieve subscription policies.  The `APIM5898.txt` file shows a `POST` request to `/api/am/admin/v0.17/throttling/policies/subscription` for creating a new subscription throttling policy. \\n\\n## Documentation References\\n\\nThe `README.md` file for the `wso2/product-apim` repository mentions \"Enforce rate limiting and throttling policies for APIs by consumer.\"  This indicates that the system is designed to control API usage based on consumer-specific policies.  Additionally, the `Overview` wiki page describes the Traffic Manager\\'s role in enforcing rate limits.  The `advanced_mediation_samples.xml` files provide examples of how throttling can be configured and how access can be denied when limits are reached.   \\n\\n## Notes\\n\\nThe provided code snippets demonstrate that WSO2 API Manager has robust throttling capabilities at various levels (subscription, application, resource).  However, the specific requirement of checking \"access frequency per account that has been accessed and per PSU for list of accounts consent\" is not explicitly detailed in the provided context. <cite/> While the system can enforce policies \"by consumer\" , it\\'s not clear from these snippets if it can differentiate throttling based on individual accounts within a consent that covers multiple accounts, or if \"PSU\" (Payment Service User) is a recognized entity for throttling purposes. <cite/> Further investigation into the custom throttling policies or advanced analytics features would be needed to confirm this specific functionality. <cite/>\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-apim)](/wiki/wso2/product-apim#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_641ddefa-042c-4d94-ad47-44e77796b44c\\n', 'id': 'lc_d0f4798f-7c0e-4ae1-b279-251cb705da8f'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0029",
      "requirement": {
        "requirement_id": "ATOM_168",
        "requirement_text": "The system SHALL include Authorization header conditionally only when OAuth2 based authentication was performed",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0029_1",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_2",
          "text": "### getSubjectClaim method\n\nThis method contains the pairwise subject calculation logic. You can customize it according to your requirements. Given \nbelow is the method signature:\n\n``` java\ngetSubjectClaim(OAuthAuthzReqMessageContext authzReqMessageContext,\n                                OAuth2AuthorizeRespDTO authorizeRespDTO,\n                                String clientId,\n                                String spTenantDomain,\n                                AuthenticatedUser authorizedUser) throws IdentityOAuth2Exception;\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_3",
          "text": "### getSubjectClaim method\n\nThis method contains the pairwise subject calculation logic. You can customize it according to your requirements. Given \nbelow is the method signature:\n\n``` java\ngetSubjectClaim(OAuthTokenReqMessageContext tokenReqMessageContext,\n                                OAuth2AccessTokenRespDTO tokenRespDTO,\n                                String clientId,\n                                String spTenantDomain,\n                                AuthenticatedUser authorizedUser) throws IdentityOAuth2Exception;\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_4",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_5",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the conditional inclusion of the `Authorization` header when OAuth2-based authentication is performed. The system uses different methods to construct headers based on the authentication type, specifically distinguishing between basic authentication and OAuth2 bearer token authentication. \\n\\n## Implementation Details\\n\\nThe `OAuth2RestClient.java` file contains methods that demonstrate how the `Authorization` header is conditionally included. \\n\\n*   **Basic Authentication**: The `getHeaders()` method constructs an array of `Header` objects.  This method explicitly sets the `AUTHORIZATION_ATTRIBUTE` (which corresponds to the \"Authorization\" header) with a `BASIC_AUTHORIZATION_ATTRIBUTE` prefix, followed by a Base64 encoded string of the username and password.  This indicates that for basic authentication, the `Authorization` header is always present and contains basic credentials. \\n\\n*   **OAuth2 Bearer Token Authentication**: The `getHeadersWithBearerToken(String accessToken)` method is used when an OAuth2 access token is available.  This method also sets the `AUTHORIZATION_ATTRIBUTE`, but it uses a `BEARER_TOKEN_AUTHORIZATION_ATTRIBUTE` prefix followed by the provided `accessToken`.  This confirms that for OAuth2 authentication, the `Authorization` header is present and carries the bearer token. \\n\\nThe `RESTTestBase.java` file further illustrates this conditional behavior in its utility methods for making HTTP requests. \\n\\n*   Methods like `getResponseOfGetWithOAuth2(String endpointURL, String accessToken)`  and `getResponseOfPostWithOAuth2(String endpointURL, String body, String accessToken)`  explicitly use `given().auth().preemptive().oauth2(accessToken)` to include the OAuth2 bearer token in the `Authorization` header. \\n*   In contrast, methods like `getResponseOfPost(String endpointUri, String body, String contentType)`  use `given().auth().preemptive().basic(authenticatingUserName, authenticatingCredential)` for basic authentication, which also includes an `Authorization` header but with basic credentials. \\n\\nThe `OAuth2DPopTestCase.java` also demonstrates the explicit inclusion of the `DPoP` header and `Authorization` header for OAuth2 token requests. \\n\\n## Configuration Options\\n\\nThe `OAuth2Constant.java` file defines various constants related to OAuth2, including `AUTHORIZATION_HEADER` and `ACCESS_TOKEN`.  While this file primarily contains constants, the presence of these constants indicates the system\\'s awareness and handling of OAuth2-specific headers. \\n\\nThe `identity.xml` configuration files (e.g., `default-identity.xml`, `IDENTITY6777-identity.xml`, `encrypt-decrypt-persistence-enabled-identity.xml`, `identity-mgt-listener-enabled.xml`, `saml-assertion-query-enabled-identity.xml`, `identity-skipuserconsent.xml`) define various OAuth-related endpoints and validity periods for tokens.       These configurations indirectly affect how OAuth2 tokens are issued and, consequently, how the `Authorization` header would be used. \\n\\n## API Endpoints or Features\\n\\nThe system provides API endpoints for OAuth2 token issuance and management. \\n\\n*   `ACCESS_TOKEN_ENDPOINT`: This endpoint is used to obtain access tokens.  When requesting an access token, the client typically includes its credentials in an `Authorization` header (e.g., Basic authentication for client credentials grant). \\n*   `TOKEN_REVOKE_ENDPOINT`: This endpoint is used to revoke tokens.  Revocation requests would also typically include an `Authorization` header with the token to be revoked or client credentials. \\n\\nThe `OrganizationManagementSuccessTest.java` file demonstrates obtaining an M2M (Machine-to-Machine) access token using client credentials and then using this token in an `Authorization` header for subsequent API calls.  Specifically, the `testSelfOnboardOrganization` method makes a POST request to `ORGANIZATION_MANAGEMENT_API_BASE_PATH` with the `m2mToken` in the `Authorization` header. \\n\\n## Documentation References\\n\\nThe \"OAuth2 and OpenID Connect\" wiki page provides an overview of the OAuth2 and OIDC implementation in WSO2 Identity Server.  It discusses token types, including access tokens, and token binding mechanisms like DPoP.  The \"Application Management\" wiki page also mentions OAuth2/OIDC as a supported protocol and details configuration options for grant types and token binding.  These documents implicitly support the idea that the `Authorization` header is used when OAuth2 is involved, as it\\'s fundamental to how access tokens are transmitted. \\n\\n## Test Criteria Verification\\n\\nThe integration tests within the `wso2/product-is` repository, particularly in `OAuth2RestClient.java`  and `RESTTestBase.java` , demonstrate the conditional inclusion of the `Authorization` header. When OAuth2 authentication is performed, methods like `getHeadersWithBearerToken`  or `given().auth().preemptive().oauth2(accessToken)`  are used, ensuring the `Authorization` header is present with the bearer token. Conversely, for non-OAuth2 scenarios (e.g., basic authentication), the `Authorization` header is still present but contains basic credentials, as seen in `getHeaders()`  and `given().auth().preemptive().basic(...)` . The prompt\\'s requirement \"only when OAuth2 based authentication was performed\" implies that the header should be absent otherwise. However, the provided code snippets show that for basic authentication, an `Authorization` header is still included, albeit with different content. This suggests that the system always includes an `Authorization` header if authentication is required, but its content varies based on the authentication mechanism.\\n\\n## Notes\\n\\nThe prompt states \"The system SHALL include Authorization header conditionally only when OAuth2 based authentication was performed\". The provided code snippets indicate that an `Authorization` header is always included when authentication is performed, whether it\\'s OAuth2 bearer token authentication or basic authentication. The content of the header changes (bearer token vs. basic credentials), but the header itself is not absent in non-OAuth2 authenticated requests. Therefore, the system includes the `Authorization` header conditionally based on the *type* of authentication, but not conditionally based on the *presence* of authentication.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2fb081a2-7a8b-42ca-b1ed-ce9855989372\\n', 'id': 'lc_3bada1fb-e564-45fb-998a-545257feb1c9'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_8a6e160e-4b5d-4291-bc43-5bef4ac7b991'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0030",
      "requirement": {
        "requirement_id": "ATOM_141",
        "requirement_text": "The system SHALL include PSU-IP-Address header when request was actively initiated by the PSU",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0030_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0030_2",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, does not directly support the explicit inclusion of a `PSU-IP-Address` header based on whether a request was actively initiated by a PSU (Payment Service User) or a TPP (Third Party Provider) <cite/>. The provided code snippets do not contain any direct references to `PSU-IP-Address`, `PSU`, or `TPP`   .\\n\\nHowever, the system does include a `RemoteIpValve` in its Tomcat configuration, which is designed to extract client IP addresses from request headers . This valve can be configured to read IP addresses from a specified header, which might be a point of extension for your requirement .\\n\\n## Implementation Details\\n\\nThe `wso2/product-is` repository uses a `RemoteIpValve` within its Tomcat server configuration, defined in `catalina-server.xml.j2` . This valve's purpose is to get the real client IP addresses via request headers . The `RemoteIpValve` is configured with properties such as `internalProxies`, `remoteIpHeader`, `protocolHeader`, `proxiesHeader`, and `trustedProxies` .\\n\\nThe `remoteIpHeader` property specifies the header from which the remote IP address should be read . While there's no direct mention of `PSU-IP-Address`, this `remoteIpHeader` could potentially be configured to look for such a header if it were to be passed to the Tomcat instance .\\n\\n## Configuration Options\\n\\nThe `RemoteIpValve` can be enabled or disabled using the `catalinaValves.remoteIpValve.enable` flag . The specific header to be used for the remote IP address can be configured via the `remoteIpHeader` property within the `catalinaValves.remoteIpValve` section .\\n\\nFor example, if you wanted to configure the system to read a `PSU-IP-Address` header, you would need to modify the configuration that populates the `catalinaValves.remoteIpValve.remoteIpHeader` property . This configuration is likely managed through the system's configuration templates, specifically `catalina-server.xml.j2` .\\n\\n## API Endpoints or Features\\n\\nThere are no specific API endpoints or features directly related to handling a `PSU-IP-Address` header mentioned in the provided context <cite/>. The `API Layer` described in the architecture wiki page focuses on RESTful APIs for administration and user management, and does not detail specific header handling for client IP addresses beyond what the Tomcat valve provides .\\n\\n## Documentation References\\n\\nThe `Architecture` wiki page provides a high-level overview of the system's design, including the `Configuration System` . It mentions that configuration is managed through `repository/conf` and `repository/resources/conf/templates` . The `catalina-server.xml.j2` file is a configuration template that would be relevant for understanding how the `RemoteIpValve` is configured .\\n\\n## Notes\\n\\nThe requirement to include a `PSU-IP-Address` header and differentiate between PSU-initiated and TPP-initiated requests suggests a need for custom logic to identify the initiator and then inject or process this specific header. While the `RemoteIpValve` can extract IP addresses from headers, it does not inherently provide the logic to determine if a request was PSU-initiated versus TPP-initiated, nor does it explicitly add a `PSU-IP-Address` header . This would likely require custom development or an extension to the existing authentication or API layers to implement the required business logic and header manipulation. The `RequestCorrelationIdValve` is present, which handles correlation IDs from headers, but this is distinct from IP address handling .\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d8e5a3e9-d9aa-43aa-a45b-07422b4a1495\\n\", 'id': 'lc_963bac3c-3a76-4a95-9c92-c4f54b565a04'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0030_3",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_e1874d52-4591-42fd-9456-030e528ba28d'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0031",
      "requirement": {
        "requirement_id": "ATOM_095",
        "requirement_text": "X-Request-ID header MUST be included in all payment initiation API calls as unique request identifier",
        "strength": "MUST",
        "capability": "General",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0031_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to have some support for \"payment initiation\" as a type of authorization detail, but there is no direct evidence in the provided snippets of explicit support for the `X-Request-ID` header as a unique request identifier in payment initiation API calls.   The codebase includes models for `AuthorizationDetailsType` and `AuthorizationDetailsTypesCreationModel` that define a `type` field, which can be set to \"payment_initiation\".   However, there are no implementation details, configuration options, or API endpoints explicitly mentioning the `X-Request-ID` header or its uniqueness for payment initiation flows. <cite />\\n\\n### Implementation Details\\nThe `AuthorizationDetailsType` class, located at `modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/rest/api/server/api/resource/v1/model/AuthorizationDetailsType.java`, defines a model for authorization details.  It includes fields such as `id`, `type`, `name`, `description`, and `schema`.  The `type` field is annotated with an example value of \"payment_initiation\", indicating that this type of authorization detail is recognized.  Similarly, `AuthorizationDetailsTypesCreationModel` also defines a `type` field with \"payment_initiation\" as an example. \\n\\nThe `OAuth2RichAuthorizationRequestsTestCase` at `modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/oauth2/OAuth2RichAuthorizationRequestsTestCase.java` demonstrates the use of `AuthorizationDetailsType` in integration tests.  It creates test authorization details types and registers API resources with them.  The test `testOIDCMetadataResponseContent` verifies that the OIDC metadata endpoint contains supported authorization details types.  However, none of these snippets provide details on how an `X-Request-ID` header would be implemented or enforced for uniqueness within these payment initiation flows. <cite />\\n\\n### Configuration Options\\nThe provided code snippets do not contain any explicit configuration options related to an `X-Request-ID` header for payment initiation API calls. <cite /> The `schema` field within `AuthorizationDetailsType` and `AuthorizationDetailsTypesCreationModel` accepts a JSON Schema document, which could potentially define requirements for request headers, but there is no example provided that includes `X-Request-ID`.  \\n\\n### API Endpoints or Features\\nThe `Features and Capabilities` wiki page mentions \"Financial-grade API (FAPI) Support\" as part of API Security.  FAPI often includes requirements for request identifiers, but the provided context does not elaborate on the specific implementation of FAPI or how `X-Request-ID` would be handled within it. <cite /> The `AuthorizationDetailsType` and `AuthorizationDetailsTypesCreationModel` classes are used to define and manage authorization details, which can include \"payment_initiation\" as a type.   This suggests that the system is designed to handle different types of authorization details, including those related to payments. <cite />\\n\\n### Documentation References\\nThe `Features and Capabilities` wiki page provides a high-level overview of the product\\'s features.  While it mentions \"Financial-grade API (FAPI) Support\", it does not specifically detail the `X-Request-ID` header.  The `README.md` also briefly mentions \"Best API security available anywhere, using the powerful FAPI standard\" but without further specifics on request headers. \\n\\n## Notes\\nThe provided snippets indicate that WSO2 Identity Server has a mechanism to define and manage different types of authorization details, including \"payment_initiation\".   The mention of FAPI support also suggests a focus on secure financial APIs.  However, there is no direct evidence in the provided context that the `X-Request-ID` header is explicitly supported, enforced, or configurable as a unique request identifier for payment initiation API calls. <cite /> To confirm this, further investigation into the FAPI implementation details and the schema definitions for \"payment_initiation\" authorization details would be necessary. <cite />\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-x_c7bb9d54-caef-4a8d-9747-67839f191a90\\n', 'id': 'lc_b4cd99b2-09f6-4e08-9cb7-02a056c03da2'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0031_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, `wso2/product-apim`, does not explicitly support an `X-Request-ID` header for payment initiation API calls as a unique request identifier. However, it does utilize `MessageID` and `RelatesTo` headers, which serve similar purposes of providing unique identifiers for messages and related requests.\\n\\n### Implementation Details    \\nThe codebase defines two headers, `MessageID` and `RelatesTo`, which are intended for unique identification of messages and their relationships. The `MessageID` header is described as \"The unique message ID of the message\" . Its possible value is a `UUID` . Similarly, the `RelatesTo` header is described as \"The unique ID of the request to which the current message is related\" , also using a `UUID` as a possible value . These headers are mentioned in `properties_guide.xml` files across different modules, including `all-in-one-apim` , `api-control-plane` , `gateway` , and `traffic-manager` .\\n\\nWhile these headers provide unique identifiers, there is no direct mention or implementation of an `X-Request-ID` header specifically for payment initiation flows in the provided snippets. The `StarbucksOutletServiceImpl.java` file contains a `doPayment` method  which handles payment processing, but it does not explicitly interact with `X-Request-ID`, `MessageID`, or `RelatesTo` headers.\\n\\n### Configuration Options \\nThe `Owasp.CsrfGuard.Carbon.properties` file mentions `X-Requested-With` header in the context of CSRF protection for Ajax requests . When `org.owasp.csrfguard.Ajax` is set to `true` , the system expects an `X-Requested-With` header and a custom header for CSRF token verification . This is related to request identification but is specific to CSRF protection and not a general `X-Request-ID` for all API calls.\\n\\n### API Endpoints or Features \\nThe `StarbucksOutletServiceImpl.java` file includes a `doPayment` method  that simulates a payment initiation. This method takes an `id` and a `Payment` object as parameters . It checks for duplicate payments and invalid order IDs . However, there\\'s no explicit mechanism shown in this snippet to enforce or utilize an `X-Request-ID` header for these payment calls.\\n\\n### Documentation References \\nThe `properties_guide.xml` files across various modules document the `MessageID` and `RelatesTo` headers . These documents describe their purpose as unique identifiers. There is no documentation specifically for an `X-Request-ID` header in the provided context.\\n\\n## Notes\\nThe provided snippets do not show direct support for an `X-Request-ID` header. While `MessageID` and `RelatesTo` headers exist and serve similar purposes of unique identification, they are not explicitly named `X-Request-ID`. The `X-Requested-With` header is mentioned in the context of CSRF protection, which is a different use case. To implement the `X-Request-ID` requirement, you would likely need to introduce custom mediation policies or handlers within the WSO2 API Manager to intercept and process this header for payment initiation API calls.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-x_295d8b99-0b44-4398-9484-700d42d1ad94\\n', 'id': 'lc_5ad9f985-aea0-4fdd-9230-1deb7d5ee397'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0032",
      "requirement": {
        "requirement_id": "ATOM_057",
        "requirement_text": "The system MUST provide SCA process status information through 'scaStatus' data element in GET SCA Status Response Message for payment initiation.",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0032_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0032_2",
          "text": "backendTime)`|`142`| In addition to the above-mentioned data elements, you can publish data that are specific to your open banking standard. For information on the additional data elements that you can publish, see [Data Publishing Extensions](../develop/authentication-flow-for-data-publishing.md). WSO2 Open Banking Accelerator has by default enabled data publishing in API gateway and authentication components. Additionally, you can publish any streams using a custom component. For more information, see [Custom Data Publishing](../develop/custom-data-publishing.md). ###Data Summarization You can write a summarization script for the data stored using Siddhi Applications. For more information, see the WSO2 Streaming Integrator documentation on [Summarizing Data](https://ei.docs.wso2.com/en/latest/streaming-integrator/guides/summarizing-data/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0032_3",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n```\ncurl --location --request POST 'https://localhost:8243/open-banking/v3.1/aisp/account-access-consents' \\\n--header 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n--header 'x-fapi-financial-id: open-bank' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n    \"Data\": {\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\"\n    },\n    \"Risk\": {\n        \n    }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"StatusUpdateDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\",\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"a34c8608-dbd2-4997-aad7-398a5b31cbe6\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0032_4",
          "text": "### push-auth/discovery-data endpoint\n\nInvoke the `push-auth/discovery-data` endpoint to retrieve device registration information for a particular user who \nwishes to register their device. This is a secured endpoint and requires a bearer token bound to the user.\n\nPass the response of this request to the `addAccount()` method of the SDK as the `qrData` parameter.\n\nInvoke this API within the bank user portal, convert the response to a QR code and display it to the user. Therefore, \nthe mobile app should contain a QR code scanner. \n\n ``` tab=\"Request\"\n GET https://<IS_HOST>:<PORT>/api/openbanking/ciba/push-auth/discovery-data\n ```\n\n ``` tab=\"Response\"\n {\n    \"did\":\"014e502a-cdff-43bd-9705-ad0ceb6dd351\",\n    \"un\":\"admin@wso2.com\",\n    \"td\":\"carbon.super\",\n    \"hst\":\"https://192.168.8.193:9446\",\n    \"bp\":\"/t/carbon.super/api/users/v1/me\",\n    \"re\":\"/push-auth/devices\",\n    \"ae\":\"/push-auth/authenticate\",\n    \"rde\":\"/push-auth/devices/remove\",\n    \"chg\":\"82e33587-ba35-440e-8f73-d3542a859da8\"\n }\n ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0032_5",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0032_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository does not appear to directly support providing SCA (Strong Customer Authentication) process status information through an `scaStatus` data element in a GET SCA Status Response Message for payment initiation. The provided code snippets primarily relate to Single Sign-On (SSO) with WS-Federation, SCIM 2.0 API definitions, and general integration tests   . There are no explicit mentions of \"SCA\", \"payment initiation\", or \"scaStatus\" in the context of a response message within the provided code.\\n\\n## Implementation Details, Configuration Options, API Endpoints, and Documentation References\\n\\nBased on the provided code snippets, there are no implementation details, configuration options, API endpoints, or documentation references that directly address the requirement of providing SCA process status information through an `scaStatus` data element for payment initiation <cite/>.\\n\\nThe `TestPassiveSTS.java` file contains tests related to WS-Federation and SAML assertions, which are part of SSO flows, not payment initiation or SCA status reporting . The `scim2.yaml` file defines SCIM 2.0 API endpoints for user and group management, and it does not include any SCA-related functionalities . Similarly, `identity-original-530-cache-disabled.xml` configures resource access control for SCIM2 endpoints and other identity-related services, but not SCA status .\\n\\n## Notes\\n\\nThe term \"SCA\" in the user\\'s query refers to Strong Customer Authentication, which is a regulatory requirement in certain payment contexts. The provided code snippets do not contain any references to this specific domain or the `scaStatus` data element. The `TestPassiveSTS.java` file does contain \"STS\" which stands for Security Token Service, but this is in the context of WS-Federation and not related to payment SCA .\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_afbbd4a4-89eb-405c-a59c-c57b565d3435\\n', 'id': 'lc_d135cf85-d033-4e0c-84ae-db4ea618e64c'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0032_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_4baf7f73-6ccc-40c4-ae05-b6dd7bfd1f92'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0033",
      "requirement": {
        "requirement_id": "ATOM_109",
        "requirement_text": "The API SHALL support DELETE /v1/{payment-service}/{payment-product}/{paymentId} endpoint for payment cancellation",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0033_1",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_3",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts |[account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments |[payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds |[funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/) as an Operational Policy.\n\n    Use aut as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n\n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n\n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_4",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts | [account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments | [payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds | [funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/).\n\n    Use **aut** as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n    \n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    \n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_5",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not directly support a `DELETE /v1/{payment-service}/{payment-product}/{paymentId}` endpoint for payment cancellation. Instead, it provides mechanisms for deleting payment *consents* and a generic `DELETE` endpoint for consent management.\\n\\n## Implementation Details and API Endpoints\\n\\nThe `wso2/financial-services-accelerator` repository, which is a solution extending WSO2 Identity Server and API Manager for financial services and Open Banking , defines API specifications for various financial services, including Payment Initiation APIs .\\n\\nThe `payment-initiation-openapi.yaml` file, which defines the Payment Initiation API, includes endpoints for creating and retrieving payment consents and payments, but it does not define a `DELETE` operation for `/payments/{paymentId}` .\\n\\nHowever, the repository does support the deletion of *consents* related to payments and other services. For instance, the `account-info-swagger.yaml` defines a `DELETE` endpoint for `/account-access-consents/{ConsentId}` . Similarly, the `funds-confirmation-openapi.yaml` defines a `DELETE` endpoint for `/funds-confirmation-consents/{consentId}` .\\n\\nThere is also a generic consent `DELETE` endpoint handled by the `ConsentManageEndpoint` class in `org.wso2.financial.services.accelerator.consent.mgt.endpoint` . This endpoint, defined as `@Path(\"/{s:.*}\")`, can handle `DELETE` requests for various consent-related resources.\\n\\nFor administrative purposes, there is an endpoint `DELETE /admin/revoke` which allows for the revocation of consents by `consentID` and optionally `userID` . This administrative revocation process is handled by the `DefaultConsentAdminHandler`  and can integrate with external services for pre-revocation validations .\\n\\n## Configuration Options\\n\\nThe system uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class . This configuration supports consent management with customizable handlers and validation rules .\\n\\nThe `PRE_PROCESS_CONSENT_REVOKE` extension point allows for external validation and custom revocation logic before a consent is revoked . This is configured in the `financial-services.xml` file and processed by `ExternalAPIConsentAdminUtils` .\\n\\n## Documentation References\\n\\nThe `Overview` wiki page provides a high-level overview of the Financial Services Accelerator, including its modular architecture, core components, configuration management, and API specifications . It specifically mentions \"Payment Initiation APIs\" and their endpoints for consent creation and payment execution .\\n\\nThe `Admin Operations` wiki page details the administrative consent operations, including search, revocation, and amendment history management . It describes the `DefaultConsentAdminHandler` and the external service integration for pre-revocation processing .\\n\\n## Notes\\n\\nWhile the repository does not explicitly define a `DELETE /v1/{payment-service}/{payment-product}/{paymentId}` endpoint for direct payment cancellation, it offers robust consent management capabilities, including the ability to revoke payment consents. The administrative `DELETE /admin/revoke` endpoint could be used to cancel payments by revoking the associated payment consent, assuming the backend payment system is integrated to act upon consent revocation. The `paymentId` itself is used in `GET /payments/{paymentId}` to retrieve payment details , but not for direct cancellation.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Admin Operations (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_5c6e9a5e-317a-4af2-9335-d88355ca0458\\n', 'id': 'lc_1d9f78d2-b512-4650-ba68-f44a36f6a95a'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0034",
      "requirement": {
        "requirement_id": "ATOM_034",
        "requirement_text": "The ASPSP SHALL provide a mandatory POST funds-confirmations endpoint to check whether a specific amount is available at point of time of the request on an account",
        "strength": "SHALL",
        "capability": "Funds Confirmation",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0034_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support a mandatory `POST /funds-confirmations` endpoint for checking fund availability on an account <cite/>. The provided codebase context primarily focuses on the API Layer of WSO2 Identity Server, which deals with identity and access management functionalities . There are no explicit API endpoints, implementation details, or configuration options related to financial funds confirmation within the given snippets <cite/>.\\n\\n## API Endpoints and Features\\n\\nThe `wso2/product-is` repository provides APIs for managing applications, identity providers, claims, user stores, and user-specific resources like profiles and sessions . The API Layer is structured into \"Server APIs\" (e.g., `/api/server/v1/applications`) for administrative tasks and \"User APIs\" (e.g., `/api/users/v1/me/sessions`) for self-service operations  .\\n\\nThe `AuthorizationDetailsType` class, found in the test backend, includes an example schema that mentions \"payment_initiation\" . However, this appears to be a generic model for authorization details and does not indicate the presence of a specific `POST /funds-confirmations` endpoint or its implementation . The example schema describes properties like `type`, `actions`, `locations`, and `instructedAmount` for a \"payment_initiation\" authorization, but this is within the context of defining an authorization details type, not an actual funds confirmation API .\\n\\n## Implementation Details and Configuration Options\\n\\nThe API Layer uses Apache CXF as its JAX-RS implementation and is deployed as a WAR file (`api-resources-full.war`)  . The `RestBaseClient` class provides utility methods for making HTTP requests, including `getResponseOfHttpPost` , but these are general client-side utilities for testing and do not imply the existence of the specific `POST /funds-confirmations` endpoint .\\n\\n## Documentation References\\n\\nThe provided wiki page \"API Layer\" describes the general architecture, categories, versioning, and authentication mechanisms of the APIs within WSO2 Identity Server . It does not contain any documentation specific to a `POST /funds-confirmations` endpoint <cite/>.\\n\\n## Notes\\n\\nThe user\\'s query specifically asks about a `POST /funds-confirmations` endpoint for checking fund availability, which is a financial service. The provided codebase context, particularly the \"API Layer\" wiki page and related code snippets, pertains to identity and access management within WSO2 Identity Server. While there\\'s a mention of \"payment_initiation\" in an example schema for `AuthorizationDetailsType` , this is a data model for authorization details and not an active API endpoint for funds confirmation. Therefore, based on the provided information, this repository does not appear to support the requested functionality.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_a0bccbda-1bc0-4c68-91a4-89eefbbec1ff\\n', 'id': 'lc_0233b7d7-372d-4a2c-a589-152ee4258d44'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0034_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to be an API Management platform. While it supports the creation and management of APIs, including defining POST endpoints and their associated throttling policies and security, it does not inherently provide a specific `POST /funds-confirmations` endpoint or the underlying logic to check fund availability on an account  . Such an endpoint would need to be implemented as part of a backend service and then exposed and managed through this API Management platform.\\n\\n### Implementation Details\\nThe `wso2/product-apim` repository focuses on API management functionalities rather than specific business logic implementations like funds confirmation. It allows you to define API resources, including `POST` methods, and configure their behavior . For example, the `AddEditRemoveRESTResourceTestCase.java` file demonstrates how to add a `POST` resource to an API with a target path like `/customers/name/` . The actual logic for checking funds would reside in a backend service that this API gateway would proxy requests to.\\n\\n### Configuration Options\\nYou can configure various aspects of an API, including:\\n*   **HTTP Methods**: Define supported methods like `GET`, `POST`, `PUT`, `DELETE`, `PATCH`, `OPTIONS` .\\n*   **Authentication Type**: Set authentication for API operations, such as \"Application & Application User\" .\\n*   **Throttling Policies**: Apply throttling policies like \"Unlimited\" or \"10KPerMin\" to control API usage  .\\n*   **Endpoint Configuration**: Specify production and sandbox endpoints for the API .\\n*   **Scopes**: Define and assign scopes to API operations for fine-grained access control .\\n\\n### API Endpoints or Features\\nThe platform allows you to define custom API endpoints. A `POST /funds-confirmations` endpoint would be a custom API resource that you would define within the API Manager. The `ValidationApi.java` file shows a `validateEndpointCall` method that can be used to validate an API endpoint URL . The `rest_api_samples.xml` file provides an example of defining a `POST` resource with a `url-pattern` like `/order/*` .\\n\\n### Documentation References\\nThe provided snippets include examples of API definitions in JSON and YAML formats, which can serve as documentation for how APIs are structured and configured within the platform  . The `openapi.yaml` file also details various API management operations, such as retrieving subscription policies .\\n\\n## Notes\\nThe provided code snippets primarily illustrate the capabilities of the WSO2 API Manager for defining, publishing, and managing APIs. They do not contain any specific implementation of a `POST /funds-confirmations` endpoint or the business logic for checking fund availability. This functionality would need to be developed as a separate backend service and then exposed through the API Manager. The snippets show how to configure `POST` endpoints and apply policies, which are relevant to exposing such a service.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_09c0ab6e-68e1-4980-b43e-90b61ab8b7c8\\n', 'id': 'lc_b79c8c12-99b9-4eb9-a16f-3aa313c947ec'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0035",
      "requirement": {
        "requirement_id": "ATOM_104",
        "requirement_text": "The API SHALL support GET /v1/{payment-service}/{payment-product}/{paymentId} endpoint for retrieving payment object content",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0035_1",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_3",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts |[account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments |[payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds |[funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/) as an Operational Policy.\n\n    Use aut as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n\n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n\n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_4",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts | [account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments | [payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds | [funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/).\n\n    Use **aut** as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n    \n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    \n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_5",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports the `GET /v1/{payment-service}/{payment-product}/{paymentId}` endpoint for retrieving payment object content. This functionality is primarily defined in the OpenAPI specification for Payment Initiation and implemented in a demo backend service.  \\n\\n## Implementation Details\\n\\nThe `financial-services-accelerator` repository includes an OpenAPI specification file, `payment-initiation-openapi.yaml`, which defines the `GET /payments/{paymentId}` endpoint.  This endpoint is designed to retrieve payment details using a `paymentId` path parameter.  The expected successful response for this endpoint is an HTTP 200 status code, returning an `obWritePaymentResponse5` schema.  \\n\\nA demo backend service, `PaymentService.java`, provides a concrete implementation for this endpoint.  The `getPaymentTypePayment` method in this service is annotated with `@GET` and `@Path(\"/payments/{paymentId}\")`, directly corresponding to the specified API endpoint.   It retrieves payment information based on the provided `paymentId` and returns an HTTP 200 response with the payment object content.  \\n\\n## Configuration Options\\n\\nThe `payment-initiation-openapi.yaml` file defines several parameters for the `GET /payments/{paymentId}` endpoint, including: \\n*   `paymentId`: A path parameter to identify the payment. \\n*   `x-fapi-auth-date`, `x-fapi-customer-ip-address`, `x-fapi-interaction-id`: Optional header parameters for FAPI compliance. \\n*   `authorization`: A required header for authentication. \\n\\nThe API also specifies security schemes, including `TPPOAuth2Security` and a `default` scheme, both requiring the `payments` scope. \\n\\n## API Endpoints or Features\\n\\nThe `payment-initiation-openapi.yaml` defines the following payment-related endpoints:     \\n*   `POST /payment-consents`: To create payment consents. \\n*   `GET /payment-consents/{consentId}`: To retrieve payment consents. \\n*   `GET /payment-consents/{consentId}/funds-confirmation`: To get funds confirmation for a payment consent. \\n*   `POST /payments`: To create payments. \\n*   `GET /payments/{paymentId}`: To retrieve a specific payment. \\n\\nThe `PaymentService.java` in the demo backend implements the `GET /payments/{paymentId}` endpoint. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page for the `wso2/financial-services-accelerator` repository mentions \"Payment Initiation APIs\" as one of the supported Open Banking API categories.  It also explicitly lists `Payments` as an API specification with endpoints for payment consent creation, payment execution, and funds confirmation.  The `payment-initiation-openapi.yaml` file itself serves as a primary documentation reference for the API\\'s structure, parameters, and responses. \\n\\n## Test Criteria\\n\\nThe test criteria \"Verify that `GET /v1/{payment-service}/{payment-product}/{paymentId}` endpoint returns payment object content with HTTP 200 status code\" is directly addressed by the `Verify Retrieving Payments` test case in `EndToEndPaymentsFlowTest.groovy`.  This test specifically calls `doDefaultPaymentIdRetrieval()` and asserts that the `submissionResponse.statusCode()` is `200`. \\n\\n## Notes\\n\\nThe user\\'s prompt uses a generic path `/v1/{payment-service}/{payment-product}/{paymentId}`. Based on the provided context, the specific path implemented and documented is `/open-banking/{version}/pisp/payments/{paymentId}`.   The `{payment-service}` and `{payment-product}` parts of the user\\'s query are likely represented by the `/open-banking/{version}/pisp` base path and the `/payments` resource in the OpenAPI definition.  \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e2d4c64d-3647-4373-8adb-bd211927b424\\n', 'id': 'lc_8463dcaf-0e44-4e16-b462-f3fa5a0d4ad8'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0036",
      "requirement": {
        "requirement_id": "ATOM_107",
        "requirement_text": "The Authorization header SHALL be included only when OAuth2 based authentication was performed in a pre-step or current transaction",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0036_1",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_2",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_3",
          "text": "### doPreCreateApplication method\n\nThis method lets you change the `oAuthAppRequest` before the application creation.\n\n``` java\n/**\n* Do changes to app request before creating the app at toolkit level\n*\n* @param oAuthAppRequest OAuth Application Request\n* @param additionalProperties Values for additional property list defined in the config\n* @throws APIManagementException when failed to validate a given property\n*/\nvoid doPreCreateApplication(OAuthAppRequest oAuthAppRequest, HashMap<String, String> additionalProperties)\n       throws APIManagementException;\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_4",
          "text": "reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank. In this web application, the customer: - Logs in using the login credentials. - Views information that the API consumer requested to access. - Selects the accounts that the API consumer can access. - Provides consent to the API consumer to access the information. ###Identifier-first authenticator Banks use Identifier-first authentication to authenticate the user with a second-factor authenticator instead of a password. The user who logs into the authorization web application, can provide the username, and authenticate using a second-factor authentication mechanism such as SMS-OTP/TOTP.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_5",
          "text": "A pushed authorization request contains authentication and authorization request parameters, which will be used in the Pushed Authorization endpoint of WSO2 Open Banking Accelerator. The Pushed Authorization endpoint returns a `request_uri` with an expiration time as a reference to the details sent in the pushed authorization request. ##Default Pushed Authorization Request validations The Pushed Auth Request Validator uses the existing validation layer of WSO2 Open Banking Accelerator to enforce validations. By default, the following validations are available in the validation layer: - Repeated parameter validation for all parameters: checks the pushed authorization request body for any repeated parameters When the `request` parameter is available: !!! note The `request` parameter value which will be referred to as `request object` from here onwards should be a Signed JWT(JWS) or an Encrypted JWT(JWE). It can be signed and encrypted as well. In this scenario, it must be signed before being encrypted. - Validation of form body parameters - verifies that only client authentication parameters (such as `client_id`, `client_assertion`, `client_assertion_type`) are present in the request form body. Other parameters must be included in the request object. - Validation of client id - validates the `client id` claim of the request object. - Validation of redirect URI - validates the redirect URI to check whether it matches with the registered redirect URIs. - Validation of request object signature algorithm - checks if the correct signing algorithm is used. - Validation of request object signature - verifies the signature of the request object. - Validation of the nonce claim - checks whether the nonce claim is available for response types requesting `id_token`. - Validation of the scope claim - checks whether the scope claim contains scopes that are registered with the client application. - Validation of the audience claim - checks if the audience claim matches the token endpoint URL. - Validation of the issuer claim - checks whether the issuer claim matches the client_id. - Validation of invalid claims in request object - check whether the `request` and `request_uri` claims are present in the request object. ##Writing a Custom Pushed Auth Request Validator You can extend the default validations in WSO2 Open Banking Accelerator and add more validations according to your open banking requirements: - To implement a custom Pushed Auth Request validator, extend the following class: ``` java com.wso2.openbanking.accelerator.identity.push.auth.extension.request.validator.PushAuthRequestValidator ``` Given below is a brief explanation of the methods you need to implement. ###validateAdditionalParams method This method performs the additional validations you add. Given below is the method signature: ``` java public void validateAdditionalParams(Map<String, Object> parameters) throws PushAuthRequestValidatorException ``` Input parameters - `Map<String, Object> parameters` - contains pushed authorization request parameters obtained from the HTTP servlet request Output parameter - `void` !!! note When a valid request object is present as a request parameter, the default implementation of the accelerator decodes the request object JWT and adds the following parameters to the Map<String, Object> parameters map. 1. Key - `\"decodedJWTBody\"`, Value - `<decoded request object JWT body>` 2. Key - `\"decodedJWTHeader\"`, Value - `<decoded request object JWT header>` For example: - Extend the `PushAuthRequestValidator` class and",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of the `Authorization` header specifically when OAuth2-based authentication has been performed. The `Authorization` header is used in various OAuth2 grant types, such as the Resource Owner Password Credentials grant and the Authorization Code grant, to send client credentials or access tokens.   \\n\\n## Implementation Details\\n\\nThe `Authorization` header is a constant defined as `OAuth2Constant.AUTHORIZATION_HEADER` . It is frequently used in conjunction with `Basic` authentication for client credentials or with `Bearer` tokens for accessing protected resources  .\\n\\n### Usage in OAuth2 Grant Types\\n\\n*   **Resource Owner Password Credentials Grant**: When obtaining an access token using the password grant type, the `Authorization` header is set with `Basic` authentication, encoding the client ID and client secret . This is demonstrated in `OAuth2ServiceResourceOwnerTestCase.java`  and `OAuth2DPopTestCase.java` .\\n*   **Authorization Code Grant**: Similarly, for the authorization code grant, the `Authorization` header is used with `Basic` authentication when making a token request to exchange the authorization code for an access token . This is visible in `PreIssueAccessTokenActionFailureRefreshTokenGrantTestCase.java`  and `OAuth2ServiceAuthCodeGrantCacheDisabledTestCase.java` .\\n*   **Refresh Token Grant**: When refreshing an access token, the `Authorization` header is also used with `Basic` authentication to send client credentials .\\n*   **Accessing Protected Resources**: After obtaining an access token, the `Authorization` header is used with a `Bearer` token to access protected API endpoints . The `OAuth2RestClient.java` file contains a helper method `getHeadersWithBearerToken` that constructs headers with a bearer token . Similarly, `RESTTestBase.java` shows how to invoke endpoints with OAuth2 authentication using an access token .\\n\\n### DPoP (Demonstrating Proof of Possession)\\n\\nFor DPoP tokens, an additional `DPoP` header is included along with the `Authorization` header . This ensures that the access token is bound to a specific cryptographic key, enhancing security .\\n\\n## Configuration Options\\n\\nThe `Authorization` header\\'s behavior is intrinsically linked to the OAuth2 grant types configured for an application. The `identity-default.xml` and `IDENTITY6777-identity.xml` files define the supported grant types, such as `authorization_code`, `password`, `refresh_token`, and `client_credentials`  . The presence and content of the `Authorization` header depend on which of these grant types is being used.\\n\\n## API Endpoints or Features\\n\\nThe `Authorization` header is primarily used when interacting with the OAuth2 token endpoint (`/oauth2/token`)  and when accessing protected resources. The `OAuth2Constant` class defines various OAuth2 endpoints, including `ACCESS_TOKEN_ENDPOINT`  and `USER_INFO_ENDPOINT` .\\n\\n## Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" provides a comprehensive overview of the OAuth2 and OpenID Connect implementation in WSO2 Identity Server, including supported grant types and token management . This documentation implicitly supports the requirement by detailing the mechanisms where the `Authorization` header is a fundamental part of the OAuth2 protocol.\\n\\n## Test Criteria\\n\\nThe provided test cases in the `modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/oauth2/` directory demonstrate the expected behavior of the `Authorization` header. For instance, `OAuth2DPopTestCase.java` explicitly adds the `Authorization` header for token requests . The test `testGetAccessTokenWithAuthorizationCodeUsingParWithDifferentThumbprint` in `OAuth2DPopTestCase.java` also verifies error conditions when the DPoP proof (which is sent in a separate header but is related to the Authorization header\\'s context) is incorrect, implying that the system validates the presence and correctness of authentication-related headers .\\n\\n## Notes\\n\\nThe codebase primarily consists of integration tests, which demonstrate how the `Authorization` header is used in various OAuth2 flows. While these tests confirm the header\\'s presence and usage during OAuth2 authentication, they do not explicitly contain logic to *prevent* the `Authorization` header from being included when OAuth2 authentication has *not* been performed. However, the nature of OAuth2 implies that the header is only relevant and processed within an OAuth2 context. The `OAuth2Constant.java` file serves as a central place for defining OAuth2-related constants, including `AUTHORIZATION_HEADER` .\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_28bf9a5f-5f8b-46b2-8223-e240a7a25111\\n', 'id': 'lc_83b859c8-48a3-4c1a-889a-3940ad83fc03'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_dfe6fa82-5715-4704-b900-316d3df07fc7'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0037",
      "requirement": {
        "requirement_id": "ATOM_201",
        "requirement_text": "The TPP-Signature-Certificate header shall contain the TPP's eIDAS certificate",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "4e52743eb3ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0037_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the handling of certificates, including the ability to update and retrieve them for Identity Providers (IdPs) and applications. While there isn\\'t a direct mention of a \"TPP-Signature-Certificate\" header or eIDAS certificates, the codebase demonstrates mechanisms for managing X.509 certificates and JWKS URIs, which are foundational for such a requirement.   \\n\\n### Implementation Details\\n\\nThe system allows for the configuration of certificates for Identity Providers. Specifically, the `IdPSuccessTest.java` integration test demonstrates how to patch an IdP to add or remove JWKS URI properties and certificates.   The `certificate` field within the `IdentityProviderPOSTRequest` model is used to manage these certificates.  The `Oauth2JWKSEndpointTestCase.java` file further indicates support for JWKS endpoints, which are used to publish public keys, including X.509 certificates.  This test also includes logic to validate the SHA256 thumbprint of X.509 certificates. \\n\\nFor applications, the `OAuth2ServiceAbstractIntegrationTest.java` provides a method `updateApplicationCertificate` to update an application\\'s certificate using an X.509 certificate.  This method converts the `X509Certificate` to PEM format and sets it in an `ApplicationPatchModel`. \\n\\n### Configuration Options\\n\\nCertificates can be configured for Identity Providers through the `certificate` property in the `IdentityProviderPOSTRequest` model.  This allows setting a `jwksUri` or directly providing `certificates`.  \\n\\n### API Endpoints or Features\\n\\nThe `IdPSuccessTest.java` integration test interacts with an API endpoint for Identity Provider management, specifically for updating IdP configurations related to certificates.  The `IDP_API_BASE_PATH` is used for these operations. \\n\\nThe `Oauth2JWKSEndpointTestCase.java` confirms the existence and functionality of JWKS endpoints at `https://localhost:9853/oauth2/jwks` for both super tenant and tenant contexts.  These endpoints expose public keys in JWKS format. \\n\\n### Documentation References\\n\\nThe \"Features and Capabilities\" wiki page for `wso2/product-is` mentions \"Financial-grade API (FAPI) Support\" and \"JWT Access Tokens\" under API Security, which often involve advanced certificate handling and signing.   It also lists \"JWKS Endpoint\" under OpenID Connect Features. \\n\\n## Notes\\n\\nThe prompt specifically asks about \"TPP-Signature-Certificate header\" and \"eIDAS certificate\". While the codebase demonstrates strong capabilities in managing X.509 certificates and JWKS endpoints, there is no explicit mention of \"TPP-Signature-Certificate\" as a header or \"eIDAS certificate\" by name. However, eIDAS certificates are a type of X.509 certificate, and the existing certificate management features would likely be leveraged to support such a requirement. The `oidc-fapi-conformance-tests/resource-server/resource-server.py` file shows an example of extracting a thumbprint from an `X-Ssl-Cert` header and comparing it with a thumbprint from an access token, which is a related concept to verifying certificate authenticity in a header.   This suggests that the system is capable of handling certificate information passed in headers for validation purposes.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0530c8ba-c25c-4216-9a11-29e06063f871\\n', 'id': 'lc_687744fe-3aa4-4546-83fa-de0a47773127'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0037_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the use of client certificates, which could be relevant to the `TPP-Signature-Certificate` header requirement. The `ClientCertificatesApi.java`  and `ClientCertificatesApi.md`  files indicate functionality for uploading, retrieving, and updating client certificates. Additionally, the `APISecurityTestCase.java`  demonstrates how a client certificate can be sent in the `X-WSO2-CLIENT-CERTIFICATE` header for API invocation.\\n\\n## Implementation Details\\n\\nThe `wso2/product-apim` repository provides an API for managing client certificates. The `ClientCertificatesApi` class  includes methods for:\\n*   `addAPIClientCertificate`: Uploading a new certificate for an API. This method takes `apiId`, `certificate` (the file), `alias`, and `tier` as parameters. \\n*   `getAPIClientCertificateByAlias`: Retrieving information about a certificate using its alias and API ID. \\n*   `getAPIClientCertificateByKeyTypeAndAlias`: Retrieving certificate information based on key type, alias, and API ID. \\n*   `getAPIClientCertificateContentByAlias`: Downloading the content of a certificate by API ID and alias. \\n*   `updateAPIClientCertificateByAlias`: Updating an existing certificate using its alias, API ID, the new certificate file, and tier. \\n*   `updateAPIClientCertificateByKeyTypeAndAlias`: Updating a certificate of a given key type. \\n\\nThe `APIPublisherRestClient.java`  also contains an `uploadCertificate` method, which uses a `ClientCertificateCreationBean` to upload client certificates.\\n\\nFor API invocation, the `APISecurityTestCase.java`  demonstrates sending a Base64 encoded client certificate in the `X-WSO2-CLIENT-CERTIFICATE` header. This suggests that the system can process client certificates provided in this manner. The `generateBase64EncodedCertificate()` method (not provided in the snippets) would be responsible for encoding the certificate.\\n\\n## Configuration Options\\n\\nWhile explicit configuration options for \"eIDAS certificate\" are not directly visible in the provided snippets, the system allows for the upload and management of client certificates. The `addAPIClientCertificate`  and `updateAPIClientCertificateByAlias`  methods take a `File certificate` parameter, implying that any valid certificate file can be uploaded. The system also uses an `alias` and `tier` for managing these certificates.\\n\\nThe `APIMTestCaseUtils.java`  shows how JWT signatures are validated using a keystore, which involves loading a trust store and verifying the certificate. This indicates that the system has mechanisms to handle and validate certificates.\\n\\n## API Endpoints or Features\\n\\nThe `ClientCertificatesApi`  exposes several API endpoints for certificate management:\\n*   `POST /apis/{apiId}/client-certificates`: Used by `addAPIClientCertificate` to upload a new client certificate. \\n*   `GET /apis/{apiId}/client-certificates/{alias}`: Used by `getAPIClientCertificateByAlias` to retrieve certificate information. \\n*   `GET /apis/{apiId}/client-certificates/{keyType}/{alias}`: Used by `getAPIClientCertificateByKeyTypeAndAlias` to retrieve certificate information by key type. \\n*   `GET /apis/{apiId}/client-certificates/{alias}/content`: Used by `getAPIClientCertificateContentByAlias` to download certificate content. \\n*   `PUT /apis/{apiId}/client-certificates/{alias}`: Used by `updateAPIClientCertificateByAlias` to update a certificate. \\n*   `PUT /apis/{apiId}/client-certificates/{keyType}/{alias}`: Used by `updateAPIClientCertificateByKeyTypeAndAlias` to update a certificate by key type. \\n\\nFor API invocation, the system supports receiving client certificates via the `X-WSO2-CLIENT-CERTIFICATE` header, as shown in `APISecurityTestCase.java` .\\n\\n## Documentation References\\n\\nThe `ClientCertificatesApi.md`  file provides documentation for the `ClientCertificatesApi`, including example usage in Java and details about HTTP request/response headers and status codes for the various certificate management operations.\\n\\n## Test Criteria\\n\\nThe `APISecurityTestCase.java`  includes a test case `testAPIInvocationWithMutualSSLHeader` that specifically sends a client certificate in the `X-WSO2-CLIENT-CERTIFICATE` header. This test verifies that the API invocation with the certificate results in an `SC_UNAUTHORIZED` response, which is expected if the certificate is not properly configured for mutual SSL authentication. This test case demonstrates the system\\'s capability to receive and process client certificates from a header.\\n\\n## Notes\\n\\nThe provided code snippets do not explicitly mention \"eIDAS certificate\" or \"TPP-Signature-Certificate\" header. However, the functionality for managing and using client certificates, particularly the `X-WSO2-CLIENT-CERTIFICATE` header, strongly suggests that the system can be configured to meet the requirement of including a TPP\\'s eIDAS certificate in a header for authentication or signature verification. The `APIMTestCaseUtils.java`  also shows that the system can validate JWT signatures using certificates from a trust store, which is a related security mechanism. Further investigation into the specific configuration of mutual SSL and client certificate validation within the WSO2 API Manager would be necessary to confirm full eIDAS compliance.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_a6792c76-d464-4bde-bf20-8243e9bb6b06\\n', 'id': 'lc_deda5389-7c9f-4f04-9db9-e0ddfe041a1c'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0038",
      "requirement": {
        "requirement_id": "ATOM_170",
        "requirement_text": "The system SHALL support reading card account transaction data via GET /v1/card-accounts/{account-id}/transactions endpoint",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0038_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0038_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0038_3",
          "text": "This document provides step by step instructions to tryout the flow with Manual Client Registration. This includes\n\n- Setting up WSO2 FInancial Services Key Manager\n- Create application using Manual Client Registration\n- Tryout Accounts Information Flow using application created using Manual Client Registration",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0038_4",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0038_5",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0038_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports reading card account transaction data via a `GET /v1/card-accounts/{account-id}/transactions` endpoint. This functionality is primarily defined within the `AccountandTransactionAPI` specification and demonstrated in a backend service and integration tests.    \\n\\n## Implementation Details\\n\\nThe API endpoint for retrieving account transactions is defined in the `account-info-swagger.yaml` file as `/accounts/{AccountId}/transactions` with a GET method.  This endpoint is part of the `AccountandTransactionAPI` and is tagged under \"Transactions\".  \\n\\nThe `AccountService.java` in the `org.wso2.financial.services.accelerator.demo.backend` module provides a demo implementation for this endpoint.  The `getAccountTransactions` method handles GET requests to `/accounts/{AccountId}/transactions` and returns a hardcoded JSON response containing transaction data.   The response includes fields such as `AccountId`, `TransactionId`, `Amount`, `CreditDebitIndicator`, `Status`, `BookingDateTime`, and `Balance`. \\n\\n## Configuration Options\\n\\nThe API definition specifies that the endpoint requires `PSUOAuth2Security` or `default` security, both of which require the `accounts` scope.  This indicates that access to transaction data is controlled by OAuth 2.0 scopes, ensuring that only authorized applications and users can retrieve this information. \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `GET /accounts/{AccountId}/transactions`.  This endpoint is designed to retrieve transaction details for a specific account identified by `{AccountId}`.  The response schema for this endpoint is `OBReadTransaction5`, which defines the structure of the transaction data returned. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page mentions \"Account Information APIs\" which include \"Transactions\" as a category, and states that the `accounts` OAuth scope is used for transaction history.  The `account-info-swagger.yaml` file serves as the primary API specification for this endpoint. \\n\\n## Test Criteria\\n\\nIntegration tests confirm the functionality of retrieving account transactions. The `EndToEndAccountFlowTest.groovy` file includes a test case named `\"Verify Accounts transaction Retrieval Request for a Authorised Consent\"` which specifically calls the `TRANSACTIONS_SINGLE_PATH` and asserts an HTTP 200 status code.  The `TRANSACTIONS_SINGLE_PATH` constant is defined as `/open-banking/v3.1/aisp/accounts/{accountID}/transactions`.  This test verifies that after obtaining an authorized consent, a GET request to the transactions endpoint for a valid `account-id` returns a successful response. \\n\\n## Notes\\n\\nThe prompt specifies `GET /v1/card-accounts/{account-id}/transactions`. The codebase uses `/accounts/{AccountId}/transactions` within the `/open-banking/{version}/aisp` base path.   While the version and the specific path segment (`card-accounts` vs `accounts`) differ slightly, the core functionality of retrieving transactions for a given account ID is supported. The `v1` in the prompt might refer to a specific API version that is mapped to the `v3.1` used in the `account-info-swagger.yaml` file.  The `AccountService.java` is a demo backend service, implying that in a production environment, this would integrate with an actual banking system to fetch real transaction data. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_976397b9-c57e-41da-a908-d100a5e59c09\\n', 'id': 'lc_8c634774-6c17-4712-a9fe-4c1b4c41ed5d'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0039",
      "requirement": {
        "requirement_id": "ATOM_202",
        "requirement_text": "Header field names in the signing string shall be normalized to lowercase",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "4e52743eb3ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0039_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to explicitly support or enforce the normalization of header field names to lowercase in the signing string before digest calculation based on the provided code snippets. There are no direct implementation details, configuration options, or API features that specifically address this requirement.\\n\\nThe provided snippets primarily deal with:\\n*   **SCIM2 REST Client Headers**: The `SCIM2RestClient.java` file shows how `BasicHeader` objects are constructed with predefined header names like `USER_AGENT_ATTRIBUTE`, `AUTHORIZATION_ATTRIBUTE`, and `CONTENT_TYPE_ATTRIBUTE` . These attributes are constants and do not indicate any dynamic lowercasing of header names before they are used in the signing string.\\n*   **DPoP Proof Generation**: The `DPoPProofGenerator.java` file is responsible for generating DPoP proofs, which involve signing JWTs . While it constructs JWT claims and headers, there\\'s no explicit step to lowercase HTTP header names before they are included in the `htm` (HTTP method) or `htu` (HTTP URL) claims, or before the JWT is signed. The `htm` and `htu` claims directly use the provided `httpMethod` and `httpUrl` parameters .\\n*   **SAML Configuration**: Several XML configuration files and a `ClientSignKeyDataHolder.java` file relate to SAML signing and digest algorithms   . These snippets define the algorithms used for signing and digesting SAML assertions and responses, but they do not mention any header field normalization for HTTP requests.\\n\\nBased on the provided context, there is no evidence to suggest that header field names in the signing string are normalized to lowercase before digest calculation.\\n\\n## Notes\\nThe user\\'s query specifically asks about \"Header field names in the signing string\" and \"digest calculation\". While the codebase contains various implementations related to signing (e.g., DPoP, SAML) and HTTP headers (e.g., in REST clients), none of the provided snippets directly address the normalization of HTTP header *names* to lowercase specifically for inclusion in a signing string or before a digest calculation. The `DPoPProofGenerator.java` is the closest in terms of generating a signed artifact that includes HTTP method and URL, but it does not show header name normalization.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-h_f8f5d95a-5d13-48dc-a8b6-1cdf90d242e8\\n', 'id': 'lc_8999a045-4dce-40b0-84ba-9147a6480b84'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0039_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"Based on the provided code snippets, there is no direct evidence or explicit implementation details that confirm the normalization of header field names to lowercase in the signing string before digest calculation. <cite/> The snippets primarily deal with general header manipulation, API key handling, and WebSub subscription configurations, but none specifically address the lowercase normalization of header field names for signing purposes. \\n\\n### Implementation Details\\nThe `ApiClient.java` files in both the publisher and store sample clients show methods for processing header parameters.  Specifically, the `processHeaderParams` method iterates through a map of header parameters and adds them to a `Request.Builder` object.  However, there is no explicit call to a `toLowerCase()` or similar method on the header keys (`param.getKey()`) before they are added.  The `WebsubSubscriptionConfigurationDTO` defines fields like `signingAlgorithm` and `signatureHeader`, which are related to signing, but do not provide details on header name normalization. \\n\\n### Configuration Options\\nThere are no explicit configuration options visible in the provided snippets that directly control the normalization of header field names to lowercase for signing strings. <cite/> The `WebsubSubscriptionConfigurationDTO` allows setting a `signingAlgorithm` and `signatureHeader`, but these are for specifying the algorithm and the header to send the signature, not for controlling the case of header names in the signing string itself. \\n\\n### API Endpoints or Features\\nThe `CustomHeaderTestCase.java` demonstrates how custom API key headers can be used and configured for API invocation.  It shows that an API's `apiKeyHeader` can be updated, which affects how the API key is sent and validated.  However, this relates to the name of the API key header itself, not the normalization of header names within a signing string for digest calculation. <cite/> The `dummy_digest_api.xml` files show configurations for Digest Authentication, which involves headers like `Authorization` and `WWW-Authenticate`.  While these are related to authentication and headers, they do not explicitly detail the lowercase normalization of header field names for signing strings. <cite/>\\n\\n### Documentation References\\nThe provided snippets do not contain any direct documentation references that specifically address the normalization of header field names to lowercase in the signing string. <cite/> The `qos_proxy_samples.xml` discusses WS-Security and policy attachments, which involve signing and encryption, but does not mention header name normalization. \\n\\n## Notes\\nThe provided code snippets do not offer sufficient information to confirm whether header field names in the signing string are normalized to lowercase before digest calculation. <cite/> The `ApiClient.java` files handle general header processing, but without explicit `toLowerCase()` calls on header keys, it's not possible to verify this specific requirement.  Further investigation into the actual signing logic would be required to definitively answer the question. <cite/>\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-h_e9ed2d46-6fa6-4a3c-844b-e748961c9a5d\\n\", 'id': 'lc_3e9d0ff9-7215-459a-9b3b-77e0032e68f7'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0040",
      "requirement": {
        "requirement_id": "ATOM_171",
        "requirement_text": "The system SHALL support bookingStatus query parameter with mandatory values 'booked', 'pending', and 'both'",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0040_1",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports the `bookingStatus` query parameter with mandatory values \\'Booked\\' and \\'Pending\\' for transactions, as defined in the OpenAPI specification for Account Information APIs . The value \\'both\\' is not explicitly listed as a supported value in the provided API definitions.\\n\\n### API Endpoints and Features\\n\\nThe `bookingStatus` parameter is relevant to the Account Information APIs, specifically when querying transactions. The `account-info-swagger.yaml` file defines the `OBEntryStatus1Code` schema, which enumerates the possible values for the status of a transaction entry .\\n\\n*   **Supported Values**: The `OBEntryStatus1Code` enum explicitly lists \\'Booked\\' and \\'Pending\\' .\\n*   **Transaction Object**: The `OBTransaction5` object, which describes a transaction entry, includes a `Status` field that references `OBEntryStatus1Code` .\\n\\n### Implementation Details\\n\\nThe `AccountService.java` file in the demo backend provides a sample implementation for retrieving account transactions . In this demo, a hardcoded response is returned, where the `Status` of a transaction is set to \"Booked\" . This demonstrates that \\'Booked\\' is a supported status by the ASPSP (Account Servicing Payment Service Provider) in this demo context.\\n\\n### Configuration Options\\n\\nThe provided context does not explicitly detail configuration options for the `bookingStatus` query parameter. The `financial-services.xml` file is mentioned as a centralized configuration file parsed by `FinancialServicesConfigParser`  . However, there is no direct reference to `bookingStatus` within the snippets related to configuration.\\n\\n### Documentation References\\n\\nThe `account-info-swagger.yaml` file serves as the primary documentation reference for the Account Information APIs, including the definition of transaction statuses .\\n\\n## Notes\\n\\nThe user\\'s prompt specifies \\'booked\\', \\'pending\\', and \\'both\\' as mandatory values. While \\'Booked\\' and \\'Pending\\' are explicitly defined in the `OBEntryStatus1Code` enum , the value \\'both\\' is not present in the OpenAPI specification. This suggests that the system, as defined by the provided `account-info-swagger.yaml`, does not natively support \\'both\\' as a single query parameter value for `bookingStatus`. It is possible that \\'both\\' would be handled by omitting the `bookingStatus` parameter entirely, or by making separate requests for \\'Booked\\' and \\'Pending\\' transactions.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e9bdf124-5156-43d3-a4b7-d6ba7f4985a3\\n', 'id': 'lc_c43a3ed7-54b4-4077-be36-e9804c87acaa'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0041",
      "requirement": {
        "requirement_id": "ATOM_146",
        "requirement_text": "The system MUST distinguish between booked and pending transactions",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f30dd2c91d5e",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0041_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0041_2",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports distinguishing between booked and pending transactions through its API definitions and a demo backend service. The `account-info-swagger.yaml`  defines a transaction status with `Booked` and `Pending` enumerations. The demo backend service, `AccountService.java`, provides an example of a transaction response that includes a `Status` field, which can be set to \"Booked\" .\\n\\n## Implementation Details\\n\\nThe core implementation detail for distinguishing between booked and pending transactions lies within the OpenAPI (Swagger) definition for the Account Information APIs. Specifically, the `OBEntryStatus1Code` schema defines the possible statuses for a transaction entry .\\n\\n```yaml\\n  OBEntryStatus1Code:\\n    description: Status of a transaction entry on the books of the account servicer.\\n    type: string\\n    enum:\\n      - Booked\\n      - Pending\\n```\\n\\n\\nThis enumeration explicitly includes `Booked` and `Pending` as valid statuses for transactions .\\n\\nThe `OBTransaction5` schema, which represents a transaction, includes a `Status` property that references `OBEntryStatus1Code` . This means that any transaction object returned by the API will have a status that is either \"Booked\" or \"Pending\".\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `/accounts/{AccountId}/transactions` . This endpoint is used to retrieve transaction information for a specific account . The response for this endpoint is defined by `200AccountsAccountIdTransactionsRead` , which in turn references the `OBReadTransaction5` schema .\\n\\nA demo backend service, `AccountService.java`, provides a concrete example of a response from the `/accounts/{AccountId}/transactions` endpoint . In this example, a transaction is returned with its `Status` explicitly set to \"Booked\" . While this specific demo response only shows a \"Booked\" transaction, the underlying OpenAPI definition allows for both \"Booked\" and \"Pending\" statuses .\\n\\n## Configuration Options\\n\\nThere are no explicit configuration options in the provided snippets that directly control the distinction between \"booked\" and \"pending\" transactions. This distinction is inherent in the API\\'s data model as defined in the OpenAPI specification .\\n\\n## Documentation References\\n\\nThe `Overview` wiki page for `wso2/financial-services-accelerator` mentions \"Account Information APIs\" and \"transaction history\" as a supported use case . The `account-info-swagger.yaml` file serves as the primary documentation for the structure and behavior of the Account Information APIs, including the transaction status .\\n\\n## Notes\\n\\nThe provided code snippets confirm that the system supports distinguishing between booked and pending transactions at the API level through the `Status` field within the transaction object . However, the test criteria mentioned in the prompt, \"Verify that transaction responses contain separate \\'booked\\' and \\'pending\\' arrays,\" is not directly supported by the current API definition. The API returns a list of `OBTransaction5` objects, where each object has a `Status` field . It does not provide separate arrays for \"booked\" and \"pending\" transactions. A client would need to filter the returned transactions based on their `Status` field to achieve this separation.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_09bb9a52-4e0e-4517-a31e-acc390299b12\\n', 'id': 'lc_b1a2ff3c-27b9-4a1a-a3c5-0b0a9ce57589'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0042",
      "requirement": {
        "requirement_id": "ATOM_096",
        "requirement_text": "Payment status retrieval SHALL support three payment service types: payments, bulk-payments, and periodic-payments",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0042_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0042_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0042_3",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports payment status retrieval for `payments` through the `/payments/{paymentId}` endpoint, as defined in the `payment-initiation-openapi.yaml` file . However, direct support for `bulk-payments` and `periodic-payments` as distinct `payment-service` types in the specified API endpoint format (`/v1/{payment-service}/{payment-product}/{paymentId}/status`) is not explicitly visible in the provided code snippets.\\n\\n## Implementation Details\\n\\nThe `PaymentService.java` file in the `demo.backend` module contains a demo implementation for retrieving payment status . The `getPaymentTypePayment` method handles GET requests to `/payments/{paymentId}` and retrieves payment information from an in-memory `domesticPayments` map . The status of a payment is stored within the `responseObject` as `Status` .\\n\\n## API Endpoints and Features\\n\\nThe `payment-initiation-openapi.yaml` defines the OpenAPI specification for payment-related APIs .\\nIt includes the following endpoint for retrieving the status of a single payment:\\n*   `GET /payments/{paymentId}`: This endpoint is used to retrieve the status of a specific payment identified by `paymentId` . The `paymentId` is a path parameter .\\n\\nThe `payment-initiation-openapi.yaml` also defines schemas for `obWritePaymentResponse5` which includes `PaymentId`, `ConsentId`, `CreationDateTime`, `Status`, and `StatusUpdateDateTime` . The `Status` field specifies the status of the payment information group .\\n\\nWhile `payments` are explicitly supported, the provided snippets do not show direct API endpoints or configurations for `bulk-payments` or `periodic-payments` in the format `/v1/{payment-service}/{payment-product}/{paymentId}/status`. However, the `ConnectorTestConstants.groovy` file defines constants for various payment consent and submission paths, including `DOMESTIC_PAYMENTS`, `DOMESTIC_SCHEDULE`, and `DOMESTIC_STANDING_ORDERS` . These constants suggest that the system might handle different payment types, but their integration into a unified status retrieval endpoint as described in the prompt is not directly evident.\\n\\n## Configuration Options\\n\\nThe `Overview` wiki page mentions that the system uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class . However, the provided snippets do not contain specific configuration options related to enabling or defining the different payment service types (`payments`, `bulk-payments`, `periodic-payments`) for status retrieval.\\n\\n## Documentation References\\n\\nThe `Overview` wiki page provides a high-level overview of the WSO2 Financial Services Accelerator and mentions \"Payment Initiation APIs\" which include endpoints for payment consent creation, payment execution, and funds confirmation . The `payment-initiation-openapi.yaml` file itself serves as a documentation reference for the `payments` API .\\n\\n## Notes\\n\\nThe prompt specifically asks about a `GET /v1/{payment-service}/{payment-product}/{paymentId}/status` endpoint. While the `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml` file defines a `GET /payments/{paymentId}` endpoint for retrieving payment status , it does not explicitly show the `{payment-service}` and `{payment-product}` path parameters as described in the prompt. The `payments` service type is implicitly handled by the `/payments` path. The existence of `domestic-scheduled-payment-consents` and `domestic-standing-order-consents` in `ConnectorTestConstants.groovy`  suggests that \"periodic-payments\" might be supported under different API paths or through internal mechanisms not directly exposed by the provided OpenAPI specification for status retrieval. Similarly, \"bulk-payments\" are not explicitly defined in the provided API specifications for status retrieval.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_64d78cbf-4230-40af-84b2-1e7da108218b\\n', 'id': 'lc_11585db3-7aa4-4667-9a5e-072bd700b1f6'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0043",
      "requirement": {
        "requirement_id": "ATOM_019",
        "requirement_text": "The API SHALL support dedicated authorisation endpoints for payment initiation and consent establishment to handle transaction authorisation by PSUs starting from version 1.2",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0043_1",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0043_2",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0043_3",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0043_4",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0043_5",
          "text": "## What is new in this release\n\n####WSO2 Open Banking Accelerator for Identity Server \n\n- Accelerator-level support for both pre-initiated and scope-based consent flows\n- OpenAPI based accelerator extension points to implement specification compliance addition to supported java based extension points. Fore more information, see [OpenAPI for Accelerator extensions](../references/accelerator-extensions-api.md)\n- JDK21 runtime support\n- Idempotency feature support from accelerator layer\n- Generalized consent management support for common open banking use cases. For more information, see [Consent Management](../learn/consent-management.md).\n- New features support from WSO2 Identity Server\n\n    - Native support for Financial grade API (FAPI) Security. For more info,[refer](https://is.docs.wso2.com/en/7.0.0/references/financial-grade-api/)  \n    - OAuth2 Rich Authorization Request (RAR) support.For more info ,[refer](https://is.docs.wso2.com/en/latest/guides/authorization/rich-authorization-requests/) \n    \n\n\n\n##What has changed in this release\n\nWSO2 Open Banking Accelerator 4.0 is an improved version of WSO2 Open Banking Accelerator 3.0 to expand covering\ndomain from Open Banking to Open Finance and improve developer experience of implementing accelerator extension points\nto cater regulatory and other open banking/ open finance requirements. Some significant changes in this release are,\n\n- OpenAPI based extensions support for IAM Accelerators.  Fore more information, see [OpenAPI for Accelerator extensions](../references/accelerator-extensions-api.md)\n- Out of the box support for both of the consent flows of pre-initiated and scopes based",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0044",
      "requirement": {
        "requirement_id": "ATOM_046",
        "requirement_text": "Payment process must conclude with transaction status of either RJCT (Rejected) or ACSC (AcceptedSettlementCompleted).",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0044_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_2",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_3",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_4",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_5",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports payment processes concluding with a transaction status of either `RJCT` (Rejected) or `ACSC` (AcceptedSettlementCompleted) . The `payment-initiation-openapi.yaml` file defines the possible `Status` values for a payment, which include `AcceptedSettlementCompleted` and `Rejected` .\\n\\n## Implementation Details\\n\\nThe `PaymentService.java` in the demo backend is responsible for processing payment requests and setting the payment status . In the `cacheAndGetPaymentResponse` method, the status is explicitly set to `\"AcceptedSettlementCompleted\"` for successful transactions . While the provided snippet only shows `AcceptedSettlementCompleted`, the OpenAPI specification indicates that `Rejected` is also a valid final state .\\n\\nThe `ConsentExtensionConstants.java` file defines various consent-related constants, including `REJECTED_STATUS` . This constant is used within the consent management extensions, which are part of the overall payment flow .\\n\\n## API Endpoints and Features\\n\\nThe `/payments` API endpoint, defined in `payment-initiation-openapi.yaml`, is used to create payments . The response to a payment creation request (`obWritePaymentResponse5`) includes a `Status` field, which can be one of several enumerated values, including `AcceptedSettlementCompleted` and `Rejected` .\\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, is used for centralized configuration . While the provided snippets do not explicitly show configuration options for payment statuses, the `wso2is-7.0.0-deployment.toml` and `wso2is-7.1.0-deployment.toml` files indicate that the system is highly configurable, with sections for `financial_services.extensions.endpoint` and `financial_services.app_registration.dcr.params`  . These extensions could potentially be used to customize or extend the handling of payment statuses.\\n\\n## Documentation References\\n\\nThe `Overview` wiki page mentions that the accelerator supports payment initiation . The API specifications section within the `Overview` also highlights the \"Payment Initiation APIs\" which include `PaymentConsents` and `Payments` .\\n\\n## Test Criteria\\n\\nThe integration tests in `fs-integration-test-suite` verify payment flows. For example, `AuthorizationFlowValidationTest.groovy` includes a test case to \"Deny consent in consent authorisation\" and asserts that the `consentStatus` becomes \"Rejected\" . Similarly, `EndToEndPaymentsFlowTest.groovy` verifies the payment initiation and submission, and checks the `consentStatus` at various stages, including \"Authorised\" . The `ConnectorTestConstants.groovy` file defines constants like `DATA_STATUS` which is used to parse the status from responses .\\n\\n## Notes\\n\\nThe `PaymentService.java` is part of a demo backend . While it explicitly sets the status to `AcceptedSettlementCompleted`, a production implementation would likely involve more complex logic to determine the final payment status, potentially including integration with external banking systems. The OpenAPI specification, however, clearly defines `AcceptedSettlementCompleted` and `Rejected` as possible final states for a payment . Other statuses like `AcceptedCreditSettlementCompleted`, `AcceptedSettlementInProcess`, `AcceptedWithoutPosting`, and `Pending` are also defined, but these are typically intermediate states .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_abd30472-1d60-4bcf-8460-d2e0485a92f9\\n', 'id': 'lc_ff40bb0c-eea9-464b-b0d8-42961d8beefb'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0045",
      "requirement": {
        "requirement_id": "ATOM_140",
        "requirement_text": "The system SHALL support bookingStatus values of 'booked', 'pending', 'both', and 'information' with booked being mandatory",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0045_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0045_2",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0045_3",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0045_4",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports `bookingStatus` values of \\'Booked\\' and \\'Pending\\' for transactions, as defined in the `OBEntryStatus1Code` enum within the `account-info-swagger.yaml` file . The system does not explicitly support \\'both\\' or \\'information\\' as direct `bookingStatus` values for transactions. However, \\'Information\\' is supported as a `BalanceType` . The \\'Booked\\' status is mandatory for transactions, as indicated by its presence in the `required` fields for `OBTransaction5` .\\n\\n## Implementation Details\\n\\nThe `bookingStatus` is implemented as part of the `OBEntryStatus1Code` enum in the OpenAPI specification for Account Information APIs . This enum defines the possible statuses for a transaction entry on the account servicer\\'s books .\\n\\nThe `OBTransaction5` schema, which describes transaction details, includes `Status` as a required field, referencing `OBEntryStatus1Code` . The `BookingDateTime` field is also mandatory and its description clarifies that \"Booking date is the expected booking date, unless the status is booked, in which case it is the actual booking date\" .\\n\\nAn example of a transaction response in the demo backend service, `AccountService.java`, shows a hardcoded `Status` of \"Booked\" for a transaction . This demonstrates that \\'Booked\\' is a supported and expected status.\\n\\n## API Endpoints or Features\\n\\nThe `bookingStatus` is relevant to the Account Information APIs, specifically when retrieving transaction details. The `GET /accounts/{AccountId}/transactions` endpoint in the demo backend service provides transaction information, including the `Status` field .\\n\\nThe `account-info-swagger.yaml` defines the structure for `OBReadTransaction5` which contains an array of `OBTransaction5` objects, each with a `Status` field .\\n\\n## Documentation References\\n\\nThe `OBEntryStatus1Code` enum, which defines \\'Booked\\' and \\'Pending\\' statuses, is documented within the `account-info-swagger.yaml` file . This OpenAPI specification serves as the primary documentation for the API\\'s data models.\\n\\nThe `Overview` wiki page mentions \"Account Information APIs\" as one of the main categories supported by the accelerator, which includes endpoints for transaction history .\\n\\n## Notes\\n\\nThe prompt specifically asks for `bookingStatus` values of \\'booked\\', \\'pending\\', \\'both\\', and \\'information\\'. While \\'Booked\\' and \\'Pending\\' are directly supported as `OBEntryStatus1Code` for transactions , \\'information\\' is found as a value for `OBBalanceType1Code` , which is a different concept related to balance types rather than transaction booking status. There is no explicit `bookingStatus` value of \\'both\\' in the provided context. The `OBTransaction5` schema makes `Status` a mandatory field, ensuring that a booking status is always provided .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6b779748-97ed-457a-80d5-613cf28a5127\\n', 'id': 'lc_2ac8a552-8dee-4e9e-b327-2a10f2dfa578'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0046",
      "requirement": {
        "requirement_id": "ATOM_090",
        "requirement_text": "ASPSP SHALL return ASPSP-SCA-Approach header with value 'DECOUPLED' when PSU chooses decoupled authentication method in embedded flow",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0046_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_2",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_3",
          "text": "#Client-Initiated Backchannel Authentication (CIBA) Flow\n\nWSO2 Open Banking Accelerator provides support for the\n[OpenID Connect Client-Initiated Backchannel Authentication Flow](https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html). \n\nThe CIBA flow is an authentication flow like OpenID Connect. In the OpenID Connect authentication flow, the bank customers \nare redirected to the bank in order to log in by providing their credentials. The customers are authenticating themselves \nthrough the same device that is used for the rest of the flow. \n\nHowever, in CIBA, the bank sends a notification to the customer's mobile device and verifies the account owners. CIBA \nuses a decoupled direct channel to verify the customer without relying on redirects. This flow consists of 2 types of devices:\n\n- Consumption Device:  Device used to interact with the bank\n- Authentication Device: Device used for authentication and consent grant\n\nThe customer starts the flow with a relying party (a Third Party Provider/API consumer application) at the Consumption Device \nbut authenticates and grants consent on the Authentication Device. This makes the flow a form of \n**Decoupled authentication/authorization**.\n\nCIBA flow increases the security by involving a second device, which is similar to Two-Factor Authentication. Customers \nsimply receive a mobile notification to authenticate themselves and grant access to their accounts. This also\nimproves the user experience as the customers are not redirected between websites.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_4",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_5",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, does not appear to explicitly support the `ASPSP-SCA-Approach` header with a `DECOUPLED` value for decoupled authentication in embedded flows based on the provided code snippets. The snippets primarily focus on general OAuth2/OIDC functionalities, client native authentication test cases, and FAPI conformance configurations, without specific mentions of this header or its associated decoupled authentication mechanism.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThe provided code snippets do not contain any direct implementation details, configuration options, or API endpoints that specifically handle the `ASPSP-SCA-Approach` header or the concept of \"decoupled authentication method in embedded flow\" as described in the prompt.\\n\\nThe `wso2/product-is` repository generally supports OAuth2/OIDC protocols  and has a REST API layer . However, there is no explicit code that demonstrates the handling or generation of the `ASPSP-SCA-Approach` header with a `DECOUPLED` value.\\n\\nThe integration test cases, such as `JITUserAssociationTestCase.java`  and `ApplicationNativeAuthenticationFederationTestCase.java` , validate the structure of client native authentication responses, including `FLOW_ID`, `FLOW_STATUS`, `NEXT_STEP`, and `LINKS`. These tests assert the presence of specific authenticators and metadata, but they do not check for the `ASPSP-SCA-Approach` header.\\n\\nThe `oidc-fapi-conformance-tests` directory contains Python scripts for configuring FAPI-related settings , including dynamic client registration (DCR) body configurations  and ACR values . While FAPI is relevant to strong customer authentication (SCA), these snippets do not directly address the `ASPSP-SCA-Approach` header or decoupled authentication.\\n\\n## Documentation References\\n\\nThe provided wiki page \"Overview\"  mentions that WSO2 Identity Server supports OAuth 2.0/OpenID Connect and FAPI compliance . However, it does not contain specific documentation references for the `ASPSP-SCA-Approach` header or decoupled authentication methods.\\n\\n## Notes\\n\\nThe prompt specifically asks about the `ASPSP-SCA-Approach` header and \"decoupled authentication method in embedded flow\". While the codebase has extensive support for OAuth2/OIDC and FAPI, which are related to strong customer authentication, there is no direct evidence in the provided snippets to confirm support for this specific header and decoupled authentication approach. It\\'s possible that this functionality exists within the broader WSO2 Identity Server product but is not covered by the provided code context.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_31cce471-6503-4f42-a6f7-30704186d391\\n', 'id': 'lc_81bb3b18-bf9c-4b74-afa1-42dda5005787'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_12f79fb9-dff9-48fa-9757-f430a92f2e57'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0047",
      "requirement": {
        "requirement_id": "ATOM_059",
        "requirement_text": "The system MUST support payment initiation transaction status 'PATC' (PartiallyAcceptedTechnicalCorrect) for multilevel SCA when at least one PSU has authorized but final authorization is pending.",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0047_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_2",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_3",
          "text": "## Consent Authorization\n\n- Once you enter a properly constructed authorization request in your web browser, based on the `bank_code` in the \n  request object, you will be redirected to ABC bank or DCB Bank. \n\n- A bank customer needs to enter their credentials and sign in. \n    ![sign_in](../../assets/img/toolkit/regulatory-aggregator/sign-in.png)\n- Then redirected to the Aggregator's Account selection page.\n    ![account_selection](../../assets/img/toolkit/regulatory-aggregator/account-selection.png)\n- Once the bank customer selects the accounts they want to share, the whole consent agreement is displayed.\n    ![consent_agreement](../../assets/img/toolkit/regulatory-aggregator/consent-agreement.png)\n- Once the bank customer approves this consent, the aggregator will redirect you to the registered callback URL with an \n  authorization code in the query parameters.\n   ```\n   https://wso2.com/#code=1390032d-622f-3977-a976-923505035571&id_token=eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJhdWQiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwiY19oYXNoIjoiNXFNeEhhY0d2d2IxX2ZDT29GWmlNZyIsInN1YiI6ImFiY3VzZXJAY2FyYm9uLnN1cGVyIiwic19oYXNoIjoiOU9WMVpnRXVfWWExanFxU3hWelg1ZyIsImF6cCI6IngwVWkyR2k3YTVCNGp1cTdXcHdkcFdyTjlsRWEiLCJhbXIiOlsiQ3VzdG9tRmVkZXJhdGVkQXV0aGVudGljYXRvciJdLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0Ojk0NDZcL29hdXRoMlwvdG9rZW4iLCJleHAiOjE2NTM0ODI2ODAsImlhdCI6MTY1MzQ3OTA4MCwibm9uY2UiOiJqQlhoT21PS0NCIiwic2lkIjoiZmRlODZlMzMtNjljYi00ZTIwLTgxZTMtOTFiMDJhYjlmMjM3In0.OQmAuO3yH-Ap3bPzb1NpbbFN628BdIuKYZ6kZqeDRJwLK2Z5GqtO5P2VZpEoMlRSPi15Z0eg_8Uxv1ns1Na8djpIs1UyK2zK20HzHCZh4flpXlW0AMbvoxUUbAsfDzaH8r0xpzweA471vD0HX9rja2Xio0AhsP6VPJasBxC3jnAt9H9wjqB_qXYw8-TQwVPjkFONNgEZHQ44eJFRxK7Um5TOv1fHb6Ivz4URc0R91vL1LEyaIRy8w7afGePNDQn5BHObbfzwX6O4hI_jsUVeOybG0M3-ofhEwYcvkMuiMPsLeF2Oqa849bNNr11P75TajKV7ozUBo1UJquTs7VfSnA&state=0pN0NBTHcv&session_state=13831b535eebb5527056f57766e0b5a1d66caea43afbe041f75d27adcdb954f1.PNSwGdfigyA_dxaCi45fPA \n   ```\n   - The authorization code from the above URL is in the code parameter `1390032d-622f-3977-a976-923505035571`. \n   - Extract this code for the next step.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_4",
          "text": "as a Java Map in the Worker Java implementation. You can use these properties to implement the logic you want. 3. Worker Name - This is the name of the Worker. !!! note Provide the same name you configured in the `deployment.toml` file as the Worker name in the third step. !!! info You can implement multiple workers, give them different names, and use them in the adaptive authentication script. Below is a sample adaptive authentication script that uses this Worker extension: ``` java var psuChannel = \"Online Banking\"; var onLoginRequest = function (context) { publishAuthData(context, \"AuthenticationAttempted\", { psuChannel: psuChannel, }); executeStep(1, { onSuccess: function (context) { Log.info(\"Authentication Successful\"); publishAuthData(context, \"AuthenticationSuccessful\", { psuChannel: psuChannel, }); OBAuthenticationWorker(context, {}, \"psuAuthenticated\"); }, onFail: function (context) { Log.info(\"Authentication Failed\"); publishAuthData(context, \"AuthenticationFailed\", { psuChannel: psuChannel, }); OBAuthenticationWorker(context, {}, \"psuAuthenticated\"); }, }); OBAuthenticationWorker(context, {}, \"finalised\"); }; ``` !!! note To add these to one or more existing applications, log into the Carbon console as the super admin and update the script. Follow the steps in the [Adaptive Authentication - Overview](https://is.docs.wso2.com/en/latest/guides/adaptive-auth/configure-adaptive-auth/) documentation.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_5",
          "text": "reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank. In this web application, the customer: - Logs in using the login credentials. - Views information that the API consumer requested to access. - Selects the accounts that the API consumer can access. - Provides consent to the API consumer to access the information. ###Identifier-first authenticator Banks use Identifier-first authentication to authenticate the user with a second-factor authenticator instead of a password. The user who logs into the authorization web application, can provide the username, and authenticate using a second-factor authentication mechanism such as SMS-OTP/TOTP.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to have support for defining and managing \"authorization details types\" which could be extended to handle payment initiation transaction statuses like \\'PATC\\' for multilevel SCA.  The system allows for the creation, retrieval, update, and deletion of these authorization details types, and they can be associated with API resources and applications. \\n\\n### Implementation Details\\n\\nThe core concept for handling different authorization scenarios is the `AuthorizationDetailsType` model.  This model includes fields such as `id`, `type`, `name`, `description`, and a `schema`.  The `schema` field is particularly relevant as it accepts a JSON Schema document, allowing for flexible definition of the structure and validation rules for specific authorization details.  For instance, the example schema provided for `payment_initiation` includes properties like `type`, `actions`, `locations`, and `instructedAmount`.  This schema could be extended to include a `status` field that would hold values like \\'PATC\\'. \\n\\nThe `OAuth2RichAuthorizationRequestsTestCase` demonstrates the CRUD operations for `AuthorizationDetailsType`.  It shows how to create new types, retrieve them, update their properties (including the schema), and delete them. \\n\\n### Configuration Options\\n\\nThe system allows for the configuration of `AuthorizationDetailsType` objects.  These types can be associated with API resources, and applications can then be authorized to use specific authorization details types.  The `APIResourcePatchModel` is used to add or remove `AuthorizationDetailsType` from an API resource.  Similarly, `AuthorizedAPIPatchModel` is used to update the authorized `AuthorizationDetailsType` for an application. \\n\\n### API Endpoints or Features\\n\\nThe `OAuth2RestClient` provides methods for interacting with the API resources and their authorization details. \\nKey API features include:\\n*   `updateAPIResource(String apiId, APIResourcePatchModel apiResource)`: Used to update an API resource, including its associated authorization details types. \\n*   `getAPIResourceAuthorizationDetailsTypes(String apiIdentifier)`: Retrieves the list of authorization details types associated with a given API resource. \\n*   The OIDC metadata endpoint (`/oauth2/token/.well-known/openid-configuration`) exposes the `authorization_details_types_supported`, indicating the types of authorization details the system can handle. \\n\\n### Documentation References\\n\\nThe \"API Layer\" wiki page provides a high-level overview of the API architecture, categories, versioning, and authentication mechanisms.  While it doesn\\'t specifically mention \"PATC\" or multilevel SCA, it describes the general framework for managing APIs and their configurations, which would be the foundation for implementing such a feature.  The `AuthorizationDetailsType` model itself contains detailed `ApiModelProperty` annotations that serve as inline documentation for its fields. \\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which demonstrate the functionality of the API layer.  While the concept of `AuthorizationDetailsType` is present and flexible enough to define custom authorization statuses, there is no explicit mention or implementation of \"PATC\" or specific multilevel SCA logic within the provided context.  The `schema` field of `AuthorizationDetailsType` would be the place to define the structure for such a status.  The `backupIdentity.xml` file contains configurations related to OAuth2 token persistence and multifactor authentication, but it does not directly address the \"PATC\" status or multilevel SCA in the context of payment initiation. \\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2034d595-fab6-4945-b6ae-f49e65d33bc3\\n', 'id': 'lc_cfbf0b43-865d-40a3-9a26-9425d44ee793'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_64c71e87-fd75-47d6-abfa-eb738c284774'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0048",
      "requirement": {
        "requirement_id": "ATOM_172",
        "requirement_text": "The system SHALL support dateFrom query parameter as conditional requirement when no delta access is required",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0048_1",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0048_2",
          "text": "All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  StatusUpdateDateTime:\n    description: >-\n      Date and time at which the resource status was updated.All dates in the\n      JSON payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  OBExternalRequestStatus1Code:\n    description: Specifies the status of consent resource in code form.\n    type: string\n    enum:\n      - Authorised\n      - AwaitingAuthorisation\n      - Rejected\n      - Revoked\n  OBReadAccount4:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        type: object\n        properties:\n          Account:\n            type: array\n            items:\n              $ref: '#/definitions/OBAccount4'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadAccount5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        type: object\n        properties:\n          Account:\n            type: array\n            items:\n              $ref: '#/definitions/OBAccount4'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n    additionalProperties: false\n  OBAccount4:\n    type: object\n    description: >-\n      Unambiguous identification of the account to which credit and debit\n      entries are made.\n    required:\n      - AccountId\n      - Currency\n      - AccountType\n      - AccountSubType\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      Status:\n        $ref: '#/definitions/OBAccountStatus1Code'\n      StatusUpdateDateTime:\n        $ref: '#/definitions/StatusUpdateDateTime'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n      AccountType:\n        $ref: '#/definitions/OBExternalAccountType1Code'\n      AccountSubType:\n        $ref: '#/definitions/OBExternalAccountSubType1Code'\n      Description:\n        $ref: '#/definitions/Description'\n      Nickname:\n        $ref: '#/definitions/Nickname'\n      Account:\n        type: array\n        items:\n          type: object\n          description: Provides the details to identify an account.\n          required:\n            - SchemeName\n            - Identification\n          properties:\n            SchemeName:\n              $ref: '#/definitions/OBExternalAccountIdentification4Code'\n            Identification:\n              $ref: '#/definitions/Identification'\n            Name:\n              $ref: '#/definitions/Name'\n            SecondaryIdentification:\n              $ref: '#/definitions/SecondaryIdentification'\n      Servicer:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification5'\n  OBReadBalance1:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        type: object\n        required:\n          - Balance\n        properties:\n          Balance:\n            type: array\n            items:\n              type: object\n              description: Set of elements used to define the balance details.\n              required:\n                - AccountId\n                - CreditDebitIndicator\n                - Type\n                - DateTime\n                - Amount\n              properties:\n                AccountId:\n                  $ref: '#/definitions/AccountId'\n                CreditDebitIndicator:\n                  $ref: '#/definitions/OBCreditDebitCode'\n                Type:\n                  $ref: '#/definitions/OBBalanceType1Code'\n                DateTime:\n                  description: >-\n                    Indicates the date (and time) of the balance.All dates in\n                    the JSON payloads are represented in ISO 8601 date-time\n                    format.\n\n                    All date-time fields in responses must include the timezone.\n                    An example is below:\n\n                    2017-04-05T10:43:07+00:00\n                  type: string\n                  format: date-time\n                Amount:\n                  type: object\n                  required:\n                    - Amount\n                    - Currency\n                  description: Amount of money of the cash balance.\n                  properties:\n                    Amount:\n                      $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                    Currency:\n                      $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n                CreditLine:\n                  type: array\n                  items:\n                    type: object\n                    description: >-\n                      Set of elements used to provide details on the credit\n                      line.\n                    required:\n                      - Included\n                    properties:\n                      Included:\n                        description: >-\n                          Indicates whether or not the credit line is included\n                          in the balance of the account.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0048_3",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0048_4",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': \"The WSO2 Financial Services Accelerator supports the `dateFrom` query parameter as a conditional requirement for transaction lists when delta access is not required. This functionality is primarily defined within the OpenAPI specifications for Account Information APIs and is handled during consent authorization.  \\n\\n### Implementation Details\\n\\nThe `TransactionFromDateTime` parameter is defined in the `account-info-swagger.yaml` file as part of the `OBReadData1` schema.  It specifies the start date and time for a transaction query period.  If this parameter is not populated, the system is designed to return data from the earliest available transaction. \\n\\nDuring the consent authorization flow, the `ConsentAuthorizeUtil.populateAccountData` method processes the `TransactionFromDateTime` from the consent data.   This method extracts the `TransactionFromDateTime` string and adds it to the `consentDataJSON` object, which is then used to display consent information. \\n\\nThe `MssqlConsentCoreDAOImpl.searchConsents` method demonstrates how `fromTime` and `toTime` parameters are used in database queries to filter consent resources based on a time period.  While this method is for searching consents, it illustrates the system's capability to handle time-based filtering. \\n\\n### API Endpoints or Features\\n\\nThe `TransactionFromDateTime` parameter is part of the Account Information APIs, specifically within the context of transaction history retrieval.  The `account-info-swagger.yaml` defines the structure for requests related to account information, including transaction queries. \\n\\nTest payloads in `AccountsRequestPayloads.groovy` and `RequestPayloads.groovy` demonstrate how `TransactionFromDateTime` is included in consent initiation requests.   These payloads include `TransactionFromDateTime` and `TransactionToDateTime` as part of the `Data` object in the request body.  \\n\\n### Documentation References\\n\\nThe `Overview` wiki page mentions that the accelerator implements regulatory standards for consent management and supports account information services, including transaction history.  The `Consent Management` wiki page details the consent authorization flow, where parameters like `TransactionFromDateTime` would be processed. \\n\\n## Notes\\n\\nThe prompt specifically asks about the `dateFrom` query parameter as a conditional requirement when no delta access is required. The provided context shows `TransactionFromDateTime` as a field within the request body for consent initiation, not directly as a query parameter.   The `deltaList` concept is not explicitly present in the provided snippets. However, the description for `TransactionFromDateTime` indicates that if it's not populated, data will be returned from the earliest available transaction, implying a default behavior when a specific start date is not provided.  The test criteria regarding `deltaList` being false or not provided cannot be directly verified with the given context.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0fd8e919-66a7-4509-b743-fe3b78fa4835\\n\", 'id': 'lc_c3cb8dec-d5de-46ab-8562-489ac6615375'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0049",
      "requirement": {
        "requirement_id": "ATOM_132",
        "requirement_text": "Account access endpoints SHALL separate usual bank accounts and credit card accounts since data is usually separated in ASPSP backend",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0049_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0049_2",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0049_3",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports the separation of bank accounts and credit card accounts through its API definitions and data models. The `account-info-swagger.yaml` file defines the `OBExternalAccountSubType1Code` enum, which explicitly lists `CreditCard`, `ChargeCard`, `CurrentAccount`, `EMoney`, `Loan`, `Mortgage`, and `Savings` as possible account subtypes . This indicates that the API is designed to differentiate between various types of accounts, including credit cards and traditional bank accounts.\\n\\n## Implementation Details\\n\\nThe core of this separation is within the OpenAPI/Swagger definition for the Account Information Service Provider (AISP) APIs. The `account-info-swagger.yaml` file defines the structure for account-related data .\\n\\nSpecifically, the `OBAccount4` object, which represents an account, includes an `AccountSubType` property that references the `OBExternalAccountSubType1Code` enum . This enum allows for the explicit categorization of accounts into types like `CreditCard`, `CurrentAccount`, `Savings`, etc. .\\n\\nThe `AccountService.java` in the demo backend also illustrates how different account subtypes could be handled, although it currently returns a hardcoded `CurrentAccount` for all demo accounts   . In a real-world scenario, this service would interact with the ASPSP backend to retrieve the actual `AccountSubType` for each account.\\n\\n## API Endpoints and Features\\n\\nThe API defines a `/accounts` endpoint for retrieving a list of accounts and `/accounts/{AccountId}` for retrieving a specific account . These endpoints are generic and return `OBReadAccount5` or `OBReadAccount4` objects, which contain the `AccountSubType` field  .\\n\\nWhile there aren\\'t separate top-level endpoints like `/bank-accounts` and `/credit-card-accounts`, the design allows for filtering and distinguishing between account types based on the `AccountSubType` field within the returned account data. This means that a single endpoint can serve both types of accounts, with the distinction made at the data model level.\\n\\n## Documentation References\\n\\nThe `Overview` wiki page mentions \"Account Information APIs\" which include endpoints for `Accounts`, `Balances`, and `Transactions` . The `account-info-swagger.yaml` file serves as the primary documentation for these API definitions .\\n\\n## Notes\\n\\nThe current implementation uses a single set of endpoints for all account types, with the distinction made through the `AccountSubType` field in the response payload. This approach is common in Open Banking specifications, where a unified account information endpoint provides detailed account type information within the data structure. While the demo `AccountService.java` currently hardcodes `CurrentAccount` , the underlying API definition supports various account subtypes, including `CreditCard` .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_99f41f24-96df-48be-b23f-e78a71fb6064\\n', 'id': 'lc_04d80004-2e54-497d-91f4-1f408d0d932c'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0050",
      "requirement": {
        "requirement_id": "ATOM_204",
        "requirement_text": "The client_id parameter shall contain the organizationIdentifier from the eIDAS certificate in the format 'PSD[2-char-country]-[NCA-identifier]-[PSP-identifier]'",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "13.1",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0050_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_2",
          "text": "### getKeyId method\n\nThe method contains the KeyID calculation logic. You can customize it according to your requirements. Given below is \nthe method signature:\n\n``` java\npublic String getKeyId(Certificate certificate, JWSAlgorithm signatureAlgorithm, String tenantDomain) throws IdentityOAuth2Exception;\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_3",
          "text": "## Configuring a custom CIBA Authentication Endpoint Consent Updater  \n\n1. Once implemented, build a JAR file for your project.\n2. Place the above-created JAR file in the `<IS_HOME>/repository/components/dropins` directory.\n3. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n4. Add the `open_banking.identity.ciba_webapp` tag and configure your customization using the Fully Qualified Name \n(FQN). For example,\n\n      ``` toml\n      [open_banking.identity.ciba_webapp]\n      Servlet_extension = com.wso2.openbanking.accelerator.consent.extensions.ciba.model.CIBAAuthenticationEndpointInterface\n      ```\n   \n5. Save the configurations and restart the Identity Server.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_4",
          "text": "## Configuring a custom ID Token Builder\n\nTo configure the custom ID Token Builder, follow the steps below:\n\n1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n\n2. Add the following tags and configure your custom ID Token Builder using its FQN:\n\n    ``` toml\n    [oauth.oidc.extensions]\n    id_token_builder = \"com.wso2.openbanking.accelerator.identity.idtoken.OBIDTokenBuilder\"\n    ```\n   \n    !!! note\n        If `id_token_builder` is not configured, the default ID Token Builder `DefaultIDTokenBuilder` is used for \n        `subject` claim calculation. \n\n3. If you need to return the subject claim of the id token as a PPID, add the following configurations and set the value to `true`.\n\n    ``` toml\n    [open_banking.identity] \n    enable_PPID = true\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_5",
          "text": "## Configuring a custom Push Authenticator  \n\n1. Once implemented, build a JAR file for your project.\n2. Place the above-created JAR file in the `<IS_HOME>/repository/components/dropins` directory.\n3. Open the `<IS_HOME>/repository/conf/deployment.toml` file and configure your custom authenticator using the Fully \nQualified Name (FQN):\n\n      ``` toml\n      [open_banking.sca.idp]\n      name = \"CIBA-Push-Auth\"\n      ```\n    \n4. Save the configurations and restart the Identity Server.\n5. Follow the [Set up CIBA flow](../learn/ciba-set-up-flow.md#configuring-authenticator) documentation and try out the \nflow.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase, there is no direct evidence or implementation details that explicitly support the validation of the `client_id` parameter against the specific eIDAS certificate format \\'PSD[2-char-country]-[NCA-identifier]-[PSP-identifier]\\'. The codebase primarily focuses on general OAuth2 and OpenID Connect functionalities, including client registration and validation of basic `client_id` presence and validity.  \\n\\n### Implementation Details\\n\\nThe codebase includes tests for `client_id` validation, but these tests are for basic scenarios such as checking for an invalid `client_id` or a missing `client_id`. For instance, `OAuth2PushedAuthRequestTestCase.java` contains tests like `testSendParWithInvalidClient()`  and `testSendParWithoutClient()` . In `testSendParWithInvalidClient()`, the `client_id` is set to \"invalid_consumerKey\" , and the system asserts an unauthorized response with the message \"Client credentials are invalid.\" . Similarly, `testSendParWithoutClient()` verifies that a missing `client_id` results in an \"Client ID not found in the request.\" error . These tests do not indicate any specific pattern matching for the `client_id` beyond its existence and basic validity.\\n\\nThe `DCRTestCase.java` also validates the `client_id` during Dynamic Client Registration (DCR) . It checks if the `client_id` in the response matches the one in the request if provided, or if a `client_id` is generated if not provided . However, there\\'s no explicit regex or format validation for the `client_id` in the eIDAS certificate format.\\n\\n### Configuration Options\\n\\nThe configuration files, such as `deployment-fapi-config.toml` , show an option `enable_fapi_enforcement = true` under `[oauth.dcr]`. While FAPI (Financial-grade API) conformance is mentioned in the wiki <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" wiki_page=\"OAuth2 and OpenID Connect\" heading=\"FAPI Conformance\" /> and implies stricter security and validation, there is no direct configuration parameter visible in the provided snippets that allows defining a custom regex or specific format for the `client_id` as described in the prompt. The `client_id` can be explicitly set during application creation, as seen in `create-oauth-app-with-additional-oidc-attributes.json` where `clientId` is set to \"custom_client_id\" .\\n\\n### API Endpoints or Features\\n\\nThe Dynamic Client Registration (DCR) endpoint `/api/identity/oauth2/dcr/v1.1/register`   is used for registering clients, and the `client_id` is a parameter in this process . However, the provided code does not show any specific API feature or endpoint that would enforce the \\'PSD[2-char-country]-[NCA-identifier]-[PSP-identifier]\\' format for the `client_id`. The `OAuth2PushedAuthRequestTestCase.java` also interacts with the `PAR_ENDPOINT`  and uses `CLIENT_ID_PARAM`  as a parameter, but again, no specific format validation is evident.\\n\\n### Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" wiki_page=\"OAuth2 and OpenID Connect\" /> mentions FAPI conformance <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" wiki_page=\"OAuth2 and OpenID Connect\" heading=\"FAPI Conformance\" /> and advanced OAuth features like Pushed Authorization Requests (PAR) <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" wiki_page=\"Features and Capabilities\" heading=\"OAuth 2.0 and OpenID Connect\" />. While FAPI often involves stricter client authentication and identification, the provided documentation does not specifically detail a requirement for the `client_id` to adhere to the \\'PSD[2-char-country]-[NCA-identifier]-[PSP-identifier]\\' format.\\n\\n## Notes\\n\\nThe provided snippets indicate that WSO2 Identity Server supports OAuth2 and OpenID Connect, including Dynamic Client Registration and FAPI conformance. However, there is no explicit code or configuration that directly implements or enforces the specific `client_id` format \\'PSD[2-char-country]-[NCA-identifier]-[PSP-identifier]\\'. It is possible that such validation could be implemented as a custom extension or policy, but it is not part of the core functionality visible in the provided context. To verify this requirement, further investigation into custom extension points or policy enforcement mechanisms within the WSO2 Identity Server would be necessary.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_dc10ce9d-8366-495c-a223-5208d8424e72\\n', 'id': 'lc_aa3555c7-21c3-47f6-a7b2-a268e1bde88a'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_a5524ad0-ff8e-44c3-818d-c7b9cb38dfb7'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0051",
      "requirement": {
        "requirement_id": "ATOM_147",
        "requirement_text": "Account transaction requests MUST support bookingStatus query parameter",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f30dd2c91d5e",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0051_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0051_2",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0051_3",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0051_4",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0051_5",
          "text": "Sun, 10 Sep 2017 19:43:31 UTC\n    pattern: >-\n      ^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\d{2}\n      (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\d{4} \\d{2}:\\d{2}:\\d{2}\n      (GMT|UTC)$\n  ConsentId:\n    name: ConsentId\n    in: path\n    description: ConsentId\n    required: true\n    type: string\n  AccountId:\n    name: AccountId\n    in: path\n    description: AccountId\n    required: true\n    type: string\n  x-fapi-interaction-id:\n    in: header\n    name: x-fapi-interaction-id\n    type: string\n    required: false\n    description: An RFC4122 UID used as a correlation id.\nresponses:\n  201AccountAccessConsentsCreated:\n    description: Account Access Consents Created\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadConsentResponse1'\n  200AccountAccessConsentsConsentIdRead:\n    description: Account Access Consents Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadConsentResponse1'\n  204AccountAccessConsentsConsentIdDeleted:\n    description: Account Access Consents Deleted\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  200AccountsRead:\n    description: Accounts Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadAccount5'\n  200AccountsAccountIdRead:\n    description: Accounts Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadAccount4'\n  200AccountsAccountIdBalancesRead:\n    description: Balances Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadBalance1'\n  200AccountsAccountIdTransactionsRead:\n    description: Transactions Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        required: true\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadTransaction5'\n  400Error:\n    description: Bad request\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\n  401Error:\n    description: Unauthorized\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  403Error:\n    description: Forbidden\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\n  404Error:\n    description: Not found\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  405Error:\n    description: Method Not Allowed\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  406Error:\n    description: Not Acceptable\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  415Error:\n    description: Unsupported Media Type\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  429Error:\n    description: Too Many Requests\n    headers:\n      Retry-After:\n        description: Number in seconds to wait\n        type: integer\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  500Error:\n    description: Internal Server Error\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    tokenUrl: 'https://authserver.example/token'\n    scopes:\n      accounts: Ability to read Accounts information\n    description: TPP client credential authorisation flow with the ASPSP\n    x-scopes-bindings:\n      accounts: Internal/consumer\n  PSUOAuth2Security:\n    type: oauth2\n    flow: accessCode\n    tokenUrl: 'https://authserver.example/token'\n    authorizationUrl: 'https://authserver.example/authorization'\n    scopes:\n      accounts: Ability to read Accounts information\n    description: >-\n      OAuth flow, it is required when the PSU needs to perform SCA with the\n      ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\n    x-scopes-bindings:\n      accounts: Internal/consumer\n  default:\n    type: oauth2\n    authorizationUrl: 'https://test.com'\n    flow: implicit\n    scopes:\n      accounts: Ability to read Accounts information\n    x-scopes-bindings:\n      accounts: Internal/consumer\ndefinitions:\n  OBReadConsent1:\n    type: object\n    required:\n      - Data\n      - Risk\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadData1'\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n  OBReadConsentResponse1:\n    type: object\n    required:\n      - Data\n      - Risk\n    properties:\n      Data:\n        type: object\n        required:\n          - ConsentId\n          - CreationDateTime\n          - StatusUpdateDateTime\n          - Permissions\n        properties:\n          ConsentId:\n            description: >-\n              Unique identification as assigned to identify the account access\n              consent resource.\n            type: string\n            minLength: 1\n            maxLength: 128\n          CreationDateTime:\n            $ref: '#/definitions/CreationDateTime'\n          Status:\n            $ref: '#/definitions/OBExternalRequestStatus1Code'\n          StatusUpdateDateTime:\n            $ref: '#/definitions/StatusUpdateDateTime'\n          Permissions:\n            type: array\n            items:\n              $ref: '#/definitions/OBExternalPermissions1Code'\n            minItems: 1\n          ExpirationDateTime:\n            description: >-\n              Specified date and time the permissions will expire.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0051_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support a `bookingStatus` query parameter for account transaction requests based on the provided `account-info-swagger.yaml` . The OpenAPI specification for the `/accounts/{AccountId}/transactions` endpoint does not list `bookingStatus` as a supported parameter .\\n\\n## Implementation Details\\n\\nThe `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml` file defines the API endpoints and their parameters for Account Information Services . The `GET /accounts/{AccountId}/transactions` endpoint is defined with parameters such as `AccountId`, `x-fapi-auth-date`, `x-fapi-customer-ip-address`, `x-fapi-interaction-id`, and `Authorization` . However, there is no mention of a `bookingStatus` query parameter in this specification .\\n\\nThe `OBTransaction5` schema, which describes the structure of a transaction, includes a `Status` field . This `Status` field references `OBEntryStatus1Code`, which has an enum of `Booked` and `Pending` . While this indicates that transactions have a status, the API definition does not expose this as a filterable query parameter.\\n\\nThe `AccountService.java` file in the demo backend provides a mock implementation for `getAccountTransactions` . This method currently returns a hardcoded JSON response and does not process any `bookingStatus` parameter .\\n\\n## Configuration Options\\n\\nThere are no explicit configuration options found in the provided context that would enable or configure a `bookingStatus` query parameter for transaction requests. The `financial-services.xml` configuration, parsed by `FinancialServicesConfigParser`, focuses on consent management, identity, and event notifications, without specific details on transaction filtering parameters .\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `GET /accounts/{AccountId}/transactions` . As noted, the current OpenAPI specification for this endpoint does not include `bookingStatus` as a query parameter .\\n\\n## Documentation References\\n\\nThe `Overview` wiki page mentions \"Account Information APIs\" including \"Transactions\" . It also refers to `account-info-swagger.yaml` for API specifications . However, this documentation does not detail support for a `bookingStatus` query parameter.\\n\\n## Notes\\n\\nThe `fs-integration-test-suite` contains a test case for \"Verify Accounts transaction Retrieval Request for a Authorised Consent\" . This test verifies that the `/transactions` endpoint returns a `200` status code, but it does not appear to test for filtering by `bookingStatus` . The `AccountsRequestPayloads.groovy` file defines various initiation payloads, some of which include `TransactionFromDateTime` and `TransactionToDateTime` . This suggests that date-based filtering is supported, but not `bookingStatus`.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_63be0a54-9883-4de5-a473-e2b28726aebe\\n', 'id': 'lc_8f9ac604-8b09-4e7b-8f9b-be53e10eea46'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0052",
      "requirement": {
        "requirement_id": "ATOM_097",
        "requirement_text": "ASPSP SHALL validate that the payment-product parameter matches the payment product under which the paymentId was initiated",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0052_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_2",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_3",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_4",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_5",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support the validation of the `payment-product` parameter against the original payment initiation product for a given `paymentId` as a built-in feature. The provided code snippets primarily define API specifications and demonstrate basic payment submission and retrieval, but they do not show specific logic for this type of product-matching validation.\\n\\n### Implementation Details\\nThe `financial-services-accelerator` provides OpenAPI specifications for Payment Initiation APIs, including endpoints for creating payment consents (`/payment-consents`) and retrieving payments (`/payments/{paymentId}`) . The `paymentId` is a path parameter used to identify a specific payment .\\n\\nThe `PaymentService.java` in the demo backend handles payment submissions and funds confirmation requests . However, this service primarily caches payment responses and does not appear to perform validation of the `payment-product` parameter against the initial payment product .\\n\\nThe `DefaultConsentManageValidator.java` contains a method `validatePaymentRequestPayload` which validates the structure of the payment initiation request payload . This validation focuses on the presence and structure of `Data` and `Initiation` objects within the request . There is no explicit logic within this validator to compare a `payment-product` parameter with a previously stored payment product.\\n\\nThe OpenAPI specification for payment initiation defines `obExternalLocalInstrument1Code` which enumerates various payment instruments like `UK.OBIE.BACS`, `UK.OBIE.FPS`, etc. . This `LocalInstrument` is part of the `Initiation` object in both `obWriteConsent4` (for payment consents)  and `obWritePayment2` (for payments)  schemas. While these define the possible payment products, the codebase does not show an active validation mechanism to ensure consistency between the initial consent and subsequent payment requests based on this field.\\n\\n### Configuration Options\\nThe `Overview` wiki page mentions a centralized configuration approach using `financial-services.xml` parsed by `FinancialServicesConfigParser` . This configuration system allows for customizable handlers and validation rules for consent management . It is possible that a custom extension could be configured to implement the required validation, but it is not present by default.\\n\\n### API Endpoints or Features\\nThe relevant API endpoints are defined in `payment-initiation-openapi.yaml` :\\n*   `POST /payment-consents`: Used to create payment consents . The `obWriteConsent4` schema includes the `LocalInstrument` (payment product)  .\\n*   `GET /payments/{paymentId}`: Used to retrieve the status of a payment . This endpoint takes `paymentId` as a path parameter .\\n\\nThe current API definitions do not include a `payment-product` parameter for status requests on `/payments/{paymentId}` that would allow for explicit validation against the original payment product. The `paymentId` is the primary identifier for retrieving payment status .\\n\\n### Documentation References\\nThe `Overview` wiki page describes the accelerator\\'s capabilities, including payment initiation . It also mentions the `Consent Management` and `API Gateway Extensions` as areas for specific implementation details . While these components are crucial for overall payment processing, the provided documentation does not specifically detail a mechanism for validating the `payment-product` parameter during status requests.\\n\\n## Notes\\nThe requirement \"ASPSP SHALL validate that the payment-product parameter matches the payment product under which the paymentId was initiated\" implies a need for stateful validation where the `payment-product` used in a status request is compared against the `LocalInstrument` (payment product) stored during the initial payment consent creation. The current codebase, based on the provided snippets, does not explicitly demonstrate this specific validation logic. It would likely require custom implementation within the `Consent Management` or `Gateway` components to retrieve the original payment product associated with the `paymentId` and compare it with any `payment-product` parameter provided in a status request.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_d76c21c8-c323-4df4-8521-de4d6f4421b3\\n', 'id': 'lc_2442aa68-9e75-4669-9900-a1a485168b16'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0053",
      "requirement": {
        "requirement_id": "ATOM_205",
        "requirement_text": "The scope parameter shall reference the resource in the format 'PIS:<paymentId>' for Payment Initiation Services",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "13.1",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0053_1",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_2",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_3",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_4",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_5",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support the scope parameter format \\'PIS:<paymentId>\\' for Payment Initiation Services. The API specifications and configuration options primarily use a generic \"payments\" scope.    \\n\\n### Implementation Details\\n\\nThe `payment-initiation-openapi.yaml` file defines the API endpoints for Payment Initiation Services.  This OpenAPI specification uses `payments` as the scope for various operations, including creating payment consents, getting payment consents, and getting payment consents funds confirmation.    The `x-scope` field is also set to \"payments\" for these operations.   \\n\\nThe `ConnectorTestConstants.groovy` file, used in integration tests, defines an `ApiScope` enum which includes `PAYMENTS(\"payments\")`.  This further indicates the use of a generic \"payments\" scope. \\n\\n### Configuration Options\\n\\nThe `wso2is-7.1.0-deployment.toml` file, which is a configuration file for WSO2 Identity Server, lists \"payments\" as an allowed value for the `Scope` parameter in Dynamic Client Registration (DCR).  There is no explicit configuration for a `PIS:<paymentId>` format. \\n\\n### API Endpoints or Features\\n\\nThe API endpoints related to Payment Initiation Services are defined in `payment-initiation-openapi.yaml`.  These include:\\n*   `/payment-consents` for creating payment consents. \\n*   `/payment-consents/{consentId}` for getting payment consents. \\n*   `/payment-consents/{consentId}/funds-confirmation` for getting payment consents funds confirmation. \\n*   `/payments` for creating payments. \\n*   `/payments/{paymentId}` for getting payments. \\n\\nThe `paymentId` is used as a path parameter in the `/payments/{paymentId}` endpoint, but it is not integrated into the scope parameter in the format \\'PIS:<paymentId>\\'. \\n\\n### Documentation References\\n\\nThe `Overview` wiki page mentions \"Payment Initiation APIs\" and states that the OAuth scope for Payments is `payments`.  This aligns with the OpenAPI specification and configuration files, indicating a generic `payments` scope rather than a `PIS:<paymentId>` format. \\n\\n## Notes\\n\\nThe codebase consistently uses a generic \"payments\" scope for Payment Initiation Services. There is no evidence in the provided snippets to suggest support for a more granular scope format like \\'PIS:<paymentId>\\'. The `paymentId` is used as a path parameter for specific API calls, but not as part of the OAuth scope itself.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_69a3282e-20ff-4997-969b-4b1ebb7effb5\\n', 'id': 'lc_be72edab-7c7a-4f0f-b39a-6a24373cadd5'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0054",
      "requirement": {
        "requirement_id": "ATOM_173",
        "requirement_text": "The system SHALL create authorisation sub-resource via POST to authorisation endpoints and return HTTP 201 status code",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0054_1",
          "text": "### postProcessRequest method\n\nThis method handles the requests after API Authentication.\n\n``` java\npublic void postProcessRequest(OBAPIRequestContext obapiRequestContext);\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_2",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_3",
          "text": "### Dynamic Endpoint Policy\n\nDynamic Endpoint Policy is a policy designed to be engaged in the request flow of any request that requires to be routed to the consent manage service or the actual backend endpoint based on the provided regex expression. It will perform the below tasks.\n\n- Routes the requests to the consent management service or the actual backend endpoint based on the provided regex expression.\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require this routing mechanism. Find the details to create the policy below.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_4",
          "text": "reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank. In this web application, the customer: - Logs in using the login credentials. - Views information that the API consumer requested to access. - Selects the accounts that the API consumer can access. - Provides consent to the API consumer to access the information. ###Identifier-first authenticator Banks use Identifier-first authentication to authenticate the user with a second-factor authenticator instead of a password. The user who logs into the authorization web application, can provide the username, and authenticate using a second-factor authentication mechanism such as SMS-OTP/TOTP.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_5",
          "text": "### Step 5: Validate Account Information Invocation\n\nThe Consent Validate implements the validations that are required when the resource endpoints are invoked with a user access token.\n\n!!! note\n    In a real-life open banking environment, the API consumer applications can retrieve details of accounts for which \n    the bank customer has granted them consent.\n \n- A sample request looks as follows:\n   ```\n   curl -X POST \\\n   https://localhost:9446/api/fs/consent/validate/validate \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'x-wso2-client-id: <CLIENT_ID>' \\\n   -H 'Authorization: Basic <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/jwt \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   --data 'eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.CgkJCXsKICAgICAgCQkJImhlYWRlcnMiOiB7CiAJCQkgIAkJIkF1dGhvcml6YXRpb24iOiAiQmFzaWMgYVhOZllXUnRhVzVBZDNOdk1pNWpiMjA2ZDNOdk1qRXlNdz09IiwKIAkJCSAJIAkiY29uc2VudC1pZCI6ICIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLAogCQkJICAJCSJhY3Rpdml0eWlkIjogIjg2NjZhYTg0LWZjNWEtNDI1ZS05MWM5LTM3ZmEzMGE5NTc4NCIsCiAJCQkgIAkJIkNhY2hlLUNvbnRyb2wiOiAibm8tY2FjaGUiLAogCQkJICAJCSJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogCQkgICAgICAJCSJVc2VyLUFnZW50IjogIlBvc3RtYW5SdW50aW1lLzcuMjguNCIsCiAJCQkgIAkJIkhvc3QiOiAibG9jYWxob3N0OjgyNDMiLAogCQkJICAJCSJQb3N0bWFuLVRva2VuIjogIjI0NGQxNWI2LWViMTgtNDA0NS1iYTg3LThlZTZjODMwYjg0YyIsCiAJCQkgIAkJIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlLCBiciIsCiAJCQkgIAkJImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IgogCQkJICAJfSwKICAgICAgICAJCSJjb25zZW50SWQiOiAiMTJhNGViYzgtYjk4Yy00ZjgwLTlhMzctNDQ2NzkzNjNiOTdiIiwKICAgICAgICAJCSJyZXNvdXJjZVBhcmFtcyI6IHsKCQkJCQkicmVzb3VyY2UiOiAiL2Fpc3AvYWNjb3VudHMiLAoJCQkJCSJjb250ZXh0IjogIi9vcGVuLWJhbmtpbmcvdjMuMS9haXNwIiwKCQkJCQkiaHR0cE1ldGhvZCI6ICJHRVQiCiAJCQkgCSB9LAogCQkJICAgICJ1c2VySWQiOiAicHN1QHdzbzIuY29tIiwKICAgICAJCSAJImVsZWN0ZWRSZXNvdXJjZSI6ICIvYWNjb3VudHMiLAoJCQkJImNsaWVudElkIjogImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiCiAJCQl9CiAgICAJCQk.mjbOnLQUvpCfIpy8WRaYxBmSMnENNIu7OG89Dc7kLJTk9NebnKsgFRo0PAyrkCN-h0g5PRfM0HPhSeBxbazgjekaLpA0iSXiuaXKZUmIUSBORNxORjvqD6flQRzUraaf2qG_OKSBMBpal-unqjcCAlNdgwclCnJMwDmQrJPMqs7jJoiJAudIHwppnJ1uK82Zz_J3bWkL4kEuT4Hz4P8ukdTzTALCPGqxt4VT4dh_ADzR-NTGmpAuSNo8dEWkW9a3QAxhS4WZXRTK192wAS16YqRPOk3UXasqF2qI1KVBb5txNFtjw5eZFW0Eg8cNSOQ0BSwp3B_6zd0jHf9EiwTbLA'\n   ```\n\n???tip \"Click here to see a sample data payload...\"\n      - Given below is a sample payload in the JWT format:\n\n           ```\n           {\n               \"kid\": \"<The KID value of the signing jwk set>\",\n               \"alg\": \"<SUPPORTED_ALGORITHM>\",\n               \"typ\": \"JWT\"\n           }\n           {\n               \"headers\": {\n                  \"Authorization\": \"Basic aXNfYWRtaW5Ad3NvMi5jb206d3NvMjEyMw==\",\n                  \"consent-id\": \"12a4ebc8-b98c-4f80-9a37-44679363b97b\",\n                  \"activityid\": \"8666aa84-fc5a-425e-91c9-37fa30a95784\",\n                  \"Cache-Control\": \"no-cache\",\n                  \"Connection\": \"keep-alive\",\n                  \"User-Agent\": \"PostmanRuntime/7.28.4\",\n                  \"Host\": \"localhost:8243\",\n                  \"Postman-Token\": \"244d15b6-eb18-4045-ba87-8ee6c830b84c\",\n                  \"Accept-Encoding\": \"gzip, deflate, br\",\n                  \"accept\": \"application/json; charset=utf-8\"\n               },\n               \"consentId\": \"<CONSENT_ID>\",\n               \"resourceParams\": {\n               \"resource\": \"/aisp/accounts\",\n               \"context\": \"/open-banking/v3.1/aisp\",\n               \"httpMethod\": \"GET\"\n           },\n           \"userId\": \"psu@wso2.com\",\n           \"electedResource\": \"/accounts\",\n           \"clientId\": \"<CLIENT_ID>\"\n           }\n           ```\n     \n- The request validates the Account Information access request. \n\n    !!! note\n        The response contains the validity of the Account access request along with consent information or the reason for the validation failure.\n\n```\n{\n    \"isValid\": true,\n    \"consentInformation\": \"eyJhbGciOiJSUzI1NiJ9.eyJjbGllbnRJZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJjdXJyZW50U3RhdHVzIjoiQXV0aG9yaXNlZCIsImNyZWF0ZWRUaW1lc3RhbXAiOjE3NDkwMTQ4MjYsInJlY3VycmluZ0luZGljYXRvciI6ZmFsc2UsImF1dGhvcml6YXRpb25SZXNvdXJjZXMiOlt7InVwZGF0ZWRUaW1lIjoxNzQ5MDE0ODU4LCJjb25zZW50SWQiOiIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLCJhdXRob3JpemF0aW9uSWQiOiI0NzRlYzFhMS1kZDRkLTQ1YjQtYTk4Zi1kMWYwNGRlMjUxYWEiLCJhdXRob3JpemF0aW9uVHlwZSI6ImF1dGhvcmlzYXRpb24iLCJ1c2VySWQiOiJwc3VAd3NvMi5jb20iLCJhdXRob3JpemF0aW9uU3RhdHVzIjoiQXV0aG9yaXNlZCJ9XSwidXBkYXRlZFRpbWVzdGFtcCI6MTc0OTAxNDg1OCwiY29uc2VudF90eXBlIjoiYWNjb3VudHMiLCJ2YWxpZGl0eVBlcmlvZCI6MCwiY29uc2VudEF0dHJpYnV0ZXMiOnt9LCJjb25zZW50SWQiOiIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLCJjb25zZW50TWFwcGluZ1Jlc291cmNlcyI6W3sibWFwcGluZ0lkIjoiNjZhOTU4YWItMjNkNC00ODhhLTg3M2EtYzM3MzRjN2VlMzVkIiwibWFwcGluZ1N0YXR1cyI6ImFjdGl2ZSIsImFjY291bnRfaWQiOiIzMDA4MDAxMjM0MzQ1NiIsImF1dGhvcml6YXRpb25JZCI6IjQ3NGVjMWExLWRkNGQtNDViNC1hOThmLWQxZjA0ZGUyNTFhYSIsInBlcm1pc3Npb24iOiJwcmltYXJ5In1dLCJhZGRpdGlvbmFsQ29uc2VudEluZm8iOnt9LCJyZWNlaXB0Ijp7IlJpc2siOnt9LCJEYXRhIjp7IlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjUtMDYtMDdUMTA6NTc6MDIuOTczNDIxKzA1OjMwIiwiRXhwaXJhdGlvbkRhdGVUaW1lIjoiMjAyNS0wNi0wOVQxMDo1NzowMi45NzIyNjErMDU6MzAiLCJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNCYXNpYyIsIlJlYWRBY2NvdW50c0RldGFpbCIsIlJlYWRCYWxhbmNlcyIsIlJlYWRUcmFuc2FjdGlvbnNEZXRhaWwiXSwiVHJhbnNhY3Rpb25Gcm9tRGF0ZVRpbWUiOiIyMDI1LTA2LTA0VDEwOjU3OjAyLjk3MzMyNCswNTozMCJ9fSwiY29uc2VudEZyZXF1ZW5jeSI6MH0.dtk8sPwuLdgHENiu7soD-I7cinmVGKn2Dn23pfcrPzqoGC5HuSJ9pPvYnCOeEMvf0gtvSaLbtn02CIo3oNn9JQiyQeR6iaINMfnXxINybWZvIlYowXAePESt3mh9BKNJ8SUWBdQQ1rjq5Jv4WY2Y3rKSqVyxn1l-5bmS7hiE6eb-REE4zqQY4sD8cfQAtJPcn5QWBDjUTssiTHuHJlROdXZTs7NpexzueFWOnMEPw00u9agW-hVnq6i8bDT4AH-ZLNZVT8IozGZ0AFbf9qBbYr5t0wmmiRwXmMEeoXa4np_nFOxzlt4kFdqdM47QIwq71dAzhQW9psMoZd6p6yMPug\"\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the creation of authorization-related resources via `POST` requests to specific API endpoints, and these operations are expected to return an `HTTP 201 Created` status code upon successful creation.      This functionality is demonstrated through various integration tests for different API categories, including Identity Provider Management, Organization Management, and SCIM2.    \\n\\n## Implementation Details\\n\\nThe system uses RESTful APIs for managing resources, with `POST` requests typically used for creation operations.     Upon successful creation, the API returns an `HTTP 201 Created` status code and often includes a `Location` header pointing to the newly created resource.   \\n\\nFor example, in the `IdPSuccessTest.java` file, the `testAddIdPWithUserDefinedAuthenticator` method demonstrates creating an Identity Provider (IdP) using a `POST` request to the `IDP_API_BASE_PATH`.  The test asserts that the response status code is `HTTP 201 Created` and that a `Location` header is present, from which the `customIdPId` is extracted. \\n\\nSimilarly, the `OrganizationManagementSuccessTest.java` shows the creation of an organization via a `POST` request to `ORGANIZATION_MANAGEMENT_API_BASE_PATH`.  This also verifies an `HTTP 201 Created` status code and extracts the `organizationID` from the `Location` header. \\n\\nThe `scim2.yaml` OpenAPI specification also defines `POST` operations for creating `User` and `Group` resources, both of which specify a `201` response for successful creation.  \\n\\n## API Endpoints or Features\\n\\nThe system provides various API endpoints for creating resources:\\n\\n*   **Identity Provider Management**: Endpoints like `IDP_API_BASE_PATH` are used to create Identity Providers. \\n*   **Organization Management**: The `ORGANIZATION_MANAGEMENT_API_BASE_PATH` is used for creating organizations. \\n*   **SCIM2 Endpoints**: The `/scim2/Users` and `/scim2/Groups` endpoints support `POST` requests for creating users and groups, respectively.  \\n\\nThe `OAuth2RestClient` class contains methods like `createApplication` and `createV2Roles` which internally use `POST` requests to create resources and handle the `HTTP 201` response. \\n\\n## Configuration Options\\n\\nWhile specific configuration options for authorization sub-resources are not explicitly detailed in the provided snippets, the general API architecture described in the \"Server APIs\" wiki page indicates that API implementations are configured via `web.xml` and utilize various service classes and providers.  This suggests that the behavior of these endpoints, including authorization, would be managed through these configurations.\\n\\n## Documentation References\\n\\nThe \"Server APIs\" wiki page provides a comprehensive overview of the Server APIs in WSO2 Identity Server, including their purpose, scope, architecture, and categories.  It also details API implementation specifics like servlet configuration and error handling.  \\n\\n## Notes\\n\\nThe prompt specifically asks about \"authorisation sub-resource\". While the provided snippets demonstrate the creation of various resources (Identity Providers, Organizations, Users, Groups, Applications, API Resources, Authorization Details Types), the term \"authorisation sub-resource\" is not a direct code identifier. However, the `OAuth2RichAuthorizationRequestsTestCase` specifically deals with `AuthorizationDetailsType` which are added to API resources, and these operations involve `POST` requests and `HTTP 201` responses for creation.   The `addAuthorizationDetailsTypes` method in `OAuth2RestClient` uses `HttpPut` and asserts `SC_OK`, but the `testAuthorizationDetailsTypes` in `OAuth2RichAuthorizationRequestsTestCase` shows adding `AuthorizationDetailsType` and then retrieving them, implying a creation process.   The `addAPIAuthorizationToApplication` method also results in an `SC_OK` status, which is not `201 Created`. \\n\\nThe `scim2.yaml` file explicitly defines `POST` operations for creating `User` and `Group` resources that return `201 Created`.   This directly aligns with the requirement of returning `HTTP 201` for resource creation. The `OAuth2RestClient` also has a `createApplication` method that returns `201 Created`. \\n\\nWiki pages you might want to explore:\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b7c99386-97c0-48bd-abc0-b378f7631d3a\\n', 'id': 'lc_bdfdfb37-c134-4117-b593-d5163d6c660e'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_6c57241f-8abc-463c-8f05-c8ebaf9d2c09'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0055",
      "requirement": {
        "requirement_id": "ATOM_048",
        "requirement_text": "The system MUST support payment initiation transaction status 'ACTC' (AcceptedTechnicalCorrect) when PSU authentication, syntactical and semantical product checks have been successful.",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0055_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0055_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0055_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0055_4",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0055_5",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0055_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports payment initiation transaction status \\'ACTC\\' (AcceptedTechnicalCorrect) implicitly through its payment initiation API and consent management flows. The system defines various payment statuses, including \"AcceptedSettlementCompleted\", \"AcceptedSettlementInProcess\", and \"AcceptedWithoutPosting\", which align with the concept of a technically correct and accepted transaction after successful authentication and validation. \\n\\n### Implementation Details\\nThe `PaymentInitiationAPI` OpenAPI specification defines the structure for payment initiation requests and responses.  The `obWritePaymentResponse5` schema includes a `Status` field that enumerates possible payment statuses.  While \\'ACTC\\' is not explicitly listed, statuses like \"AcceptedSettlementCompleted\" and \"AcceptedWithoutPosting\" indicate a successful technical acceptance. \\n\\nThe `DefaultConsentManageValidator.java` class contains methods for validating payment initiation requests, ensuring syntactical and semantical correctness.  Specifically, `validatePaymentRequestPayload` and `validatePaymentInitiationPayload` perform checks on the request body, debtor and creditor accounts, and instructed amounts. \\n\\nThe `PaymentService.java` in the demo backend handles payment submissions and returns a response that includes the payment status.  This service is responsible for caching and returning the payment response after processing. \\n\\n### Configuration Options\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, manages the system\\'s configuration, including consent management and identity server extensions.   This configuration allows for customization of validation rules and other parameters that influence the success or failure of a payment initiation. \\n\\nThe `wso2is-7.1.0-deployment.toml` file defines various extension points for customizing consent processing and authorization flows, which can be used to integrate custom validation logic. \\n\\n### API Endpoints or Features\\nThe primary API endpoints for payment initiation are defined in `payment-initiation-openapi.yaml`. \\n*   `POST /payment-consents`: Used to create payment consents.  A successful creation returns a `201` status. \\n*   `POST /payments`: Used to create payments.  A successful payment submission also returns a `201` status. \\n*   `GET /payments/{paymentId}`: Used to retrieve the status of a payment. \\n\\nThe `EndToEndPaymentsFlowTest.groovy` integration test demonstrates the flow of payment initiation, consent authorization, and payment submission, verifying that a `201` status is returned for successful operations.  \\n\\n### Documentation References\\nThe \"Overview\" wiki page provides a high-level understanding of the WSO2 Financial Services Accelerator, mentioning its support for payment initiation and consent management.  It also details the system architecture and core components involved in processing financial transactions. \\n\\n## Notes\\nThe term \\'ACTC\\' (AcceptedTechnicalCorrect) is not explicitly used in the provided code snippets or documentation. However, the presence of various \"Accepted\" statuses within the `obWritePaymentResponse5` schema, coupled with the validation mechanisms in `DefaultConsentManageValidator`, strongly suggests that the system supports the underlying concept of a technically correct and accepted payment initiation after successful authentication and validation. The integration tests further confirm the successful processing and status updates for payment transactions.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_28ea9a98-e58b-41b1-9be9-ee9a663c0d28\\n', 'id': 'lc_0122123c-8402-437b-a6cf-9b713bcb9fa4'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0056",
      "requirement": {
        "requirement_id": "ATOM_064",
        "requirement_text": "The system MUST provide hyperlinks with semantic tags in '_links' data element to enable API steering for payment initiation and account information services.",
        "strength": "MUST",
        "capability": "General",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0056_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of hyperlinks with semantic tags in `_links` data elements within API responses, which can be used for API steering, including for services like payment initiation and account information.    This functionality is demonstrated in various API pagination scenarios and is a standard feature of the API Layer.   \\n\\n## Implementation Details\\n\\nThe `_links` data element is a common feature in API responses for pagination and navigation.    The system uses semantic tags like `next` and `previous` within these hyperlinks to indicate the relationship of the linked resource to the current resource.   \\n\\nThe `getLink` method in `OrganizationManagementSuccessTest.java` is responsible for extracting these links based on their `rel` (relation) attribute.  This method specifically looks for `LINK_REL_NEXT` and `LINK_REL_PREVIOUS` to retrieve the corresponding `href` values.  \\n\\nThe `AuthorizationDetailsType.java` file defines a model for authorization details, which includes a `type` field that can be set to values like `payment_initiation`.   This suggests that the system is designed to handle specific types of authorization flows, including those related to payment initiation. \\n\\n## Configuration Options\\n\\nThe presence of `_links` elements is a standard feature of the API Layer for paginated responses.    While there are no explicit configuration options mentioned for enabling or disabling the `_links` element itself, the pagination behavior, including the `limit` and `offset` parameters, directly influences the generation of these links.   \\n\\n## API Endpoints or Features\\n\\nThe `_links` element is a feature of various REST APIs within the `wso2/product-is` repository.    For instance, the Organization Management API uses `_links` for paginating organization lists.    Similarly, the User Discoverable Application API also includes `links` in its responses for navigation.  \\n\\nThe `AuthorizationDetailsType` class, found in `modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/rest/api/server/api/resource/v1/model/AuthorizationDetailsType.java`, explicitly defines a `type` field that can be `payment_initiation`.  This indicates that the API is designed to handle authorization details specifically for payment initiation services. \\n\\n## Documentation References\\n\\nThe \"API Layer\" wiki page provides a general overview of the API architecture, including advanced features like pagination, which inherently involves the use of `_links`. <wiki_page repo_name=\"wso2/product-is\" id=\"4\" page_name=\"API Layer\" /> The \"Organization Management\" wiki page also details the Organization Management API, which utilizes `_links` for pagination. <wiki_page repo_name=\"wso2/product-is\" id=\"3.4\" page_name=\"Organization Management\" />\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, specifically `OrganizationManagementSuccessTest.java`    and `UserDiscoverableApplicationSuccessTest.java` . These tests confirm the presence and correct behavior of `_links` elements in API responses for pagination. The `AuthorizationDetailsType.java`  file directly addresses the \"payment initiation\" aspect of the query by defining a type for it. While the snippets demonstrate the existence of `_links` with semantic tags and the capability for payment initiation services, they do not provide explicit configuration files or detailed documentation on how to enable or configure these features beyond what is implied by the API structure.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4ed0a92f-3ca1-49c0-944d-e144bc2a8000\\n', 'id': 'lc_74b7e27a-7b12-4ffd-8ad2-d6879a05829c'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0056_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to have some support for handling hyperlinks and links within its registry system, but there is no direct evidence in the provided snippets of an explicit `_links` data element with semantic tags for API steering in payment initiation or account information services.    \\n\\n### Implementation Details\\n\\nThe system includes handlers for processing different types of links within its registry. The `ExternalLinkHandler` is configured to process resources with the media type `application/vnd.wso2-hyperlink` . Similarly, a `SmartLifecycleLinkHandler` is present for `application/vnd.wso2-smart-link` media types, indicating support for links related to resource lifecycles . These handlers are defined in `registry.xml` files across different modules, such as `all-in-one-apim`  and `api-control-plane` .\\n\\nThe `APIList` definition in `publisher-api.yaml` includes `next` and `previous` fields, which are described as \"Link to the next subset of resources qualified\" and \"Link to the previous subset of resources qualified\" respectively . These are examples of hyperlinks for navigation within API resource lists.\\n\\n### Configuration Options\\n\\nThe `registry.xml` files configure handlers for different media types related to links. For instance, the `ExternalLinkHandler` is activated for resources with `mediaType` set to `application/vnd.wso2-hyperlink` . This suggests that the system can be configured to recognize and process specific types of hyperlinks based on their media types.\\n\\n### API Endpoints or Features\\n\\nThe `publisher-api.yaml` defines API endpoints for managing tiers, including operations like updating a tier  and updating tier permissions . While these APIs handle resources, the responses shown in the examples do not explicitly contain a `_links` element with semantic tags for workflow navigation related to payment initiation or account information services  . However, the `APIList` definition does include `next` and `previous` links for pagination .\\n\\n### Documentation References\\n\\nThe `README.md` files in `all-in-one-apim/modules/integration/tests-common/clients/store/`  and `all-in-one-apim/sample-scenarios/clients/store/`  provide documentation for API endpoints and models. These documents list various API operations, such as `apisGet` for retrieving APIs  and `applicationsPost` for creating applications . While these documents describe API functionality, they do not specifically mention the `_links` data element with semantic tags for API steering in payment initiation or account information services.\\n\\n## Notes\\n\\nThe provided code snippets indicate that the `wso2/product-apim` repository has a mechanism for handling various types of links and hyperlinks within its registry and API definitions. However, there is no explicit mention or implementation of a `_links` data element with semantic tags specifically for API steering in payment initiation and account information services, as requested in the prompt. The existing link handling appears to be more general (e.g., lifecycle links, external links, pagination links) rather than domain-specific for financial services workflow navigation. Therefore, based on the provided context, it cannot be confirmed that the system *MUST* provide such a feature.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ffb985f9-0df7-4cd9-97c6-172e92d0c1b5\\n', 'id': 'lc_bd51b7ff-b62f-4c7f-b8e2-ac6a165c7e04'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0057",
      "requirement": {
        "requirement_id": "ATOM_116",
        "requirement_text": "The response body for HTTP code 202 SHALL include transactionStatus as mandatory field",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0057_1",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0057_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0057_3",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0057_4",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0057_5",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0057_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, specifically the WSO2 Financial Services Accelerator, does not explicitly support the requirement for HTTP 202 responses to include a `transactionStatus` field as mandatory. The OpenAPI specification for Payment Initiation APIs defines a `Status` field within the `obWritePaymentResponse5` schema for HTTP 200 responses, but there is no direct mention or schema definition for a `transactionStatus` field in HTTP 202 responses. \\n\\n## Implementation Details\\n\\nThe `financial-services-accelerator` repository includes OpenAPI specifications for various APIs, such as Payment Initiation.  The `payment-initiation-openapi.yaml` file defines the `obWritePaymentResponse5` schema, which is used for successful payment responses (HTTP 200 and 201).  This schema includes a `Status` field, which specifies the status of the payment information group.  The possible values for this `Status` field are \"AcceptedCreditSettlementCompleted\", \"AcceptedSettlementCompleted\", \"AcceptedSettlementInProcess\", \"AcceptedWithoutPosting\", \"Pending\", and \"Rejected\". \\n\\nWhile the `ResponseStatus` enum in `ResponseStatus.java` defines `ACCEPTED` for HTTP 202, there is no corresponding schema in the provided OpenAPI definitions that explicitly mandates a `transactionStatus` field for HTTP 202 responses.  The OpenAPI specification primarily details responses for HTTP 200 and 201 for payment creation and retrieval. \\n\\n## Configuration Options\\n\\nThe configuration files, such as `wso2is-7.0.0-deployment.toml` and `wso2is-7.1.0-deployment.toml`, primarily deal with Identity Server deployment, database configurations, and extension points.   These files do not contain specific configurations related to the structure of HTTP 202 response bodies or the mandatory inclusion of a `transactionStatus` field.  \\n\\n## API Endpoints or Features\\n\\nThe API specifications define endpoints for Payment Initiation and Confirmation of Funds.   For Payment Initiation, the `obWritePaymentResponse5` schema is used for responses to payment creation and retrieval, which includes a `Status` field.  However, there is no explicit definition for a 202 Accepted response body that mandates a `transactionStatus` field in the provided API specifications. \\n\\n## Documentation References\\n\\nThe provided wiki page \"Overview\" describes the WSO2 Financial Services Accelerator and its components, including API specifications.  It mentions that the accelerator implements standard Open Banking APIs for payments.  While the `ResponseStatus` enum in `ResponseStatus.java` lists `ACCEPTED` (202 HTTP code), the OpenAPI definitions do not specify a `transactionStatus` field as mandatory for HTTP 202 responses. \\n\\n## Notes\\n\\nThe `Status` field in `obWritePaymentResponse5`  appears to serve a similar purpose to `transactionStatus`. However, this is defined for HTTP 200/201 responses, not specifically for HTTP 202.  To meet the requirement of a mandatory `transactionStatus` field for HTTP 202, modifications to the OpenAPI specification would be necessary to define a schema for 202 responses that includes this field. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_76fd6d65-dd57-4a8a-9645-6fde162062f6\\n', 'id': 'lc_638d16f7-615d-4a5e-92ab-d85c0b20ecaf'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0058",
      "requirement": {
        "requirement_id": "ATOM_134",
        "requirement_text": "The system SHALL support multi-currency accounts by setting currency code to 'XXX' for aggregated account views",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0058_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_2",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_3",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_4",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_5",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports multi-currency accounts, and the currency code is returned in the account details response. The system does not explicitly set the currency code to \\'XXX\\' for aggregated account views; instead, it returns the actual currency code, such as \\'GBP\\'     . The API specifications define a `Currency` field that expects a 3-letter uppercase alphabetic code as per ISO 4217 .\\n\\n## Implementation Details\\n\\nThe `AccountService.java` file in the `org.wso2.financial.services.accelerator.demo.backend` component provides a demo implementation for retrieving account details . This service includes methods like `getAccounts` and `getOneAccount` that return hardcoded JSON responses containing account information  . In these responses, the `Currency` field is set to \"GBP\"   .\\n\\n## API Endpoints and Features\\n\\nThe `account-info-swagger.yaml` file defines the OpenAPI specification for the Account Information APIs .\\nThe `/accounts` endpoint, specifically the `GET /accounts` operation, is used to retrieve account details .\\nThe `OBAccount4` schema, which is used in the response for account details, includes a `Currency` field . This `Currency` field references `ActiveOrHistoricCurrencyCode`, which is described as the \"Identification of the currency in which the account is held\" and expects a 3-letter uppercase alphabetic code .\\n\\nSimilarly, for balances and transactions, the `OBReadBalance1` and `OBReadTransaction5` schemas also include `Currency` fields within their respective `Amount` objects, also referencing `ActiveOrHistoricCurrencyCode`    .\\n\\n## Configuration Options\\n\\nThe provided codebase context does not explicitly show configuration options to set a default currency code like \\'XXX\\' for aggregated account views. The `financial-services.xml` file and `FinancialServicesConfigParser` are mentioned for configuration management  (from wiki page \"Overview\"), but no specific currency aggregation settings are detailed in the provided snippets.\\n\\n## Documentation References\\n\\nThe OpenAPI specifications in `account-info-swagger.yaml` , `funds-confirmation-openapi.yaml` , and `payment-initiation-openapi.yaml`  define the structure and expected values for currency codes, adhering to ISO 4217 standards   .\\n\\n## Notes\\n\\nThe current implementation returns specific currency codes (e.g., \"GBP\") rather than a generic \"XXX\" for aggregated views . If the requirement is to explicitly return \\'XXX\\' for aggregated views, this would require a modification to the backend service logic that constructs the response, or potentially an API Gateway transformation layer if such a feature is available and configured. The provided snippets do not indicate a mechanism to configure \\'XXX\\' as an aggregated currency code.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f18d2aad-5bfe-4fc8-ba37-3686a75f7179\\n', 'id': 'lc_9e0a90e7-ccc3-48e2-b7b7-9408d513d354'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0059",
      "requirement": {
        "requirement_id": "ATOM_174",
        "requirement_text": "The system SHALL return mandatory scaStatus and authorisationId in authorisation creation response",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0059_1",
          "text": "## Persist\n\nThe second extension point of the Consent Authorize component is the Persist Flow. The Persistent functionality is engaged once the \nuser approves/denies the consent via an API invocation made from the consent page. When the `/persist` endpoint is \ninvoked, the OpenAPI extension implementation to persist are also invoked and the data required for persistence will be provided from the extension point.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_2",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_3",
          "text": "6. After the user approves/denies the consent and selects the accounts, a `PATCH authorize/persist` request is made to persist the consent information. 7. Finally, if the persistence is successful, to complete the flow the `/authorize` endpoint is invoked. This results in a redirection to the callback URL of the API consumer application, which is deep linked to the API consumer application. Therefore, the customer is redirected to the mobile application of the API consumer.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_4",
          "text": "## Validate Authorize Request\n\nThe OpenAPI extension for validate client sending authorize API requests to ensure request parameters are according to  the way\nallowed in the Open Banking  specificatio requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_5",
          "text": "### publishUserAccessTokenData method\n\nThis method lets  you add a data publishing logic. Given below is the method signature.\n\n``` java\npublic void publishUserAccessTokenData(OAuth2AccessTokenRespDTO oAuth2AccessTokenRespDTO);\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support \"Rich Authorization Requests\" (RAR) which involve authorization details types, but there is no direct evidence in the provided snippets that it specifically returns `scaStatus` and `authorisationId` in an \"authorisation creation response\" as mandatory fields. The snippets primarily focus on the management and authorization of API resources with associated authorization details types.   \\n\\n### Implementation Details\\n\\nThe system handles \"Rich Authorization Requests\" by allowing the definition and association of `authorizationDetailsTypes` with API resources.  These types are then used when authorizing an application to access an API resource. \\n\\nThe `AuthorizedAPICreationModel` class is used to define the API resource ID, policy identifier, and a list of `authorizationDetailsTypes` when creating an authorization for an application.  The `OAuth2RestClient` provides methods to `addAPIAuthorizationToApplication` which takes an `applicationId` and an `AuthorizedAPICreationModel`. \\n\\n### API Endpoints or Features\\n\\nThe system exposes API endpoints for managing API resources and their authorizations. \\n\\n*   **Creating API Resources**: The `createTestAPIResource` method in `RichAuthorizationRequestsUtils` demonstrates how to create an API resource with `authorizationDetailsTypes`. \\n*   **Authorizing API Resources to Applications**: The `addAPIAuthorizationToApplication` method in `OAuth2RestClient` is used to authorize an API resource to a specific application.  This method takes an `applicationId` and an `AuthorizedAPICreationModel`. \\n*   **Retrieving Authorized API Resources**: The `getAPIAuthorizationsFromApplication` method in `OAuth2RestClient` can retrieve the authorized API resources for an application, which includes their `AuthorizedAuthorizationDetailsTypes`. \\n\\n### Configuration Options\\n\\nThe `policyIdentifier` field within `AuthorizedAPICreationModel` suggests that different authorization policies can be configured, with \"RBAC\" being an example. \\n\\n### Documentation References\\n\\nThe wiki page \"Features and Capabilities\" mentions \"Rich Authorization Requests\" as an advanced OAuth feature, confirming its support within WSO2 Identity Server. \\n\\n## Notes\\n\\nThe provided code snippets and wiki page do not contain any direct references to `scaStatus` or `authorisationId` being returned in an authorization creation response. The term \"authorisation\" in the prompt seems to align with the concept of \"API authorization\" in the codebase, where applications are authorized to access API resources.  However, the specific fields requested (`scaStatus` and `authorisationId`) are not present in the `AuthorizedAPICreationModel` or the `AuthorizedAPIResponse` objects shown.   It is possible these fields are handled at a different layer or are part of a different API not covered by the provided snippets.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ac2c78e3-d2e1-429b-92e6-24d7d8277743\\n', 'id': 'lc_1c7052bc-ca16-49e2-883e-a32a4f9e05ac'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_ebaf6552-c5dd-45cd-875a-7cdda84f8a6d'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0060",
      "requirement": {
        "requirement_id": "ATOM_115",
        "requirement_text": "For multilevel SCA payments, the API SHALL require explicit start of authorization and not contain direct SCA processing links in payment initiation response",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0060_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_2",
          "text": "reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank. In this web application, the customer: - Logs in using the login credentials. - Views information that the API consumer requested to access. - Selects the accounts that the API consumer can access. - Provides consent to the API consumer to access the information. ###Identifier-first authenticator Banks use Identifier-first authentication to authenticate the user with a second-factor authenticator instead of a password. The user who logs into the authorization web application, can provide the username, and authenticate using a second-factor authentication mechanism such as SMS-OTP/TOTP.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_3",
          "text": "## Writing a custom Gateway Executor\n\nThe WSO2 Open Banking Accelerator contains extension points known as Open Banking Executors that can validate and \nmanipulate API requests. The executors can mediate and enforce different policies based on regulatory and other \nrequirements. You can use the executors to perform the following: \n\n- Intercept requests and responses before and after API authentication \n- Modify request/response headers and payloads\n- Configure custom error messages\n- Add custom attributes. For example, data reporting  \n\nFor the executors, you can configure context attributes (for example, consent ID) provided by swagger definitions. \nThese context attributes are shared through a particular request/response flow. You can also define the order of \nexecution by the flow. \n\nTo build your own executor, implement the following interface:\n\n``` java\ncom.wso2.openbanking.accelerator.gateway.executor.core.OpenBankingGatewayExecutor\n```\n\n!!! note\n    The `com.wso2.openbanking.accelerator.gateway-3.0.0.jar` JAR file inside the \n    `<APIM_HOME>/repository/components/dropins` directory contains all the Java implementations related to gateway \n    executors.\n\nUse the following data model and implement the interface methods according to your requirements:",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_4",
          "text": "## Open Banking API Calls\n\n- Now you can invoke the aggregator gateway using the access token generated above.\n- The aggregator should validate the access token and the consent to verify whether the consent allows the requested \n  resource. \n- Then this request is forwarded to the relevant bank (ABC Bank/DCB Bank) with a different access token that the \n  aggregator obtained during the authorization flow.\n- A sample request is as follows:\n    ```\n    curl --location --request GET 'https://localhost:8243/open-banking/v3.1/aisp/accounts/1234' \\\n    --header 'Authorization: Bearer eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJhYmN1c2VyQGNhcmJvbi5zdXBlciIsImF1dCI6IkFQUExJQ0FUSU9OX1VTRVIiLCJiYW5rX2NvZGUiOiIwMDEiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0Ojk0NDZcL29hdXRoMlwvdG9rZW4iLCJhY2Nlc3NfdG9rZW4iOiJiZTQzOGI1YS03NzQ3LTM1OGYtOWM5Yi1mNjU3YjJiZmFlZDUiLCJhdWQiOiIxcmhFamZpUFcxOW1Sd0dCZVpWYmxZdktuVGdhIiwibmJmIjoxNjUzNDgyNzkwLCJhenAiOiIxcmhFamZpUFcxOW1Sd0dCZVpWYmxZdktuVGdhIiwic2NvcGUiOiJhY2NvdW50cyBvcGVuaWQiLCJjbmYiOnsieDV0I1MyNTYiOiIyaHlmMEF0a2Q2Rmo0cnpuLXZzRDdHT244aUtnY2JiSEpVSlhMbG1yMUlzIn0sImV4cCI6MTY1MzQ4NjM5MCwiaWF0IjoxNjUzNDgyNzkwLCJqdGkiOiJhYzk5NTUxYy0wNWE4LTQzY2MtYTQ4MC05ODVkMmQxNjJlMWMiLCJjb25zZW50X2lkIjoiYzI2Mzk2OWEtMDlmNC00Y2MwLTlhMTctZjlkMWY2NGI2NWIwIn0.nLU8J1JrPbVmAs66zSAeThrRiiWnKBHYt_3dZwdgPSKxBtMAsM7-h8PeGSwi1uIwc4f7XqVjQeZjQtO6Uj0Us5iYqBb8CBmJHK8d2IZfJqWeq8N23yqj14Y43AMmJqy7pGSebaeNclwbwqdq22SJX-x4GdSPLffD8U2F5anCkUeyae4R4kq1JAs4BctSzjs5MXIjSf3_UsSFwDqOCoH0dagEFkAvYc2r1_NzJeKsXw3shTh8a1LXdHLT2Qq8mbgTIpcJlmzcwvSKWo1F6kT1FK1-jNmuiH9xYMkm1AZ8g0iTubnyuMZq7Wr_7s3vsmRDiklNTZjf60blm3KFAYdKiQ'\n    ```\n- If the access token is valid and the consent allows this request, the aggregator will send you a JSON response as follows.\n  This response originated from a mock bank back end configured during [setting up the aggregator](regulatory-aggregator-try-out.md).\n    ```\n    {\n       \"Data\":{\n          \"Account\":[\n             {\n                \"AccountId\":\"1234\",\n                \"Status\":\"Enabled\",\n                \"StatusUpdateDateTime\":\"2020-04-16T06:06:06+00:00\",\n                \"Currency\":\"GBP\",\n                \"AccountType\":\"Personal\",\n                \"AccountSubType\":\"CurrentAccount\",\n                \"Nickname\":\"Bills\",\n                \"Account\":[\n                   {\n                      \"SchemeName\":\"SortCodeAccountNumber\",\n                      \"Identification\":\"1234\",\n                      \"Name\":\"Alex\",\n                      \"SecondaryIdentification\":\"00021\"\n                   }\n                ]\n             }\n          ]\n       },\n       \"Links\":{\n          \"Self\":\"https://api.alphabank.com/open-banking/v3.0/accounts/1234\"\n       },\n       \"Meta\":{\n          \"TotalPages\":1\n       }\n    }\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_5",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n```\ncurl --location --request POST 'https://localhost:8243/open-banking/v3.1/aisp/account-access-consents' \\\n--header 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n--header 'x-fapi-financial-id: open-bank' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n    \"Data\": {\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\"\n    },\n    \"Risk\": {\n        \n    }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"StatusUpdateDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\",\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"a34c8608-dbd2-4997-aad7-398a5b31cbe6\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0061",
      "requirement": {
        "requirement_id": "ATOM_011",
        "requirement_text": "Electronic signatures SHALL be included in HTTP header as defined by signHTTP specification chapter 4.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0061_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_2",
          "text": "A pushed authorization request contains authentication and authorization request parameters, which will be used in the Pushed Authorization endpoint of WSO2 Open Banking Accelerator. The Pushed Authorization endpoint returns a `request_uri` with an expiration time as a reference to the details sent in the pushed authorization request. ##Default Pushed Authorization Request validations The Pushed Auth Request Validator uses the existing validation layer of WSO2 Open Banking Accelerator to enforce validations. By default, the following validations are available in the validation layer: - Repeated parameter validation for all parameters: checks the pushed authorization request body for any repeated parameters When the `request` parameter is available: !!! note The `request` parameter value which will be referred to as `request object` from here onwards should be a Signed JWT(JWS) or an Encrypted JWT(JWE). It can be signed and encrypted as well. In this scenario, it must be signed before being encrypted. - Validation of form body parameters - verifies that only client authentication parameters (such as `client_id`, `client_assertion`, `client_assertion_type`) are present in the request form body. Other parameters must be included in the request object. - Validation of client id - validates the `client id` claim of the request object. - Validation of redirect URI - validates the redirect URI to check whether it matches with the registered redirect URIs. - Validation of request object signature algorithm - checks if the correct signing algorithm is used. - Validation of request object signature - verifies the signature of the request object. - Validation of the nonce claim - checks whether the nonce claim is available for response types requesting `id_token`. - Validation of the scope claim - checks whether the scope claim contains scopes that are registered with the client application. - Validation of the audience claim - checks if the audience claim matches the token endpoint URL. - Validation of the issuer claim - checks whether the issuer claim matches the client_id. - Validation of invalid claims in request object - check whether the `request` and `request_uri` claims are present in the request object. ##Writing a Custom Pushed Auth Request Validator You can extend the default validations in WSO2 Open Banking Accelerator and add more validations according to your open banking requirements: - To implement a custom Pushed Auth Request validator, extend the following class: ``` java com.wso2.openbanking.accelerator.identity.push.auth.extension.request.validator.PushAuthRequestValidator ``` Given below is a brief explanation of the methods you need to implement. ###validateAdditionalParams method This method performs the additional validations you add. Given below is the method signature: ``` java public void validateAdditionalParams(Map<String, Object> parameters) throws PushAuthRequestValidatorException ``` Input parameters - `Map<String, Object> parameters` - contains pushed authorization request parameters obtained from the HTTP servlet request Output parameter - `void` !!! note When a valid request object is present as a request parameter, the default implementation of the accelerator decodes the request object JWT and adds the following parameters to the Map<String, Object> parameters map. 1. Key - `\"decodedJWTBody\"`, Value - `<decoded request object JWT body>` 2. Key - `\"decodedJWTHeader\"`, Value - `<decoded request object JWT header>` For example: - Extend the `PushAuthRequestValidator` class and",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_3",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_4",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_5",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, primarily focuses on OAuth2 and OpenID Connect (OIDC) implementations, including various grant types, token handling, and conformance with standards like FAPI . While the codebase demonstrates robust support for digital signatures within SAML and OAuth2 request objects, there is no direct evidence or explicit mention of support for electronic signatures in HTTP headers as defined by the `signHTTP` specification chapter 4. \\n\\n### Implementation Details\\nThe codebase extensively uses digital signatures for various security mechanisms, particularly within SAML assertions and OAuth2 request objects. For instance, SAML responses and assertions can be signed and validated. The `SAML2SSOTestBase.java` file contains methods like `setSignature` for adding signatures to SAML POST requests and `validateSAMLResponseSignature` and `validateSAMLAssertionSignature` for validating signatures on SAML responses and assertions respectively   . These methods utilize `XMLSignature` and `SignatureValidator` for cryptographic operations  .\\n\\nSimilarly, for OAuth2, the `OAuth2RequestObjectSignatureValidationTestCase.java` demonstrates the enforcement and validation of signed request objects . The `oidcInboundConfig.setValidateRequestObjectSignature(true)`  setting enables this validation, and tests are performed to ensure that unsigned or invalidly signed request objects are rejected  . The `buildSignedJWT` method is used to create signed JWTs for these tests .\\n\\nHowever, these implementations are specific to SAML messages and OAuth2 request objects, not general HTTP headers as per the `signHTTP` specification. <cite/>\\n\\n### Configuration Options\\nFor SAML, signing of responses and assertions can be configured. For example, `SAML2.EnableResponseSigning` and `SAML2.EnableAssertionSigning` properties in `travelocity.properties` files control whether SAML responses and assertions are signed  . The `SAMLDefaultSigningAlgorithmURI` and `SAMLDefaultDigestAlgorithmURI` in `IDENTITY6777-identity.xml` define the default algorithms used for SAML signing .\\n\\nFor OAuth2, the `request_object_signing_alg` and `require_signed_request_object` parameters in `oidc-fapi-conformance-tests/constants_fapi.py` indicate configuration options related to signing OAuth2 request objects . The `requestObjectSignatureValidationEnabled` property in `TestServer.xml` also shows a configuration for enabling or disabling request object signature validation .\\n\\nThere are no configuration options found that directly relate to signing arbitrary HTTP headers according to the `signHTTP` specification. <cite/>\\n\\n### API Endpoints or Features\\nThe codebase includes various OAuth2/OIDC endpoints such as `/oauth2/authorize`, `/oauth2/token`, `/oauth2/revoke`, `/oauth2/userinfo`, and `/oauth2/jwks` . The `OAuth2DPopTestCase.java` file shows an example of sending a Push Authorization Request (PAR) with a DPoP proof thumbprint, which is a form of token binding for enhanced security  . While DPoP involves cryptographic proofs in HTTP headers, it is a specific mechanism for OAuth2 token binding and not a general implementation of `signHTTP` for arbitrary HTTP headers. \\n\\n### Documentation References\\nThe provided wiki page \"OAuth2 and OpenID Connect\" details the implementation of OAuth2 and OIDC, including token management and standards compliance like FAPI conformance . It mentions DPoP tokens as a type of access token and token binding mechanism  . However, there are no specific documentation references within the provided context that describe support for the `signHTTP` specification chapter 4 for electronic signatures in HTTP headers. <cite/>\\n\\n## Notes\\nThe query specifically asks about \"electronic signatures SHALL be included in HTTP header as defined by signHTTP specification chapter 4\". While the codebase demonstrates strong capabilities in digital signatures for SAML and OAuth2 request objects (e.g., JWTs), and DPoP tokens which involve cryptographic proofs in HTTP headers, these are distinct from a general implementation of the `signHTTP` specification for arbitrary HTTP headers. The existing signature mechanisms are tied to specific protocol elements (SAML messages, OAuth2 request objects, DPoP tokens) rather than a generic HTTP header signing as implied by the `signHTTP` specification. Therefore, based on the provided codebase context, there is no direct evidence of support for the `signHTTP` specification chapter 4. <cite/>\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_afe52805-e54e-415a-9697-e62c65c81b37\\n', 'id': 'lc_b544788c-389a-4fc9-aed3-c19f6c065892'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_920da90f-2bf4-4fd5-9874-f96556db51c6'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0062",
      "requirement": {
        "requirement_id": "ATOM_175",
        "requirement_text": "The system SHALL include ASPSP-SCA-Approach header conditionally in authorisation responses with values EMBEDDED, DECOUPLED, or REDIRECT",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0062_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_2",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_3",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_4",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_5",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, does not appear to directly support the `ASPSP-SCA-Approach` header in authorization responses with values like `EMBEDDED`, `DECOUPLED`, or `REDIRECT` based on the provided code snippets and wiki page. <cite/> The provided context primarily focuses on application management, OAuth2/OIDC configurations, and DPoP (Demonstrating Proof-of-Possession) related functionalities.    The `ASPSP-SCA-Approach` header is typically associated with Open Banking APIs and Strong Customer Authentication (SCA) flows, which are not explicitly mentioned or implemented in the given snippets. <cite/>\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThe provided code snippets and wiki page do not contain any direct references to the `ASPSP-SCA-Approach` header or its associated values (`EMBEDDED`, `DECOUPLED`, `REDIRECT`). <cite/>\\n\\nThe `OAuth2DPopTestCase.java` file, for instance, demonstrates DPoP token generation and usage in authorization and access token requests, but it does not interact with any `ASPSP-SCA-Approach` header.  Similarly, `OAuth2RestClient.java` handles OAuth2 flows, including obtaining authorization codes and access tokens, but lacks any mention of SCA-related headers.  The `Application Management` wiki page details various configurations for applications, including OAuth2/OIDC settings, but does not include any options for configuring `ASPSP-SCA-Approach` headers. <cite/>\\n\\n## Documentation References\\n\\nThere are no documentation references within the provided context that mention the `ASPSP-SCA-Approach` header. <cite/> The wiki page covers general application management and OAuth2/OIDC configurations, but not specific Open Banking or SCA-related headers. <cite/>\\n\\n## Notes\\n\\nThe `ASPSP-SCA-Approach` header is a specific requirement often found in Open Banking specifications for Strong Customer Authentication. <cite/> While WSO2 Identity Server, as a comprehensive identity and access management solution, might support Open Banking features through other modules or extensions, the provided snippets from the `wso2/product-is` repository do not show direct evidence of this specific header's implementation. <cite/> It's possible that this functionality resides in a different part of the codebase or is implemented as a separate feature not covered by the provided context. <cite/>\\n\\nWiki pages you might want to explore:\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_5921fe05-3dab-4e19-a148-7d6be27bbda9\\n\", 'id': 'lc_f48fe5ec-ccaa-4a9d-971b-ef58ecf27f30'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_ade59015-cece-4983-a65b-e49ba3f838e3'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0063",
      "requirement": {
        "requirement_id": "ATOM_026",
        "requirement_text": "TPPs SHALL be identified using PSD2 related eIDAS certificates as specified in ETSI PSD2 standards",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0063_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the identification of Third-Party Providers (TPPs) using eIDAS certificates, specifically for Financial-grade API (FAPI) security, which aligns with PSD2 requirements. The system allows for the configuration of certificates and JWKS URIs for Identity Providers (IdPs), which can represent TPPs.\\n\\n### Implementation Details\\nThe `wso2/product-is` repository includes features for configuring certificates and JSON Web Key Sets (JWKS) URIs for Identity Providers . The `IdentityProviderPOSTRequest.Certificate` class contains fields for `certificates` (a list of strings representing certificates) and `jwksUri` . This indicates that the system can store and utilize both direct certificate values and references to JWKS endpoints for IdP authentication.\\n\\nThe system also supports Financial-grade API (FAPI) security <cite repo=\"wso2/product-is\" path=\"wso2/product-is/wiki/Features-and-Capabilities\" start=\"1.2\" end=\"1.2\" />. FAPI is a set of profiles of OAuth 2.0 and OpenID Connect that are designed to provide more stringent security for financial services, which is relevant to PSD2 requirements. The `oidc-fapi-conformance-tests/constants_fapi.py` file contains configurations for FAPI conformance tests, including settings for `tls_client_certificate_bound_access_tokens`  and `token_endpoint_auth_method` as `tls_client_auth` . This suggests support for Mutual TLS (mTLS) for client authentication, which is a common mechanism for certificate-based authentication in PSD2.\\n\\n### Configuration Options\\nYou can configure certificates and JWKS URIs for Identity Providers through the Identity Provider management APIs. The `IdPSuccessTest.java` file demonstrates how to add and remove JWKS URIs and certificates for an Identity Provider using PATCH operations . Specifically, the `patch-add-jwks-uri.json` and `patch-add-certificate.json` resources are used to add these configurations .\\n\\nThe `DCR_BODY` constant in `oidc-fapi-conformance-tests/constants_fapi.py` shows configuration options for Dynamic Client Registration (DCR) that are relevant to FAPI and PSD2, such as `tls_client_certificate_bound_access_tokens` . This indicates that client applications (TPPs) can be registered with the requirement to use TLS client certificates for token binding.\\n\\n### API Endpoints or Features\\nThe Identity Provider management API provides endpoints to manage IdP configurations, including certificate and JWKS URI settings. The `IdPSuccessTest.java` file shows the use of `IDP_API_BASE_PATH` for interacting with these APIs . Specifically, PATCH requests are made to update certificate and JWKS URI properties of an IdP .\\n\\nThe system also supports OAuth 2.0 and OpenID Connect protocols with advanced features like Proof of Possession (DPoP) and JWT Access Tokens, which are crucial for FAPI and PSD2 compliance <cite repo=\"wso2/product-is\" path=\"wso2/product-is/wiki/Features-and-Capabilities\" start=\"1.2\" end=\"1.2\" />. The `token_endpoint_auth_method` can be set to `tls_client_auth` for client authentication using TLS client certificates .\\n\\n### Documentation References\\nThe \"Features and Capabilities\" wiki page for `wso2/product-is` mentions support for Financial-grade API (FAPI) <cite repo=\"wso2/product-is\" path=\"wso2/product-is/wiki/Features-and-Capabilities\" start=\"1.2\" end=\"1.2\" />. This section also highlights advanced OAuth features like JWT Access Tokens and DPoP, which are relevant to the security requirements of PSD2 and eIDAS certificates <cite repo=\"wso2/product-is\" path=\"wso2/product-is/wiki/Features-and-Capabilities\" start=\"1.2\" end=\"1.2\" />.\\n\\n## Notes\\nThe provided context strongly suggests that `wso2/product-is` supports TPP identification using eIDAS certificates through its FAPI compliance and the ability to configure client certificates and JWKS URIs for Identity Providers. While the term \"eIDAS\" is not explicitly mentioned in the code snippets, the support for FAPI, TLS client authentication, and certificate management aligns with the technical requirements for eIDAS QWAC and QSEAL certificates in ETSI PSD2 standards. The `org.wso2.carbon.extension.identity.authenticator.outbound.x509Certificate` dependency in `pom.xml`  also indicates a general capability for X.509 certificate authentication, which would be the underlying technology for eIDAS certificates.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_5fb80428-e529-4d1a-b56f-cf0a5c41c781\\n', 'id': 'lc_07e94bb5-d5e5-45f9-8f95-3ba4a726d018'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0063_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to have some capabilities related to certificate management, which might be relevant to the identification of TPPs using eIDAS certificates. However, there is no explicit mention or direct implementation of PSD2, eIDAS, QWAC, or QSEAL certificates within the provided code snippets.   \\n\\n## Implementation Details\\n\\nThe codebase includes functionality for managing endpoint certificates. The `EndpointCertificatesApi` in the publisher client provides operations to retrieve and search uploaded certificates.  The `getEndpointCertificates` method allows searching for certificates by `limit`, `offset`, `alias`, and `endpoint`. \\n\\nThere are also integration tests, such as `APIEndpointCertificateTestCase`, that demonstrate the uploading and searching of endpoint certificates.  These tests verify that certificate information, including subject, version, and validity, can be retrieved. \\n\\nAdditionally, the `JWTGrantTestCase` and `ExternalIDPJWTTestCase` show how JWT tokens are signed and validated using certificates from keystores.   Specifically, the `addIdentityProvider` method in `JWTGrantTestCase` demonstrates adding an identity provider with a public certificate. \\n\\n## Configuration Options\\n\\nThe `listenerprofiles.xml.j2` file indicates that keystores and truststores are configurable for SSL profiles.  This includes specifying the location, type, and passwords for the keystore and truststore.  The `SSLVerifyClient` parameter suggests that client certificate verification can be enabled. \\n\\nThe `automationXMLSchema.xsd` files define the structure for configuring truststores, including `fileName`, `type`, and `password`. \\n\\n## API Endpoints or Features\\n\\nThe `EndpointCertificatesApi` provides the following endpoints:\\n*   `getEndpointCertificateContentByAlias`: Retrieves the content of an endpoint certificate by its alias. \\n*   `getEndpointCertificates`: Retrieves and searches uploaded certificates based on `limit`, `offset`, `alias`, and `endpoint`. \\n\\nThe `GatewayPoliciesApi` is also present, which deals with engaging gateway policies to request, response, and fault flows.  While not directly related to certificate identification, it represents a point where custom policies could potentially be applied for certificate validation. \\n\\n## Documentation References\\n\\nThe provided snippets are primarily API documentation and integration tests. The `EndpointCertificatesApi.md` file serves as documentation for the certificate management API. \\n\\n## Notes\\n\\nWhile the repository demonstrates robust certificate management capabilities, including uploading, retrieving, and using certificates for JWT validation, there is no explicit mention of PSD2, eIDAS, QWAC, or QSEAL certificates.   The existing certificate infrastructure could potentially be extended or configured to support these specific types of certificates, but the current codebase does not provide direct evidence of such support. The `SSLVerifyClient` configuration suggests that mutual TLS could be enabled, which is a prerequisite for client certificate-based identification, but the specific eIDAS compliance would likely require additional implementation or configuration beyond what is shown. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_43be87e2-5771-4178-ab35-252f7d47ba6c\\n', 'id': 'lc_6cb33a6c-6d4b-4bdc-9788-044908f64599'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0064",
      "requirement": {
        "requirement_id": "ATOM_102",
        "requirement_text": "Payment status response SHALL include fundsAvailable field when funds check was performed and transaction status is ACTC, ACWC, or ACCP",
        "strength": "SHALL",
        "capability": "Funds Confirmation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0064_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase context, there is no information or code that directly supports the requirement for a payment status response to include a `fundsAvailable` field when a funds check was performed and the transaction status is `ACTC`, `ACWC`, or `ACCP` <cite />. The codebase primarily deals with identity and access management functionalities such as Organization Management, SAML and Identity Federation, OAuth2, and Passive STS   .\\n\\nThe provided snippets and wiki pages do not contain any references to payment processing, financial transactions, `fundsAvailable` fields, or the specific transaction statuses mentioned (`ACTC`, `ACWC`, `ACCP`) <cite />. Therefore, I cannot provide implementation details, configuration options, API endpoints, or documentation references related to this specific payment status requirement within this repository <cite />.\\n\\n## Notes\\nThe provided codebase context focuses on identity and access management features of WSO2 Identity Server <cite />. While there are mentions of various APIs and configurations, they are all within the scope of user authentication, authorization, and organization management . There is no indication of any payment gateway integration or financial transaction processing capabilities <cite />.\\n\\nWiki pages you might want to explore:\\n- [SAML and Identity Federation (wso2/product-is)](/wiki/wso2/product-is#3.2)\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_13e66b54-6453-43b7-880d-73088958da09\\n', 'id': 'lc_d09705d7-ba1b-480e-aa07-082075b90b41'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0064_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, specifically within the `wso2/product-apim` project, does not appear to directly support the requirement of including a `fundsAvailable` field in payment status responses based on transaction status codes like ACTC, ACWC, or ACCP <cite/>. The provided code snippets show a basic payment processing service for a coffee sample application, which includes a `PaymentStatus` bean . However, this `PaymentStatus` bean only contains a `status` field and a `payment` object, without any explicit `fundsAvailable` field or logic for handling specific transaction status codes related to funds checking .\\n\\n### Implementation Details\\nThe `StarbucksOutletServiceImpl.java` file implements a `doPayment` method that processes payments . This method checks for duplicate payments, invalid order IDs, and \"Insufficient Funds\" . If funds are insufficient, it returns a `PaymentStatus` with the status \"Insufficient Funds\" . However, it does not include a `fundsAvailable` field in the response, nor does it use the specific transaction status codes (ACTC, ACWC, ACCP) mentioned in your query . The `PaymentStatus` object is constructed with a simple status string and the `Payment` object .\\n\\n### Configuration Options\\nThere are no explicit configuration options visible in the provided code snippets that would enable or disable a `fundsAvailable` field or modify the transaction status codes <cite/>. The `PaymentStatus` class is a simple Java bean with `XmlElement` annotations for XML/JSON serialization .\\n\\n### API Endpoints or Features\\nThe `doPayment` method in `StarbucksOutletServiceImpl` acts as an API endpoint for processing payments . The response from this endpoint is a `PaymentStatus` object . However, as noted, this `PaymentStatus` object does not include the `fundsAvailable` field .\\n\\n### Documentation References\\nNo specific documentation references related to the `fundsAvailable` field or the mentioned transaction status codes (ACTC, ACWC, ACCP) are present in the provided code snippets <cite/>. The comments in `PaymentStatus.java` describe the XML element mapping and JSON structure but do not mention these specific requirements .\\n\\n## Notes\\nThe provided code snippets are part of a \"coffeesample\" application within the `wso2/product-apim` repository . This suggests it might be an example or integration test service rather than a core payment processing system <cite/>. Therefore, it may not reflect the full capabilities or requirements of a production-grade payment system that would handle detailed funds checking and specific transaction status codes like ACTC, ACWC, or ACCP <cite/>. The `Customer.java` files in different packages are similar but appear to be distinct beans for different sample services  . The `ResourceAdminServiceClient.java` and `PeopleRestService.java` are unrelated to payment processing  .\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_c0efd3e4-cc3d-4be8-b90d-a4c6bc995a0e\\n', 'id': 'lc_4942288e-25bd-4aeb-92c5-b57f4af15f15'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0065",
      "requirement": {
        "requirement_id": "ATOM_094",
        "requirement_text": "TPP registration information including TPP Number, TPP Name, TPP Roles, and National Competent Authority MUST be validated from eIDAS certificates",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0065_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support X.509 certificate authentication, which is a prerequisite for eIDAS certificate validation. Specifically, the `pom.xml` file indicates the presence of an X.509 certificate authenticator module . However, the provided context does not contain explicit implementation details, configuration options, API endpoints, or documentation references directly related to validating TPP registration information (TPP Number, TPP Name, TPP Roles, National Competent Authority) from eIDAS certificates for payment initiation requests.\\n\\n## Implementation Details\\n\\nThe codebase includes a dependency for an X.509 certificate authenticator: `org.wso2.carbon.extension.identity.authenticator.x509Certificate.connector` . This suggests that the system has the capability to process X.509 certificates for authentication purposes. The `Architecture` wiki page also mentions \"Protocol Support\" including FAPI (Financial-grade API)  and DPoP (Demonstrating Proof-of-Possession) , which are relevant to secure financial transactions and could potentially leverage certificate-based authentication. The `OAuth2DPopTestCase.java` file contains tests related to DPoP, which involves proof-of-possession of a cryptographic key . While DPoP uses cryptographic keys, it\\'s not explicitly stated that these keys are derived from eIDAS certificates or used for TPP validation.\\n\\n## Configuration Options\\n\\nThe `automation.xml` file shows configuration for keystores and truststores, including a `client-truststore.p12` . This indicates that the system can be configured to trust certificates. However, there are no specific configuration options provided in the snippets that directly relate to eIDAS certificate validation for TPP registration details.\\n\\n## API Endpoints or Features\\n\\nThe `AuthorizationDetailsType.java` file defines a model for authorization details, with an example type of \"payment_initiation\" . This suggests that the system handles payment initiation requests. However, the provided code does not expose any specific API endpoints or features for validating TPP registration information from eIDAS certificates. The `IdPFailureTest.java` file shows tests for Identity Provider (IdP) templates , but this is not directly related to TPP validation from eIDAS certificates.\\n\\n## Documentation References\\n\\nThe provided context does not include any specific documentation references that detail the validation of TPP registration information from eIDAS certificates. The `Architecture` wiki page provides a high-level overview of the system , but it does not delve into the specifics of eIDAS or TPP validation.\\n\\n## Notes\\n\\nThe presence of an X.509 authenticator and support for FAPI/DPoP suggests that the WSO2 Identity Server has capabilities that could be extended to support eIDAS certificate validation. However, the provided snippets do not explicitly demonstrate the validation of TPP registration information (TPP Number, TPP Name, TPP Roles, National Competent Authority) from eIDAS certificates. Further investigation into the implementation of the X.509 authenticator and any related custom extensions would be necessary to confirm full compliance with the stated requirement.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_1d136706-ff00-4c0b-a4bd-3a98d7d37331\\n', 'id': 'lc_a695f2c6-7428-4ffc-82c6-b0a0e2601f0d'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0065_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, `wso2/product-apim`, appears to handle JWT (JSON Web Token) validation and identity provider management, which could be relevant to validating information from eIDAS certificates. However, there is no direct evidence or explicit mention of \"eIDAS certificates\" or \"TPP registration information\" (TPP Number, TPP Name, TPP Roles, National Competent Authority) being extracted or validated from certificates for payment initiation requests.   \\n\\n### Implementation Details\\n\\nThe codebase includes functionality for adding and managing Identity Providers (IDPs) and their associated certificates. The `addIdentityProvider` method in `JWTGrantTestCase.java`  and `ExternalIDPJWTTestCase.java`  demonstrates how a public certificate can be loaded from a keystore and set for an `IdentityProvider` object.   This certificate is then used for JWT validation. \\n\\nThe `JWTGrantTestCase.java` also shows how JWT tokens are generated and validated, including scenarios where the JWT is signed by a different certificate, leading to an unauthorized response.   This suggests that certificate-based validation of JWTs is a core feature. \\n\\n### Configuration Options\\n\\nThe `services-config.xml` file contains configuration related to security, including \"Authentication Mechanism\" options like \"Client Certificates\".  This indicates that client certificate authentication is a supported mechanism. \\n\\n### API Endpoints or Features\\n\\nThe `EndpointCertificatesApi.md` documentation describes API endpoints for managing endpoint certificates.   Specifically, `getEndpointCertificateByAlias`  and `getEndpointCertificates`  allow retrieving certificate information by alias or endpoint.   While these endpoints manage \"endpoint certificates,\" it\\'s not explicitly stated if they are used for eIDAS certificate validation or TPP registration details. \\n\\n### Documentation References\\n\\nThe provided snippets do not contain direct documentation references that explicitly mention \"eIDAS certificates\" or the validation of \"TPP registration information\". <cite /> The `EndpointCertificatesApi.md` file serves as API documentation for certificate management. \\n\\n## Notes\\n\\nThe provided code snippets demonstrate capabilities related to JWT validation using certificates and general certificate management.    However, there is no explicit mention of eIDAS certificates or the specific TPP registration details (TPP Number, TPP Name, TPP Roles, National Competent Authority) being validated from these certificates for payment initiation requests. <cite /> The existing certificate handling mechanisms might be extensible to support eIDAS, but this cannot be confirmed from the given context. <cite />\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_32a169c9-5587-46d6-8d69-b094c1cf389b\\n', 'id': 'lc_7a09990c-85a2-40b7-8520-ffd2ca41839a'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0066",
      "requirement": {
        "requirement_id": "ATOM_136",
        "requirement_text": "The system SHALL accept an optional withBalance query parameter to include booking balance in account details response",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0066_1",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0066_2",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0066_3",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0066_4",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0066_5",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0066_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator does not appear to directly support an optional `withBalance` query parameter for the `/v1/accounts/{account-id}` endpoint to include booking balance in the account details response. Instead, balance information is retrieved through a separate dedicated endpoint, `/accounts/{AccountId}/balances` .\\n\\n### API Endpoints and Features\\n\\nThe API specification for accounts, defined in `account-info-swagger.yaml` , includes distinct endpoints for retrieving account details and account balances:\\n*   `GET /accounts/{AccountId}`: This endpoint is used to retrieve account details . The response for this endpoint is defined by `#/responses/200AccountsAccountIdRead` , which references the `OBReadAccount4` schema .\\n*   `GET /accounts/{AccountId}/balances`: This is a separate endpoint specifically for retrieving balance information for a given account . The response for this endpoint is defined by `#/responses/200AccountsAccountIdBalancesRead` , which references the `OBReadBalance1` schema .\\n\\nThe `account-info-swagger.yaml`  does not define a `withBalance` query parameter for the `GET /accounts/{AccountId}` endpoint.\\n\\n### Implementation Details\\n\\nThe `AccountService.java`  in the demo backend implements the `GET /accounts/{AccountId}/balances` endpoint. This service returns a hardcoded JSON response containing balance details . This further indicates that balance information is retrieved via a dedicated endpoint rather than as an optional parameter to the account details endpoint.\\n\\n### Test Criteria\\n\\nIntegration tests confirm the separate retrieval of account and balance information. The `EndToEndAccountFlowTest.groovy`  tests the retrieval of accounts and then separately tests the retrieval of balances . The constant `BALANCES_SINGLE_PATH`  is used to define the path for retrieving balances, which is `/open-banking/v3.1/aisp/accounts/{AccountId}/balances` .\\n\\n### Configuration Options\\n\\nThe `permissionDataLanguage.js`  file defines permissions related to account data. Specifically, `ReadAccountsDetail`  includes \"Your account balance\"  as part of the shared data, and `ReadBalances`  is a distinct permission for \"All your balance information\" . This suggests that access to balance information is managed through specific consent permissions, separate from general account details.\\n\\n## Notes\\n\\nThe provided codebase context indicates that the WSO2 Financial Services Accelerator follows a pattern of providing separate API endpoints for different types of account information, such as account details and balances. There is no explicit mention or implementation of a `withBalance` query parameter to combine these responses into a single endpoint. The system relies on distinct API calls and corresponding consent permissions for accessing account balances.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6b9906b8-3049-4e77-bbc7-f827f7f8b322\\n', 'id': 'lc_0e787209-01f8-43bb-bd34-2d83747cdbc5'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0067",
      "requirement": {
        "requirement_id": "ATOM_016",
        "requirement_text": "Resources SHALL be addressed under API endpoints using the format https://{provider}/v1/{service}{?query-parameters}.",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0067_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Yes, the WSO2 Identity Server repository supports the API endpoint format `https://{provider}/v1/{service}{?query-parameters}`. This structure is evident across various server-side APIs, including those for Organization Management, Application Management, and Identity Provider Management.   The base path for server APIs typically includes `/api/server/v1/` or `/o/api/server/v1/` for organization-specific endpoints, followed by the service name and optional query parameters.  \\n\\n## Implementation Details\\n\\nThe API endpoints are implemented as servlets defined in `web.xml` . For instance, the `/server/v1/*` pattern is mapped to `ServerV1ApiServlet`, which handles various API services like `ClaimManagementApi`, `EmailApi`, `ApplicationsApi`, and `OrganizationsApi` . Similarly, organization-specific APIs use the `/o/server/v1/*` pattern, mapped to `OrganizationServerV1Servlet` . The `CustomCXFNonSpringJaxrsServlet` class is used for these servlet implementations .\\n\\nThe base path for server APIs is constructed using `API_SERVER_BASE_PATH` which is defined as `/api/server/%s` . This allows for versioning, where `%s` is replaced by the API version (e.g., `v1`) . For multi-tenancy, the `TENANT_PATH` (`/t/`) and `ORGANIZATION_PATH` (`/o/`) are prepended to the base path, as seen in `OAuth2RestClient`  .\\n\\n## Configuration Options\\n\\nThe `web.xml` file configures the `jaxrs.serviceClasses` and `jaxrs.providers` for each servlet  . This allows for specifying which API classes are exposed and how JSON processing and error handling are managed .\\n\\nQuery parameters are commonly used for filtering, pagination, and other options. Examples include `limit`, `offset`, `filter`, and `recursive` . These parameters are appended to the base URL using `?` and `&` separators .\\n\\n## API Endpoints and Features\\n\\nThe repository exposes a wide range of API endpoints conforming to the specified URL structure.\\n\\n### Organization Management API\\nThe Organization Management API uses `/organizations` as its base path . Examples of endpoints include:\\n*   `/api/server/v1/organizations` for listing and creating organizations .\\n*   `/api/server/v1/organizations/{id}` for retrieving, updating, or deleting a specific organization .\\n*   `/api/server/v1/organizations/discovery` for organization discovery operations .\\n*   `/api/server/v1/organization-configs/discovery` for managing organization discovery configurations .\\n\\nQuery parameters are used for pagination and filtering, such as `offset` and `limit` .\\n\\n### SCIM2 Endpoints\\nSCIM2 endpoints also follow this pattern, with `/scim2/Users` and `/scim2/Groups` for user and group management . For organization-specific SCIM2 operations, the path includes `/o/scim2/Users` and `/o/scim2/Roles` . The `scim2.yaml` Swagger definition shows a `basePath` of `/t/{tenant-domain}/scim2` .\\n\\n### Other Server APIs\\nOther APIs like Branding Preference Management , Identity Governance , and Configs  also adhere to the `/api/server/v1/{service}` format.\\n\\n## Documentation References\\n\\nThe `Organization Management` wiki page explicitly lists core endpoints for organization management, demonstrating the `/api/server/v1/organizations` and `/api/server/v1/organization-configs` base paths, followed by specific resources and query parameters . The `Server APIs` wiki page further details the API architecture, including versioning and multi-tenancy support, confirming the `/server/v1/resource-type` and `/o/server/v1/resource-type` patterns  .\\n\\n## Test Criteria Verification\\n\\nIntegration tests within the repository, such as `OrganizationManagementBaseTest`  and `OrganizationManagementSuccessTest` , explicitly construct and validate URLs against this format. For example, `buildQueryUrl` in `OrganizationManagementSuccessTest` constructs URLs with query parameters for pagination . The `RESTAPIServerTestBase` class provides utility methods for initializing tests with the correct base paths, ensuring adherence to the `/api/server/{version}` structure .\\n\\n## Notes\\n\\nThe provided context primarily focuses on server-side REST APIs within the `wso2/product-is` repository. The URL format `https://{provider}/v1/{service}{?query-parameters}` is consistently applied to these APIs, with `{provider}` typically being the WSO2 Identity Server instance, `v1` indicating the API version, and `{service}` representing the specific API category (e.g., `organizations`, `applications`). The `{?query-parameters}` part is used for various functionalities like filtering and pagination. The presence of `/t/{tenant-domain}` and `/o/` in the paths indicates support for multi-tenancy and organization-specific contexts, respectively.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-r_4719846f-9889-4d64-9e3a-d0f265fd02c2\\n', 'id': 'lc_f4b43b00-c3d5-40a9-a366-1e904a228235'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0067_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports API endpoints that generally conform to a structure similar to `https://{provider}/v1/{service}{?query-parameters}`. The API definitions and configurations within the codebase demonstrate the use of versioning (`v1`, `v0.16`, `v0.17`, `v3`, `v4`), service/resource paths, and query parameters.     \\n\\n## Implementation Details\\n\\nThe API definitions are primarily found in OpenAPI (Swagger) YAML files and XML configuration files.   \\n\\n*   **OpenAPI Definitions**: Files like `service-catalog-api.yaml`  and `openapi.yaml`  explicitly define API endpoints, their versions, and query parameters. For instance, the `service-catalog-api.yaml` defines a base URL `https://apis.wso2.com/api/service-catalog/v1`  and a `/services` path with query parameters like `name`, `version`, `definitionType`, and `key`.  \\n*   **XML Configurations**: `api-manager.xml` files contain `<RESTAPI>` sections with `<WhiteListedURIs>` that specify API endpoint patterns, including versioning and resource paths.  Examples include `/api/am/store/{version}/apis` and `/api/am/store/{version}/apis/{apiId}/swagger`. \\n*   **Test Cases**: Java test files like `APIResourceWithSpecialCharactersInvocation.java` demonstrate how API endpoints are constructed and invoked, including context, version, and resource paths.  The `API_CONTEXT` is `specialCharacterResourceNameAPI` and `API_VERSION_1_0_0` is `1.0.0`. \\n\\n## Configuration Options\\n\\nThe `api-manager.xml` files define whitelisted URIs for REST APIs, which implicitly configure the supported URL structures.  These configurations use placeholders like `{version}` and `{apiId}` to represent dynamic parts of the URL. \\n\\n## API Endpoints or Features\\n\\nThe repository contains various API endpoints that adhere to a structured format:\\n\\n*   **Service Catalog API**: Endpoints like `https://apis.wso2.com/api/service-catalog/v1/services` are defined, supporting query parameters for filtering services.  \\n*   **Publisher API**: Examples include `/api/am/publisher/v4/apis`  and `/api/am/publisher/{version}/swagger.json`. \\n*   **Store API**: Endpoints such as `/api/am/store/{version}/apis` and `/api/am/store/{version}/apis/{apiId}/swagger` are common. \\n*   **Devportal API**: The `api-manager.xml` also shows `/api/am/devportal/{version}/apis` and `/api/am/devportal/{version}/search`. \\n\\nThe general format observed is `/api/am/{service}/{version}/{resource}{?query-parameters}`. The `{provider}` part of the requested format `https://{provider}/v1/{service}{?query-parameters}` appears to be implicitly handled by the base URL of the API gateway, such as `https://127.0.0.1:9443`  or `https://apis.wso2.com` , with the `{service}` often being `am/publisher`, `am/store`, `am/service-catalog`, or `am/devportal`.\\n\\n## Documentation References\\n\\nThe OpenAPI YAML files themselves serve as documentation for the API endpoints, detailing paths, parameters (including query parameters), and responses.   For example, `publisher-api.yaml` defines parameters like `apiId`, `documentId`, `applicationId`, and `subscriptionId` with descriptions and their location (`in: path` or `in: query`). \\n\\n## Test Criteria Verification\\n\\nThe test cases and configuration files demonstrate adherence to the specified URL structure. For example, `APIResourceWithSpecialCharactersInvocation.java` constructs a URL using `getGatewayURLNhttp() + API_CONTEXT + \"/\" + API_VERSION_1_0_0 + API_ENDPOINT_RESOURCE` , which resolves to a format like `https://{gateway_url}/specialCharacterResourceNameAPI/1.0.0/special,-._~resource`. This aligns with the `/{service}/{version}/{resource}` part of the requirement. The presence of `query-parameters` is also evident in OpenAPI definitions and test data.  \\n\\n## Notes\\n\\nThe `{provider}` part of the requested URL format `https://{provider}/v1/{service}{?query-parameters}` is typically represented by the base URL of the API gateway or the domain where the APIs are hosted, rather than an explicit path segment within the API definition itself. The codebase consistently uses a pattern of `/api/am/{service}/{version}/{resource}` for its internal and exposed APIs.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-r_ef6798ce-2ff9-49ea-9346-bba9790f1b31\\n', 'id': 'lc_712731dc-6fbe-433c-b0db-e685924415a9'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0068",
      "requirement": {
        "requirement_id": "ATOM_176",
        "requirement_text": "The system SHALL support TPP-Redirect-URI header for redirect SCA approach when TPP-Redirect-Preferred equals true",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0068_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_2",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_3",
          "text": "## How WSO2 Open Banking supports App-to-App redirection [ ![](../assets/img/learn/app-to-app-redirection/app-to-app-redirection-sequence-flow.png) ](../assets/img/learn/app-to-app-redirection/app-to-app-redirection-sequence-flow.png) WSO2 Open Banking supports the App-to-App redirection flow as follows: The API consumer mobile application invokes the `authorize` endpoint, similar to a basic browser-based auth-code/hybrid redirect flow. When the bank\u2019s mobile application is installed in the customer\u2019s device with a deep link connected to this authorize request, the request is handled by the bank\u2019s mobile application instead of the browser. !!! note If the bank\u2019s mobile application is not available in the customer\u2019s device, the customer is taken through a typical browser-based flow. Once the mobile application handles the customer authentication and consent, it obtains a callback URI. This is the URL to the API consumer application. Using deep links, the bank application redirects the customer to the API consumer\u2019s mobile application. Here, similar to the initial scenario, the callback URI is deep linked to the API consumer\u2019s mobile application. Using this, the flow continues from the bank\u2019s mobile application to the API consumer\u2019s mobile application again. In the App-to-App redirection method, the flow should be handled in the bank\u2019s mobile application as follows: 1. The bank\u2019s mobile application is opened using the deep link. 2. The application invokes the `/authorize` endpoint to initiate the authorization flow. The response redirect is sent by an authenticator that is customized to the app-based flow. !!! note You need to configure custom authenticators that address the requirements of both browser-based and app-based redirection flows. For more information, see [Adding Custom Authenticators](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-local-authenticator/#writing-a-custom-local-authenticator). If this is not an error page or application callback redirect, the application can gain the authentication of the bank customer. For example, using biometrics. !!! info Based on the user agent of the auth request in the adaptive authentication script, a mobile app-based flow can be detected. This states which authenticators need to be invoked in each scenario. 3. Once the authentication is provided, a `/commonauth` request has to be made. This is processed by the authenticator mentioned above. In a biometric scenario, since the verification happens in the mobile application, this request should guarantee non-repudiation and client identification. Given below is a sample request, modify the payload according to your requirements: ``` cURL curl -X POST \\ https://<IS_HOST>:9446/commonauth \\ -H 'Content-Type: application/x-www-form-urlencoded' \\ -d 'sessionDataKey=value&username=value&password=value' ``` - It is recommended to have a key pair for the mobile application. So that the response can be included with a signed JWT, which helps to identify the client with guaranteed non-repudiation. 4. Successful authentication prompts a redirection response to the consent page that contains `sessionDataKeyConsent`. This value is extracted and will be used in the next step. 5. The `authorize/retrieve` request has to be sent with the `SessionDataKeyConsent`. This is to retrieve the data that is required to display on the consent page. 6. After the user approves/denies the consent and selects the accounts, a `PATCH authorize/persist` request is made to persist the consent information. 7. Finally, if the persistence is successful, to complete the flow the `/authorize` endpoint is invoked. This results in a redirection to the callback URL of the API",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_4",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_5",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase context, there is no direct evidence or explicit mention of support for the `TPP-Redirect-URI` header in conjunction with `TPP-Redirect-Preferred` for a redirect SCA approach. The codebase primarily focuses on OAuth2 and OpenID Connect implementations, including various grant types, token management, and conformance testing  .\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThe provided snippets do not contain any specific implementation details, configuration options, or API endpoints related to `TPP-Redirect-URI` or `TPP-Redirect-Preferred` headers. The `redirect_uri` parameter is a standard OAuth2 concept and is frequently referenced in the codebase    . However, this is distinct from the `TPP-Redirect-URI` header, which is typically associated with specific financial-grade API (FAPI) profiles or Strong Customer Authentication (SCA) requirements.\\n\\nThe codebase does include FAPI conformance tests , which might imply support for related financial industry standards. However, the provided snippets from `oidc-fapi-conformance-tests/constants_fapi.py`  define client configurations for FAPI tests, but do not explicitly mention `TPP-Redirect-URI` or `TPP-Redirect-Preferred`.\\n\\nThe `redirectURL` is extracted and used in several test cases related to client native authentication and federated token sharing    . These instances refer to the standard OAuth2 `redirect_uri` and not specifically to a `TPP-Redirect-URI` header.\\n\\n## Documentation References\\n\\nThe provided wiki page on \"OAuth2 and OpenID Connect\" <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" /> gives a general overview of OAuth2 and OIDC implementation in WSO2 Identity Server, including supported grant types and token management. While it mentions FAPI conformance, it does not delve into specific headers like `TPP-Redirect-URI` or `TPP-Redirect-Preferred`.\\n\\n## Notes\\n\\nThe terms `TPP-Redirect-URI` and `TPP-Redirect-Preferred` are specific to certain financial industry standards, often related to Open Banking and Strong Customer Authentication (SCA). While the WSO2 Identity Server codebase supports FAPI, the provided snippets do not offer enough detail to confirm explicit support for these particular headers. It is possible that such support exists within the broader codebase but is not reflected in the provided context. To verify this, a more extensive search for these specific header names within the entire repository would be necessary.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Testing Framework (wso2/product-is)](/wiki/wso2/product-is#6)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9e021398-72a8-4f2e-921f-07935973c622\\n', 'id': 'lc_dfac574d-997f-4916-89d6-4b73bbce45b2'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_14832912-5b1e-4e07-b19f-5684d9c55e01'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0069",
      "requirement": {
        "requirement_id": "ATOM_089",
        "requirement_text": "ASPSP SHALL support mixed SCA approaches allowing PSU to choose decoupled authentication method even when flow starts with redirect approach",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0069_1",
          "text": "#Client-Initiated Backchannel Authentication (CIBA) Flow\n\nWSO2 Open Banking Accelerator provides support for the\n[OpenID Connect Client-Initiated Backchannel Authentication Flow](https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html). \n\nThe CIBA flow is an authentication flow like OpenID Connect. In the OpenID Connect authentication flow, the bank customers \nare redirected to the bank in order to log in by providing their credentials. The customers are authenticating themselves \nthrough the same device that is used for the rest of the flow. \n\nHowever, in CIBA, the bank sends a notification to the customer's mobile device and verifies the account owners. CIBA \nuses a decoupled direct channel to verify the customer without relying on redirects. This flow consists of 2 types of devices:\n\n- Consumption Device:  Device used to interact with the bank\n- Authentication Device: Device used for authentication and consent grant\n\nThe customer starts the flow with a relying party (a Third Party Provider/API consumer application) at the Consumption Device \nbut authenticates and grants consent on the Authentication Device. This makes the flow a form of \n**Decoupled authentication/authorization**.\n\nCIBA flow increases the security by involving a second device, which is similar to Two-Factor Authentication. Customers \nsimply receive a mobile notification to authenticate themselves and grant access to their accounts. This also\nimproves the user experience as the customers are not redirected between websites.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_2",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_3",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_4",
          "text": "## Configuring a custom Push Authenticator  \n\n1. Once implemented, build a JAR file for your project.\n2. Place the above-created JAR file in the `<IS_HOME>/repository/components/dropins` directory.\n3. Open the `<IS_HOME>/repository/conf/deployment.toml` file and configure your custom authenticator using the Fully \nQualified Name (FQN):\n\n      ``` toml\n      [open_banking.sca.idp]\n      name = \"CIBA-Push-Auth\"\n      ```\n    \n4. Save the configurations and restart the Identity Server.\n5. Follow the [Set up CIBA flow](../learn/ciba-set-up-flow.md#configuring-authenticator) documentation and try out the \nflow.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_5",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'It seems you are asking about the support for mixed Strong Customer Authentication (SCA) approaches, specifically allowing a Payment Service User (PSU) to choose a decoupled authentication method even when the flow starts with a redirect approach, and ensuring this is transparent to the Third-Party Provider (TPP). This involves examining how authentication flows are managed, configured, and exposed via APIs within the WSO2 Identity Server.\\n\\nThe WSO2 Identity Server appears to support flexible authentication flows through its \"Adaptive Authentication\" framework, which allows for dynamic selection of authenticators based on runtime conditions . This framework, combined with the \"Client Native Authentication\" feature, seems to be the most relevant area for addressing your query.\\n\\n### Implementation Details\\n\\nThe core of supporting mixed SCA approaches and decoupled authentication lies within the \"Adaptive Authentication\" framework . This framework uses JavaScript-based conditional authentication scripts to define dynamic authentication flows . These scripts can:\\n*   **Define Multi-step Authentication**: Configure authentication steps based on user attributes or other conditions . This would allow for a redirect flow to initiate, and then based on conditions, a decoupled authenticator could be introduced as a subsequent step.\\n*   **Customize Authentication Flow**: Dynamically select authenticators based on runtime conditions . This is crucial for allowing the PSU to choose a decoupled method.\\n\\nThe `ApplicationNativeAuthenticationTestCase.java` and `ApplicationNativeAuthenticationFederationTestCase.java` integration tests demonstrate how \"Client Native Authentication\" works  . These tests show the process of initiating an authentication flow and receiving a JSON response that describes the next steps, including available authenticators and their metadata .\\n\\nSpecifically, the `validInitClientNativeAuthnResponse` method in these test cases validates the structure of the JSON response for client native authentication . This response includes `flowId`, `flowStatus`, `nextStep`, and a list of `authenticators` . Each authenticator can have `metadata` that includes a `promptType` and `params` . For redirect-based authenticators, the `additionalData` within `metadata` can contain a `redirectUrl` . This indicates that the system can present different authentication options, including those that might lead to a decoupled flow.\\n\\nThe transparency to the TPP is suggested by the nature of the \"Client Native Authentication\" flow, where the TPP initiates the authentication, and the ASPSP (WSO2 Identity Server) handles the authentication steps, returning a final authorization code upon successful completion . The TPP would primarily interact with the initial authorization request and the final authorization code, without needing to know the intricacies of the authentication steps chosen by the PSU.\\n\\n### Configuration Options\\n\\nThe ability to enable or disable API-based authentication (which is related to client native authentication) is a configuration option at the application level . This is managed through the `AdvancedApplicationConfiguration` model, specifically the `enableAPIBasedAuthentication` property .\\n\\nThe `pom.xml` file lists various authenticators that can be integrated, such as `emailotp`, `smsotp`, and `magiclink` . These could potentially be used as decoupled authentication methods within an adaptive authentication script.\\n\\n### API Endpoints or Features\\n\\nThe \"Client Native Authentication\" flow is initiated by sending an authorization request to the `/oauth2/authorize` endpoint . The response to this request, when API-based authentication is enabled, provides a JSON payload describing the authentication flow, including the `flowId`, `flowStatus`, and `nextStep` with details about available `authenticators` .\\n\\nThe `getResponseOfJSONPost` method is used to interact with these API endpoints, sending JSON POST requests and receiving JSON responses .\\n\\n### Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Adaptive Authentication, which is the underlying mechanism for implementing flexible authentication flows . It describes how JavaScript-based conditional authentication scripts can be used to customize authentication flows and dynamically select authenticators .\\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests, which demonstrate the functionality rather than providing direct implementation code. However, they clearly indicate the presence and usage of \"Client Native Authentication\" and its interaction with the OAuth2 authorization flow. The concept of \"decoupled authentication\" is not explicitly mentioned in the provided context, but the ability to dynamically select authenticators and present different `promptType` options within the \"Client Native Authentication\" response suggests that such a mechanism can be implemented. The transparency to the TPP is inferred from the standard OAuth2 flow where the TPP receives an authorization code after the ASPSP handles the user authentication.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_aced7773-865a-4d34-894a-4f65543a9282\\n', 'id': 'lc_32f6008d-ce39-437f-b2fd-a79f186f7188'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_cc5266e4-b1c0-4d7a-b408-25b7c5c4b92f'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0070",
      "requirement": {
        "requirement_id": "ATOM_137",
        "requirement_text": "The system SHALL validate that Consent-ID header is provided as mandatory for account details requests",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0070_1",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0070_2",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0070_3",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0070_4",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0070_5",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0071",
      "requirement": {
        "requirement_id": "ATOM_207",
        "requirement_text": "The scope parameter shall reference the consent resource in the format 'PIIS:<consentId>' for Payment Instrument Issuer Services",
        "strength": "SHALL",
        "capability": "Funds Confirmation",
        "section_id": "13.1",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0071_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the concept of scopes in OAuth2/OpenID Connect, including custom scopes and consent management. However, there is no direct evidence in the provided snippets that explicitly confirms support for a scope parameter format like `PIIS:<consentId>` for Payment Instrument Issuer Services or for accessing funds confirmation resources.\\n\\n### Implementation Details and API Endpoints\\n\\nThe codebase includes functionality for managing OAuth2/OIDC scopes. The `OIDCCustomScopesLoginTest.java` file demonstrates how custom OIDC scopes can be created and managed . Specifically, the `buildCreateScopeRequestBody` method constructs a JSON object to create a new scope with a `name`, `displayName`, and associated `claims` . The `getOIDCSCopeEndpoint` method provides the endpoint for OIDC scope management .\\n\\nThe `OAuth2ScopesTestCase.java` further illustrates scope management, including adding, retrieving, and deleting scopes via an API endpoint . The `SCOPE_ENDPOINT_SUFFIX` constant defines the base path for scope-related API calls as `/api/identity/oauth2/v1.0/scopes` . The `addScope` method sends a request to this endpoint to create a new scope .\\n\\nThe `configure_is.py` script also interacts with a scope management API at `/api/server/v1/oidc/scopes/` to edit existing scopes .\\n\\n### Configuration Options\\n\\nThe `default-identity.xml` configuration file shows that `ScopeValidators` and `ScopeHandlers` are configured for OAuth2, indicating that custom logic can be applied to scope validation and handling . The `OIDCScopeHandler` is specifically mentioned, suggesting that OpenID Connect scopes are processed by a dedicated handler .\\n\\nThe `UserConsentEnabledGrantTypes` section in `default-identity.xml` specifies which grant types filter user claims based on user consent, with `authorization_code` and `implicit` being the defaults . This implies that consent is a configurable aspect of how scopes and claims are handled.\\n\\n### Consent Management\\n\\nThe wiki page on \"Advanced Features\" explicitly mentions \"Consent Management\" as a capability, allowing for the collection, storage, and management of user consent for processing personal data . It describes key consent components like PII Categories, Purposes, and Consent Receipts . The `SelfSignUpConsentTest.java` file contains tests related to consent management during self-registration, including adding financial purposes and retrieving consent receipts . The `getConsentReqBody` method constructs a consent request body, which includes `purposeId` and `piiCategoryId` .\\n\\nWhile the system supports custom scopes and consent management, there is no direct indication in the provided code snippets or wiki pages of a predefined scope format like `PIIS:<consentId>` or specific support for \"Payment Instrument Issuer Services\" or \"funds confirmation resources.\" The existing scope management capabilities could potentially be extended or configured to support such a format, but this would require custom implementation or configuration beyond what is directly shown.\\n\\n## Notes\\n\\nThe provided snippets focus on the general mechanisms for OAuth2/OIDC scope management and consent handling within WSO2 Identity Server. While the system is highly configurable and extensible, the specific `PIIS:<consentId>` format for Payment Instrument Issuer Services is not explicitly mentioned. The `AuthorizationDetailsType.java` file contains a `type` field with an example value of \"payment_initiation\" , which suggests that payment-related authorization details are considered, but this is not directly linked to the requested scope format.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_7f7cb27f-96b9-4a38-9158-c040b2e36c09\\n', 'id': 'lc_f2dd77ba-92f1-4a03-8883-7ccccf3ba5e6'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0071_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to have some support for managing scopes, which are relevant to the `scope` parameter in API calls. However, there is no direct evidence within the provided snippets that explicitly details the handling or validation of a `scope` parameter in the format `PIIS:<consentId>` for Payment Instrument Issuer Services (PIIS) when accessing funds confirmation resources.\\n\\nThe codebase includes functionalities for defining, managing, and validating API scopes  . It also contains configurations related to consent management   and identity management, including the addition of a \"scope validator\" to `identity.xml`  . However, the specific format `PIIS:<consentId>` is not explicitly mentioned or implemented in the provided code snippets.\\n\\n### Implementation Details\\n\\nThe WSO2 API Manager codebase allows for the definition and management of scopes associated with APIs. Scopes can be added, retrieved, updated, and deleted for a given API . Shared scopes can also be managed through a separate API .\\n\\nAn example of how scopes are defined and associated with API operations can be seen in the `AllowedScopesTestCase.java` integration test . In this test, `scope1` and `scope2` are created and bound to the \"admin\" role, and then associated with specific API operations . The `APIOperationsDTO` object is used to define the scopes required for an operation .\\n\\nThe system also includes a `SubscriptionValidationApi` which has a `scopesGet` method to retrieve scopes from the database based on a `scopeKey` . This suggests that scopes are stored and can be queried.\\n\\n### Configuration Options\\n\\nThe build process for WSO2 API Manager includes steps to configure consent management and add a scope validator. Specifically, the `pom.xml` files for the `api-control-plane` and `traffic-manager` distributions show a `config-processor-maven-plugin` execution with the ID `add-scope-validator`  . This plugin processes `identity.xml` to add the scope validator, using a configuration file named `identity_config_change.xml`  . The content of `identity_config_change.xml` is not provided, but it would contain the specific configuration for the scope validator.\\n\\nAdditionally, there are configurations to replace the datasource in `consent-mgt-config.xml`  . This indicates that consent management is an integrated part of the system.\\n\\n### API Endpoints or Features\\n\\nThe following API endpoints and features related to scopes are available:\\n\\n*   **`GET /apis/{apiId}/scopes`**: Retrieves a list of scopes for a specific API .\\n*   **`POST /apis/{apiId}/scopes`**: Adds a new scope to an API .\\n*   **`PUT /apis/{apiId}/scopes/{name}`**: Updates a scope of an API .\\n*   **`DELETE /apis/{apiId}/scopes/{name}`**: Deletes a scope of an API .\\n*   **`GET /scopes`**: Retrieves all available shared scopes .\\n*   **`POST /scopes`**: Adds a new shared scope .\\n*   **`HEAD /scopes/{scopeId}`**: Checks if a given scope name already exists .\\n*   **`GET /scopes` (internal API)**: Provides access to scopes created in the database, with an optional `scopeKey` parameter for searching .\\n\\nThe `ApplicationScopeValidationTestCase` also indicates that there\\'s an endpoint `/api/am/store/v0.16//applications/scopes/{applicationId}` which can be used to get scopes of applications .\\n\\n### Documentation References\\n\\nThe provided snippets include documentation for the `ApiScopesApi`  and `ScopesApi` . These markdown files describe the available API operations, their parameters, and return types.\\n\\n### Conclusion on `PIIS:<consentId>` Format\\n\\nWhile the repository clearly supports a robust scope management system, there is no explicit mention or implementation of the `PIIS:<consentId>` format for the `scope` parameter within the provided code snippets. The existing scope validation mechanisms would need to be extended or configured to specifically recognize and process this format if it\\'s a new requirement. The `identity_config_change.xml` file, which is used to configure the scope validator, would be the most likely place to define such a custom validation rule  .\\n\\n## Notes\\n\\nThe provided code snippets primarily focus on the build system, API scope management, and some aspects of consent management. The term \"Payment Instrument Issuer Services\" (PIIS) and \"funds confirmation resources\" are not found in the provided context, suggesting that this specific functionality might be implemented elsewhere in the codebase or is a new requirement. The `consent-mgt-config.xml` and `identity.xml` files are configured during the build process, indicating that these are key configuration points for consent and identity-related features.\\n\\nWiki pages you might want to explore:\\n- [Build System (wso2/product-apim)](/wiki/wso2/product-apim#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_25ff0819-f053-4273-9171-229ebb94abab\\n', 'id': 'lc_6b9e265a-e9ee-41bb-9a3c-d3df1941be2a'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0072",
      "requirement": {
        "requirement_id": "ATOM_208",
        "requirement_text": "The state parameter shall be a dynamical value set by the TPP to prevent XSRF attacks",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "13.1",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0072_1",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_2",
          "text": "## Inbuilt Gateway Enforcements\n\n- [Dynamic Client Registration Request Policy](../learn/dcr-request-policy.md)\n- [Dynamic Client Registration Response Policy](../learn/dcr-response-policy.md)\n- [Consent Enforcement Policy](../learn/consent-enforcement-policy.md)\n- [Dynamic Endpoint Policy](../learn/dynamic-endpoint-policy.md)\n- [MTLS Enforcement Policy](../learn/mtls-enforcement-policy.md)\n- [UK JWS Header Processing Policy](../learn/uk-jws-header-processing-policy.md)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_3",
          "text": "### Run tests\n\n1. Use a tool and convert the private key (tpp.com.key) to a JWK. Use this JWK to update the value of the **keys** \n   array element in the JSON configuration.\n2. Log in to the test suite.\n3. Select the Open Banking test plan and client authentication type as follows:\n    - Test plan: `FAPI-CIBA-ID1: Authorization server test`\n    - Client Authentication Type `private_key_jwt` or `mtls`\n    - CIBA Mode: `poll`\n    - FAPI Profile: `plain_fapi`\n    - Client Registration Type: `static_client`\n    ![test_configuration](../assets/img/conformance/test-config.png)\n4. Copy the content in the modified JSON configuration file and paste it into the **JSON** tab. ![json_configuration](../assets/img/conformance/json-config.png)\n5. Click **Start Test Plan**.\n6. Run each given test in sequence. ![run_test](../assets/img/conformance/run-test.png)\n7. Refer to <https://openid.net/certification/instructions/> for more information.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_4",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_5",
          "text": "which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it is required to check whether a given certificate is revoked by its issuer. That can be done through two protocols: ####Certificate Revocation List (CRL) CRL is a list of digital certificates that have been revoked by the issuing CA. ####Online Certificate Status Protocol (OCSP) OCSP is an internet protocol used for obtaining the revocation status of a digital certificate based on the certificate serial number. The OCSP validation is faster compared to the CRL validation. By default, WSO2 Open Banking Accelerator verifies the revocation status of a certificate using the OCSP validation. If the OCSP validation is unsuccessful, the revocation status is verified using the CRL information. The certificate is rejected if none of these protocols is successful or if the required revocation information is not found on the certificate. ###Validate external API consumers This validation allows banks to validate API consumers from the NCAs. This is done by validating the transport layer certificate an API consumer has obtained. ###Role validation According to the [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), API consumers have roles for the services they provide. The API consumer\u2019s role is defined in the API consumer\u2019s transport certificate (QWAC certificate that they obtain from an NCA), which WSO2 Open Banking Accelerator checks in the API and Dynamic Client Registration flows. If the role exists in the transport certificate, WSO2 Open Banking Accelerator allows the API consumer to invoke the API. Following are the roles that an API consumer can have: | Role | Description | |---------|--------- | |Account Information Service Provider|Provides an online service by sharing information on payment accounts held by a payment service user with payment service providers.| |Payment Initiation Services Provider|Provides an online service to initiate a payment order at the request of the payment service user with respect to a payment account held at another payment service provider.| |Card-Based Payment Instrument Issuer|Issues card-based payment instruments that can be used to initiate a payment transaction from a payment account held with another payment service provider.| !!!tip An API consumer can have one or more roles. For example, if an API consumer provides an application to view account information as well as to initiate payments, the roles of the API consumer are **Account Information Service Provider** and **Payment Initiation Services Provider**. ###eIDAS The **electronic IDentification, Authentication and trust Services (eIDAS)** regulation provides unique identity schemas for individuals and businesses to access the publicly available online services in Europe. Among electronic Identification (eID) solutions, PSD2 recommends Qualified Website Authentication Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Yes, the WSO2 Identity Server repository supports the use of a dynamic `state` parameter to prevent XSRF attacks in OAuth 2.0/OpenID Connect authorization requests. This is evident in the integration tests, which simulate authorization flows and explicitly include and validate the `state` parameter.  \\n\\n### Implementation Details\\n\\nThe `state` parameter is included in authorization requests and is subsequently validated. In the `MockOIDCIdentityProvider` class, which simulates an OpenID Connect Identity Provider for testing purposes, the `/authorize` endpoint is configured to expect and return the `state` parameter. \\n\\nSpecifically, the `configureMockEndpoints()` method sets up a stub for the `/authorize` endpoint that includes `withQueryParam(\"state\", matching(\".*\"))`, indicating that the `state` parameter is expected in the incoming request.   The response from this mock endpoint then echoes the received `state` parameter back to the client using `state={{request.query.state}}`.  This mechanism ensures that the `state` parameter sent by the client is returned unmodified, allowing the client to verify its integrity and prevent XSRF attacks. \\n\\nIn the `ApplicationNativeAuthenticationFederationTestCase`, the `state` parameter is explicitly added to the authorization request parameters.  The value of the `state` parameter is extracted from the redirect URL after the authorization request and then used in subsequent authentication steps.   This demonstrates that the `state` parameter is treated as a critical component of the authentication flow. \\n\\n### API Endpoints or Features\\n\\nThe primary API endpoint involved in the `state` parameter handling is the OAuth 2.0/OpenID Connect authorization endpoint.  The `MockOIDCIdentityProvider` defines `MOCK_IDP_AUTHORIZE_ENDPOINT` as `https://localhost:8089/authorize`.  This endpoint is where the authorization request, including the `state` parameter, is sent. \\n\\n### Test Criteria\\n\\nThe integration tests verify that the `state` parameter is correctly handled. In `ApplicationNativeAuthenticationFederationTestCase`, the `state` parameter is extracted from the redirect URL and then included in a subsequent authentication POST request.   This implies that the system expects the `state` parameter to be present and consistent throughout the authorization flow, which is crucial for preventing XSRF attacks. \\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests, which demonstrate the expected behavior and handling of the `state` parameter in OAuth 2.0/OpenID Connect flows. While these tests confirm that the `state` parameter is supported and used for its intended purpose (XSRF prevention), they do not directly expose the internal implementation details of how the `state` parameter is generated or validated within the core WSO2 Identity Server. The snippets focus on the interaction with the authorization endpoint and the subsequent use of the `state` parameter in the authentication process.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d3a21947-1878-420a-a77e-d8586bc8f372\\n', 'id': 'lc_8cbb9320-b328-48f8-833d-7d3cec075fef'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, utilizes OWASP CSRFGuard for Cross-Site Request Forgery (CSRF) protection, which includes mechanisms for generating and validating tokens. However, the provided code snippets primarily focus on CSRF token management (per-session, per-page, and rotation) and do not directly address the \"state parameter\" in the context of OAuth 2.0 or OpenID Connect authorization requests for preventing XSRF attacks.    \\n\\n## Implementation Details\\n\\nThe repository uses OWASP CSRFGuard, configured via `Owasp.CsrfGuard.Carbon.properties` files, to protect against CSRF attacks.     This configuration manages CSRF tokens, which are distinct from the \"state parameter\" used in OAuth 2.0 for XSRF protection during authorization flows. \\n\\nThe CSRFGuard implementation focuses on:\\n*   **Per-session tokens**: A single token is used for a user\\'s entire session. \\n*   **Per-page tokens**: An experimental feature that generates unique tokens for each page (URI).  However, the configuration explicitly disables this feature due to \"overhead, necessity, as well as current unintended behaviour of library after blocking a CSRF attack\". \\n*   **Token Rotation**: A mechanism to generate a new token after verifying the previous one, which is commented out in the provided snippets. \\n*   **Ajax Support**: CSRFGuard supports injection and verification of unique per-session prevention tokens for XMLHttpRequests. \\n\\nThe system uses a pseudo-random number generator (PRNG) for token generation, configured with `org.owasp.csrfguard.PRNG.Provider=SUN`. \\n\\n## Configuration Options\\n\\nThe primary configuration file for CSRF protection is `Owasp.CsrfGuard.Carbon.properties`.  Key configuration properties include:\\n\\n*   `org.owasp.csrfguard.TokenPerPage`: Set to `false` to disable unique per-page tokens. \\n*   `org.owasp.csrfguard.TokenPerPagePrecreate`: Set to `false`. \\n*   `org.owasp.csrfguard.Ajax`: Set to `true` to enable Ajax support for CSRF token handling. \\n*   `org.owasp.csrfguard.UnprotectedMethods`: Configured to `GET`, indicating that CSRF validation is disabled for GET requests. \\n*   `org.owasp.csrfguard.PRNG.Provider`: Set to `SUN` for the pseudo-random number generator provider. \\n\\n## API Endpoints or Features\\n\\nThe provided snippets do not directly expose API endpoints or features related to a \"state parameter\" for OAuth 2.0 authorization requests. <cite /> The CSRF protection implemented through OWASP CSRFGuard is a general web application security measure, not specifically tied to OAuth 2.0 `state` parameter handling. \\n\\n## Documentation References\\n\\nThe configuration files themselves contain comments that refer to OWASP CSRFGuard documentation, such as \"https://www.owasp.org/index.php/CSRFGuard_3_Token_Injection\".  This indicates that the CSRF protection mechanisms are based on the OWASP CSRFGuard library. \\n\\n## Notes\\n\\nThe user\\'s query specifically asks about the \"state parameter\" in the context of preventing XSRF attacks, implying the OAuth 2.0 `state` parameter. <cite /> The provided codebase snippets, while addressing CSRF prevention, do so through the OWASP CSRFGuard library, which manages CSRF tokens for general web application requests.  There is no direct evidence in the provided code that explicitly implements or configures the OAuth 2.0 `state` parameter for authorization requests. <cite /> The `Owasp.CsrfGuard.Carbon.properties` files configure the behavior of CSRF tokens, which are distinct from the OAuth `state` parameter, although both serve to mitigate CSRF/XSRF risks. \\n\\nThe `registry.xml` and `tenant-axis2.xml` files, as well as `header.jsp`, appear to be unrelated to the specific question about the `state` parameter for XSRF prevention in authorization requests.   \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d111be82-7f58-4dbd-98a2-8df5552b796a\\n', 'id': 'lc_93c506eb-47f1-4f35-90d7-db98e972c739'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0073",
      "requirement": {
        "requirement_id": "ATOM_119",
        "requirement_text": "Account Information Service consent SHALL be authorised by the PSU towards the ASPSP with Strong Customer Authentication as mandated by EBA-RTS",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0073_1",
          "text": "## How to manage consents\n\nThe API consumer applications seek consent from their customers who wish to expose their financial data through the \napplication. When granting consent the customers must know the following:\n\n- Who they are granting access to: The identity of the API consumer application\n- For what purpose: The details that this application will have access to. For example, account details, payment details\n- For what period: Number of days the consent is valid for\n- Expiration process: How the user can revoke a granted consent\n\nOnce the customer successfully agrees to the above the bank backends take over the process. The bank backend engages \nwith the customer and authenticates them according to the available security mechanisms, for example, multi-factor \nauthentication/Strong Customer Authentication via SMS OTP. \n\nAfter successful authentication, the customer is presented with the details of the consent where they can allow or \ndeny this request from the API consumer application to access data. Depending on the customer\u2019s response the API \nconsumer application may or may not have access to the data. \n\nWith the [Consent Manager](consent-manager.md) application in WSO2 Open Banking Accelerator you can use one of the \nfollowing methods to revoke these consents granted to API consumer applications.\n \n - A customer can revoke a consent using the Consent Manager portal \n - A Customer Care Representative from the bank can revoke a consent on behalf of a user\n \nWSO2 Open Banking Accelerator uses the following [API endpoints](../references/consent-rest-api.md) to manage consents \nas previously described. \n\n- **Consent Validation - `/validate` endpoint**  \n  The accelerator gathers all consent details and invokes validators via this API. Once the validations are performed, \n  the flow will proceed. You can write your own validations and customize the process.  \n  \n- **Consent Portal - `/admin` endpoint**  \n   The Consent Management portal and the Customer Care portal invoke this API to search consents and revoke consents.\n    \n- **Consent Management - `/manage` endpoint**  \n  This component processes requests based on specification requirements on consent management operations as create \n- consent,get consent, revoke consent and update consent. \n  \n- **Consent Authorize - `/authorize` endpoint**  \n  This endpoint uses to retrieve the consent and consumer data showing in consent grant UI and then persist the user \n  granted data . You can customize the populating data to the consent grant page or persist custom data \n  after user granted.\n\nFor more information on this, refer to [Consent Management OpenAPI Extensions](../develop/openapi-consent-management-manage.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_2",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_3",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_4",
          "text": "## Consent Authorization\n\n- Once you enter a properly constructed authorization request in your web browser, based on the `bank_code` in the \n  request object, you will be redirected to ABC bank or DCB Bank. \n\n- A bank customer needs to enter their credentials and sign in. \n    ![sign_in](../../assets/img/toolkit/regulatory-aggregator/sign-in.png)\n- Then redirected to the Aggregator's Account selection page.\n    ![account_selection](../../assets/img/toolkit/regulatory-aggregator/account-selection.png)\n- Once the bank customer selects the accounts they want to share, the whole consent agreement is displayed.\n    ![consent_agreement](../../assets/img/toolkit/regulatory-aggregator/consent-agreement.png)\n- Once the bank customer approves this consent, the aggregator will redirect you to the registered callback URL with an \n  authorization code in the query parameters.\n   ```\n   https://wso2.com/#code=1390032d-622f-3977-a976-923505035571&id_token=eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJhdWQiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwiY19oYXNoIjoiNXFNeEhhY0d2d2IxX2ZDT29GWmlNZyIsInN1YiI6ImFiY3VzZXJAY2FyYm9uLnN1cGVyIiwic19oYXNoIjoiOU9WMVpnRXVfWWExanFxU3hWelg1ZyIsImF6cCI6IngwVWkyR2k3YTVCNGp1cTdXcHdkcFdyTjlsRWEiLCJhbXIiOlsiQ3VzdG9tRmVkZXJhdGVkQXV0aGVudGljYXRvciJdLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0Ojk0NDZcL29hdXRoMlwvdG9rZW4iLCJleHAiOjE2NTM0ODI2ODAsImlhdCI6MTY1MzQ3OTA4MCwibm9uY2UiOiJqQlhoT21PS0NCIiwic2lkIjoiZmRlODZlMzMtNjljYi00ZTIwLTgxZTMtOTFiMDJhYjlmMjM3In0.OQmAuO3yH-Ap3bPzb1NpbbFN628BdIuKYZ6kZqeDRJwLK2Z5GqtO5P2VZpEoMlRSPi15Z0eg_8Uxv1ns1Na8djpIs1UyK2zK20HzHCZh4flpXlW0AMbvoxUUbAsfDzaH8r0xpzweA471vD0HX9rja2Xio0AhsP6VPJasBxC3jnAt9H9wjqB_qXYw8-TQwVPjkFONNgEZHQ44eJFRxK7Um5TOv1fHb6Ivz4URc0R91vL1LEyaIRy8w7afGePNDQn5BHObbfzwX6O4hI_jsUVeOybG0M3-ofhEwYcvkMuiMPsLeF2Oqa849bNNr11P75TajKV7ozUBo1UJquTs7VfSnA&state=0pN0NBTHcv&session_state=13831b535eebb5527056f57766e0b5a1d66caea43afbe041f75d27adcdb954f1.PNSwGdfigyA_dxaCi45fPA \n   ```\n   - The authorization code from the above URL is in the code parameter `1390032d-622f-3977-a976-923505035571`. \n   - Extract this code for the next step.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_5",
          "text": "### Account Information Service\n\nIf the API consumer application is aggregating account information on behalf of the bank user, the APP-to-APP redirection \nflow is as follows: \n\n[ ![](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Account Information Service, it is known as an Account Information Service Provider (AISP).\n\n| Implementation | Requirement | Participant |\n|----------------|-------------|-------------|\n| A- AISP requests the bank customer to identify the bank. | Required | AISP |\n| B- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | bank |\n| C- The customer consents to the accounts, which the AISP is allowed to have access | Required | Bank |\n| D- Confirms the completion of AIS request | Recommended | AISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports consent management, which is a prerequisite for handling Account Information Service (AIS) consent. The system includes features for defining purposes, collecting, and revoking user consent . While the provided context indicates support for Financial-grade API (FAPI) , which is relevant to EBA-RTS, there is no explicit mention or implementation detail regarding Strong Customer Authentication (SCA) specifically for AIS consent as mandated by EBA-RTS within the provided snippets.\\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server includes a consent management component. The `SelfSignUpConsentTest.java`  class demonstrates how consent is handled during self-registration. This test class interacts with consent-related endpoints, such as `/api/identity/consent-mgt/v1.0/consents` . It includes methods to add purposes and purpose categories for consent  and to retrieve user consents .\\n\\nThe `SAMLSSOConsentTestCase.java`  further illustrates consent management in the context of SAML SSO, including updating service provider claim configurations and re-logging in to test updated claims .\\n\\nThe `configure_is_fapi.py` script  shows how advanced authentication configurations, potentially including SCA, can be set up for applications. It specifically mentions setting up \"advanced authentication scripts\" for a given application ID . This script also includes a function `disable_skipping_consent`  which indicates that consent flows can be enforced.\\n\\n## Configuration Options\\n\\nConsent management can be enabled or disabled through configuration. The `default-identity.xml`  file contains a `<Consent>` section with an `<EnableSSOConsentManagement>` flag. This flag, when set to `true`, enables consent management during SSO .\\n\\nThe `db_separation_config.toml`  file indicates that consent data can be configured to use a specific data source, `jdbc/CONSENT_DB`, for persistence.\\n\\nFor applications, the `skipLoginConsent` property can be set to `false` to ensure that consent flows are not skipped . This is demonstrated in the `disable_skipping_consent` function in `configure_is_fapi.py` .\\n\\n## API Endpoints or Features\\n\\nThe following API endpoints related to consent management are identified:\\n*   `/api/identity/consent-mgt/v1.0/consents` : Used for managing user consents. The `SelfSignUpConsentTest` uses this endpoint to retrieve consents for a user .\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes` : Used for managing consent purposes.\\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories` : Used for managing Personally Identifiable Information (PII) categories related to consent.\\n*   `/api/identity/consent-mgt/v1.0/consents/purpose-categories` : Used for managing purpose categories for consent.\\n\\nThe system also supports FAPI (Financial-grade API) , which is a set of security profiles built on OAuth 2.0 and OpenID Connect, designed for financial services and often requires SCA. The `configure_acr` function in `configure_is_fapi.py`  suggests that advanced authentication configurations, which could include SCA, can be applied to applications.\\n\\n## Documentation References\\n\\nThe `README.md`  refers to the WSO2 Identity Server website for more information, and the wiki page \"Features and Capabilities\"  provides an overview of the product\\'s features, including consent management  and FAPI support .\\n\\n## Notes\\n\\nWhile the repository demonstrates strong capabilities in consent management and FAPI support, explicit details on how Strong Customer Authentication (SCA) is enforced specifically for Account Information Service (AIS) consent as per EBA-RTS requirements are not directly visible in the provided code snippets. The `configure_acr` function  suggests that advanced authentication mechanisms can be configured, which would be the likely place to implement SCA. However, the specifics of this implementation for EBA-RTS compliance are not detailed. Further investigation into the \"advanced authentication scripts\" mentioned in `configure_is_fapi.py` would be necessary to fully address the SCA requirement.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_f30e241e-a5cf-4517-8f5d-af1ab4c5d2af\\n', 'id': 'lc_d891ab4a-67bf-40be-8812-8f78d2ff331c'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_c4b9562d-3ce2-4c72-bf3e-8a7fe8cd831e'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0074",
      "requirement": {
        "requirement_id": "ATOM_081",
        "requirement_text": "OAuth2 based authentication SHALL be supported as a pre-step for PSU authentication in payment initiation flows",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0074_1",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_2",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_3",
          "text": "The TPPs can create OAuth 2.0 client applications to facilitate banking services exposed via Bank APIs. WSO2 Open Banking provides the Client Registration feature to register the applications in the bank's back end. The TPP applications go through an in-depth verification during this process to make sure the application is authorized and secured before sharing customers\u2019 financial data.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_4",
          "text": "### setOauthAppProperties method\nThis method lets you enable OAuth 2.0 properties related to the application. For example, ID token encryption.\n\n``` java\npublic void setOauthAppProperties(boolean isRegulatoryApp, OAuthConsumerAppDTO oauthApplication, Map<String, Object> spMetaData)\nthrows OpenBankingException {\n\n  oauthApplication.setIdTokenEncryptionEnabled(true);\n  oauthApplication.setIdTokenEncryptionAlgorithm(\"RSA-OAEP\");\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_5",
          "text": "##Writing a Custom AuthenticationWorker !!! info This is only available as a WSO2 Update from **WSO2 Open Banking Identity Server Accelerator Level 3.0.0.157** onwards. For more information on updating, see [Getting WSO2 Updates](../install-and-setup/setting-up-servers.md#getting-wso2-updates). WSO2 Open Banking Accelerator and the Toolkits built based on the Accelerator use an adaptive authentication script to define the authentication flow. In many Open Banking and BFSI use cases, it is required to change the authentication flow in various ways. The Authentication Worker is an extension point that enables Open Banking users to engage in custom business logic during the authentication flow. Listed below are such requirements: - Integrating with external components (For example, fraud detection mechanisms) and adapting the authentication based on the response - Invoking external or internal endpoints to retrieve data - Invoking external or internal endpoints to persist data - Publishing authentication-related metadata to WSO2 or external analytics receivers In such scenarios, you can simply register a Worker class and configure it to execute during the authentication flow as described below: 1. Create a Java project. (You may use an existing project for this as well.) 2. Add the Accelerator Identity as a dependency. - The JAR file for this dependency is located inside the `<OB_IS_HOME>/repository/components/dropins` directory. ``` <dependency> <groupId>com.wso2</groupId> <artifactId>com.wso2.openbanking.accelerator.identity</artifactId> <version>3.0.0.x</version> </dependency> ``` !!! note The `x` value should be greater than 157. 3. Create a Java class for the Worker implementation in a desired location of the new Java project. - Make that class an implementation of the below class from the above-added dependency. ``` java com.wso2.openbanking.accelerator.identity.auth.extensions.adaptive.function.OpenBankingAuthenticationWorker ``` A sample class is shown below: ``` java public abstract class SampleWorker implements OpenBankingAuthenticationWorker { @Override public JSONObject handleRequest(JsAuthenticationContext context, Map<String, String> map) { //Your Worker Implementation } } ``` 4. Implement the required logic inside the `handleRequest` method. 5. Once implemented, build a JAR file for the project. ##Configuring the Authentication Worker 1. Place the above-created JAR file in the `<IS_HOME>/repository/components/lib` directory. 2. Open the `<IS_HOME>/repository/conf/deployment.toml` file. 3. Add the Worker implementation. For example: ``` toml [[open_banking.identity.authentication.worker]] name = \"sampleWorker\" class = \"com.wso2.openbanking.sample.worker.impl.SampleWorker\" ``` 4. Now you can add this new logic to any authentication flow. !!! note To add this to future applications, 1. Open the `<IS_HOME>/repository/conf` directory. 2. Add this function to the original adaptive auth template file (usually named as `common.auth.script.js`). 5. You can call this new Worker method as shown below: ``` java OBAuthenticationWorker(JSAuthenticationContext, {}, \"sampleWorker\"); ``` Given below is a brief explanation of the three parameters of this method: 1. `JSAuthenticationContext` - This context is available inside any authentication element in the adaptive authentication script. Pass this context object as the first parameter. 2. Map of properties - This provides flexibility for this extension point. Add any key-value pair to this. Those keys and values will be available as a Java Map in the Worker Java implementation. You can use these properties to implement the logic you want. 3. Worker Name - This is the name of the Worker. !!! note Provide the same name you configured in the `deployment.toml` file as the Worker name in the third",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0075",
      "requirement": {
        "requirement_id": "ATOM_177",
        "requirement_text": "The system SHALL update PSU identification data via PUT requests to authorisation sub-resources and return HTTP 200",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0075_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0075_2",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support updating \"PSU identification data via PUT requests to authorisation sub-resources\" as described in your query. The codebase primarily focuses on \"Organization Management\"  and \"API Layer\" , including user and claim management through SCIM2 APIs . There are no explicit references to \"PSU identification data\" or \"authorisation sub-resources\" in the provided snippets that align with your requirement.\\n\\n## Implementation Details and API Endpoints\\n\\nThe codebase includes REST APIs for managing various aspects of the Identity Server, such as:\\n\\n*   **Organization Management API**: This API allows for CRUD operations on organizations . It supports `PUT` requests for updating organizations , but these are for organization-level attributes, not \"PSU identification data\" within \"authorisation sub-resources\".\\n*   **SCIM2 API**: This API is used for user and group management . It supports `PUT` requests to update user details, as seen in `SCIMUserUpdateTest.java`  and `SCIM2CustomSchemaMeTestCase.java` . The `scim2.yaml` Swagger definition also outlines a `PUT` operation for `/Users/{id}` to update user details, returning HTTP 200 on success . However, this is for general user attributes and not specifically \"PSU identification data\" or \"scaStatus\".\\n*   **Claim Management API**: This API allows for updating claims, including those for sub-organizations . While claims can represent user attributes, there\\'s no direct indication of \"PSU identification data\" or \"scaStatus\" being managed through this.\\n\\n## Configuration Options\\n\\nThe provided context does not explicitly detail configuration options related to \"PSU identification data\" or \"authorisation sub-resources\". The \"Organization Management\" wiki page mentions \"Organization Discovery\" configuration , but this is for directing users to the correct organization during authentication, not for managing specific PSU data.\\n\\n## Documentation References\\n\\nThe \"Organization Management\" wiki page provides a comprehensive overview of organization management functionality . The \"API Layer\" wiki page describes the overall API architecture and categories . However, neither of these documents, nor the provided code snippets, contain specific documentation for \"PSU identification data\" or \"authorisation sub-resources\" as requested.\\n\\n## Notes\\n\\nThe terms \"PSU identification data\" and \"scaStatus\" are not found within the provided codebase context. It is possible that these terms refer to a domain-specific concept not directly implemented or exposed through the APIs and functionalities described in the snippets. The closest functionality found is the updating of user attributes via SCIM2 `PUT` requests , which returns HTTP 200 on success, but this is for general user data and not specifically \"PSU identification data\" or \"scaStatus\".\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_98d7aa9e-faf7-4ddc-8e02-8722da83905d\\n', 'id': 'lc_28b548ec-8619-437d-9257-b50460658c3a'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0075_3",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_03538984-b238-4e9f-9370-a6c3fa42a3e1'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0076",
      "requirement": {
        "requirement_id": "ATOM_091",
        "requirement_text": "Multilevel SCA SHALL support authorization of payments by multiple users using explicit start of authorization mechanisms",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0076_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_2",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_3",
          "text": "reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank. In this web application, the customer: - Logs in using the login credentials. - Views information that the API consumer requested to access. - Selects the accounts that the API consumer can access. - Provides consent to the API consumer to access the information. ###Identifier-first authenticator Banks use Identifier-first authentication to authenticate the user with a second-factor authenticator instead of a password. The user who logs into the authorization web application, can provide the username, and authenticate using a second-factor authentication mechanism such as SMS-OTP/TOTP.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_4",
          "text": "## Consent Authorization\n\n- Once you enter a properly constructed authorization request in your web browser, based on the `bank_code` in the \n  request object, you will be redirected to ABC bank or DCB Bank. \n\n- A bank customer needs to enter their credentials and sign in. \n    ![sign_in](../../assets/img/toolkit/regulatory-aggregator/sign-in.png)\n- Then redirected to the Aggregator's Account selection page.\n    ![account_selection](../../assets/img/toolkit/regulatory-aggregator/account-selection.png)\n- Once the bank customer selects the accounts they want to share, the whole consent agreement is displayed.\n    ![consent_agreement](../../assets/img/toolkit/regulatory-aggregator/consent-agreement.png)\n- Once the bank customer approves this consent, the aggregator will redirect you to the registered callback URL with an \n  authorization code in the query parameters.\n   ```\n   https://wso2.com/#code=1390032d-622f-3977-a976-923505035571&id_token=eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJhdWQiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwiY19oYXNoIjoiNXFNeEhhY0d2d2IxX2ZDT29GWmlNZyIsInN1YiI6ImFiY3VzZXJAY2FyYm9uLnN1cGVyIiwic19oYXNoIjoiOU9WMVpnRXVfWWExanFxU3hWelg1ZyIsImF6cCI6IngwVWkyR2k3YTVCNGp1cTdXcHdkcFdyTjlsRWEiLCJhbXIiOlsiQ3VzdG9tRmVkZXJhdGVkQXV0aGVudGljYXRvciJdLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0Ojk0NDZcL29hdXRoMlwvdG9rZW4iLCJleHAiOjE2NTM0ODI2ODAsImlhdCI6MTY1MzQ3OTA4MCwibm9uY2UiOiJqQlhoT21PS0NCIiwic2lkIjoiZmRlODZlMzMtNjljYi00ZTIwLTgxZTMtOTFiMDJhYjlmMjM3In0.OQmAuO3yH-Ap3bPzb1NpbbFN628BdIuKYZ6kZqeDRJwLK2Z5GqtO5P2VZpEoMlRSPi15Z0eg_8Uxv1ns1Na8djpIs1UyK2zK20HzHCZh4flpXlW0AMbvoxUUbAsfDzaH8r0xpzweA471vD0HX9rja2Xio0AhsP6VPJasBxC3jnAt9H9wjqB_qXYw8-TQwVPjkFONNgEZHQ44eJFRxK7Um5TOv1fHb6Ivz4URc0R91vL1LEyaIRy8w7afGePNDQn5BHObbfzwX6O4hI_jsUVeOybG0M3-ofhEwYcvkMuiMPsLeF2Oqa849bNNr11P75TajKV7ozUBo1UJquTs7VfSnA&state=0pN0NBTHcv&session_state=13831b535eebb5527056f57766e0b5a1d66caea43afbe041f75d27adcdb954f1.PNSwGdfigyA_dxaCi45fPA \n   ```\n   - The authorization code from the above URL is in the code parameter `1390032d-622f-3977-a976-923505035571`. \n   - Extract this code for the next step.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_5",
          "text": "### setAuthenticators method\nThis method lets you configure authenticators to be invoked during the authorization flow.\n\n``` java\npublic void setAuthenticators (boolean isRegulatoryApp, String tenantDomain, ServiceProvider serviceProvider,\n                               LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\n        throws OpenBankingException {\n\n    if (isRegulatoryApp) {\n\n        List<AuthenticationStep> authSteps = new ArrayList<>();\n\n        //Step 1 - Default basic authentication\n        LocalAuthenticatorConfig localAuthenticatorConfig = new LocalAuthenticatorConfig();\n        LocalAuthenticatorConfig[] localAuthenticatorConfigs = new LocalAuthenticatorConfig[1];\n        AuthenticationStep basicAuthenticationStep = new AuthenticationStep();\n\n        String authenticatorDisplayName = \"<PRIMARY_AUTHENTICATOR_DISPLAY_NAME>\";\n        String authenticatorName = \"<PRIMARY_AUTHENTICATOR_NAME>\";\n\n        localAuthenticatorConfig.setDisplayName(authenticatorDisplayName);\n        localAuthenticatorConfig.setEnabled(true);\n        localAuthenticatorConfig.setName(authenticatorName);\n        localAuthenticatorConfigs[0] = localAuthenticatorConfig;\n\n        basicAuthenticationStep.setStepOrder(1);\n        basicAuthenticationStep.setLocalAuthenticatorConfigs(localAuthenticatorConfigs);\n        basicAuthenticationStep.setAttributeStep(true);\n        basicAuthenticationStep.setSubjectStep(true);\n        //set step 1\n        authSteps.add(basicAuthenticationStep);\n\n         if (logger.isDebugEnabled()) {\n            logger.debug(String.format(\"Authentication step 1 added: %s\", authenticatorName));\n        }\n\n        localAndOutboundAuthenticationConfig.setAuthenticationSteps(authSteps.toArray(\n                    new AuthenticationStep[0]));\n    }\n}\n```\n\n!!! tip\n    You can change the name of the Identity Provider by configuring the following tag in the \n    `<IS_HOME>/repository/conf/deployment.toml` file. For example:\n    ``` xml\n    [open_banking.sca.idp]\n    name = \"SMSAuthentication\"\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support aspects of \"Rich Authorization Requests\" (RAR) which could be foundational for implementing multilevel Strong Customer Authentication (SCA) with explicit authorization mechanisms. Specifically, the codebase includes features for defining and managing authorization details types for API resources, and for associating these types with applications. However, direct support for \"multilevel SCA\" or \"authorization of payments by multiple users\" with explicit \"start of authorization mechanisms\" is not explicitly detailed in the provided snippets.\\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository implements a mechanism for \"Rich Authorization Requests\" (RAR) through the definition and management of `AuthorizationDetailsType` objects . These types can be associated with API resources, allowing for granular control over authorization .\\n\\nThe `OAuth2RichAuthorizationRequestsTestCase`  and `OAuth2RichAuthorizationRequestsGrantTypesTestCase`  classes demonstrate the testing of these features. For instance, `OAuth2RichAuthorizationRequestsTestCase` shows how to create an API resource with specific `AuthorizationDetailsType`s , update them , and authorize them for an application .\\n\\nThe `RichAuthorizationRequestsUtils` class provides utility methods for creating test API resources and authorization details . It defines constants for different authorization detail types like `TEST_TYPE_1`, `TEST_TYPE_2`, and `TEST_TYPE_3` .\\n\\nWhile the concept of \"authorization details\" is present, the provided code snippets do not explicitly show how these details are used to implement a \"multilevel SCA\" or \"n-times SCA\" with multiple users. The `AuthorizationDetailsType`  model includes fields for `type`, `name`, `description`, and `schema`, suggesting that custom authorization rules and data structures can be defined.\\n\\n### Configuration Options\\n\\nThe `AdvancedApplicationConfiguration` class contains a boolean field `enableAuthorization` , which might be related to enabling authorization features for an application. However, its direct impact on multilevel SCA is not detailed.\\n\\nThe `OAuth2RichAuthorizationRequestsGrantTypesTestCase`  sets up applications with opaque and JWT tokens , and then adds API authorizations to these applications . This indicates that authorization configurations are managed at the application level.\\n\\n### API Endpoints or Features\\n\\nThe API Layer wiki page  describes \"Server APIs\" for administrative operations, including \"Application Management API\"  which allows CRUD operations on applications and configuration of authentication . This would be the likely interface for configuring the `AuthorizationDetailsType`s and their association with applications.\\n\\nThe `OAuth2ServiceAbstractIntegrationTest` class includes a method `authorizeSystemAPIs`  which takes an `applicationId` and a list of `apiIdentifiers` to authorize. This method uses `restClient.addAPIAuthorizationToApplication`  to add authorization, suggesting an API endpoint for managing API authorizations.\\n\\nThe `OAuth2RichAuthorizationRequestsTestCase`  further elaborates on API endpoints for managing authorization details types:\\n*   `getAPIResourceAuthorizationDetailsTypes` : To retrieve authorization details types for a given API resource.\\n*   `updateAPIResource` : To update an API resource, including its authorization details types.\\n*   `addAuthorizationDetailsTypes` : To add new authorization details types to an API resource.\\n*   `getAuthorizationDetailsType` : To retrieve a specific authorization details type.\\n*   `updateAuthorizationDetailsType` : To update a specific authorization details type.\\n*   `deleteAuthorizationDetailsType` : To delete an authorization details type.\\n*   `addAPIAuthorizationToApplication` : To authorize an API resource, including its authorization details types, for an application.\\n*   `getAPIAuthorizationsFromApplication` : To retrieve authorized API resources for an application.\\n*   `updateAPIAuthorizationsFromApplication` : To update authorized API resources for an application.\\n*   `deleteAPIAuthorizationsFromApplication` : To delete authorized API resources from an application.\\n\\nThe `OAuth2RichAuthorizationRequestsGrantTypesTestCase`  also includes `OpaqueTokenAsserter`  and `JwtTokenAsserter`  classes that assert the presence of `authorization_details` in token responses and introspected tokens  , indicating that these details are part of the OAuth2 flow.\\n\\n### Documentation References\\n\\nThe \"API Layer\" wiki page  provides a high-level overview of the API architecture, categories, implementation, versioning, and authentication/authorization mechanisms. It mentions \"API endpoints and their functionality\"  and \"Authentication and authorization mechanisms\"  which are relevant to the query. However, it does not specifically detail \"multilevel SCA\" or \"explicit start of authorization mechanisms.\"\\n\\n## Notes\\n\\nThe provided code snippets and wiki page indicate that WSO2 Identity Server supports \"Rich Authorization Requests\" (RAR) which allows for defining custom authorization details and associating them with API resources and applications. This framework could potentially be extended or configured to implement multilevel SCA with explicit authorization mechanisms. However, the current context does not provide explicit examples or direct features for \"multilevel SCA,\" \"authorization of payments by multiple users,\" or \"n-times SCA.\" The existing `AuthorizationDetailsType`  and related API management features would serve as a foundation for building such a system, but the specific logic for orchestrating multiple user approvals or explicit authorization starts is not present in the provided snippets. Further investigation into the core identity services and policy enforcement points would be necessary to confirm the full extent of support for the requested functionality.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-m_15586234-4ab9-40f2-bad5-9932ecb74358\\n', 'id': 'lc_ef56a0fe-e4ee-4e8d-8d77-22ee6bb6d337'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_3f9205c1-799d-46af-b048-fdd2320ff1ba'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0077",
      "requirement": {
        "requirement_id": "ATOM_036",
        "requirement_text": "The ASPSP SHALL return HTTP response code 201 for successful POST requests where Payment Initiation or Consent Request was correctly performed",
        "strength": "SHALL",
        "capability": "Error Handling",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0077_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports returning an HTTP `201 Created` status code for successful `POST` requests related to certain resource creations, including those that could be analogous to \"Payment Initiation or Consent Request\" in a broader API context. Specifically, the API tests demonstrate that successful creation of Identity Providers, Applications, and SCIM2 users and groups results in a `201` status code.\\n\\n### Implementation Details and API Endpoints\\n\\nThe WSO2 Identity Server\\'s REST APIs, particularly the Server APIs, are designed to return `201 Created` for successful resource creation via `POST` requests . This behavior is consistently tested across various API categories.\\n\\nFor instance, when creating an Identity Provider (IdP), the `IdPSuccessTest.java`  includes a test case `addSAMLStandardBasedIdP()`  that sends a `POST` request to the `IDP_API_BASE_PATH` . The assertion `statusCode(HttpStatus.SC_CREATED)`  explicitly verifies that an HTTP `201` status code is returned upon successful creation. A similar test `testAddIdPWithUserDefinedAuthenticator()`  also confirms this behavior for user-defined authenticators.\\n\\nSimilarly, for Application Management, the `ApplicationManagementSuccessTest.java`  contains `testCreateSAMLAppWithMetadataFile()`  which posts to `APPLICATION_MANAGEMENT_API_BASE_PATH`  and asserts `statusCode(HttpStatus.SC_CREATED)` .\\n\\nThe SCIM2 API also adheres to this standard. The `scim2.yaml`  OpenAPI definition for `POST /Me` (user self-registration) and `POST /Groups` (group creation) explicitly states that a `201` status code is returned for successful creation  . The `SCIM2RestClient.java`  client code confirms this by checking for `HttpServletResponse.SC_CREATED` (which is 201) after a user creation attempt .\\n\\nWhile \"Payment Initiation or Consent Request\" is not explicitly mentioned, the `AuthorizationDetailsType.java`  model includes an example of `payment_initiation`  as an authorization details type, suggesting that the system is designed to handle such concepts. If a \"Payment Initiation\" or \"Consent Request\" were implemented as a resource creation via a `POST` request within this framework, it would be expected to return a `201 Created` status code.\\n\\n### Configuration Options\\n\\nThe `web.xml`  configuration for the Server APIs defines the servlets and their associated service classes. The error handling mechanism, including `APIErrorExceptionMapper` , ensures consistent error responses. However, there are no specific configuration options directly exposed in the provided snippets to alter the `201` status code behavior for successful `POST` requests. This behavior is inherent to the API design for resource creation.\\n\\n### Documentation References\\n\\nThe \"Server APIs\" wiki page  provides a comprehensive overview of the Server APIs, their architecture, and common API patterns, including resource creation via `POST` requests. It states that these APIs follow REST principles  and use JSON as the primary data format. The wiki also details the API categories, such as Application Management  and Identity Provider Management , which are shown to return `201` for successful `POST` operations in their respective integration tests.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which are excellent indicators of expected API behavior. While the term \"Payment Initiation or Consent Request\" is not directly found as an API endpoint, the general pattern for successful `POST` operations creating resources (like IdPs, Applications, Users, Groups) consistently returns `HTTP 201 Created`. The `AuthorizationDetailsType` model suggests that concepts like `payment_initiation` are recognized within the system\\'s data structures, implying that if an API for such a concept were implemented, it would likely follow the established `201` response pattern for creation.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_5ccd826b-108a-48d9-94f6-b84e5db39f84\\n', 'id': 'lc_5c89e464-1e20-480b-b1d8-cb2bcbd86d3a'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0077_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support returning an HTTP 201 status code for successful POST requests across various API operations, including the creation of APIs, throttling policies, API categories, environments, labels, and subscriptions. While the prompt specifically mentions \"Payment Initiation or Consent Request,\" the provided code snippets do not directly reference these terms. However, the general pattern of returning `201 Created` for successful resource creation via POST requests is consistently present.\\n\\n### Implementation Details\\nThe codebase utilizes OpenAPI/Swagger definitions to specify API endpoints and their expected responses. For instance, the `admin-api.yaml`  and `openapi.yaml`  files explicitly define a `201` status code for successful POST operations.\\n\\nThe generated Java API clients, such as `AdvancedPolicyCollectionApi.java` , `ApiCategoryIndividualApi.java` , `ApplicationPolicyCollectionApi.java` , `CustomRulesCollectionApi.java` , `EnvironmentApi.java` , `LabelApi.java` , `SubscriptionPolicyCollectionApi.java` , `ApiRevisionsApi.java` , `CommentsApi.java` , `ApplicationsApi.java` , and `SubscriptionsApi.java`  all include `201 Created` in their `@http.response.details` for POST requests. This indicates that the API endpoints are designed to return a 201 status code upon successful creation of a resource.\\n\\n### API Endpoints or Features\\nThe repository contains various API endpoints that support POST requests and are expected to return a 201 status code upon successful resource creation. These include:\\n*   **Adding Advanced Throttling Policies**: The `throttlingPoliciesAdvancedPost` method in `AdvancedPolicyCollectionApi.java`  and the corresponding OpenAPI definition .\\n*   **Adding API Categories**: The `apiCategoriesPost` method in `ApiCategoryIndividualApi.java` .\\n*   **Adding Application Throttling Policies**: The `throttlingPoliciesApplicationPost` method in `ApplicationPolicyCollectionApi.java`  and the corresponding OpenAPI definition .\\n*   **Adding Custom Throttling Rules**: The `throttlingPoliciesCustomPost` method in `CustomRulesCollectionApi.java` .\\n*   **Adding Environments**: The `environmentsPost` method in `EnvironmentApi.java` .\\n*   **Adding Labels**: The `labelsPost` method in `LabelApi.java` .\\n*   **Adding Subscription Throttling Policies**: The `throttlingPoliciesSubscriptionPost` method in `SubscriptionPolicyCollectionApi.java` .\\n*   **Creating API Revisions**: The `createAPIRevision` method in `ApiRevisionsApi.java` .\\n*   **Adding Comments to APIs**: The `addCommentToAPI` method in `CommentsApi.java` .\\n*   **Adding Services to Service Catalog**: The `addService` operation in `openapi.yaml` .\\n*   **Creating New Applications**: The `applicationsPost` method in `ApplicationsApi.java`  and the corresponding OpenAPI definition .\\n*   **Adding New Subscriptions**: The `subscriptionsPost` method in `SubscriptionsApi.java` .\\n\\n### Configuration Options\\nThe configuration of HTTP response codes for successful POST requests is primarily defined within the OpenAPI/Swagger specification files. For example, in `admin-api.yaml`, the `post` operation for `/throttling/policies/application` explicitly lists `201` as a possible response with the description \"Created. Successful response with the newly created object as entity in the body.\" . Similar definitions exist for other POST endpoints.\\n\\n### Documentation References\\nThe generated client documentation files, such as `ApIsApi.md` , `CommentsApi.md` (publisher) , and `CommentsApi.md` (store) , explicitly state that a `201` status code is returned for successful POST operations, along with a description and relevant headers like `ETag` and `Location`.\\n\\n### Test Criteria\\nIntegration tests, such as those found in `APITestCase.txt`  and `ApplicationScopeTestCase.txt` , include assertions to verify that POST requests return a `status-code` of `201`. This confirms that the system is tested to meet the requirement of returning HTTP 201 for successful resource creation.\\n\\n## Notes\\nThe provided code snippets demonstrate a consistent pattern of returning HTTP 201 for successful POST requests that create new resources. However, the specific terms \"Payment Initiation\" or \"Consent Request\" were not found in the provided context. The answer is based on the general API design and testing practices observed for resource creation operations within the `wso2/product-apim` repository.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3efc4ea9-17e0-49e3-914f-3df89f28a5f8\\n', 'id': 'lc_6416232e-fb69-463d-8d0d-7b34cf17c601'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0078",
      "requirement": {
        "requirement_id": "ATOM_051",
        "requirement_text": "The system MUST support payment initiation transaction status 'ACFC' (AcceptedFundsChecked) when funds availability has been verified positively in addition to customer profile.",
        "strength": "MUST",
        "capability": "Funds Confirmation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0078_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"Based on the provided codebase, there is no direct support for the payment initiation transaction status 'ACFC' (AcceptedFundsChecked) or any explicit mechanisms for verifying funds availability and customer profiles to achieve this status. <cite/> The code snippets primarily deal with `AuthorizationDetailsType` and `AuthorizationDetailsTypesCreationModel` which define schemas for authorization details, including a `payment_initiation` type.   However, these models describe the structure of authorization details rather than implementing or managing transaction statuses like 'ACFC'.  \\n\\n### Implementation Details\\nThe `AuthorizationDetailsType` and `AuthorizationDetailsTypesCreationModel` classes define the structure for various authorization details, including a `payment_initiation` type.   The `schema` property within these classes uses JSON Schema to define the expected format of the authorization details.   For `payment_initiation`, the schema includes fields like `type`, `actions` (initiate, cancel), `locations`, and `instructedAmount`.   However, there are no explicit fields or logic within these models that directly correspond to transaction statuses like 'ACFC' or the verification of funds availability. <cite/>\\n\\n### Configuration Options\\nThe provided code snippets do not reveal any configuration options related to payment initiation transaction statuses or the 'ACFC' status specifically. <cite/> The `OpenIDConnectConfiguration` class includes a property `isFAPIApplication` which indicates if an application is FAPI conformant,  which is relevant to financial-grade API security, but it does not directly address transaction status management. \\n\\n### API Endpoints or Features\\nThe code snippets are models used in REST APIs, as indicated by the package structure `org.wso2.identity.integration.test.rest.api.server`.  The `AuthorizationDetailsType` and `AuthorizationDetailsTypesCreationModel` are likely used for defining and creating authorization detail types through a REST API.   However, these models do not expose any API endpoints or features for managing payment transaction statuses like 'ACFC'. <cite/> The `payment_initiation` type within the schema suggests that the system can handle payment initiation requests,  but the actual processing and status updates are not visible in these snippets. <cite/>\\n\\n### Documentation References\\nThe provided code snippets do not contain direct documentation references that describe the 'ACFC' payment initiation transaction status. <cite/> The `ApiModelProperty` annotations provide examples and descriptions for individual fields,  and the `schema` property refers to the JSON Schema document,  but these do not detail specific transaction statuses. <cite/>\\n\\n## Notes\\nThe provided code snippets are primarily related to defining data models for authorization details within the `wso2/product-is` repository.   While `payment_initiation` is mentioned as a type of authorization detail,  there is no direct evidence in these snippets to suggest support for the 'ACFC' transaction status or the underlying logic for funds availability verification. <cite/> The `isFAPIApplication` flag in `OpenIDConnectConfiguration` indicates FAPI compliance,  which is a related concept in financial services, but it does not directly address the specific transaction status. <cite/> To determine if 'ACFC' is supported, more context on the payment processing or transaction management modules would be required. <cite/>\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b3a1585d-2652-46ec-a7be-cec19548a3e4\\n\", 'id': 'lc_e66e7b73-d8d7-47a3-9dbf-310390189d31'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0078_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not appear to directly support the payment initiation transaction status \\'ACFC\\' (AcceptedFundsChecked) as described in your query. The provided code snippets primarily relate to a sample JAX-RS application for a coffee shop, general transaction management within WSO2 ESB, and API management functionalities. There is no explicit mention or implementation of \\'ACFC\\' status or a system designed for payment initiation with detailed fund availability checks and customer profile verification.\\n\\n## Implementation Details\\nThe `StarbucksOutletServiceImpl.java` file contains a `doPayment` method that handles payment processing for a coffee sample application . This method performs basic checks such as duplicate payments and invalid order IDs . It also includes a check for \"Insufficient Funds\" using `order.isAmountAcceptable(amount)` . However, this is a simplified example and does not align with the \\'ACFC\\' status, which implies a more robust verification of funds availability and customer profile. The `PaymentStatus` bean is used to return a status like \"Payment Accepted\" or \"Insufficient Funds\"   .\\n\\n## Configuration Options\\nThe `wso2/product-apim` repository includes documentation for a \"Transaction mediator\" within the WSO2 ESB context . This mediator supports distributed transactions using Java Transaction API (JTA) and allows for actions like `new`, `commit`, and `rollback`  . While this provides general transaction management capabilities, it does not specifically offer configuration options for a payment initiation transaction status like \\'ACFC\\' or for verifying funds availability and customer profiles. An example of transaction configuration is shown in `axis2.xml`, which is commented out and refers to ActiveMQ for JNDI lookups related to transactions .\\n\\n## API Endpoints or Features\\nThe `StarbucksOutletServiceImpl.java` file exposes a `doPayment` endpoint for handling payments . However, this is part of a sample application and does not represent a comprehensive payment initiation system with \\'ACFC\\' status. The `PaymentStatus` object returned by this endpoint contains a `status` field, which can be \"Payment Accepted\" or \"Insufficient Funds\"   . There are no other API endpoints or features visible in the provided context that specifically address the \\'ACFC\\' status or the detailed verification process you described.\\n\\n## Documentation References\\nThe documentation in `gateway/docs/xdoc/transactions.xml` and `traffic-manager/docs/xdoc/transactions.xml` discusses general transaction support within WSO2 ESB, focusing on the \"Transaction mediator\" and its configuration for distributed transactions  . This documentation describes how to define transaction boundaries (start, commit, rollback) but does not provide specific details on payment initiation transaction statuses like \\'ACFC\\' or the verification of funds availability and customer profiles .\\n\\n## Notes\\nThe provided code snippets and documentation do not indicate direct support for the \\'ACFC\\' (AcceptedFundsChecked) payment initiation transaction status. The `StarbucksOutletServiceImpl.java` is a sample application demonstrating basic payment functionality, and the transaction documentation refers to general distributed transaction management within WSO2 ESB, not specific payment initiation statuses. The concept of \"customer profile\" verification in the context of payment initiation is also not present in the provided materials.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_5a09dcc4-e2c2-42f4-aa39-05e93db057ab\\n', 'id': 'lc_2d4b75d2-e768-4e66-bdbf-995e242e254e'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0079",
      "requirement": {
        "requirement_id": "ATOM_031",
        "requirement_text": "The ASPSP SHALL provide a mandatory POST consents endpoint to create a consent resource defining access rights to dedicated accounts of a given PSU-ID",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0079_1",
          "text": "### Data\nThe following table explains the data available in `ConsentValidateData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| headers   | JSONObject            | The request headers sent in the request. |\n| body   | JSONObject            | The payload sent in the request. |\n| electedResource   | String            | The path invoked in the request. For example: `/accounts/{AccountId}`|\n| consentId | String                | The consent ID related to the current resource request. This consent ID is bound to the user access token used. |\n| userId | String                | The user ID related to the current resource request. This user ID is retrieved from the user access token. |\n| clientId | String                | The ID of the TPP application related to the current resource request. This client ID is retrieved from the user access token.|\n| comprehensiveConsent  | DetailedConsentResource   | The comprehensive consent object related to the consent that is being validated. This object contains all the details related to the consent. |\n| resourceParams | Map<String, String>                | A map containing the full resource path with query parameters (ex: `aisp/accounts/{AccountId}?queryParam=urlEncodedQueryParamValue`), HTTP method, and context (ex: `/open-banking/v3.1/aisp`) of the request. |\n\nThe following table explains the data available in `ConsentValidationResult`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| isValid | boolean | An attribute to identify whether the consent is in a valid state or not. |\n| modifiedPayload | JSONObject | Optionally used to set a modified error payload to be sent with the consent validation response. If a modified payload is set, it is given priority over creating a generic error response using the message and code information. |\n| consentInformation | JSONObject | Used to set the consent data to the consent validation result. This data will be sent to the bank backend. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_2",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_3",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_4",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_5",
          "text": "## Using Consent Core Service\n\nThe consent management [extension points](consent-management-manage.md) can invoke the Consent core service. WSO2 Open \nBanking Accelerator handles consent creation, update, deletion, and any other consent related functionality using a \nservice named `ConsentCoreService`. This is an interface, which you can simply invoke via any WSO2 Identity Server \nextension. The Fully Qualified Name (FQN) of `ConsentCoreService` is as follows:\n\n``` java\ncom.wso2.openbanking.accelerator.consent.mgt.service.ConsentCoreService\n```\n\n!!! note\n    The `com.wso2.openbanking.accelerator.consent.service-3.0.0.jar` JAR file inside the \n    `<IS_HOME>/repository/components/dropins` directory contains the Java implementation related to consent \n    management core services.\n    \nAccording to your requirements, invoke the relevant methods of this service. Given below is a brief description of each \nmethod.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports a `POST /consents` endpoint for managing consent resources, which can define access rights. The implementation details are primarily found within the consent management API and its integration tests.  \\n\\n## Implementation Details\\n\\nThe `POST /consents` endpoint is part of the `/api/identity/consent-mgt/v1.0/consents` API.  This endpoint is handled by the `IdentityConsentMgtV1ApiServlet` as defined in `web.xml`.  The servlet uses `org.wso2.carbon.consent.mgt.endpoint.expmapper.ConsentEndpointExceptionMapper` for exception handling and `com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider` for JSON processing. \\n\\nThe `SelfSignUpConsentTest.java` integration test demonstrates how to interact with this endpoint.  Specifically, the `selfRegister` method constructs a JSON request body that includes consent information, which is then sent to the `/api/identity/user/v1.0/me` endpoint.  The consent information within this request body is generated by the `getConsentReqBody` method, which defines details such as `jurisdiction`, `collectionMethod`, `piiPrincipalId` (PSU-ID), and `purposes` with associated `piiCategory` and `validity`. \\n\\nThe `ConsentMgtTestCase.java` also shows how to add a consent receipt using a `POST` request to the `consentEndpoint`.  This method, `addReceipt`, takes parameters like `piiPrincipalId`, `service`, `serviceDisplayName`, and `purposes` to define the consent resource. \\n\\n## Configuration Options\\n\\nThe `default-identity.xml` file defines resource access control for the consent management API.  The `POST` method to `/api/identity/consent-mgt/v1.0/consents` is secured, implying that authentication and authorization are required. \\n\\nThe `SelfSignUpConsentTest` also configures self-registration properties for resident identity providers, such as `SelfRegistration.Enable` and `SelfRegistration.LockOnCreation`, which can influence how consent is collected during user self-signup.  \\n\\n## API Endpoints and Features\\n\\nThe primary API endpoint for creating consent resources is `/api/identity/consent-mgt/v1.0/consents`.  This endpoint allows for the creation of consent receipts that define access rights. \\n\\nRelated endpoints include:\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes`: Used to add and manage purposes for consent.  \\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories`: Used to add and manage Personally Identifiable Information (PII) categories.  \\n*   `/api/identity/consent-mgt/v1.0/consents/purpose-categories`: Used to add and manage purpose categories.  \\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/{receiptId}`: Used to retrieve specific consent receipts. \\n\\nThe system also includes a `ConsentMgtPostAuthnHandler` which is an event listener that can be enabled to handle consent management after authentication. \\n\\n## Documentation References\\n\\nThe \"Integration Tests\" wiki page provides an overview of the testing framework, including how consent management tests are structured.   It mentions \"Self-Registration and Consent Tests\" and specifically references `SelfSignUpConsentTest`. \\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests, which demonstrate the functionality and API usage rather than being the core implementation itself. The actual implementation of the consent management API would reside in the `org.wso2.carbon.consent.mgt.endpoint` package, as indicated by the `web.xml` configuration.  The term \"ASPSP\" (Account Servicing Payment Service Provider) is not explicitly found in the provided code, but the functionality described aligns with the requirements of an ASPSP to manage consent for account access. The \"PSU-ID\" (Payment Services User ID) is represented by `piiPrincipalId` in the consent management API. \\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_a0ceb708-f3c0-4b7c-a5c0-7f0647b06a13\\n', 'id': 'lc_54fb1692-46b4-43b9-8c10-eb75263f1502'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_558c2aa1-1968-490b-bb80-52bd68a89254'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0080",
      "requirement": {
        "requirement_id": "ATOM_087",
        "requirement_text": "ASPSP SHALL provide list of available SCA methods to TPP when multiple authentication methods are supported for the PSU",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0080_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0080_2",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0080_3",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0080_4",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0080_5",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0081",
      "requirement": {
        "requirement_id": "ATOM_178",
        "requirement_text": "The Digest header field must be contained if and only if the Signature element is contained in the header of the request.",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0081_1",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_2",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_3",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_4",
          "text": "### Validate method\n\nThis method lets you perform validations at the filter level. Given below is the method signature.\n\n``` java\nvoid validate(ServletRequest request, String clientId) throws TokenFilterException, ServletException;\n```\n\nThe following validators are implemented by extending `OBIdentityFilterValidator`. You can customize them by extending \nthe respective class and overriding the `validate` method, which is explained above.\n\n!!! note \n    In addition to extending the below validators, you can directly extend the `OBIdentityFilterValidator` class and \n    develop your own validators.\n\n - MTLSEnforcementValidator validator\n      \n    This enforces that a certificate needs to be passed during token creation. This certificate is then bound to the \n    access token.\n     \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.MTLSEnforcementValidator \n    ```\n   \n - ClientAuthenticatorValidator validator\n\n    This validates whether the token request follows the client authentication method format that was registered through \n    Dynamic Client Registration. \n    \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.ClientAuthenticatorValidator  \n    ```\n\n - SignatureAlgorithmEnforcementValidator method\n\n    This validates whether the client assertion is signed with the algorithm that was registered through Dynamic Client Registration. \n    \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.SignatureAlgorithmEnforcementValidator \n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_5",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the configuration of digest algorithms for SAML responses, which is related to the \"Digest header field\" mentioned in your query. However, the provided code snippets primarily focus on SAML (Security Assertion Markup Language) and OAuth2/OpenID Connect (OIDC) protocols, and do not directly show an implementation of an HTTP \"Digest header\" that is conditionally present based on an HTTP \"Signature header\" as described in your prompt. \\n\\n### Implementation Details and Configuration Options\\n\\nThe codebase includes configuration options for `responseDigestAlgorithm` and `SAMLDefaultDigestAlgorithmURI` within the context of SAML. \\n\\n*   **SAML Response Digest Algorithm**: In SAML configurations, you can specify the digest algorithm to be used for signing SAML responses. \\n    *   The `responseDigestAlgorithm` in `saml-metadata-super-tenant.json` and `saml-metadata-tenant.json` lists various digest algorithms such as SHA1, SHA256, SHA384, and SHA512, with `http://www.w3.org/2001/04/xmlenc#sha256` as the default value. \\n    *   Similarly, `saml-idp.xml` contains a `DigestAlgorithm` property that can be set to `MD5`. \\n    *   `TestServer.xml` also specifies a `digestAlgorithmURI` for SAML service providers, with `http://www.w3.org/2000/09/xmldsig#sha1` as an example. \\n*   **SAML Default Digest Algorithm**: The `identity.xml` and related configuration files define a `SAMLDefaultDigestAlgorithmURI` for the SSO service, which is set to `http://www.w3.org/2000/09/xmldsig#sha1`. \\n\\nThe `OAuth2DPopTestCase.java` file demonstrates the use of a `DPOP_HEADER` in requests, which is a form of proof-of-possession.  While this involves cryptographic proofs and headers, it is distinct from the generic \"Digest header\" and \"Signature element\" in HTTP requests as described in your prompt. \\n\\n### API Endpoints or Features\\n\\nThe provided context does not explicitly show API endpoints or features that directly implement the conditional presence of a \"Digest header\" based on a \"Signature element\" in generic HTTP requests. <cite /> The `OAuth2DPopTestCase.java` shows how a `DPOP_HEADER` is added to an HTTP request for DPoP (Demonstrating Proof of Possession) tokens, but this is specific to OAuth2 DPoP and not a general HTTP Digest/Signature header mechanism. \\n\\n### Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" provides an overview of the OAuth2 and OIDC implementation in WSO2 Identity Server, including token management and standards compliance.  It mentions DPoP tokens as a type of access token, which involves cryptographic proofs.  However, it does not detail a general mechanism for HTTP Digest and Signature headers as described in your query. \\n\\n## Notes\\n\\nThe query specifically asks about the \"Digest header field\" and \"Signature element\" in the header of a request, implying a general HTTP header mechanism. The provided code snippets and wiki page primarily deal with SAML and OAuth2/OIDC specific signing and digest mechanisms, such as `responseDigestAlgorithm` for SAML responses  and the `DPOP_HEADER` for OAuth2 DPoP tokens.  These are not directly equivalent to a generic HTTP Digest header that is conditionally present with an HTTP Signature header. Therefore, based on the provided context, there is no direct evidence of support for the specific requirement as stated in the prompt. <cite />\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4fbf8bd0-af4a-4df4-87d1-f77e8f8746f8\\n', 'id': 'lc_d5b27c24-7068-43c9-84cf-35651da3e434'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support Digest Authentication, but there is no direct evidence to suggest that it enforces the specific requirement: \"The Digest header field must be contained if and only if the Signature element is contained in the header of the request.\" <cite/> The provided code snippets primarily focus on the presence or absence of the `Authorization` header for Digest Authentication, rather than a co-dependency between `Digest` and `Signature` headers.  \\n\\n## Implementation Details\\n\\nThe implementation details show how Digest Authentication is handled within the WSO2 API Manager.  \\n\\n*   **Synapse Configuration**: The `dummy_digest_api.xml` files define a Synapse API named `DigestAuth_API` with a context `/digestAuth`.   This API checks for the presence of the `Authorization` header.  \\n    *   If the `Authorization` header is present, it logs a message \"The Digest Authorization header is present in the request.\"  and sends a 200 OK response. \\n    *   If the `Authorization` header is not present, it logs \"The Digest Authorization header is not present in the request.\"  and sends a 401 Unauthorized response with a `WWW-Authenticate` header for Digest authentication. \\n*   **Test Case**: The `DigestAuthenticationTestCase.java` file demonstrates how to create, publish, subscribe to, and invoke an API configured with Digest Authentication.  \\n    *   It sets the `endpointType` to \"secured\" and `endpointAuthType` to \"digestAuth\" during API creation. \\n    *   The test then invokes the API with an `Authorization` header containing a Bearer token, which is a different authentication scheme than Digest.  This suggests the test case is verifying the overall API invocation flow rather than the specific Digest header logic. \\n\\n## Configuration Options\\n\\nThe `api-manager.xml` file shows general API Gateway configurations, including environments and caching, but does not contain specific configuration options related to the co-dependency of `Digest` and `Signature` headers. \\n\\n## API Endpoints or Features\\n\\nThe `DigestAuth_API` is an example of an API configured to use Digest Authentication.  The `api_product_template.xml` includes a `<class name=\"org.wso2.carbon.apimgt.gateway.mediators.DigestAuthMediator\"/>` which indicates that there is a mediator specifically designed to handle Digest Authentication.  However, the provided snippets do not show any API endpoints or features that explicitly link the presence of a `Digest` header to a `Signature` element. <cite/>\\n\\n## Documentation References\\n\\nNo explicit documentation references were found within the provided snippets that describe the specific requirement of the `Digest` header being present if and only if the `Signature` element is present. <cite/>\\n\\n## Conclusion\\n\\nBased on the provided codebase context, the `wso2/product-apim` repository supports Digest Authentication, primarily by checking for the `Authorization` header.  However, there is no direct evidence in the snippets to confirm the requirement that \"The Digest header field must be contained if and only if the Signature element is contained in the header of the request.\" <cite/> The existing test cases and configurations focus on the `Authorization` header for Digest authentication, not a co-dependency with a `Signature` header. \\n\\n## Notes\\n\\nThe `WebsubSubscriptionConfigurationDTO.java` file contains fields for `signingAlgorithm` and `signatureHeader`, which are related to signatures.   However, this DTO appears to be for WebSub subscriptions and not directly related to the general HTTP request header processing for Digest Authentication as described in the `dummy_digest_api.xml` files. <cite/> Similarly, `BackendJWTUtil.java` and `URLSafeJWTTestCase.java` deal with JWT signatures, which are distinct from the `Signature` element in the context of Digest authentication.   The `auth_headers.xml` file is a generic configuration for authentication headers and does not specify a co-dependency between `Digest` and `Signature` headers. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_cbe01caf-4fff-4133-9b9c-1a121357ff2f\\n', 'id': 'lc_e10243ee-125d-4d7a-9501-c0e2351f5edc'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0082",
      "requirement": {
        "requirement_id": "ATOM_139",
        "requirement_text": "The system SHALL support transaction list retrieval with dateFrom, dateTo, and bookingStatus query parameters",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0082_1",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_2",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_3",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_4",
          "text": "All dates in the HTTP headers are represented as RFC 7231 Full Dates. An\n      example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_5",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports transaction list retrieval with `dateFrom`, `dateTo`, and `bookingStatus` query parameters through its Account Information APIs. The primary API endpoint for this functionality is `/accounts/{AccountId}/transactions` . These parameters are defined within the OpenAPI specification for the Accounts API and are used to filter transaction results .\\n\\n### API Endpoints and Features\\n\\nThe system exposes a `GET` endpoint for retrieving transactions:\\n*   `GET /accounts/{AccountId}/transactions` : This endpoint is defined in the `account-info-swagger.yaml` file and is responsible for fetching transactions for a specific account .\\n\\nThe OpenAPI specification indicates support for the following parameters for filtering transactions:\\n*   `TransactionFromDateTime`: This parameter specifies the start date and time for the transaction query period. If not populated, the start date will be open-ended, returning data from the earliest available transaction .\\n*   `TransactionToDateTime`: This parameter specifies the end date and time for the transaction query period. If not populated, the end date will be open-ended, returning data up to the latest available transaction .\\n*   `bookingStatus`: While not explicitly defined as a query parameter in the `account-info-swagger.yaml` for the `GET /accounts/{AccountId}/transactions` endpoint, the `OBEntryStatus1Code` definition indicates that transactions have a `Status` which can be `Booked` or `Pending` . This suggests that filtering by booking status is a supported concept within the system\\'s data model.\\n\\n### Implementation Details\\n\\nThe `AccountService.java` in the `org.wso2.financial.services.accelerator.demo.backend` module contains a demo implementation for `getAccountTransactions` . This demo endpoint currently returns a hardcoded JSON response for transactions and does not explicitly implement filtering based on `dateFrom`, `dateTo`, or `bookingStatus` query parameters . However, the presence of these parameters in the OpenAPI specification indicates that the system is designed to support them.\\n\\nThe `ConsentAuthorizeUtil.java` class includes a `populateAccountData` method that processes `TransactionFromDateTime` and `TransactionToDateTime` from consent data, suggesting that these date parameters are handled during the consent authorization flow .\\n\\nThe `DefaultConsentManageValidator.java` also validates `TransactionFromDateTime` and `TransactionToDateTime` to ensure they are valid ISO 8601 dates and that the \"to\" date is not before the \"from\" date . This validation occurs during the consent initiation process, ensuring that any date ranges specified for transaction access are logically sound.\\n\\n### Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, is used for centralized configuration . While the provided snippets do not show specific configuration options directly related to enabling or disabling `dateFrom`, `dateTo`, or `bookingStatus` filtering for transaction retrieval, the system\\'s modular architecture and extensive external service integration framework suggest that such filtering logic could be customized or extended .\\n\\n### Documentation References\\n\\nThe `Overview` wiki page mentions that the accelerator implements regulatory standards for Open Banking capabilities, including account information services . The `account-info-swagger.yaml` file serves as the primary documentation for the Account Information APIs, detailing the available endpoints, parameters, and responses .\\n\\n## Notes\\n\\nThe provided `AccountService.java` is a demo backend service . Its current implementation for `getAccountTransactions` returns static data and does not include the logic to process `dateFrom`, `dateTo`, or `bookingStatus` query parameters . However, the OpenAPI specification (`account-info-swagger.yaml`) clearly defines `TransactionFromDateTime` and `TransactionToDateTime` as part of the consent object, which implies that the system is designed to handle these filtering criteria . The `OBEntryStatus1Code` definition also indicates that transaction status (`Booked`, `Pending`) is a recognized attribute . Therefore, while the demo backend might not fully implement the filtering, the core API design supports it.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4c8ac8c9-7cdb-4c96-baef-677b010a21da\\n', 'id': 'lc_f6cb84bc-aea0-4d04-8c5b-5d197f9740fe'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0083",
      "requirement": {
        "requirement_id": "ATOM_063",
        "requirement_text": "The system MUST support consent status 'terminatedByTpp' when AIS has terminated the consent.",
        "strength": "MUST",
        "capability": "Consent Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0083_1",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0083_2",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0083_3",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0083_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0083_5",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0083_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, includes integration tests for consent management, but it does not explicitly support or define the consent status `\\'terminatedByTpp\\'`. The existing consent management features primarily focus on adding PII categories, purpose categories, purposes, and consent receipts, as well as handling user consent during self-registration and OAuth2/OIDC flows.\\n\\n### Implementation Details, Configuration Options, and API Endpoints\\n\\nThe codebase contains integration tests for consent management, specifically within the `ConsentMgtTestCase.java`  and `SelfSignUpConsentTest.java`  files. These tests interact with a consent management API endpoint, `CONSENT_ENDPOINT_SUFFIX = \"/api/identity/consent-mgt/v1.0/consents\"` .\\n\\nThe `ConsentMgtTestCase` demonstrates adding PII categories, purpose categories, purposes, and consent receipts through POST requests to various sub-endpoints of the main consent endpoint . For example, adding a PII category involves a POST request to `consentEndpoint + \"/\" + \"pii-categories\"` .\\n\\nThe `SelfSignUpConsentTest` focuses on consent collection during user self-registration . It also includes a method `getConsents`  which performs a GET request to retrieve existing consents for a user.\\n\\nThe `default-identity.xml` configuration file indicates that consent management can be enabled during SSO with the `<EnableSSOConsentManagement>true</EnableSSOConsentManagement>`  setting. It also defines resource access control for various consent management API endpoints, including GET, POST, and DELETE operations for `/api/identity/consent-mgt/v1.0/consents`, `/api/identity/consent-mgt/v1.0/consents/receipts/(.*)`, `/api/identity/consent-mgt/v1.0/consents/purposes(.*)`, `/api/identity/consent-mgt/v1.0/consents/pii-categories(.*)`, and `/api/identity/consent-mgt/v1.0/consents/purpose-categories(.*)` .\\n\\nHowever, there is no explicit mention or implementation of a consent status `\\'terminatedByTpp\\'` within the provided code snippets. The existing consent management APIs and tests do not appear to support a direct mechanism for a TPP to terminate consent and set this specific status. The `sendOAuthConsentApprovePost` method in `OAuth2CommonClient.java`  allows for \\'Approve Once\\', \\'Approve Always\\', or \\'Deny\\' actions, but not a \\'terminatedByTpp\\' status.\\n\\n### Test Criteria\\n\\nTo verify that consent resources achieve a `\\'terminatedByTpp\\'` status when a TPP initiates termination, new functionality would need to be implemented. The current integration tests, such as `ConsentMgtTestCase`  and `SelfSignUpConsentTest` , do not cover this specific scenario. A new test case would be required to:\\n1. Simulate a TPP initiating consent termination.\\n2. Call a new or modified API endpoint that handles TPP-initiated termination.\\n3. Verify that the consent resource\\'s status is updated to `\\'terminatedByTpp\\'`.\\n\\n## Notes\\n\\nThe provided codebase primarily focuses on the creation, approval, and retrieval of consent receipts and related entities (PII categories, purposes). While consent management is a core feature, the specific consent status `\\'terminatedByTpp\\'` and the mechanism for a TPP to initiate termination are not evident in the given snippets. The existing API endpoints and test cases do not provide direct support for this functionality. Implementing this would likely require extending the current consent management API and adding corresponding integration tests.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_1a5b46ec-f1f7-45b8-b1bb-dd517685ab7e\\n', 'id': 'lc_271af9b1-a19d-478b-84bd-93e8a70ac983'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0083_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_d39055f0-881f-4f0c-b833-58a92241df4c'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0084",
      "requirement": {
        "requirement_id": "ATOM_124",
        "requirement_text": "ASPSP SHALL deny access if the requested Account Information Service type does not comply with the consented service",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0084_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports denying access if the requested Account Information Service type does not comply with the consented service through its Consent Management framework, particularly in the context of OAuth2/OIDC flows. The system enforces consent decisions by filtering claims and scopes during token issuance and API responses.   This functionality is demonstrated in integration tests that verify claims are filtered based on user consent. \\n\\n## Implementation Details\\n\\nThe core of this functionality lies within the Consent Management framework, which is designed to collect, store, and manage user consent for processing personal data.   When a user authenticates and provides consent, the system records these decisions.  During token issuance, only attributes for which consent has been granted are included in the tokens.  Similarly, API responses filter user information based on consent. \\n\\nThe `OAuth2ServiceAuthCodeGrantJWTAccessTokenWithConsentedTokenColumnTestCase` demonstrates this by requesting specific scopes (`openid`, `email`, `address`)  and then explicitly removing consent for the `country` claim (part of the `address` scope) . The subsequent `testClaims` method asserts that the `email` claim is present, but the `address` claim is `null`, indicating that access to the non-consented service type (address information) was denied. \\n\\nThe `sendApprovalPostWithConsent` method in `OAuth2ServiceAbstractIntegrationTest` is responsible for sending the user\\'s consent decisions to the system.  This method takes a list of `consentClaims` which are then included in the approval post request. \\n\\n## Configuration Options\\n\\nThe `default-identity.xml` configuration file contains a section `<UserConsentEnabledGrantTypes>`  which explicitly lists the grant types for which user claims will be filtered based on user consent in responses like `id_token` or user info.  By default, `authorization_code` and `implicit` grant types are configured to enable user consent.  This configuration directly impacts whether the system enforces consent for specific service types requested via these grant types.\\n\\n## API Endpoints or Features\\n\\nThe Consent Management framework integrates with OAuth2/OIDC to support custom scopes and claims.  This allows for defining application-specific scopes and mapping custom attributes to standard OIDC claims.  Consent can be collected and enforced at the scope level, meaning if a user does not consent to a particular scope, the corresponding information will not be shared. \\n\\nThe `UserInfoEndpoint` is a key API endpoint where consent enforcement takes place.  The `sendRequestToUserInfoEndpoint` method in `OAuth2ServiceWithConsentedTokenColumnAbstractIntegrationTest` demonstrates how requests are made to this endpoint, and the subsequent assertions verify that non-consented claims are not returned. \\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, explaining its purpose in collecting, storing, and managing user consent for personal data processing.  It outlines the key components, consent collection process, and consent enforcement mechanisms, including how consent decisions affect token issuance and API responses. \\n\\n## Test Criteria\\n\\nThe integration tests, specifically `OAuth2ServiceAuthCodeGrantJWTAccessTokenWithConsentedTokenColumnTestCase`  and `OAuth2ServicePasswordGrantJWTAccessTokenWithConsentedTokenColumnTestCase` , verify that requests for non-consented service types are denied. For example, in `OAuth2ServiceAuthCodeGrantJWTAccessTokenWithConsentedTokenColumnTestCase`, after explicitly removing consent for the `country` claim, the test asserts that the `address` claim (which would contain the country) is `null` in the `UserInfoEndpoint` response.  This directly addresses the test criteria of verifying denial of access for non-consented service types.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which are excellent for demonstrating functionality and verifying requirements. While they show *how* the system behaves, they do not expose the internal implementation details of the consent enforcement logic itself (e.g., the specific Java classes responsible for filtering claims based on consent). However, the presence of these tests and the configuration options strongly indicate that the functionality is supported.  \\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_8fbebe46-e433-499d-8b87-7e502bd43e07\\n', 'id': 'lc_6cf6ea35-1cb0-4164-becf-05d4b6e17337'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0084_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, WSO2 API Manager, supports denying access if the requested Account Information Service (AIS) type does not comply with the consented service through its consent management features and policy enforcement capabilities.    This is primarily achieved through the integration of consent management features and the ability to define and enforce policies that can restrict API access based on various conditions.  \\n\\n### Implementation Details\\n\\nThe WSO2 API Manager includes features for consent management, which are integrated into its build system.  Specifically, the `gateway/modules/p2-profile/product/pom.xml` file includes `featureArtifactDef` entries for `org.wso2.carbon.consent.mgt.server.feature` and `org.wso2.carbon.identity.consent.mgt.server.feature`.  These features indicate the presence of server-side components for managing consent. \\n\\nThe platform also supports defining custom mediation sequences that can inspect incoming requests and apply logic to deny access.  For instance, a custom `IN-sequence` can read headers like `User-Agent` to identify the client type, and a custom `OUT-sequence` can use a filter to restrict data based on this information.   This mechanism can be extended to check for consented service types and deny requests that do not comply. \\n\\n### Configuration Options\\n\\nConfiguration related to consent and access control can be found in `default.json` files within the distribution modules.  Key configuration parameters include:\\n\\n*   `authentication.consent.data_source`: Specifies the JDBC data source for consent-related data. \\n*   `authentication.consent.prompt`: A boolean flag to enable or disable consent prompting. \\n*   `oauth.prompt_consent`: Another boolean flag related to OAuth consent prompting. \\n*   `resource_access_control.default_access_allow`: This setting, if set to `false`, could enforce a default deny policy, requiring explicit allow rules. \\n\\nAdditionally, the system supports \"Deny Policies\" which can be managed via API endpoints.  These policies allow for blocking conditions based on various attributes. \\n\\n### API Endpoints or Features\\n\\nThe Admin API provides endpoints for managing deny policies:\\n\\n*   `GET /throttling/policies/deny-policies`: Retrieves all existing deny policies.  You can query these policies using `conditionType` and `conditionValue` to filter based on specific criteria, such as API or application. \\n*   `DELETE /throttling/policies/deny-policy/{conditionId}`: Deletes an existing deny policy. \\n\\nThe system also supports custom throttling policies, which can be configured to deny access based on request rates or other conditions.  \\n\\n### Documentation References\\n\\nThe `all-in-one-apim/sample-scenarios/sample3/README.md` provides a sample use case where API output is optimized or restricted based on the client.  It specifically mentions restricting mobile device clients from accessing all account information, which is analogous to denying access for non-consented service types.  This document refers to external documentation for \"Adding Mediation Extensions\" which would be relevant for implementing custom access denial logic. \\n\\nAnother relevant sample scenario, `all-in-one-apim/sample-scenarios/sample2/README.md`, discusses restricting API access and subscriptions by business units, which demonstrates the platform\\'s capability for fine-grained access control. \\n\\n## Notes\\n\\nThe provided snippets indicate that WSO2 API Manager has the necessary components and mechanisms to implement the requirement of denying access for non-consented service types. The consent management features, combined with flexible policy enforcement through custom mediation sequences and deny policies, allow for granular control over API access. While the snippets don\\'t directly show code for \"Account Information Service type\" or \"consented service\" in the context of Open Banking, the underlying capabilities for consent management and policy-based access control are present and can be configured to meet this requirement.   \\n\\nWiki pages you might want to explore:\\n- [Build System (wso2/product-apim)](/wiki/wso2/product-apim#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_fed0f440-0e19-42a9-b968-1e5f9ec2ca0b\\n', 'id': 'lc_f698d491-d650-4308-b2ad-8f9f5afbb6a3'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0085",
      "requirement": {
        "requirement_id": "ATOM_032",
        "requirement_text": "The ASPSP SHALL provide a mandatory GET consents/{consentId} endpoint to read the exact definition of the given consent resource including validity status",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0085_1",
          "text": "### getConsent method\n\nThis method lets you retrieve a consent with or without its attributes by performing the following: \n\n- Retrieves the consent for status validation\n- Optionally retrieves consent attributes according to the value of the withConsentAttributes flag\n- Checks whether the retrieved consent involves a file\n  \n``` java\nConsentResource getConsent(String consentID, boolean withConsentAttributes) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_2",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_3",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_4",
          "text": "### getDetailedConsent method\n \nThis method lets you retrieve detailed consent for a given consent ID. A detailed consent includes the following in \naddition to consent resource-specific data: \n\n - Relative consent authorization data\n - Relative consent account mapping data \n - Relative consent attributes\n \n``` java\nDetailedConsentResource getDetailedConsent(String consentID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_5",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0086",
      "requirement": {
        "requirement_id": "ATOM_021",
        "requirement_text": "The API SHALL support signing of a group of transactions with one SCA process",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0086_1",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_2",
          "text": "ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify fraudulent activities. 7. **API Security** - API consumers invoke APIs to access customer\u2019s financial information. Therefore, API security plays a vital role in open banking to mitigate data theft. The solution has built-in support for global industry-standards such as OpenID Connect Financial Grade API (FAPI), OAuth 2.0, Electronic Identification and Trust Services (eIDAS). API security can be categorised into two main levels: - Application layer security - Validates API consumers against the certificates issued by competent authorities. For example: open banking directories, Qualified Trust Service Providers (QTSPs). Also, the solution supports OAuth2 security implementations such as Private key JWT authentication, client-credentials grant type, and authorization code grant type. - Transport layer security - Secures the communication between the API consumer, and the bank using Mutual Transport Layer Security (MTLS). 8. **User Experience** - The solution provides an enhanced user experience for the banks, API consumers, and customers with self-explanatory and simple actions. 9. **Premium APIs and Monetization** - Using the capabilities in WSO2 API Manager, WSO2 Open Banking Accelerator allows: - banks to publish highly-performant custom APIs for API consumers. - banks to expose their performance and compliance data by integrating into analytics engines. - banks to plug in any billing engines with subscription-based freemium, tiered pricing, or per-request pricing. 10. **Standards-based API Templates** - WSO2 API Manager offers standard API management capabilities, and you can customize the API templates according to your open banking and other requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_3",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_4",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_5",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase context, there is no direct evidence or explicit mention of support for \"signing of a group of transactions with one SCA process\" within the WSO2 Identity Server. The available information primarily focuses on authentication protocols like OAuth 2.0/OpenID Connect and SAML 2.0, user management, and API architecture. \\n\\nThe codebase does not contain specific implementation details, configuration options, API endpoints, or documentation references related to grouping multiple transactions for a single Strong Customer Authentication (SCA) process. <cite/>\\n\\n## Notes\\n\\nThe term \"SCA process\" is not found within the provided code snippets or the wiki page. The codebase extensively covers various aspects of Identity and Access Management, including SAML SSO, OAuth2, and SCIM, but these do not directly address the concept of grouping transactions for a single SCA.  While there are references to signing in the context of SAML responses, such as `SAMLSSOSigner` and `SAMLDefaultSigningAlgorithmURI`, these relate to the signing of SAML assertions for authentication and not to the signing of a group of financial or other types of transactions.  Therefore, these are not relevant to the user\\'s query about grouping transactions for SCA. <cite/>\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_90c5828d-a6a5-4529-bfa0-89bb39ba9721\\n', 'id': 'lc_eada8267-c1ed-4a99-8506-a952378500d4'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_b38e9d57-d22d-46a6-acaf-a6760fcd1ff8'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0087",
      "requirement": {
        "requirement_id": "ATOM_123",
        "requirement_text": "ASPSP SHALL deny access for one-off consent if AISP requests data more than once or if consent validity has timed out",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0087_1",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_2",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_3",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports denying access for one-off consents if the data is requested more than once or if the consent validity has timed out. This functionality is primarily handled through OAuth 2.0 configurations related to token validity periods and authorization code reuse prevention.  \\n\\n## Implementation Details\\n\\nThe system enforces denial of access for one-off consents through the management of authorization codes and request URIs. Specifically, an authorization code, once used, is invalidated to prevent reuse.  The `testAuthzCodeResend` method in `OAuth2ServiceAuthCodeGrantCacheDisabledTestCase.java` demonstrates this by attempting to reuse an authorization code, which results in an `invalid_grant` error.  This test case confirms that the system correctly revokes access tokens upon reuse of an authorization code. \\n\\nAdditionally, for Pushed Authorization Requests (PAR), request URIs have a defined timeout.  The `testSendAuthorizeWithExpiredRequestURI` method in `OAuth2PushedAuthRequestTestCase.java` explicitly tests this by waiting for a request URI to expire and then attempting to use it, which leads to an `oauthErrorMsg=par.request.uri.expired` error. \\n\\n## Configuration Options\\n\\nThe validity periods for various OAuth 2.0 tokens and codes can be configured in the `identity.xml` file. \\n\\nKey configuration elements include:\\n*   `<AuthorizationCodeDefaultValidityPeriod>`: Defines the default validity period for authorization codes in seconds. \\n*   `<AccessTokenDefaultValidityPeriod>`: Sets the default validity period for application access tokens in seconds. \\n*   `<UserAccessTokenDefaultValidityPeriod>`: Specifies the default validity period for user access tokens in seconds. \\n*   `<RefreshTokenValidityPeriod>`: Configures the validity period for refresh tokens. \\n\\nThese settings directly influence how long a consent remains valid and when it will be denied due to timeout. \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoints and features involved in consent management and token validation include:\\n*   **Authorization Endpoint**: Used to initiate the OAuth 2.0 authorization flow, where consent is typically granted. \\n*   **Token Endpoint**: Used to exchange authorization codes for access tokens. \\n*   **Pushed Authorization Request (PAR) Endpoint**: Supports pre-registering authorization request parameters, which have their own validity period. \\n*   **Consent Management APIs**: The system provides REST APIs for managing consents, including `/api/identity/consent-mgt/v1.0/consents` for general consent operations.  These APIs allow for the creation, retrieval, and deletion of consent receipts. \\n\\n## Documentation References\\n\\nThe \"Features and Capabilities\" wiki page for `wso2/product-is` provides an overview of the system\\'s support for OAuth 2.0 and OpenID Connect, including advanced features like token revocation and Pushed Authorization Requests.   It also mentions \"Consent Management\" as an advanced security feature, indicating the system\\'s ability to define purposes, collect, and revoke user consent. \\n\\n## Test Criteria Verification\\n\\nThe provided test criteria can be verified through existing integration tests:\\n*   **Denial on second access attempt**: The `testAuthzCodeResend` method in `OAuth2ServiceAuthCodeGrantCacheDisabledTestCase.java` directly tests this scenario by attempting to reuse an authorization code and asserting that an `invalid_grant` error is returned. \\n*   **Denial after timeout period**: The `testSendAuthorizeWithExpiredRequestURI` method in `OAuth2PushedAuthRequestTestCase.java` simulates a timeout by pausing execution and then attempting to use an expired request URI, verifying that the system returns a `par.request.uri.expired` error.  The default validity period for authorization codes is 300 seconds (5 minutes), as configured by `<AuthorizationCodeDefaultValidityPeriod>300</AuthorizationCodeDefaultValidityPeriod>` in `default-identity.xml`. \\n\\n## Notes\\n\\nThe provided snippets primarily focus on OAuth 2.0 authorization code and Pushed Authorization Request (PAR) mechanisms. While these are crucial for managing one-off consents and their validity, the term \"one-off consent\" itself is not explicitly defined or used as a distinct technical concept within the provided code. The system\\'s behavior aligns with the requirements for one-off consents by ensuring that authorization codes are single-use and that request URIs expire. The consent management APIs mentioned in `default-identity.xml`  provide the underlying infrastructure for managing consent records, but the enforcement of \"one-off\" behavior is handled at the OAuth 2.0 protocol level.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_4ee75e4b-3155-406c-866e-d69dbe34ce26\\n', 'id': 'lc_0048ce89-7f53-4371-838a-4a533be973f7'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_01b85bae-603c-403e-a56b-cd36dd6664cd'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0088",
      "requirement": {
        "requirement_id": "ATOM_149",
        "requirement_text": "API responses MUST include proper HTTP headers including X-Request-ID and Content-Type",
        "strength": "MUST",
        "capability": "General",
        "section_id": "f30dd2c91d5e",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0088_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the inclusion of `Content-Type` headers in API responses, but there is no explicit evidence in the provided snippets for `X-Request-ID` or `Date` headers. The `Content-Type` header is consistently set in various test client implementations when making requests.    \\n\\n## Implementation Details\\n\\nThe `RestBaseClient` class, which serves as a base for various REST clients in the integration tests, defines `CONTENT_TYPE_ATTRIBUTE` as a constant for the \"Content-Type\" header.  This constant is used when constructing HTTP request headers. For instance, in `OAuth2RestClient`, the `getHeadersWithBearerToken` method explicitly sets the `Content-Type` header to `ContentType.JSON`.  Similarly, `OrgDiscoveryConfigRestClient` and `APIResourceManagementClient` also set the `Content-Type` header to `ContentType.JSON` when making requests.  \\n\\nThe `RESTTestBase` class, used for API testing, also explicitly sets the `Content-Type` header in its `given()` calls for various HTTP methods like POST and PUT.  \\n\\nWhile these snippets demonstrate that `Content-Type` is handled for outgoing requests, there is no direct code in the provided context that explicitly adds `X-Request-ID` or `Date` headers to *responses* from the server. The integration tests, such as `IdPSuccessTest`, verify the `Location` header and `statusCode` in responses, but do not explicitly check for `X-Request-ID` or `Date` headers.  \\n\\n## Configuration Options\\n\\nThe provided code snippets do not reveal any explicit configuration options for enabling or disabling `X-Request-ID`, `Date`, or `Content-Type` headers in API responses. The `Content-Type` header appears to be a standard part of the HTTP request/response handling within the test clients. \\n\\n## API Endpoints or Features\\n\\nThe Server APIs, as described in the wiki, are RESTful interfaces that use JSON as the primary data format for requests and responses.  This implies that `Content-Type: application/json` would be a standard header for many responses. The API architecture involves servlets configured in `web.xml`, which handle various API versions and categories.   Error handling is managed through exception mappers, but these do not explicitly mention adding specific headers like `X-Request-ID` or `Date`.  \\n\\n## Documentation References\\n\\nThe \"Server APIs\" wiki page provides an overview of the API architecture, categories, and implementation details.  It mentions that the APIs follow REST principles and use JSON for requests and responses, which implicitly covers the `Content-Type` header.  However, there are no specific documentation references within the provided context that detail the inclusion of `X-Request-ID` or `Date` headers in API responses.\\n\\n## Test Criteria Verification\\n\\nThe integration tests, such as `IdPSuccessTest`, verify the `Location` header and the HTTP status code of responses.   The `HttpHeaders` class from Apache HTTP Components is used to refer to standard HTTP headers like `LOCATION` and `CONTENT_TYPE`.  While `Content-Type` is used in requests, there are no explicit assertions in the provided test snippets to verify the presence or value of `X-Request-ID`, `Date`, or `Content-Type` headers in the *responses*.\\n\\n## Notes\\n\\nThe provided snippets primarily focus on the client-side construction of requests and the verification of basic response elements like status codes and the `Location` header. While `Content-Type` is clearly handled for outgoing requests, there is no direct evidence in the provided context to confirm that `X-Request-ID` and `Date` headers are explicitly added to *all API responses* by the server, nor are there tests verifying their presence in responses. The `CONTENT_TYPE_ATTRIBUTE` constant in `RestBaseClient`  and its usage in various `getHeaders` methods    indicates that `Content-Type` is a recognized header, but its presence in *responses* is not explicitly confirmed by the provided code.\\n\\nWiki pages you might want to explore:\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_68b4cf22-6b56-4ebc-b9f4-eb25140574ef\\n', 'id': 'lc_5727a207-5814-4b34-a4c9-2a3ecd277d83'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0088_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the inclusion of `Content-Type` and `Last-Modified` headers in API responses, and in some cases, `ETag` and `Location` headers. However, there is no explicit mention or configuration option for an `X-Request-ID` header in the provided snippets. The documentation primarily focuses on the `Content-Type`, `ETag`, and `Last-Modified` headers.\\n\\n## Implementation Details and Configuration Options\\n\\nThe provided OpenAPI/Swagger YAML files define the expected response headers for various API endpoints. For example, in `all-in-one-apim/sample-scenarios/clients/store/src/main/resources/store-api.yaml`, the `Content-Type` header is consistently defined for successful `200 OK` responses across different API calls, such as retrieving a list of APIs  and individual API details . Similarly, `ETag` and `Last-Modified` headers are also specified for caching and conditional requests .\\n\\nThe `Content-Type` header is also defined as a required parameter in some API requests, with a default value of `application/json` . This indicates that the system expects and handles this header for both requests and responses.\\n\\nThe `openapi.yaml` files in the `modules/integration/tests-common` directory also confirm the presence and description of `Content-Type`, `ETag`, `Last-Modified`, and `Location` headers in API responses for various administrative and publishing operations  .\\n\\n## API Endpoints and Features\\n\\nThe API definitions across different YAML files consistently show the inclusion of `Content-Type`, `ETag`, and `Last-Modified` headers in the `responses` section for successful operations (e.g., `200 OK`).\\n\\nFor instance, when retrieving API details, the response headers include `Content-Type`, `ETag`, and `Last-Modified` . Similar patterns are observed for retrieving swagger definitions  and generating SDKs .\\n\\nThe `x-wso2-response` fields in the YAML files provide examples of actual HTTP responses, which consistently include `Content-Type` . For example, a `GET` request to `/apis/{apiId}` shows `Content-Type: application/json` in the response .\\n\\n## Documentation References\\n\\nThe OpenAPI/Swagger definitions themselves serve as documentation for the API responses. They explicitly list the headers that are part of the response for each endpoint and HTTP status code. For example, the `ApIsApi.md` documentation file generated for the publisher client clearly states that `Content-Type`, `ETag`, `Last-Modified`, and `Location` headers are part of the `200 OK` response for updating WSDL definitions .\\n\\n## X-Request-ID\\n\\nThere is no direct evidence in the provided code snippets or documentation that `X-Request-ID` is explicitly supported or configured as a response header. The OpenAPI definitions consistently list `Content-Type`, `ETag`, `Last-Modified`, and sometimes `Location`, but `X-Request-ID` is not mentioned.\\n\\n## Notes\\n\\nThe provided snippets are primarily OpenAPI/Swagger definitions (`.yaml` files) and generated client documentation (`.md` and `.java` files). These files describe the API contract, including expected request and response headers. While `Content-Type`, `ETag`, and `Last-Modified` are well-documented and consistently present, `X-Request-ID` is not. The absence of `X-Request-ID` in these API definitions suggests that it might not be a standard header returned by these specific API endpoints, or its inclusion is handled at a lower level (e.g., by an API Gateway or a common interceptor) and not explicitly documented in these OpenAPI specifications. To confirm the presence of `X-Request-ID`, further investigation into the actual server-side implementation or API Gateway configurations would be necessary.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_6be14e4c-eec1-462a-8614-08b73f386faa\\n', 'id': 'lc_ae99fa0b-6710-48cb-bf7d-f6b41ba54aeb'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0089",
      "requirement": {
        "requirement_id": "ATOM_180",
        "requirement_text": "The certificate used for signing the request must be provided in base64 encoding in the TPP-Signature-Certificate header field.",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0089_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the handling of base64 encoded certificates, which is relevant to the `TPP-Signature-Certificate` header field requirement. The system provides functionalities for encoding and decoding certificates in base64 format, and for updating application certificates.\\n\\n### Implementation Details\\nThe `wso2/product-is` repository includes utility methods for handling base64 encoding and decoding of certificates. The `convertToPem` method in `OAuth2ServiceAbstractIntegrationTest.java`  converts an `X509Certificate` to PEM format, which involves base64 encoding the certificate\\'s bytes. Specifically, it uses `java.util.Base64.getEncoder().encode(x509Certificate.getEncoded())`  to perform the base64 encoding.\\n\\nConversely, the `parseCertificate` method in `Oauth2JWKSEndpointTestCase.java`  demonstrates decoding a base64 encoded certificate string back into an `X509Certificate` object using `java.util.Base64.getDecoder().decode(StringUtils.trim(content))` .\\n\\nThe `updateApplicationCertificate` method in `OAuth2ServiceAbstractIntegrationTest.java`  is responsible for updating an application\\'s certificate. This method takes an `X509Certificate` object, converts it to PEM format (which includes base64 encoding) using `convertToPem` , and then sets this certificate value in an `ApplicationPatchModel` .\\n\\n### Configuration Options\\nWhile there isn\\'t a direct configuration option explicitly named `TPP-Signature-Certificate` in the provided snippets, the system allows for the configuration of certificates for applications. The `oidc-metadata.json`  file indicates support for `accessTokenBindingType` including `certificate`, suggesting that certificates can be bound to access tokens for enhanced security.\\n\\nThe `PreUpdatePasswordTestBase.java`  file shows a `TEST_CERTIFICATE` constant which is a base64 encoded string, indicating that certificates can be provided in this format for various functionalities within the system.\\n\\n### API Endpoints or Features\\nThe `updateApplicationCertificate` method  suggests an API or feature for updating application certificates. This is further supported by `OAuth2RequestObjectSignatureValidationTestCase.java` , which includes a test case `updateServiceProviderCert` that calls `updateApplicationCertificate` to update the public certificate of a service provider.\\n\\nThe `KeystoreMgtRestClient.java`  provides an `importCertToStore` method, which is an API for uploading certificates to the tenant keystore. This method takes a `CertificateRequest` object, implying that certificates can be provided through this API.\\n\\n### Documentation References\\nThe \"OAuth2 and OpenID Connect\" wiki page <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" /> mentions \"Certificate\" as a token binding type <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" />, which implies that the system supports certificate-based authentication or validation. This wiki page also references `oidc-metadata.json`  which lists \"certificate\" as an `accessTokenBindingType` option.\\n\\n## Notes\\nThe provided code snippets primarily demonstrate the internal handling and testing of base64 encoded certificates within the `wso2/product-is` repository. While the `TPP-Signature-Certificate` header field is not explicitly mentioned, the presence of robust base64 encoding/decoding utilities and certificate management APIs strongly suggests that the system can process certificates provided in base64 format, which would be a prerequisite for supporting such a header. The `oidc-fapi-conformance-tests/resource-server/resource-server.py`  also shows `computeSHA256Thumbprint` which processes client certificates, further indicating certificate handling capabilities.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_555db6fd-8335-4efa-bbfd-5535f307d67a\\n', 'id': 'lc_2821adf6-ef2e-4092-86db-2a4ea86b41ab'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0089_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the use of base64 encoded certificates for signing requests, particularly in the context of mutual SSL and JWT-related functionalities. The `TPP-Signature-Certificate` header field is not explicitly mentioned, but the system handles base64 encoded certificates for client authentication and JWT signing.   \\n\\n## Implementation Details\\n\\nThe system uses `Base64` encoding for certificates in several scenarios.  \\n\\n### Client Certificate Handling\\nThe `ClientCertificateCreationBean` class is used to encapsulate details for uploading client certificates, including the `certificate` field which is expected to be a \"Relevant Base64 encoded certificate\".   This bean is used to add a client certificate with an action named `addClientCertificate`. \\n\\nIn `APISecurityTestCase.java`, there\\'s a test method `testAPIInvocationWithMutualSSLHeader()` that demonstrates sending a base64 encoded certificate in the `X-WSO2-CLIENT-CERTIFICATE` header.  The `generateBase64EncodedCertificate()` method reads a certificate file and encodes it using `Base64.encodeBase64URLSafeString()`. \\n\\n### JWT Signing and Validation\\nThe `APIMTestCaseUtils.java` file contains utility methods for handling JWTs, including decoding JWT parts using `Base64.decodeBase64()`.  It also includes logic to validate JWT signatures by retrieving a certificate from a keystore and initializing a `Signature` object with it. \\n\\nIn `JWTGrantTestCase.java` and `ExternalIDPJWTTestCase.java`, when adding an identity provider, a public certificate is read from a keystore, encoded in Base64, and then set in the `IdentityProvider` object.  \\n\\n## Configuration Options\\n\\nThe `deployment.toml` files show a configuration option for `encoding` under a JWT-related section, which can be set to `\"base64\"` or `\"base64url\"`.   This indicates support for different base64 encoding schemes.\\n\\n## API Endpoints or Features\\n\\nThe `ClientCertificatesApi.java` defines an API endpoint for uploading client certificates.  The `addAPIClientCertificate` method expects a `File certificate` parameter, an `alias`, and a `tier`.  While the method signature takes a `File`, the `ClientCertificateCreationBean` suggests that the content of the certificate is expected to be base64 encoded. \\n\\nSimilarly, `EndpointCertificatesApi.java` provides an endpoint for uploading endpoint certificates, also expecting a `File certificate` and an `alias`. \\n\\n## Documentation References\\n\\nThe `ClientCertificatesApi.md` file provides documentation for the `ClientCertificatesApi`, including examples for `deleteAPIClientCertificateByKeyTypeAndAlias` and `updateAPIClientCertificateByKeyTypeAndAlias`.   These operations involve certificates, and the `updateAPIClientCertificateByKeyTypeAndAlias` method explicitly mentions a `File certificate` parameter. \\n\\n## Test Criteria Verification\\n\\nThe `APISecurityTestCase.java` includes a test case `testAPIInvocationWithMutualSSLHeader()` that sets the `X-WSO2-CLIENT-CERTIFICATE` header with a base64 encoded certificate.  This test verifies the behavior when such a header is present, although the assertion in the provided snippet checks for `SC_UNAUTHORIZED`, indicating a negative test case for an invalid certificate or configuration. \\n\\n## Notes\\n\\nThe prompt specifically asks about the `TPP-Signature-Certificate` header. While the codebase demonstrates handling of base64 encoded certificates for client authentication and JWT signing, and uses a header like `X-WSO2-CLIENT-CERTIFICATE` for mutual SSL, there is no explicit mention or direct implementation related to a `TPP-Signature-Certificate` header in the provided snippets.  However, the underlying mechanism for handling base64 encoded certificates is present and could potentially be adapted or extended to support such a header.  \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c15694dd-1ee4-4d9b-95dc-ac6c58adce28\\n', 'id': 'lc_7698a683-8dcc-41f9-b85a-5891eab248e3'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0090",
      "requirement": {
        "requirement_id": "ATOM_033",
        "requirement_text": "The ASPSP SHALL provide a mandatory DELETE consents/{consentId} endpoint to terminate the addressed consent",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0090_1",
          "text": "## **Usage** **>> consent-cleanup.sql** This is a consent data cleanup script with batch wise delete, This procedure includes the cleanup of consents from the respective tables of *FS_CONSENT* , *FS_CONSENT_AUTH_RESOURCE* , *FS_CONSENT_MAPPING* , *FS_CONSENT_FILE* , *FS_CONSENT_ATTRIBUTE* , *FS_CONSENT_STATUS_AUDIT* 1. Compile the stored procedure. 2. Execute the compiled store procedure. **Data retention feature:** - If enabled, all the purged consents will be stored in temporary retention tables in the consent database. *- Logical condition and configs used for consent purging and data retention.* *CONSENT DATA PURGING PARAMETERS* - `consentTypes` - consent_types which should be eligible for purging. (ex : 'accounts,payments', leave as empty to skip) - `clientIds` - client_ids which should be eligible for purging. (leave as empty to skip) - `consentStatuses` - consent_statuses which should be eligible for purging. (ex : 'expired,revoked') - `purgeConsentsOlderThanXNumberOfDays` - time period to delete consents older than `n` days. (check below for more info.) - `lastUpdatedTime` - last_updated_time for purging, (if consent's updated time is older than this value then it's eligible for purging, check below for more info.) - Here if we wish to purge consents with last updated_time older than 31 days (1 month), we can configure `purgeConsentsOlderThanXNumberOfDays` = `31` this value is in no. of days. - If we wish to configure exact timestamp of the `lastUpdatedTime` rather than a time period, we can ignore configuring `purgeConsentsOlderThanXNumberOfDays` = `NULL`, and only configure lastUpdatedTime with exact unix timestamp. - `ex : lastupdatedtime = 1660737878;` *CONSENT DATA RETENTION PARAMETERS* - `enableDataRetention` - set true for enable data retention (archive purged data, default : false) - Note: When running backup procedure (consent-cleanup-restore.sql) to restore back the purged data with the retention feature enabled, make sure to clean retention tables to avoid duplicates when purging again. Note: below data retention parameters need to set in the scripts before compiling, Ignore if data retention is not enabled. - `enableDataRetentionForAuthResourceAndMapping` - enable storing auth resource and consent mapping tables for retention data. - `enableDataRetentionForFsConsentFile` - enable storing fs_consent_file table for retention data. - `enableDataRetentionForFsConsentAttribute` - enable storing fs_consent_attribute table for retention data. - `enableDataRetentionForFsConsentStatusAudit` - enable storing fs_consent_status_audit table for retention data. *OTHER PARAMETERS* - `backupTables` - enable the backup table to restore later at a later stage. (Please note this backup tables will be overwritten every time you run the cleanup script.). - Also, this would not capture the consents which were created in between the backup task and the cleanup iteration, hence if consents created after the backup task will not be able to restore if its get deleted from the cleanup iteration. - `enableAudit` - By setting this parameter to true, will log each of deleted consents in the auditlog_fs_consent_cleanup table for track them in a later time. Once compiled the stored procedure, We can execute the procedure with input parameters as in below example. (for mysql) ``` WSO2_FS_CONSENT_CLEANUP_SP( consentTypes, clientIds, consentStatuses, purgeConsentsOlderThanXNumberOfDays, lastUpdatedTime, backupTables, enableAudit, analyzeTables, enableDataRetention ); ``` ``` Ex: mysql> call WSO2_FS_CONSENT_CLEANUP_SP('accounts,payments', 'clientId1,clientId2', 'expired,revoked', 31, NULL, TRUE, TRUE, TRUE, FALSE); ``` Please refer the README.md file on each DB type for more information. *CONFIGURABLE",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0090_2",
          "text": "### deleteConsentAttributes method\n\nThis method lets you delete a provided list of consent attributes for a particular consent.\n\n``` java\nboolean deleteConsentAttributes(String consentID, ArrayList<String> attributeKeysList) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0090_3",
          "text": "### revokeExistingApplicableConsents method\n\nThis method lets you revoke existing consents for a given combination of `clientID`, `userID`, `consent type`, and \n`status` parameters. It also revokes any tokens related to the consents if the `shouldRevokeTokens` flag is set to `true`.\n\n``` java\nboolean revokeExistingApplicableConsents(String clientID, String userID, String consentType, String applicableStatusToRevoke, String revokedConsentStatus, boolean shouldRevokeTokens) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0090_4",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0090_5",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0091",
      "requirement": {
        "requirement_id": "ATOM_181",
        "requirement_text": "In case of incorrect password, the TPP needs to ask the PSU for re-entering the password and the newly entered password needs to be updated to the same path.",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0091_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0091_2",
          "text": "### Step 2: Sign in to the Developer Portal as the TPP\n\n1. Now, sign in to the [Developer portal](https://<APIM_HOST>:9443/devportal) as the TPP.\n\n2. Enter the username and the password you entered when signing up as a TPP.\n\n3. Click Continue. Now, you are on the home page of the Developer Portal.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0091_3",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0091_4",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0091_5",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0091_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports password recovery mechanisms that allow a user to reset their password, which can be interpreted as re-entering a new password when the original is incorrect. The system provides API endpoints and configuration options for managing this process.\\n\\n## Implementation Details\\nThe password recovery functionality is implemented through a series of steps involving user verification, sending recovery notifications (e.g., email links), and finally updating the password. The `UserInformationRecoveryServiceTestCase.java`  and `PasswordRecoveryTestCase.java`  files contain integration tests that demonstrate this flow.\\n\\nThe core steps for password recovery include:\\n1.  **Verify User**: The system first verifies the user, potentially using a captcha . This is handled by the `infoRecoveryClient.verifyUser()` method .\\n2.  **Send Recovery Notification**: A recovery notification, such as an email link, is sent to the user . The `sendRecoveryNotification()` method  is used for this purpose.\\n3.  **Verify Confirmation Code**: The user then uses the recovery link/code to verify their intent . This is done via `infoRecoveryClient.verifyConfirmationCode()` .\\n4.  **Update Password**: Finally, the user can update their password using the `infoRecoveryClient.updatePassword()` method . The `PasswordRecoveryTestCase.java`  demonstrates retrieving a password reset URL and submitting a new password. The `resetPassword` method in `PasswordRecoveryTestCase.java`  shows how the new password (`PASSWORD_NEW`)  is sent to the server.\\n\\nThe `PreUpdatePasswordActionFailureTestCase.java`  also includes a test case for `testUserResetPassword`, which involves retrieving a password recovery form URL, submitting the form, and then resetting the password. This confirms that the system expects a new password to be submitted to the recovery endpoint.\\n\\n## Configuration Options\\nPassword recovery features can be enabled or disabled through configuration. The `backupIdentity.xml`  file shows a `<Recovery>` section where `<Password><Enable>true</Enable></Password>` can be set.\\nThe `PasswordRecoveryTestCase.java`  demonstrates how to programmatically update the password recovery feature status using `IdentityGovernanceRestClient`  by setting the `Recovery.Notification.Password.emailLink.Enable` property.\\n\\n## API Endpoints or Features\\nThe `PasswordRecoveryV2RestClient.java`  defines REST client methods for password recovery. Specifically, the `reset()` method  is responsible for executing the password reset operation, taking a `ResetModel`  which includes the new password. The endpoint for this operation is `/v2/password-recovery/reset` .\\n\\n## Documentation References\\nThe wiki page \"OAuth2 and OpenID Connect\" <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" /> provides an overview of authentication and authorization protocols, including the \"Password\" grant type <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" />. While this grant type is for direct password submission, the overall context of identity management and recovery is relevant.\\n\\n## Notes\\nThe provided snippets primarily focus on the server-side implementation and testing of password recovery. The term \"TPP\" (Third Party Provider) and \"PSU\" (Payment Services User) are not explicitly found in the provided code snippets. However, the functionality described (user re-entering a password after an incorrect attempt and updating it) is supported through the password recovery flows. The system allows for a user to initiate a password reset, receive a recovery link, and then submit a new password to a designated endpoint. The integration tests confirm that the system handles the submission of a new password to the recovery path.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-i_29d16f64-baaa-4d1d-8d4c-8305e0e31852\\n', 'id': 'lc_a96f11ac-59c6-43eb-8a95-404feea3de43'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0091_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_f2de7629-0ed6-4f13-9995-7c23992a07bb'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0092",
      "requirement": {
        "requirement_id": "ATOM_151",
        "requirement_text": "The Read Transaction Details endpoint SHALL be accessible via GET /v1/accounts/{account-id}/transactions/{transactionId}",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0092_1",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_2",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_3",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_4",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_5",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the retrieval of transaction details for a specific account, but not for a specific transaction ID within that account. The API endpoint `/v1/accounts/{account-id}/transactions` is available to retrieve all transactions for a given account, but there is no direct endpoint to retrieve a single transaction by `transactionId` within that path. \\n\\n### API Endpoints and Features\\n\\nThe `wso2/financial-services-accelerator` repository defines an API for retrieving transactions via `GET /open-banking/{version}/aisp/accounts/{AccountId}/transactions` . This endpoint is documented in the `account-info-swagger.yaml` file . The `AccountId` is a path parameter . The response for this endpoint is defined by the `OBReadTransaction5` schema , which includes a list of `OBTransaction5` objects . Each `OBTransaction5` object contains a `TransactionId` . However, there is no specific endpoint to filter transactions by `transactionId` directly in the path. \\n\\n### Implementation Details\\n\\nThe backend service `AccountService.java` in the `org.wso2.financial.services.accelerator.demo.backend` module provides a demo implementation for retrieving account transactions . The `getAccountTransactions` method handles `GET /accounts/{AccountId}/transactions` and returns a hardcoded JSON response containing a list of transactions, including `TransactionId` . This implementation does not support filtering by a specific `transactionId` in the path. \\n\\nIntegration tests confirm the retrieval of account transactions. The `EndToEndAccountFlowTest.groovy` test verifies that a `GET` request to `accountsPath = ConnectorTestConstants.TRANSACTIONS_SINGLE_PATH` (which resolves to `/open-banking/v3.1/aisp/accounts/{AccountId}/transactions`) returns a `200` status code .\\n\\n### Configuration Options\\n\\nThe `financial-services-accelerator` uses a centralized configuration approach through the `financial-services.xml` file . While the provided context does not show specific configuration options for enabling or disabling the transaction details endpoint, the `FinancialServicesConfigParser` class is responsible for parsing configurations related to various financial services components .\\n\\n### Documentation References\\n\\nThe API specifications for Account Information APIs, including transactions, are outlined in the `Overview` wiki page . The `account-info-swagger.yaml` file serves as the primary documentation for the Account and Transaction API, detailing the available paths, parameters, and responses .\\n\\n## Notes\\n\\nThe prompt specifically asks for `GET /v1/accounts/{account-id}/transactions/{transactionId}`. Based on the provided `account-info-swagger.yaml`  and the `AccountService.java` implementation , the repository supports retrieving *all* transactions for a given account, but not a *single* transaction by its ID directly through a dedicated endpoint. The `TransactionId` is present within the returned transaction objects, implying that filtering would need to occur client-side or through additional query parameters not explicitly defined in the provided OpenAPI specification.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_87666650-4a58-4059-96f7-4483cc46bfc5\\n', 'id': 'lc_da5a98a0-17b2-4035-b994-fb71d4368b0f'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0093",
      "requirement": {
        "requirement_id": "ATOM_050",
        "requirement_text": "The system MUST support payment initiation transaction status 'ACCP' (AcceptedCustomerProfile) when financial risk profile including funds availability has been checked positively.",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0093_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_2",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_3",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_4",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_5",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports payment initiation transaction statuses, including \"AcceptedSettlementCompleted\", which is a similar status to \\'ACCP\\' (AcceptedCustomerProfile) indicating a positive financial risk profile and funds availability check. The system uses OpenAPI specifications for payment initiation and includes a `PaymentService` for processing payments and setting their status. External service integration points are available for custom validation and risk assessment.\\n\\n## Implementation Details\\n\\nThe `financial-services-accelerator` repository defines the API for payment initiation and includes a backend service for processing these payments.\\n\\n### API Definition\\nThe OpenAPI specification for payment initiation, located at `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml`, defines the structure for payment initiation requests and responses .\\nThe `obWritePaymentResponse5` schema includes a `Status` field that specifies the status of the payment information group . The possible values for this status include:\\n*   `AcceptedCreditSettlementCompleted` \\n*   `AcceptedSettlementCompleted` \\n*   `AcceptedSettlementInProcess` \\n*   `AcceptedWithoutPosting` \\n*   `Pending` \\n*   `Rejected` \\n\\nThe `obWritePaymentConsentResponse5` schema also defines a `Status` field for the consent resource, with values like `Authorised`, `AwaitingAuthorisation`, `Consumed`, and `Rejected` .\\n\\n### Payment Processing Logic\\nThe `PaymentService.java` file in the `org.wso2.financial.services.accelerator.demo.backend` module contains a `cacheAndGetPaymentResponse` method that simulates payment processing . This method sets the payment status to `\"AcceptedSettlementCompleted\"` by default . This indicates that the system can internally set a payment to an \"Accepted\" status. The `Risk` object is also part of the `obWriteConsent4` and `obWritePayment2` schemas, indicating that risk assessment is a component of the payment initiation process  .\\n\\n### External Service Integration for Risk Assessment\\nThe system provides an \"External Service Integration Framework\" that allows for custom validation and enrichment logic through external services . This framework includes extension points such as `VALIDATE_AUTHORIZATION_REQUEST` which could be used to integrate with external financial risk profile and funds availability checks . The `ServiceExtensionUtils` class is responsible for invoking these external services .\\n\\n## Configuration Options\\n\\nThe external service integration, which can be used for financial risk profile and funds availability checks, is configurable through the `financial-services.xml` file . The `FinancialServicesConfigParser` class parses this configuration . Key configuration properties for external services include `serviceExtensionsEndpointEnabled`, `serviceExtensionTypes`, `serviceExtensionsEndpointBaseUrl`, and authentication methods like Basic Auth or OAuth2 .\\n\\n## API Endpoints or Features\\n\\nThe primary API endpoints related to payment initiation are defined in `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml` :\\n*   `POST /payment-consents`: Used to create payment consents .\\n*   `GET /payment-consents/{consentId}`: Retrieves a specific payment consent .\\n*   `GET /payment-consents/{consentId}/funds-confirmation`: Retrieves funds confirmation for a payment consent . This endpoint is directly relevant to checking funds availability.\\n*   `POST /payments`: Used to create payments .\\n*   `GET /payments/{paymentId}`: Retrieves a specific payment .\\n\\nThe `obWriteFundsConfirmationResponse1` schema within the OpenAPI specification defines the response for funds availability checks, including a `FundsAvailable` boolean flag .\\n\\n## Documentation References\\n\\nThe \"Overview\" wiki page provides a high-level understanding of the WSO2 Financial Services Accelerator, mentioning its support for payment initiation and consent management . The \"External Service Integration\" wiki page details how external services can be integrated for custom validation and processing, which is crucial for implementing financial risk profile and funds availability checks .\\n\\n## Notes\\n\\nWhile the system does not explicitly use the status code \\'ACCP\\' (AcceptedCustomerProfile), it uses \"AcceptedSettlementCompleted\"  and other \"Accepted\" statuses  which imply a similar positive outcome after checks. The `obRisk1` schema is included in payment consent and payment initiation requests, indicating that risk information is part of the transaction . The `DefaultConsentManageValidator.java` also performs validation on the payment initiation payload, including debtor and creditor accounts and instructed amounts, which are components of a financial risk assessment . The `fs-integration-test-suite` contains test cases for payment initiation, which would be used to verify the transaction status after successful customer profile and risk assessment .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [External Service Integration (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#5)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2b77fc0f-44a2-42f8-b11a-a8a536a741d8\\n', 'id': 'lc_ed81662b-0ae3-4c17-a6d6-18c53a4778f5'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0094",
      "requirement": {
        "requirement_id": "ATOM_082",
        "requirement_text": "eIDAS certificate validation SHALL be performed for all payment initiation requests including certificate, request syntax, TPP role and semantics verification",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0094_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports certificate validation, including the handling of JWKS URIs and direct certificate uploads for Identity Providers (IdPs) . While there is no explicit mention of \"eIDAS certificate validation\" or \"payment initiation requests\" in the provided context, the system\\'s capabilities in handling certificates and its support for Financial-grade API (FAPI) suggest that it could be extended or configured to meet such requirements . The system also includes mechanisms for validating access tokens and client certificates, which are crucial for secure payment initiation requests .\\n\\n## Implementation Details\\n\\nThe `wso2/product-is` repository provides functionalities for managing certificates associated with Identity Providers. Specifically, the `IdPSuccessTest.java` file demonstrates how to update an IdP\\'s certificate configuration, allowing for the addition or removal of JWKS URIs or direct certificates .\\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` script illustrates how client certificate thumbprints are extracted from `X-Ssl-Cert` headers and compared against thumbprints embedded in access tokens (via the `cnf` claim)  . This mechanism is essential for mutual TLS (mTLS) and client certificate-bound token validation, which are often requirements for eIDAS and FAPI.\\n\\nThe `ClientSignKeyDataHolder.java` class is responsible for loading private keys and X.509 certificates from a keystore, which are then used for signing processes . This indicates the system\\'s capability to handle and utilize various certificate types.\\n\\n## Configuration Options\\n\\nThe system allows for the configuration of certificates for Identity Providers through its API. You can update an IdP\\'s certificate configuration by providing a JWKS URI or by directly uploading certificates . The `patch-add-jwks-uri.json` and `patch-add-certificate.json` resources, referenced in the `IdPSuccessTest.java` file, would contain the specific JSON payloads for these operations .\\n\\nThe `automation.xml` file shows configuration for keystores and truststores, including `fileName`, `type`, `password`, and `keyAlias` . This indicates that the system can be configured to use specific certificates for various security operations.\\n\\n## API Endpoints or Features\\n\\nThe `wso2/product-is` repository exposes REST APIs for managing Identity Providers, including their certificate configurations. The `IdPSuccessTest.java` file demonstrates interactions with the `/api/identity/v1.0/identity-providers/{id}` endpoint for patching IdP configurations, specifically for adding and removing JWKS URIs and certificates .\\n\\nThe `AuthorizationDetailsType.java` and `AuthorizationDetailsTypesCreationModel.java` files define models for authorization details, including a `type` field that can be set to \"payment_initiation\"  . This suggests that the system has a concept of \"payment initiation\" within its authorization framework, which could be leveraged for eIDAS-related payment requests.\\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` script demonstrates a resource endpoint `/resource` that performs FAPI validations, including comparing client certificate thumbprints with those in access tokens . This indicates support for strong client authentication, which is a key aspect of eIDAS.\\n\\n## Documentation References\\n\\nThe \"Features and Capabilities\" wiki page for `wso2/product-is` mentions \"Financial-grade API (FAPI) Support\" as part of its API Security features . FAPI often involves strict certificate validation and mTLS, which aligns with the requirements for eIDAS. The wiki also highlights \"OAuth 2.0 for API Security\" and \"JWT Access Tokens\" , which are foundational for secure API interactions and can be used to carry certificate-related claims.\\n\\n## Notes\\n\\nThe provided codebase does not explicitly mention \"eIDAS certificate validation\" or \"TPP role verification.\" However, the presence of FAPI support, robust certificate management for IdPs, and client certificate-bound token validation mechanisms strongly suggest that the system has the underlying capabilities to be configured and extended to meet these requirements. The \"payment_initiation\" type in authorization details models further indicates that the system is designed to handle payment-related authorization flows. To fully support eIDAS, additional implementation might be needed to specifically handle eIDAS certificate profiles, trust lists, and TPP role extraction from certificates.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_a83c07d1-6fc5-48fc-a17d-db7cd1d62d12\\n', 'id': 'lc_a440b0b0-07c1-4097-88e7-3580b2130584'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0094_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support mutual SSL certificate validation, which is a foundational component for eIDAS certificate validation. The provided code snippets primarily focus on the configuration and testing of mutual SSL for APIs, including certificate chain validation and handling of invalid certificates. However, there is no explicit mention or implementation of eIDAS-specific certificate validation, TPP role verification, or semantic verification within the provided context.\\n\\n## Implementation Details\\nThe WSO2 API Manager (APIM) supports mutual SSL authentication for APIs. This is demonstrated in the integration tests, where APIs are configured to require mutual SSL.  Specifically, the `securitySchemes` for an API can include `\"mutualssl\"` and `\"mutualssl_mandatory\"`. \\n\\nThe system allows uploading certificates for APIs.  These certificates can be root certificates or intermediate certificates, and the system validates certificate chains.  For instance, `APISecurityMutualSSLCertificateChainValidationTestCase.java` tests scenarios where APIs are invoked with root certificates, client certificates with a chain, and client certificates with only the head of the chain. \\n\\nThe system also handles cases of invalid certificates, such as expired certificates, and rejects requests accordingly.  When an API is configured for mutual SSL, requests without a valid certificate result in an `SC_UNAUTHORIZED` response. \\n\\n## Configuration Options\\nMutual SSL can be configured for an API by setting the `securitySchemes` property to include `\"mutualssl\"` or `\"mutualssl_mandatory\"`.  Certificates can be uploaded via the `restAPIPublisher.uploadCertificate` method, specifying the certificate file, an alias, the API ID, and the key type (e.g., `APIMIntegrationConstants.KEY_TYPE.SANDBOX`). \\n\\n## API Endpoints or Features\\nThe `ClientCertificatesApi` and `EndpointCertificatesApi` provide functionalities related to managing client and endpoint certificates.  \\n\\nKey operations include:\\n*   **`addEndpointCertificate`**: Uploads a certificate for an endpoint. \\n*   **`uploadCertificate`**: Uploads a client certificate associated with an API. \\n*   **`deleteAPIClientCertificateByKeyTypeAndAlias`**: Deletes a client certificate by key type and alias. \\n*   **`getAPIClientCertificateByKeyTypeAndAlias`**: Retrieves information about a client certificate. \\n*   **`getAPIClientCertificateContentByAlias`**: Downloads a client certificate. \\n*   **`updateAPIClientCertificateByAlias`**: Updates an existing client certificate. \\n*   **`getEndpointCertificateByAlias`**: Retrieves information about an endpoint certificate. \\n*   **`getEndpointCertificates`**: Retrieves a list of uploaded endpoint certificates. \\n*   **`getCertificateUsage`**: Retrieves APIs associated with a given certificate alias. \\n\\n## Documentation References\\nThe `ClientCertificatesApi.md` and `EndpointCertificatesApi.md` files provide documentation for the API endpoints related to certificate management, including parameters, return types, and HTTP response details.  \\n\\n## eIDAS Specifics\\nWhile the repository provides robust mutual SSL and certificate chain validation capabilities, there is no explicit mention or implementation of eIDAS-specific certificate validation, TPP (Third Party Provider) role verification, or semantic verification within the provided code snippets. The existing certificate validation focuses on the technical aspects of SSL/TLS certificates (e.g., chain validation, expiration) rather than the specific policy requirements of eIDAS.  \\n\\nTo fully support eIDAS certificate validation, additional logic would be required to:\\n*   Verify the qualified status of the eIDAS certificate.\\n*   Extract and validate TPP roles from the certificate or associated attributes.\\n*   Perform semantic validation of payment initiation requests based on eIDAS regulations.\\n\\n## Notes\\nThe provided context primarily consists of integration tests for mutual SSL and certificate management within the WSO2 API Manager. These tests confirm the platform\\'s ability to handle various certificate-related scenarios, including certificate chain validation and rejection of invalid certificates. However, the specific requirements for eIDAS, such as TPP role and semantics verification, are not explicitly addressed in these snippets. The existing mutual SSL infrastructure could serve as a foundation, but eIDAS-specific extensions would likely be needed.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_214bc244-c2f6-46ed-8cb9-014b47e50fe3\\n', 'id': 'lc_395d3817-6f96-4e79-9736-29dda717b614'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0095",
      "requirement": {
        "requirement_id": "ATOM_117",
        "requirement_text": "Account Information Service SHALL grant access based on the type of Account Information Service specified in the consent",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0095_1",
          "text": "#### Add CustomerCareOfficerRole Role\n\nCustomerCareOfficerRole is required for bank users to log into the Consent Manager Portal and search for the consents granted by any user.\n\n1. Go to **Roles** under the **User Management** tab in the left pane.\n\n2. Click on **+ New Role**.<br/> \n![roles](../assets/img/learn/consent-manager/roles.png)\n\n3. Enter following details and click on Next button.\n    - Role Name: CustomerCareOfficerRole\n    - Role audience: Organization<br/> \n![create-cc-role](../assets/img/learn/consent-manager/create-cc-role.png)\n\n4. Select the created **API Resource** under the **Permission Selection** section.\n\n5. Add the **consents:read_all** permission from the API resource separately.<br/> \n![create-role-step2](../assets/img/learn/consent-manager/create-role-step2.png)\n\n6. Click on the **Finish** button.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_2",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_3",
          "text": "### Viewing consent details\n\n- To view consent details, click the respective `Action` button. \n\n    ![view consent](../assets/img/learn/consent-manager/view-consent.png)\n\n- You can view the details such as the associated API consumer application, consent granted date, consent expiry date, \naccount numbers, and permissions that you have granted.\n\n    ![consent details](../assets/img/learn/consent-manager/consent-details.png)",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_4",
          "text": "## Shareable and payable accounts \n   \nSome bank customers may have a certain number of bank accounts in a particular bank, but not all these accounts have \nthe ability to be shared externally or to make a payment online. These accounts are known as shareable and payable \naccounts respectively. In a bank, the list of shareable accounts and the payable accounts can either be the same or \ndifferent.\n   \nThe WSO2 Open Banking solution expects at least two APIs from the bank that return shareable and payable accounts when \nthe `user_id` is provided. The response must be in the JSON format and it will automatically load the accounts list on \nthe consent page during the consent authorization flow. \n\n![consent-page-with-accounts](../assets/img/learn/integration/list-of-accounts.png)\n\nThe responses of shareable and payable accounts APIs depend on your open banking specification and what you need to \ndisplay on the consent page. You can configure customized steps for retrieval by following the \n[Consent Authorize endpoint](https://ob.docs.wso2.com/en/latest/develop/consent-management-authorize/#configuration) \ndocumentation.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_5",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0096",
      "requirement": {
        "requirement_id": "ATOM_020",
        "requirement_text": "The API SHALL support multiple level SCA where a transaction needs authorisation by more than one PSU in corporate contexts",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0096_1",
          "text": "ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify fraudulent activities. 7. **API Security** - API consumers invoke APIs to access customer\u2019s financial information. Therefore, API security plays a vital role in open banking to mitigate data theft. The solution has built-in support for global industry-standards such as OpenID Connect Financial Grade API (FAPI), OAuth 2.0, Electronic Identification and Trust Services (eIDAS). API security can be categorised into two main levels: - Application layer security - Validates API consumers against the certificates issued by competent authorities. For example: open banking directories, Qualified Trust Service Providers (QTSPs). Also, the solution supports OAuth2 security implementations such as Private key JWT authentication, client-credentials grant type, and authorization code grant type. - Transport layer security - Secures the communication between the API consumer, and the bank using Mutual Transport Layer Security (MTLS). 8. **User Experience** - The solution provides an enhanced user experience for the banks, API consumers, and customers with self-explanatory and simple actions. 9. **Premium APIs and Monetization** - Using the capabilities in WSO2 API Manager, WSO2 Open Banking Accelerator allows: - banks to publish highly-performant custom APIs for API consumers. - banks to expose their performance and compliance data by integrating into analytics engines. - banks to plug in any billing engines with subscription-based freemium, tiered pricing, or per-request pricing. 10. **Standards-based API Templates** - WSO2 API Manager offers standard API management capabilities, and you can customize the API templates according to your open banking and other requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_2",
          "text": "## Open banking / Open Finance regulations Open banking and Open Finance regulations provide a policy and legislative framework to help banks and API consumers deliver the benefits of open banking. - The **newest** regulation of Open Finance is the finalized **section 1033 rule from Consumer Financial Protection Bureau (CFPB) of the United States**.It requires financial institutions to make available to consumers the information they have about their financial products and services, upon request. - The first known open banking regulation is the **Payment Service Directive** in Europe. Administered by the European Commission (Directorate General Internal Market) regulates payment services and payment service providers throughout the European Union and European Economic Area (EEA). PSD1 came into force in 2007 followed by the PSD2 in 2015. - The Competition and Market Authority formed the **Open Banking Implementation Entity** in the UK. The Open Banking Implementation Entity adopted the PSD2 and issued its first version of the open banking standard in 2017. It specified how banks should allow an API consumer to access customer\u2019s information and request payments with the customer\u2019s consent. - The Berlin Group consists of almost 40 banks, associations and Payment Service Providers across the European Union. They have defined a common API standard called NextGenPSD2 for the use cases specified in PSD2. Based on the PSD2 and European Banking Authority - Regulatory Technical Standards (RTS) requirements, the Berlin Group has worked on detailed Access to Account (XS2A) Framework including implementation details for open banking named as **NextGenPSD2XS2A**.Now this has been expanded to Open Finance with the introduction of **Berlin Group openFinance API framework** - **Consumer Data Right** in Australia is a right provided by law under the Treasury Laws Amendment (Consumer Data Right) Act in 2019 to give Australians greater control over their data. It empowers consumers to choose to share their data with API consumers only for the purposes that they have authorized. - **Fintech law** in Mexico promotes data sharing as well as transparency among banks and subholding companies (example: broker-dealers, money exchangers, credit unions, popular, and community financial entities). The Fintech law defines guidelines for the regulated entities on the types of information and how to share them. Comisi\u00f3n Nacional Bancaria y de Valores, The Embassy of the United Kingdom, the FinTech Hub, C Minds, ODI and the Government of the Republic are involved in the regulation. - The Hong Kong Monetary Authority (HKMA) published the **Open API Framework** in 2018 to provide a secure, controlled, and convenient operating environment to financial institutions and third parties. It expects the banks and third parties to work together and build innovative banking services offering a better customer experience. The framework has a phased approach. - The Monetary Authority of Singapore (MAS) provided a legal framework for open banking in 2018. MAS introduced [APIX](https://www.mas.gov.sg/development/fintech/api-exchange) for the banks to open up their data and services encouraging openness among both the financial institutions and the API consumers. - Following the footsteps of the UK and Australia, New Zealand issued a government backed pilot plan in 2018 to design and develop open banking",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_3",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_4",
          "text": "# Financial -grade API (FAPI) Security\n\nFinancial-grade API (FAPI), a specification that extends the OAuth and OIDC frameworks, \nwas introduced by the FAPI Working Group and defines additional technical requirements \nto secure APIs. Eventhough FAPI was initially defined for financial serivces, \nit is appropriate for any critical API whose security is the highest priority.\n\nFor Open Banking/ Open Finance use-cases,since robust API and data security is must,most of the immerging\ntechnical specifications for Open Banking/ Open Finance have been mandated **FAPI Security** for the \nexposing financial APIs such as ;\n - Open Banking UK\n - Consumer Data Standards (CDS), Australia\n - The Financial Data Exchange (FDX), USA\n\nThe following diagram illustrates how FAPI-compliant features combine to secure applications \n\n![fapi](../assets/img/learn/api-security/fapi.png)\n\nWSO2 Identity Server 7.0.0 onwards ,FAPI Security is supported from the base product itself and \nfor more information on configuring the FAPI features,please visit WSO2 IS Documentation on \n[FAPI](https://is.docs.wso2.com/en/latest/references/financial-grade-api/)\n\n\nWSO2 Open Banking Accelerators have been certified as a OpenID FAPI1-Advanced OpenID Provider as in https://openid.net/certification/",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_5",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase, there is no direct evidence or explicit mention of support for \"multiple level SCA where a transaction needs authorisation by more than one PSU in corporate contexts\" <cite/>. The codebase primarily focuses on general identity and access management, including various authentication protocols, user management, and API security  . While it supports multi-factor authentication (MFA) and adaptive authentication, these features are generally for a single user\\'s authentication process rather than multi-party authorization for a transaction .\\n\\n## Implementation Details\\nThe codebase includes features like adaptive authentication and multi-factor authentication .\\n*   **Adaptive Authentication**: This allows for risk-based, step-based, and conditional authentication flows, where authentication requirements can be adjusted based on various factors . This is configured using JavaScript scripts .\\n*   **Multi-factor Authentication (MFA)**: WSO2 Identity Server supports various MFA methods such as SMS OTP, Email OTP, TOTP, and FIDO . These are typically configured for a single user to provide multiple authentication factors  .\\n\\nHowever, these features do not inherently provide a mechanism for multiple PSUs (Payment Service Users) to authorize a single transaction, nor do they explicitly track each authorization separately in a multi-level SCA context <cite/>. The existing authentication framework is designed for individual user authentication rather than collective transaction authorization .\\n\\n## Configuration Options\\nThe configuration system is flexible, supporting file-based and database-stored configurations . Adaptive authentication scripts can be used to define custom authentication logic . While this extensibility might allow for custom implementations of multi-level SCA, there are no out-of-the-box configuration options specifically for this requirement <cite/>.\\n\\n## API Endpoints or Features\\nThe API layer provides REST APIs for both administrative and end-user operations . There are APIs for application management, identity provider management, and user management . While there are APIs for managing authenticators  and user approvals , there is no explicit API endpoint or feature described that directly supports multi-level SCA for transactions involving multiple PSUs <cite/>. The `org.wso2.carbon.identity.rest.api.user.approval.v1` artifact suggests user approval mechanisms, but its specific functionality for multi-PSU transaction authorization is not detailed .\\n\\n## Documentation References\\nThe provided wiki pages and `README.md` files offer general overviews of the WSO2 Identity Server\\'s capabilities, architecture, and features   . However, none of these documents specifically mention \"multiple level SCA where a transaction needs authorisation by more than one PSU in corporate contexts\" <cite/>. The documentation focuses on single-user authentication and authorization flows  .\\n\\n## Notes\\nThe prompt describes a specific requirement for multi-level Strong Customer Authentication (SCA) involving multiple Payment Service Users (PSUs) for corporate transactions. While WSO2 Identity Server offers robust authentication and authorization features, including adaptive authentication and MFA, these are primarily designed for individual user authentication and access control . The codebase does not explicitly detail a system or API for orchestrating and tracking authorizations from multiple distinct users for a single transaction <cite/>. The `org.wso2.carbon.identity.rest.api.user.approval.v1` artifact could potentially be a building block for such a feature, but its current description does not confirm this specific use case . Implementing this requirement would likely involve custom development leveraging the existing extensibility points of the WSO2 Identity Server .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d9ebe26a-3815-4870-8044-d96f5fdd594b\\n', 'id': 'lc_395f4fde-6310-4c52-8318-5f3c1d2ec504'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_277cef01-6f2f-463c-9bf2-fe0dfa66b941'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0097",
      "requirement": {
        "requirement_id": "ATOM_043",
        "requirement_text": "Error responses must use Content-Type application/problem+json header.",
        "strength": "MUST",
        "capability": "Error Handling",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0097_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not explicitly support the `Content-Type: application/problem+json` header for error responses based on the provided code snippets. The existing error handling mechanism validates error responses against a predefined JSON structure, but it does not check for the `application/problem+json` content type.\\n\\n### Implementation Details\\nThe `wso2/product-is` repository uses a standardized error handling mechanism for its Server APIs through exception mappers, as described in the `Server APIs` wiki page <wiki_page repo_name=\"wso2/product-is\" id=\"4.1\" page_name=\"Server APIs\" />. These exception mappers are configured in the `web.xml` file .\\n\\nThe `RESTTestBase.java` class contains a `validateErrorResponse` method that is used to verify the structure of error responses . This method checks for the presence of `code`, `message`, `description`, and `traceId` fields in the error response body . It also validates the HTTP status code  and compares the error message and description against properties defined in `RESTAPIErrors.properties`  .\\n\\nHowever, there is no explicit check within the `validateErrorResponse` method or any related utility methods for the `Content-Type` header to be `application/problem+json`. The `RestBaseClient.java` defines `CONTENT_TYPE_ATTRIBUTE` , but it\\'s used for setting content types in requests, not for validating error response headers.\\n\\n### Configuration Options\\nThere are no explicit configuration options visible in the provided snippets that would allow enabling or disabling the `application/problem+json` content type for error responses. The error handling configuration primarily revolves around the `jaxrs.providers` in `web.xml` , which lists exception mappers but doesn\\'t specify content type negotiation for errors.\\n\\n### API Endpoints or Features\\nThe Server APIs, such as Application Management, Identity Provider Management, and Authenticator Management, use the described error handling mechanism <wiki_page repo_name=\"wso2/product-is\" id=\"4.1\" page_name=\"Server APIs\" />. Examples of error responses can be seen in various failure test cases, where `validateErrorResponse` is invoked   . These tests validate the error code, message, and description in the response body, but not the `Content-Type` header.\\n\\n### Documentation References\\nThe `Server APIs` wiki page provides an overview of the API architecture and error handling <wiki_page repo=\"wso2/product-is\" id=\"4.1\" page_name=\"Server APIs\" />. It mentions that the Server APIs use a standardized error handling mechanism through exception mappers <wiki_page repo=\"wso2/product-is\" id=\"4.1\" page_name=\"Server APIs\" />. However, it does not specifically mention the `application/problem+json` content type for error responses. The `scim2.yaml` file defines various error response schemas, such as `ErrorUnauthorized` and `ErrorSchemaNotFound`  , which include `status`, `schemas`, and `detail` fields . The `schemas` field often contains \"urn:ietf:params:scim:api:messages:2.0:Error\" , which is related to SCIM error responses, but not directly `application/problem+json`.\\n\\n## Notes\\nThe provided code snippets and wiki page do not indicate explicit support or validation for the `Content-Type: application/problem+json` header in error responses. The existing error handling focuses on the structure and content of the error body (code, message, description, traceId) rather than the specific content type header. To implement this requirement, modifications would be needed in the exception mappers or a filter to explicitly set this header for error responses.\\n\\nWiki pages you might want to explore:\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_2f3d80d3-1694-4eff-b204-12a70b17ad95\\n', 'id': 'lc_15581706-d2d3-4b52-b754-f5d504555a36'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0097_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"Based on the provided codebase, the repository does not explicitly support the `Content-Type: application/problem+json` header for error responses. Instead, the OpenAPI specifications consistently define error responses with `Content-Type: application/json`    .\\n\\n### Implementation Details\\nThe OpenAPI specification files, such as `openapi.yaml` in various client directories, define the structure of API requests and responses . For error responses (e.g., 400, 401, 404, 406, 412, 415, 500), the `content` type is consistently specified as `application/json`    . These error responses typically reference a shared `#/components/schemas/Error` schema, which defines the structure of the error object, including `code`, `message`, `description`, `moreInfo`, and `error` fields .\\n\\n### Configuration Options\\nThere are no explicit configuration options visible in the provided snippets that would allow changing the error response `Content-Type` to `application/problem+json`. The `openapi.yaml` files define the API contracts, and these contracts explicitly state `application/json` for error responses .\\n\\n### API Endpoints or Features\\nAll API endpoints examined, across different client OpenAPI specifications (store, admin, publisher, service-catalog, gateway), define their error responses using `application/json`     . For example, the Store API defines 404 and 406 errors with `application/json` , and the Admin API defines 404 and 412 errors similarly . The `gateway-api.yaml` also specifies `application/json` for its 400 and 404 error responses .\\n\\n### Documentation References\\nThe `openapi.yaml` files serve as the primary documentation for the API contracts, explicitly detailing the expected content types for responses, including error responses . There are no other documentation references provided that suggest support for `application/problem+json`.\\n\\n## Notes\\nThe `gradlew.bat` file  is a build script and is not relevant to the API's content type for error responses. The various `openapi.yaml` files consistently define `application/json` as the content type for error responses, indicating that `application/problem+json` is not currently supported.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_a7b3fcda-f002-4954-b5d5-ea0362615a7f\\n\", 'id': 'lc_9b9acddf-cc91-456f-a987-7e7a3157b76e'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0098",
      "requirement": {
        "requirement_id": "ATOM_030",
        "requirement_text": "The ASPSP SHALL tokenize card-account-id parameters such that actual card account numbers, IBANs, or PANs are not part of the API path definitions for data protection reasons",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0098_1",
          "text": "# API Security Open Banking allows API consumers to access financial data through open APIs, which requires greater API security. Therefore, open banking standards provide guidelines for security implementations so that only the intended party can access information that the customer has given prior consent. To achieve this, different specifications mandate security requirements via the relevant specification, which is built upon existing standards defined in OAuth 2.0 and OpenID specifications. The diagram below provides a brief idea of how certain specifications are built upon these specifications. ![fapi_strcutre](../assets/img/learn/api-security/fapi-structure.png) While some open banking specifications, such as the Open Banking Standard - UK and Consumer Data Standards - Australia mandated FAPI, others do not. However, regardless of your regional specification, WSO2 Open Banking Accelerator provides FAPI security standards because of the robust security standards offered by FAPI. ###MTLS enforcement Authentication is a crucial requirement in open banking to verify the authenticity of an API consumer before sharing the customer\u2019s banking information. When an API consumer invokes APIs, their private credentials can be shared in the requests, and it leads to credential leakages and data thefts. Therefore, Mutual Transport Layer Security (MTLS) is introduced as an authentication protocol where the API consumers do not need to send their private credentials. MTLS handshake at the transport layer ensures that the corresponding API consumer possesses a secret key that is associated with the X509 certificate issued by a trusted Certificate Authority (CA). In WSO2 Open Banking Accelerator, MTLS is enforced at the API Manager level to check if - the message context contains the transport certificate to make sure that the MTLS handshake is successful at the gateway - the transport certificate bound to the application when invoking the APIs There are two scenarios to consider for the MTLS validation: 1. If the client directly initiates an MTLS connection with the WSO2 API Manager Gateway, the issuer of the certificate needs to be present in the truststore of the gateway. 2. If the MTLS terminates at the load balancer prior to the gateway, the WSO2 API Manager Gateway expects the load balancer to send the client certificate as a header. In such scenarios, the WSO2 API Manager gateway expects the load balancer to perform the issuer validation. ###Certificate Revocation Validation A certificate is issued by a trusted organization commonly known as a CA. It is also known as a Trust Service Provider (TSP). These certificates are expected to be in use for their entire validity period. However, certain circumstances may cause a certificate to become invalid prior to the expiration of the validity period. For example, a compromise or suspected compromise of the corresponding private key may cause a certificate to become invalid prior to the expiration. A revocation request can originate from the National Competent Authority (NCA), which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_2",
          "text": "### Authorization Request\n\nWSO2 Open Banking Accelerator supports the following security features and fulfil FAPI requirements \nduring Authorization flows:\n\n  - OIDC Hybrid Flow\n    - Request object verification\n    - Pushed Authorization Request validation\n    - Pairwise Identifier support for ID tokens\n  - Authorization Code Flow\n    - When a request object is not available, support authentication mechanisms such as PKCE\n\nYou can use the provided extension points and customize the authorization flows. For more information, refer to the\n[Authorization Flow Customization](../develop/keyid-provider.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_3",
          "text": "### Resource Request\n\nAfter an API consumer application obtains an access token, it is used to invoke a resource endpoint. In this request, \nthe following validations will be performed:\n\n- Token validity verification\n- Token type verification (User Access Token/Application Access Token)\n- Scopes/roles validation\n- Token-bound certificate validation\n- Consent validation\n\nThe resource requests go through token-bound certificate validations according to\n[rfc8705](https://datatracker.ietf.org/doc/html/rfc8705)\nThe MTLS token binding happens once a token is issued to a particular client. This ensures that at the resource endpoint,\nthe provided MTLS certificate can be validated against the certificate bound to the token. Self-contained tokens are\nused for this purpose and are bound to the tokens via a claim named `cnf`. For more information,\nsee [Token Authentication](token-authentication.md#certificate-bound-access-tokens).\n\nConsent validation ensures that the API consumer application's resource requests adhere to the consent provided \nby the bank customers. This is a custom implementation as the behaviour of consent is defined by an open banking \nspecification. You can use the [Consent Validate](../develop/consent-management-validate.md) endpoint and define the \nconsent validations by comparing the resource requests against the user-provided consent.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_4",
          "text": "## Assumptions\n- User's mobile number should be configured.\n- Users will receive the notification as web links to authenticate and authorize the consent.\n- For multiple users involved scenarios, Identity server will assume only one user is authenticated (ID Token will contain the details of only one user (Ex: Primary user) ) and the OB consent tables will contain the authentication status of other users. (This user's identity can be customised by extending and overriding `OBCibaResponseTypeHandler.issue()` method.)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_5",
          "text": "### Configuring a custom validator\n\n1. Once you implement the custom validator, build a JAR file for the project and place it in the \n`<IS_HOME>/repository/components/dropins` directory.\n\n2. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n\n3. Add the following tags and configure your validator using its Fully Qualified Name (FQN):\n    ``` toml\n    [[open_banking.identity.token_filter_validators]] \n    class = <CUSTOM_VALIDATOR_FQN>\n    ```\n4. Save the configurations and restart the Identity Server.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, does not appear to directly support the tokenization of `card-account-id` parameters in API paths for financial-grade APIs. The provided context primarily focuses on general Identity and Access Management (IAM) functionalities, OAuth2/OpenID Connect, and SCIM APIs, none of which explicitly mention handling or tokenizing sensitive financial identifiers like card numbers, IBANs, or PANs in API paths.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThe codebase includes various API endpoints for identity management, such as those for user recovery (`/identity/recovery/v0.9/*`) , consent management (`/identity/consent-mgt/v1.0/*`) , and OAuth2 Dynamic Client Registration (`/api/identity/oauth2/dcr/v1.1/register`) . While these APIs handle sensitive user and application data, there is no explicit mention or implementation detail regarding the tokenization of financial `card-account-id` parameters within their path definitions.\\n\\nThe `web.xml` file  defines servlet mappings for various API versions and functionalities, but none of these paths indicate the presence or tokenization of financial account identifiers. Similarly, the SCIM2 API definitions  show parameters like `id` for groups, which are generic identifiers and not specifically financial account numbers.\\n\\nConfiguration files like `default-identity.xml`  and `encrypt-decrypt-persistence-enabled-identity.xml`  define various security and OAuth-related settings, including token persistence and client authentication. However, these configurations do not include specific options for tokenizing `card-account-id` parameters in API paths.\\n\\n## Documentation References\\n\\nThe \"Overview\" wiki page for WSO2 Identity Server  describes its capabilities in IAM, including OAuth 2.0/OpenID Connect and FAPI (Financial-grade API) compliance . While FAPI compliance suggests adherence to security standards for financial services, the provided context does not elaborate on specific mechanisms for tokenizing sensitive financial data in API paths as a part of this compliance. The FAPI conformance tests  are mentioned, but the details of these tests are not provided in a way that confirms the tokenization of `card-account-id` parameters in API paths.\\n\\n## Notes\\n\\nThe provided code snippets and wiki pages do not contain any direct evidence or explicit mentions of functionality related to tokenizing `card-account-id` parameters (such as actual card numbers, IBANs, or PANs) within API path definitions. While WSO2 Identity Server supports FAPI, the specific implementation details for this particular requirement are not visible in the given context. To verify this requirement, further investigation into the FAPI-specific implementations and documentation within the WSO2 Identity Server would be necessary.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_eab01e17-f51c-4f25-bdd3-0b2329ab848e\\n', 'id': 'lc_23e61666-9c4a-4a78-938e-233661e669e6'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the tokenization of sensitive identifiers in API paths, although direct evidence for \"card-account-id\" specifically is not explicitly found. The codebase demonstrates the use of path parameters for identifiers like `productID` and `apiId`, which are typically UUIDs or other non-sensitive tokens, rather than raw sensitive data.  \\n\\n### Implementation Details\\nThe `wso2/product-apim` repository, particularly within its OpenAPI Specification (OAS) definitions, shows how path parameters are defined. For instance, in `test-api-1-oas.yaml`, `productID` is defined as a path parameter of type `string` and `format: string` . Similarly, `apiId` and `applicationId` are defined as path parameters in `store-api.yaml`, with descriptions indicating that UUIDs are recommended for these identifiers  . This suggests a pattern of using non-sensitive, tokenized identifiers in API paths.\\n\\nThe `StarbucksOutletServiceImpl.java` file, while a sample service, demonstrates API endpoints that use `id` as a path parameter for operations like `lockOrder` and `removeOrder`  . The `Payment` bean, used in this service, contains fields like `cardNumber` and `expiryDate`, but these are handled within the request body of the `doPayment` method, not as path parameters  . This separation indicates that sensitive information is not exposed directly in the API path.\\n\\n### Configuration Options\\nThe OpenAPI definitions, such as `test-api-1-oas.yaml` and `store-api.yaml`, define parameters with `in: path` and specify their `type` as `string`  . While there isn\\'t an explicit \"tokenize\" configuration option, the practice of using UUIDs for identifiers in path parameters effectively achieves tokenization. The `x-encoded: true` attribute seen in `store-api.yaml` for `apiId-Q` and `applicationId-Q` suggests that these parameters might undergo encoding, further contributing to data protection  .\\n\\n### API Endpoints or Features\\nThe API definitions consistently use generic identifiers like `productID`, `userID`, `apiId`, and `applicationId` in their paths   . These are typically UUIDs, which serve as tokens for the actual underlying resources. The `StarbucksOutletServiceImpl.java` example also uses a generic `id` for order-related operations . This approach inherently tokenizes the identifiers in the API path, preventing sensitive data like card numbers or IBANs from being directly exposed.\\n\\n### Documentation References\\nThe `README.md` files in the `sample-scenarios` directory, such as `sample3/README.md`, discuss API management concepts like SDK generation and API optimization based on client types  . While these documents do not directly address \"card-account-id tokenization,\" they highlight the platform\\'s capabilities for securing and managing API interactions, which would include mechanisms to protect sensitive data. The reference to \"custom sequences\" for modifying API output based on client headers  suggests that the platform allows for custom logic to be applied to API requests and responses, which could be used to enforce tokenization or other data protection measures if not handled by default.\\n\\n## Notes\\nThe provided code snippets do not contain explicit code for tokenizing \"card-account-id\" parameters. However, the general pattern observed in the OpenAPI definitions and sample services indicates that sensitive identifiers are typically replaced with non-sensitive tokens (like UUIDs) when used in API paths. The `Payment` bean and its usage in `StarbucksOutletServiceImpl.java` show that sensitive payment information like `cardNumber` is expected in the request body, not the path, which aligns with the requirement of not exposing such data in API path definitions  .\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4c4f2145-fca1-4ed8-b507-c50a8043aacc\\n', 'id': 'lc_7401a1ad-97dc-4f0d-a659-09503cb94c58'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0099",
      "requirement": {
        "requirement_id": "ATOM_007",
        "requirement_text": "Message parameters SHALL be encoded in spinal-case (small letters) on path level.",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0099_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, primarily uses SCIM 2.0 for its User APIs, and the SCIM 2.0 specification generally uses camelCase for its attributes and parameters, not spinal-case. The provided Swagger definition for SCIM 2.0 endpoints also reflects this, using camelCase for query parameters.   \\n\\n### Implementation Details and API Endpoints\\n\\nThe SCIM 2.0 endpoints, such as `/scim2/Me`, `/scim2/Users`, and `/scim2/Groups`, are defined in the `SCIM2BaseTestCase.java` file.  The `scim2.yaml` Swagger definition further details these endpoints and their parameters.   \\n\\nFor example, the `/Me` endpoint uses query parameters like `attributes` and `excludedAttributes`, which are in camelCase.  Similarly, the `/Groups` endpoint uses `startIndex`, `count`, `sortBy`, and `sortOder` (camelCase) as query parameters. \\n\\nThe `web.xml` configuration defines servlets for various API versions, including `/server/v1/*` and `/server/v2/*`, which are part of the Server APIs.   While these are path segments, they do not appear to be parameters that would be subject to spinal-case encoding.\\n\\n### Configuration Options\\n\\nThe `identity-original-530-cache-disabled.xml` and `saml-assertion-query-enabled-identity.xml` files show resource contexts for `/scim2/Users/*`, `/scim2/Groups/*`, and `/scim2/Me`.   These configurations define the base paths for the SCIM 2.0 APIs and their associated permissions.   However, they do not specify any particular casing for path parameters beyond the defined resource names.  \\n\\n### Documentation References\\n\\nThe \"User APIs\" wiki page describes the User APIs as having a RESTful architecture and following SCIM 2.0 standards where applicable.  It lists various API categories and their base paths, such as `/users/v1/me` and `/users/v2/me/webauthn`.  These paths use spinal-case for segments like `authorized-apps` and `webauthn`.  However, the prompt specifically asks about *path parameters* being in spinal-case, not path segments. The SCIM 2.0 standard, which these APIs adhere to, typically uses camelCase for parameters. \\n\\n### Conclusion\\n\\nBased on the provided codebase context, the `wso2/product-is` repository\\'s APIs, particularly the SCIM 2.0 endpoints, do not appear to enforce spinal-case for message parameters at the path level. Instead, the SCIM 2.0 specification, which the APIs follow, uses camelCase for query parameters.   While some path segments in the User APIs use spinal-case (e.g., `authorized-apps`), this is distinct from path parameters. \\n\\n## Notes\\n\\nThe prompt specifically asks about \"message parameters SHALL be encoded in spinal-case (small letters) on path level\" and \"Verify that all URL path parameters use spinal-case formatting\". <cite /> The analysis focused on identifying actual path parameters as opposed to fixed path segments. <cite /> The SCIM 2.0 Swagger definition clearly shows query parameters in camelCase, which are the closest equivalent to \"message parameters on path level\" in a RESTful API context.  \\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n- [User APIs (wso2/product-is)](/wiki/wso2/product-is#4.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-m_fc0aedd8-4b7d-4c17-9c60-7fdeb0c615d0\\n', 'id': 'lc_099abe83-bf6e-4d7e-8544-d87f08862f58'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0099_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, the repository does not explicitly enforce or support spinal-case formatting for path parameters. The OpenAPI/Swagger definition files define path parameters with specific names and types, but they do not include validation patterns or formatting rules that mandate spinal-case.\\n\\n### Implementation Details    \\nThe OpenAPI specification files, such as `service-catalog-api.yaml` , `admin-api.yaml` , `publisher-api.yaml` , and `store-api.yaml` , define path parameters like `serviceId` , `conditionId` , `apiId` , and `applicationId` . These definitions specify the `name`, `in: path`, `description`, `required`, and `type` (usually `string`) for each parameter. However, none of these definitions include a `pattern` or `format` property that would enforce spinal-case.\\n\\nFor example, the `serviceId` parameter in `service-catalog-api.yaml` is defined as a `string` without any specific pattern for its value . Similarly, `apiId` in `publisher-api.yaml` is described as a UUID or `provider-name-version` format, but no explicit spinal-case enforcement is present .\\n\\nThe `APIMaintenance.yml` file defines parameters like `tracking_id` and `resource_id` with a `pattern: \"^[a-zA-Z0-9-]+$\"`  . This pattern allows lowercase letters, uppercase letters, numbers, and hyphens, which is consistent with spinal-case but does not *mandate* lowercase. It would allow \"Tracking-Id\" as well as \"tracking-id\".\\n\\n### Configuration Options   \\nThe `rewriteResourcePath_v3.json` policy definition files    define a `newResourcePath` attribute with a `validationRegex` . This regex `^/?([a-zA-Z0-9!@#\\\\\\\\$%\\\\\\\\^\\\\\\\\&*\\\\\\\\)\\\\\\\\(+=._\\\\\\\\-~:,\\\\\\\\?{}/]*)$` allows a broad range of characters, including uppercase letters, and does not specifically enforce spinal-case. This policy is for rewriting resource paths, not for validating incoming path parameters for spinal-case.\\n\\n### API Endpoints or Features \\nThe `UriTemplateReservedCharacterEncodingTest.java`  contains tests related to URI template expansion and percent encoding of reserved characters in both query and path parameters . These tests verify that reserved characters are correctly percent-encoded or decoded, but they do not address or enforce any specific casing convention like spinal-case for path parameters. For example, `testURITemplateExpandWithPercentEncodingPathParamCase`  uses \"APIM:WSO2\" as a path parameter value, which is not spinal-case, and the test focuses on encoding, not validation of the case .\\n\\n### Documentation References \\nThe `README.md` file for the store client  lists API endpoints and their HTTP requests. While it shows examples of path parameters like `{apiId}` and `{applicationId}` , it does not contain any explicit documentation or guidelines enforcing spinal-case for these parameters.\\n\\nIn summary, based on the provided snippets, there is no direct evidence that the repository explicitly supports or enforces spinal-case formatting for path parameters. The existing definitions and tests focus on parameter types, requirements, and encoding, but not on specific casing conventions.    \\n\\n## Notes\\nThe provided snippets are primarily OpenAPI/Swagger definitions and a Java test file. While some OpenAPI definitions include `pattern` attributes for parameters, these patterns are not consistently used to enforce spinal-case across all path parameters. The `UriTemplateReservedCharacterEncodingTest.java` focuses on URL encoding rather than naming conventions.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-m_7c30165d-370c-4205-abcc-129e1b17020d\\n', 'id': 'lc_687ca72a-bd03-4937-872f-bdc2eba7bd4d'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0100",
      "requirement": {
        "requirement_id": "ATOM_183",
        "requirement_text": "When a TPP includes a signature as defined in signHTTP chapter 4, the TPP must include a Digest header as defined in RFC3230",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0100_1",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0100_2",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0100_3",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0100_4",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0100_5",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0100_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the explicit inclusion of a `Digest` header as defined in RFC3230 for HTTP requests with signatures, as specified in signHTTP chapter 4. The codebase primarily focuses on SAML and OAuth2/OpenID Connect protocols, which have their own mechanisms for message integrity and signing.\\n\\n## Implementation Details   \\nThe codebase contains implementations for signing various types of messages, but none of them explicitly mention or implement the `Digest` header as per RFC3230.\\n\\n*   **SAML Signatures**: The `SAML2SSOTestBase.java` file demonstrates how SAML requests are signed. For HTTP Redirect binding, a signature is added to the HTTP query string using algorithms like `SHA1withRSA` . For SAML POST requests, the `setSignature` method is used to add an XML Digital Signature, which includes a `DigestAlgorithm` (e.g., `XML_DIGEST_ALGORITHM_SHA1`) . This digest is part of the XML signature structure, not a separate HTTP `Digest` header.\\n*   **DPoP (Demonstrating Proof of Possession)**: The `OAuth2DPopTestCase.java` and `DPoPProofGenerator.java` files show the generation and validation of DPoP proofs. DPoP proofs are JWTs that are signed and include a `jkt` (JWK Thumbprint) claim . The `DPoPProofGenerator.java` calculates a SHA-256 hash of the access token for the `ath` (Access Token Hash) claim within the DPoP JWT . This is also an internal mechanism within the DPoP JWT and not an HTTP `Digest` header.\\n\\n## Configuration Options   \\nFor SAML, configuration files like `IDENTITY6777-identity.xml`  and `create-saml-app-with-manual-config.json`  allow specifying `SAMLDefaultDigestAlgorithmURI` or `digestAlgorithm` for XML signatures. However, these refer to the digest algorithm used within the XML signature itself, not a separate HTTP `Digest` header.\\n\\n## API Endpoints or Features \\nThe DPoP implementation uses a `DPOP_HEADER`  for carrying the DPoP proof, which is a JWT. This header is distinct from a `Digest` header.\\n\\n## Documentation References \\nThe provided wiki page on \"OAuth2 and OpenID Connect\"  discusses various aspects of these protocols, including token management and standards compliance (OIDC and FAPI). While it mentions DPoP tokens, there is no mention of the `Digest` header as defined in RFC3230.\\n\\n## Notes\\nThe user\\'s query specifically asks about the `Digest` header as defined in RFC3230 in the context of `signHTTP chapter 4`. The provided codebase snippets and wiki page primarily deal with SAML and OAuth2/OpenID Connect, which use different mechanisms for ensuring message integrity and authenticity (e.g., XML Digital Signatures for SAML, and JWTs for DPoP). There is no direct evidence in the provided context that `wso2/product-is` implements or supports the RFC3230 `Digest` header for HTTP requests.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_6720b990-be8b-4128-8624-1f3a3ab151ce\\n', 'id': 'lc_2bfbee11-09bc-4572-b211-34ec05cab861'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0100_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"This repository, `wso2/product-apim`, appears to support Digest authentication, but there is no direct evidence that it enforces or automatically includes a `Digest` header as defined in RFC3230 when a TPP includes a signature as defined in signHTTP chapter 4.   The existing code primarily focuses on handling incoming Digest Authorization headers for authentication purposes. \\n\\n## Implementation Details\\n\\nThe `wso2/product-apim` repository contains integration tests and Synapse configurations that demonstrate the handling of Digest authentication. \\n\\n### `dummy_digest_api.xml`\\nThis Synapse configuration defines an API named `DigestAuth_API` that listens on the context `/digestAuth`.  It checks for the presence of an `Authorization` header. \\n*   If the `Authorization` header is present, it logs a message indicating its presence and sends a `200 OK` response. \\n*   If the `Authorization` header is not present, it logs a message, sets a `WWW-Authenticate` header for Digest authentication, and sends a `401 Unauthorized` response. \\n\\nThis configuration demonstrates the server-side handling of an incoming `Authorization` header for Digest authentication, but it does not show any mechanism for *generating* or *enforcing* an outgoing `Digest` header. \\n\\n### `DigestAuthenticationTestCase.java`\\nThis test case verifies the functionality of an API configured with Digest Authentication. \\n*   It sets up an API with `endpointAuthType` as `digestAuth`. \\n*   The test then invokes the API with an `Authorization` header containing a Bearer token. \\n*   The assertion checks for a `200 OK` response. \\n\\nThis test case focuses on the successful invocation of an API secured with Digest authentication, but it does not explicitly test the presence or generation of a `Digest` header conforming to RFC3230 in outgoing requests from the TPP (which in this context would be the API Gateway or a client making a signed request). \\n\\n## Configuration Options\\n\\nThe `addHeader_v2.json` policy specification allows adding arbitrary headers to requests.  While this could be used to manually add a `Digest` header, there is no built-in configuration option that automatically generates and includes a `Digest` header based on the request body or other signing mechanisms. \\n\\n## API Endpoints or Features\\n\\nThe codebase does not expose any specific API endpoints or features that are designed to automatically generate and include a `Digest` header in outgoing requests based on a signed HTTP request. <cite/> The existing Digest authentication support is for validating incoming `Authorization` headers. \\n\\n## Documentation References\\n\\nBased on the provided snippets, there are no explicit documentation references within the code that detail the automatic inclusion of a `Digest` header conforming to RFC3230 when a TPP includes a signature as defined in signHTTP chapter 4. <cite/>\\n\\n## Conclusion\\n\\nThe current codebase primarily handles Digest authentication for incoming requests, specifically the `Authorization` header.  There is no direct evidence in the provided snippets to suggest that the repository automatically generates and includes a `Digest` header in outgoing requests when a TPP includes a signature. <cite/> To meet the requirement, custom mediation or policy enforcement would likely be needed to compute and add the `Digest` header. \\n\\n## Notes\\n\\nThe `dummy_digest_api.xml` and `DigestAuthenticationTestCase.java` files are integration test artifacts.   They demonstrate the capability of the WSO2 API Manager to handle Digest authentication as a server, but not necessarily to act as a client that generates signed requests with `Digest` headers.  The `addHeader_v2.json` policy could be used to manually add a `Digest` header, but it doesn't provide the automatic computation required by the prompt.  Other files like `FORCE_HTTP_CONTENT_LENGTH.xml` and `auth_headers.xml` deal with other HTTP header manipulations or authentication mechanisms (e.g., JWT), but are not directly related to the `Digest` header requirement.   The `websub_api_template.xml` shows `X-Hub-Signature` generation, which is a different signing mechanism and not directly related to RFC3230 `Digest` headers. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_83d18358-fd26-4aa9-aa2c-424cacde55ae\\n\", 'id': 'lc_43533472-81a3-4872-9b26-cb4bbc8b2d92'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0101",
      "requirement": {
        "requirement_id": "ATOM_153",
        "requirement_text": "The transactionId path parameter SHALL be given by the attribute transactionId of the corresponding entry of a transaction list",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0101_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_3",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_4",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_5",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports using a `transactionId` from a transaction list response to retrieve transaction details.  This functionality is defined within the OpenAPI specification for Account Information APIs and demonstrated in the demo backend service.  \\n\\n## Implementation Details\\n\\nThe `financial-services-accelerator` defines the structure for transactions, including a `TransactionId`, in its OpenAPI specification for Account Information APIs. \\n\\nSpecifically, the `OBReadTransaction5` schema includes a `Data` object which contains an array of `OBTransaction5` objects.  Each `OBTransaction5` object is required to have an `AccountId`, `CreditDebitIndicator`, `Status`, `BookingDateTime`, and `Amount`, and it can optionally include a `TransactionId`.  The `TransactionId` is defined as a unique and immutable identifier for the transaction within a servicing institution. \\n\\nThe `AccountService.java` in the `org.wso2.financial.services.accelerator.demo.backend` module provides a demo endpoint for retrieving account transactions.  This endpoint, `/accounts/{AccountId}/transactions`, returns a hardcoded JSON response that includes a `TransactionId` with the value \"123\".  This demonstrates how a `transactionId` would be provided in a transaction list response. \\n\\n## API Endpoints or Features\\n\\nThe OpenAPI specification defines a `GET` endpoint for `/accounts/{AccountId}/transactions` which is used to retrieve transactions for a specific account.  While this specific endpoint retrieves a list of transactions for an `AccountId`, the presence of `TransactionId` within the `OBTransaction5` schema indicates that individual transaction details can be identified and potentially retrieved using this ID. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page for the `wso2/financial-services-accelerator` repository mentions \"Account Information APIs\" which include \"Transactions\" as a category. <cite repo=\"wso2/financial-services-accelerator\" path=\"financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml\" start=\"1-30\" end=\"1-30\" />  This aligns with the `account-info-swagger.yaml` file that defines the `/accounts/{AccountId}/transactions` endpoint and the `TransactionId` schema.  \\n\\n## Test Criteria\\n\\nThe `EndToEndAccountFlowTest.groovy` integration test includes a test case named `\"Verify Accounts transaction Retrieval Request for a Authorised Consent\"`.  This test verifies the successful retrieval of account transactions, which would involve obtaining a list of transactions that contain `transactionId` values.  While the test itself doesn\\'t explicitly verify using a `transactionId` to retrieve *individual* transaction details, it confirms the availability of transaction lists from which `transactionId` values can be extracted. \\n\\n## Notes\\n\\nThe provided context primarily focuses on the definition of the `TransactionId` within the OpenAPI specification and a demo implementation that returns a hardcoded `TransactionId`.   There isn\\'t an explicit API endpoint shown in the provided snippets that takes `transactionId` as a path parameter to retrieve a *single* transaction detail. <cite /> However, the definition of `TransactionId` as a \"Unique identifier for the transaction\" strongly implies its intended use for such retrieval.  The integration test confirms the ability to retrieve transaction lists, which would contain these `transactionId` values. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_1d887c2c-5c4f-4f12-913b-18fb0b713521\\n', 'id': 'lc_ecfa8b79-888b-4649-996a-3e4a1fbcf473'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0102",
      "requirement": {
        "requirement_id": "ATOM_154",
        "requirement_text": "The X-Request-ID header SHALL be mandatory and contain a UUID unique to the call as determined by the initiating party",
        "strength": "SHALL",
        "capability": "Audit And Logging",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Audit And Logging",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0102_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not explicitly enforce the `X-Request-ID` header as mandatory with a UUID unique to the call for all API endpoints. However, there is an instance within the `oidc-fapi-conformance-tests` module where an `X-Fapi-Interaction-Id` header, which serves a similar purpose, is handled. \\n\\n### Implementation Details\\n\\nIn the `oidc-fapi-conformance-tests/resource-server/resource-server.py` file, which appears to be a resource server for FAPI conformance testing, there is a specific handling for an `X-Fapi-Interaction-Id` header. \\n\\nThe `resource` endpoint checks for the presence of this header.  If the `X-Fapi-Interaction-Id` header is not present in the incoming request, a new UUID is generated and assigned to it.  This generated or existing `X-Fapi-Interaction-Id` is then included in the response headers.  This indicates that for this specific test resource server, the `X-Fapi-Interaction-Id` is used for tracking, but its absence does not lead to rejection; instead, a new one is generated. \\n\\nThe `UUID.randomUUID()` method is used to generate a unique identifier when the `X-Fapi-Interaction-Id` is missing.  The `modules/p2-profile-gen/pom.xml` file also references a `org.wso2.carbon.uuid.generator.feature`, suggesting that UUID generation capabilities are part of the WSO2 Identity Server\\'s features.  \\n\\n### Configuration Options\\n\\nBased on the provided snippets, there are no explicit configuration options to enforce a mandatory `X-Request-ID` header across all API endpoints within the `wso2/product-is` repository. The `X-Fapi-Interaction-Id` handling is specific to the FAPI conformance test resource server. \\n\\n### API Endpoints or Features\\n\\nThe `resource` endpoint in `oidc-fapi-conformance-tests/resource-server/resource-server.py` is the only API endpoint shown that interacts with a request ID-like header (`X-Fapi-Interaction-Id`).  This endpoint is part of a test suite for Financial-grade API (FAPI) conformance. \\n\\n### Documentation References\\n\\nThe provided context does not include specific documentation references regarding a mandatory `X-Request-ID` header. The \"Architecture\" wiki page provides a high-level overview of WSO2 Identity Server\\'s components but does not detail specific header requirements for API calls. \\n\\n## Notes\\n\\nThe user\\'s query specifically asks about an `X-Request-ID` header. While the `oidc-fapi-conformance-tests/resource-server/resource-server.py` file handles an `X-Fapi-Interaction-Id` header, it\\'s important to note that this is within a test context and not a general enforcement across the entire product.  The behavior observed (generating a UUID if the header is missing) does not align with the \"SHALL be mandatory and contain a UUID unique to the call\" requirement, as it does not reject requests without the header.  There is no evidence in the provided snippets of a global mechanism to enforce a mandatory `X-Request-ID` header and reject requests that do not conform.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9833ce6d-12dc-4f95-89ec-e13cfa5d4ce0\\n', 'id': 'lc_e5227ba1-0ae8-4045-a4e0-9982f459cca8'}]",
          "capability": "Audit And Logging",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0102_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not appear to explicitly support a mandatory `X-Request-ID` header with UUID validation as described in your query. The provided code snippets primarily discuss `MessageID` and `RelatesTo` headers, which are UUIDs but are not directly tied to an `X-Request-ID` requirement or validation. There are no configuration options or API endpoints that directly enforce or validate an `X-Request-ID` header.\\n\\n### Implementation Details <cite/>\\nThe codebase includes documentation for `MessageID` and `RelatesTo` headers, which are described as containing UUIDs. For instance, in `all-in-one-apim/docs/xdoc/properties_guide.xml`, the `MessageID` header is defined to have \"Possible Values\" of \"UUID\" and is described as \"The unique message ID of the message.\"  Similarly, the `RelatesTo` header is also documented to have \"Possible Values\" of \"UUID\" and represents \"The unique ID of the request to which the current message is related.\"  These headers are mentioned in documentation for `api-control-plane` , `gateway` , and `traffic-manager`  components. However, there is no explicit mention of an `X-Request-ID` header or any mechanism to enforce its presence or validate its UUID format.\\n\\nThe `Owasp.CsrfGuard.Carbon.properties` file mentions `X-Requested-With` header in the context of CSRF protection for Ajax requests . This is a different header and serves a different purpose than `X-Request-ID`.\\n\\n### Configuration Options <cite/>\\nThere are no configuration options found in the provided snippets that directly relate to making an `X-Request-ID` header mandatory or validating its UUID content. The `Owasp.CsrfGuard.Carbon.properties` file contains configurations for CSRF protection, such as `org.owasp.csrfguard.TokenPerPage` and `org.owasp.csrfguard.Ajax`  , but these do not pertain to `X-Request-ID`.\\n\\n### API Endpoints or Features <cite/>\\nThe provided context does not reveal any specific API endpoints or features that would enforce or validate an `X-Request-ID` header. The `tenant-axis2.xml` file outlines message processing phases like `InFlow`, `OutFlow`, and `InFaultFlow` , which could potentially be extended to include custom header validation, but no such implementation is present for `X-Request-ID`.\\n\\n### Documentation References <cite/>\\nThe documentation references provided, such as `properties_guide.xml` files across different modules    , describe `MessageID` and `RelatesTo` headers as UUIDs. However, none of these documents mention `X-Request-ID` or any requirement for it to be mandatory or validated.\\n\\n## Notes\\nThe query specifically asks about the `X-Request-ID` header. While the codebase mentions `MessageID` and `RelatesTo` headers that contain UUIDs, these are distinct from `X-Request-ID`. There is no direct evidence in the provided snippets to suggest that `wso2/product-apim` supports making `X-Request-ID` mandatory or performs validation on its content. The `Owasp.CsrfGuard.Carbon.properties` file discusses `X-Requested-With` in the context of CSRF, which is not the same as `X-Request-ID`.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_855ebec3-16d4-4ed5-a1b8-48100a023455\\n', 'id': 'lc_b8f69471-5deb-48b3-aaf4-058a75dc858f'}]",
          "capability": "Audit And Logging",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0103",
      "requirement": {
        "requirement_id": "ATOM_184",
        "requirement_text": "The Digest header must contain a hash of the message body, or if the message does not contain a body, the hash of an empty bytelist",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0103_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support hashing mechanisms, specifically SHA-256, for various security-related functions, including DPoP token generation and PKCE code challenge generation. However, there is no direct evidence within the provided snippets that explicitly implements or configures the \"Digest\" header as described in the prompt for general message body hashing.\\n\\n### Implementation Details\\n\\nThe codebase includes a utility class, `DPoPProofGenerator.java`, which contains a method `generateAccessTokenHash` . This method uses `MessageDigest.getInstance(\"SHA-256\")` to compute a SHA-256 hash of an access token, which is then Base64 URL-encoded . This is used in the context of DPoP (Demonstrating Proof of Possession) tokens, where the access token hash is part of the DPoP proof .\\n\\nAnother instance of hashing is found in `OAuth2PKCETestCase.java`, where the `getPKCECodeChallenge` method generates a SHA-256 hash of a code verifier for PKCE (Proof Key for Code Exchange) .\\n\\nWhile these examples demonstrate the use of SHA-256 hashing for specific security protocols (DPoP and PKCE), they do not directly indicate support for a generic \"Digest\" header for arbitrary message bodies.\\n\\n### Configuration Options\\n\\nThe `saml-idp.xml` configuration file shows a `DigestAlgorithm` property within the SAML2 authenticator configuration . This suggests that digest algorithms can be configured for SAML assertions, with `MD5` as an example value . Similarly, `saml-metadata-super-tenant.json` lists various `responseDigestAlgorithm` options, including SHA-1, SHA-256, SHA-384, and SHA-512, with SHA-256 as the default value . These configurations are specific to SAML and do not directly relate to an HTTP \"Digest\" header for general message bodies.\\n\\n### API Endpoints or Features\\n\\nThe provided context does not explicitly mention any API endpoints or features that directly implement or expose a \"Digest\" header for message body hashing as a general mechanism. The `OAuth2 and OpenID Connect` wiki page describes various OAuth2/OIDC endpoints like `/oauth2/token`, `/oauth2/authorize`, and `/oauth2/userinfo`   , but none are described as handling a generic \"Digest\" header.\\n\\n### Documentation References\\n\\nThe `OAuth2 and OpenID Connect` wiki page provides an overview of OAuth2 and OpenID Connect implementation . It mentions DPoP tokens as a type of access token  and token binding with DPoP , which involves hashing as seen in `DPoPProofGenerator.java` . However, there is no documentation reference for a general \"Digest\" header for message bodies.\\n\\n## Notes\\n\\nThe prompt specifically asks about a \"Digest\" header containing a hash of the message body. While the codebase demonstrates the use of hashing (SHA-256) for specific security mechanisms like DPoP tokens and PKCE code challenges, and allows configuration of digest algorithms for SAML, there is no direct evidence of a general-purpose \"Digest\" header implementation for HTTP message bodies. The existing hashing implementations are tied to particular protocol specifications rather than a generic HTTP header.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ab443453-6271-4372-8f88-9aa5291a7234\\n', 'id': 'lc_fbb29fbd-f224-4739-8d9a-ae2ffb60e21d'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0103_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support Digest authentication, but it does not explicitly implement or verify the \"Digest\" header containing a hash of the message body or an empty bytelist as described in your query.    The existing code primarily focuses on the presence of the `Authorization` header for Digest authentication and the `WWW-Authenticate` header for challenging unauthorized requests.  \\n\\n## Implementation Details\\n\\nThe `wso2/product-apim` repository includes configurations for Digest authentication within its Synapse configurations.  \\n\\n### `DigestAuth_API` Synapse Configuration\\nThe `dummy_digest_api.xml` files define a Synapse API named `DigestAuth_API` with the context `/digestAuth`.  This API handles `POST`, `GET`, `PUT`, `DELETE`, `HEAD`, and `OPTIONS` methods. \\n\\nThe `inSequence` of this API checks for the presence of the `Authorization` header. \\n*   If the `Authorization` header is present, it logs a message indicating its presence and sends a `200 OK` response with a payload.  \\n*   If the `Authorization` header is not present, it logs a message, sets the HTTP status code to `401 Unauthorized`, and includes a `WWW-Authenticate` header with `Digest` realm, `qop`, and `nonce` values in the response. \\n\\n### `DigestAuthMediator`\\nThe `api_product_template.xml` file references a `org.wso2.carbon.apimgt.gateway.mediators.DigestAuthMediator` class.  This suggests that there is a custom mediator designed to handle Digest authentication. However, the provided snippets do not contain the source code for this mediator, so its internal logic regarding hash calculation cannot be determined. \\n\\n### `DigestAuthenticationTestCase`\\nThe `DigestAuthenticationTestCase.java` integration test class is used to verify the functionality of an API configured with Digest Authentication.  This test creates an API with `endpointAuthType` set to `digestAuth` and provides `epUsername` and `epPassword`.  It then invokes the API and asserts that the response code is `200 OK`.  This test primarily confirms that the API gateway can successfully process a request after Digest authentication, but it does not specifically verify the content of the `Digest` header or the hash calculation of the message body. \\n\\n## Configuration Options\\n\\nThe configuration for Digest authentication involves setting the `endpointAuthType` to `digestAuth` and providing `epUsername` and `epPassword` when creating an API. \\n\\n## API Endpoints or Features\\n\\nThe `DigestAuth_API` is exposed at the `/digestAuth` context.  This API is designed to test the Digest authentication flow, where it either accepts a request with a valid `Authorization` header or challenges it with a `WWW-Authenticate` header. \\n\\n## Documentation References\\n\\nThe documentation for the `Cache Mediator` mentions a `hashGenerator` attribute that can be configured with a class implementing `org.wso2.caching.digest.DigestGenerator`.  The default hash generator is `org.wso2.caching.digest.DOMHashGenerator`.  While this refers to digest generation, it is in the context of caching messages and not directly related to the `Digest` header for HTTP authentication. \\n\\n## Conclusion\\n\\nBased on the provided code snippets, the `wso2/product-apim` repository supports Digest authentication at a high level, handling the presence or absence of the `Authorization` header and issuing `WWW-Authenticate` challenges.   However, there is no explicit implementation or verification logic visible in the provided code that ensures the `Digest` header contains a hash of the message body or an empty bytelist. <cite/> The `DigestAuthMediator` class is mentioned, but its implementation details are not available to confirm this specific requirement. \\n\\n## Notes\\n\\nThe term \"digest\" also appears in the context of caching, specifically with `org.wso2.caching.digest.DigestGenerator` and `org.wso2.caching.digest.DOMHashGenerator`.  This is a separate mechanism for generating hash values for caching purposes and should not be confused with the `Digest` header in HTTP authentication.  The `fips.sh` script mentions \"bcprov-jdk\" and \"bcpkix-jdk\" which are related to Bouncy Castle FIPS compliant cryptography, but this is a general security configuration and not directly tied to the HTTP Digest header calculation. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_051eb05a-967f-4be0-aeff-7e619a0fbdc5\\n', 'id': 'lc_3b22c35b-00c1-4a72-ae53-665d0a8b8d24'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0104",
      "requirement": {
        "requirement_id": "ATOM_156",
        "requirement_text": "The Consent-ID header SHALL be mandatory for transaction detail requests",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0104_1",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0104_2",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0104_3",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0104_4",
          "text": "### getDetailedConsent method\n \nThis method lets you retrieve detailed consent for a given consent ID. A detailed consent includes the following in \naddition to consent resource-specific data: \n\n - Relative consent authorization data\n - Relative consent account mapping data \n - Relative consent attributes\n \n``` java\nDetailedConsentResource getDetailedConsent(String consentID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0104_5",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0105",
      "requirement": {
        "requirement_id": "ATOM_128",
        "requirement_text": "ASPSP SHALL support Global Consent model where TPP submits only PSU identification for general account access",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0105_1",
          "text": "### Data\nThe following table explains the data available in `ConsentValidateData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| headers   | JSONObject            | The request headers sent in the request. |\n| body   | JSONObject            | The payload sent in the request. |\n| electedResource   | String            | The path invoked in the request. For example: `/accounts/{AccountId}`|\n| consentId | String                | The consent ID related to the current resource request. This consent ID is bound to the user access token used. |\n| userId | String                | The user ID related to the current resource request. This user ID is retrieved from the user access token. |\n| clientId | String                | The ID of the TPP application related to the current resource request. This client ID is retrieved from the user access token.|\n| comprehensiveConsent  | DetailedConsentResource   | The comprehensive consent object related to the consent that is being validated. This object contains all the details related to the consent. |\n| resourceParams | Map<String, String>                | A map containing the full resource path with query parameters (ex: `aisp/accounts/{AccountId}?queryParam=urlEncodedQueryParamValue`), HTTP method, and context (ex: `/open-banking/v3.1/aisp`) of the request. |\n\nThe following table explains the data available in `ConsentValidationResult`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| isValid | boolean | An attribute to identify whether the consent is in a valid state or not. |\n| modifiedPayload | JSONObject | Optionally used to set a modified error payload to be sent with the consent validation response. If a modified payload is set, it is given priority over creating a generic error response using the message and code information. |\n| consentInformation | JSONObject | Used to set the consent data to the consent validation result. This data will be sent to the bank backend. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_2",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_3",
          "text": "components:\n  schemas:\n    ConsentValidateDetail:\n      type: object\n      properties:\n        headers:\n          description: Object containing keys and values of request headers received to the gateway\n          type: object\n        payload:\n          description: Object containing the request payload received to the gateway\n          type: object\n        electedResource:\n          description: String value of the request path received in the request\n          type: string\n          example: \"/accounts/1234\"\n        consentId:\n          description: The consent ID of the consent being valdiated\n          type: string\n          example: \"cc0961f9-6b38-4c78-a522-b3210a7f2330\"\n        userId:\n          description: The user ID of the user invoking the API\n          type: string\n          example: \"admin@carbon.super\"\n        clientId:\n          description: The client ID of the TPP Application invoking the API\n          type: string\n          example: \"W4QaMjYv9rn49O7dpeBQD5DLGFQa\"\n        resourceParams:\n          description: The details of the API context and resource\n          type: object\n          properties:\n            resource:\n              description: The context including query parameters of the request\n              type: string\n              example: \"/aisp/accounts/{AccountId}?queryParam=queryParamValue\"\n            httpMethod:\n              description: The http method of the request\n              type: string\n              example: \"POST\"\n            context:\n              description: The base path of the context\n              type: string\n              example: \"/open-banking/v3.1/aisp\"\n    ConsentManageCreatePayload:\n      type: object\n    ConsentManageUpdatePayload:\n      type: object\n    ConsentManagePatchPayload:\n      type: object\n    ConsentAuthorizePatchPayload:\n      type: object\n      properties:\n        cookies:\n          type: object\n          properties:\n            commonAuthId:\n              type: string\n              example: \"060711ab-ab8e-44fe-ba3f-9d57fa0c4155\"\n            JSESSIONID:\n              type: string\n              example: \"A62B65FAA2F16E0172BD9D8825F96E49D1CADD9B55C58CD00C664380F13F8AE95138939A053851856C344A1ADECC0125FF716EE00DD32140BF8574ECECF9A5EDDFAAB641280C5220AC18B1C2F75D62E574C27B8E603A666C4DFF87F0347B460BE3A3B1A370E67559C5936FE2A7700764C9041B5E87118F763731DF9F77B0DDB8\"\n        type:\n          type: string\n          example: \"accounts\"\n        approval:\n          type: string\n          example: \"true\"\n        cofAccount:\n          type: string\n          example: \"12345\"\n        paymentAccount:\n          type: string\n          example: \"12345\"\n        accountIds:\n          type: array\n          items:\n            type: string\n            example: \"12345\"\n        metadata:\n          type: object\n    ConsentErrorCommon:\n      type: object\n      properties:\n        status:\n          description: Error status code\n          type: string\n        title:\n          description: Error title\n          type: string\n        description:\n          description: Error description\n          type: string\n    ConsentValidateOKResponse:\n      type: object\n      properties:\n        isValid:\n          description: Consent validation result\n          type: string\n          example: false\n        modifiedPayload:\n          description: Modified payload for in flow\n          type: string\n          example:\n        errorCode:\n          description: Error code to be sent\n          type: string\n          example: Unauthorized\n        errorMessage:\n          description: Error message to be sent\n          type: string\n          example: \"Path requested is invalid\"\n        httpCode:\n          description: HTTP error code\n          type: string\n          example: \"401\"\n        consentInformation:\n          description: Consent information that needs to be passed to the backend\n          type: string\n          example: \"eyJhbGciOiJSUzI1NiJ9.eyJjbGllbnRJZCI6Ilc0UWFNall2OXJuNDlPN2RwZUJRRDVETEdGUWEiLCJjdXJyZW50U3RhdHVzIjoiUmVqZWN0ZWQiLCJjcmVhdGVkVGltZXN0YW1wIjoxNzE5ODA4NTAzLCJyZWN1cnJpbmdJbmRpY2F0b3IiOmZhbHNlLCJhdXRob3JpemF0aW9uUmVzb3VyY2VzIjpbeyJ1cGRhdGVkVGltZSI6MTcxOTgwODUxNywiY29uc2VudElkIjoiYTc4MTViMmQtMGViMS00MWMwLTg5OWQtYzQwYzk3MThkMTUzIiwiYXV0aG9yaXphdGlvbklkIjoiYmNiZjUwOTgtZTkyZS00ODUxLThmYTktMWUyNjc5YTY1MjI3IiwiYXV0aG9yaXphdGlvblR5cGUiOiJhdXRob3Jpc2F0aW9uIiwidXNlcklkIjoiZTYwY2FkMWItYzhmMS00NjczLWJjMWQtZjIyZTY1ZWRlNTc2IiwiYXV0aG9yaXphdGlvblN0YXR1cyI6IlJlamVjdGVkIn1dLCJ1cGRhdGVkVGltZXN0YW1wIjoxNzE5ODA4NTE3LCJjb25zZW50X3R5cGUiOiJhY2NvdW50cyIsInZhbGlkaXR5UGVyaW9kIjowLCJjb25zZW50QXR0cmlidXRlcyI6e30sImNvbnNlbnRJZCI6ImE3ODE1YjJkLTBlYjEtNDFjMC04OTlkLWM0MGM5NzE4ZDE1MyIsImNvbnNlbnRNYXBwaW5nUmVzb3VyY2VzIjpbeyJtYXBwaW5nSWQiOiIwZmJlN2Q1NS02MDQzLTQ2MTctYmNiOS0xNDg3NWI0Y2M0YzciLCJtYXBwaW5nU3RhdHVzIjoiYWN0aXZlIiwiYWNjb3VudF9pZCI6IjEyMzQ1IiwiYXV0aG9yaXphdGlvbklkIjoiYmNiZjUwOTgtZTkyZS00ODUxLThmYTktMWUyNjc5YTY1MjI3IiwicGVybWlzc2lvbiI6InByaW1hcnkifV0sImFkZGl0aW9uYWxDb25zZW50SW5mbyI6e30sInJlY2VpcHQiOnsiUmlzayI6e30sIkRhdGEiOnsiVHJhbnNhY3Rpb25Ub0RhdGVUaW1lIjoiMjAyNC0wNy0wNFQxMDowNTowMS42OTI5OTArMDU6MzAiLCJFeHBpcmF0aW9uRGF0ZVRpbWUiOiIyMDI0LTA3LTA2VDEwOjA1OjAxLjY4NTMzMCswNTozMCIsIlBlcm1pc3Npb25zIjpbIlJlYWRBY2NvdW50c0RldGFpbCIsIlJlYWRCYWxhbmNlcyIsIlJlYWRUcmFuc2FjdGlvbnNEZXRhaWwiXSwiVHJhbnNhY3Rpb25Gcm9tRGF0ZVRpbWUiOiIyMDI0LTA3LTAxVDEwOjA1OjAxLjY5Mjg0MCswNTozMCJ9fSwiY29uc2VudEZyZXF1ZW5jeSI6MH0.OiJOGfou1n86hzS7PBkRUczDxmmIVswqidxFf9-B8wuIaTLDdAxZnDMFYVs3NCYJvnJXg_ht9m3EEhnX1YgM4BPioBRNcygs1Ns8LMQunB2Y4wOtT71sYvFuDveAPPrwsZy-Z8OV9zrM27aTyLyj-mfHckehGpsDq4pNB9jaOpxaFsBEuxpF9GZxY1Bzy1XmYNxSZ5en2itoStYjKbBwQ3jIlzIvy9DcKkPrnTlukx0ik6RrYyVJ04kctiIbzGaOBQ1x71VvJin9ezriIi8lqHjP2BPxm6zV4GepFY8scxUcut9tRJNQNrQObGDMT0Ib843yf4dDaJ2huJpEEDTNFg\"\n    ConsentSearchOKResponse:\n      type: object\n      properties:\n        data:\n          description: Detailed consent objects. Search results\n          type: array\n          items:\n            $ref: \"#/components/schemas/ConsentDetail\"\n        meatadata:\n          $ref: \"#/components/schemas/ConsentSearchMetadata\"\n    ConsentManageOKResponse:\n      type: object\n    ConsentManageCreatedResponse:\n      type: object\n    ConsentAuthorizeRetrievalResponse:\n      type: object\n      properties:\n        consentData:\n          description: Consent data to be shown to the end user\n          type: array\n          items:\n            type: object\n            properties:\n              title:\n                type: string\n                example: \"Permissions\"\n              data:\n                type: array\n                items:\n                  type: string\n                  example: \"ReadAccountsDetail\"\n        application:\n          description: Name of the application requesting access\n          type: string\n          example: \"Test App\"\n        accounts:\n          description: Accounts retrieved from the bank\n          type: array\n          items:\n            type: object\n            properties:\n              account_id:\n                type: string\n                example: \"12345\"\n              display_name:\n                type: string\n                example: \"Salary Saver Account\"\n        type:\n          description: Consent Type\n          type: string\n          example: \"accounts\"\n    ConsentDetail:\n      type: object\n      properties:\n        clientId:\n          description: Client ID associated with the consent\n          type: string\n          example: \"W4QaMjYv9rn49O7dpeBQD5DLGFQa\"\n        currentStatus:\n          description: Current status of the consent\n          type: string\n          example: \"AwaitingAuthorisation\"\n        createdTimestamp:\n          description: Consent created timestamp\n          type: string\n          example: \"1719810512\"\n        recurringIndicator:\n          description: Recurring indicator of the consent\n          type: string\n          example: \"false\"\n        authorizationResources:\n          description: Authorization resources associated with the consent\n          type: array\n          items:\n            $ref: \"#/components/schemas/ConsentAuthorizationResource\"\n        updatedTimestamp:\n          description: Last updated timestamp\n          type: string\n          example: \"1719810602\"\n        validityPeriod:\n          description: Consent validity period\n          type: string\n          example: \"0\"\n        consentAttributes:\n          description: Key value pairs of consent attributes\n          type: object\n        consentId:\n          description: Consent ID\n          type: string\n          example: \"514556fe-57b6-4565-98d1-0b53ff53d62b\"\n        consentMappingResources:\n          description: Account mapping resources associated with the consent\n          type: array\n          items:\n            $ref: \"#/components/schemas/ConsentMappingResource\"\n        consentType:\n          description: Consent type\n          type: string\n          example: \"accounts\"\n        receipt:\n          description: Consent receipt\n          type: object\n        consentFrequency:\n          description: Consent Frequency\n          type: string\n          example: \"0\"\n    ConsentSearchMetadata:\n      type: object\n      properties:\n        total:\n          description: Total number of results available despite pagination\n          type: integer\n        offset:\n          description: Pagination offset of result\n          type: integer\n        count:\n          description: Count sent in current response\n          type: integer\n        limit:\n          description: Limit applied for current result\n          type: integer\n    ConsentAuthorizationResource:\n      type: object\n      properties:\n        updatedTime:\n          description: Authorization updated time\n          type: integer\n          example: 1719809834569\n        consentID:\n          description: Consent ID of the authorization\n          type: string\n          example: \"514556fe-57b6-4565-98d1-0b53ff53d62b\"\n        authorizationID:\n          description: Authorization ID\n          type: string\n          example: \"96e4033b-6063-4bc8-ba5b-00559c1a9b31\"\n        authorizationType:\n          description: Type of authorization\n          type: string\n          example: \"authorisation\"\n        userID:\n          description: User ID\n          type: string\n          example: \"admin@carbon.super\"\n        authorizationStatus:\n          description: Current status of the authorization\n          type: string\n          example: \"created\"\n    ConsentMappingResource:\n      type: object\n      properties:\n        mappingId:\n          description: Mapping ID\n          type: string\n          example: \"ddf5db03-14b2-49f9-a596-0e0cf14e9b03\"\n        mappingStatus:\n          description: Status of the mapping\n          type: string\n          example: \"active\"\n        accountId:\n          description: Accoung ID of the mapping resource\n          type: string\n          example: \"12345\"\n        authorizationID:\n          description: Authorization ID associated with the mapping\n          type: string\n          example: \"96e4033b-6063-4bc8-ba5b-00559c1a9b31\"\n        permission:\n          description: Mapping permission\n          type: string\n          example: \"primary\"\n  securitySchemes:\n    basicAuth:\n      type: http\n      scheme: basic",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_4",
          "text": "## Setting up Consent manager app",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_5",
          "text": "### getConsentAmendmentHistoryData method\n\n!!! info\n    This is only available as a WSO2 Update from **WSO2 Open Banking Identity Server Accelerator Level\n    3.0.0.33** onwards. For more information on updating,\n    see [Getting WSO2 Updates](../install-and-setup/setting-up-servers.md#getting-wso2-updates).\n\nThis method retrieves the consent amendment history for a given consent. Given below is the method signature:\n\n``` java\nMap < String, ConsentHistoryResource > getConsentAmendmentHistoryData(\n    String consentID)\nthrows ConsentManagementException\n```\nInput parameter:\n\n- `consentID`: consent ID of the consent. This is a mandatory parameter.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support a Global Consent model where a TPP (Third Party Provider) can submit only PSU (Payment Services User) identification for general account access, particularly within the context of Open Banking and PSD2 requirements. The system includes a Consent Management framework that allows for the collection, storage, and enforcement of user consent.\\n\\n### Implementation Details\\n\\nThe Consent Management framework in `wso2/product-is` is designed to handle user consent for processing personal data, which is crucial for compliance with privacy regulations like GDPR . The system uses PII (Personally Identifiable Information) categories and Purposes to define what data is collected and why . Consent receipts are generated to record user consent decisions .\\n\\nThe `SelfSignUpConsentTest.java` integration test demonstrates how consent is collected during self-registration and how consent requests are constructed . The `getConsentReqBody` method in this test constructs a JSON request body for consent, which includes `piiPrincipalId` (PSU identification) and details about the service and purposes for which consent is being given . This structure suggests that consent can be granted for a `piiPrincipalId` (PSU) without specifying individual account details within the consent request itself, aligning with a Global Consent model.\\n\\nThe `OAuth2ServiceAbstractIntegrationTest.java` also contains methods for sending approval post requests with consent, indicating that consent is integrated into the OAuth2 flow . The `sendApprovalPostWithConsent` method takes `sessionDataKeyConsent` and `consentClaims` as parameters, and includes a `consent` parameter set to \"approve\" .\\n\\n### Configuration Options\\n\\nThe `default-identity.xml` configuration file indicates that consent management can be enabled for SSO (Single Sign-On) . Specifically, the `<EnableSSOConsentManagement>true</EnableSSOConsentManagement>` element controls this behavior .\\n\\nAdditionally, the `default-identity.xml` file defines `UserConsentEnabledGrantTypes` which specifies the OAuth 2.0 grant types that filter user claims based on user consent in their responses, such as `id_token` or user info response . By default, `authorization_code` and `implicit` grant types are configured for this .\\n\\nThe `AdvancedApplicationConfiguration.java` file, part of the application management API, includes a `useExternalConsentPage` boolean property . Setting this to `true` would allow an external consent page to be used, which could be relevant for a TPP managing its own consent UI.\\n\\n### API Endpoints or Features\\n\\nThe Consent Management API endpoints are defined in `web.xml` . The primary endpoint for consent management is `/api/identity/consent-mgt/v1.0/consents` . This endpoint is secured and allows all HTTP methods .\\n\\nOther related endpoints include:\\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/(.*)` for managing consent receipts .\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes(.*)` for managing purposes .\\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories(.*)` for managing PII categories .\\n*   `/api/identity/consent-mgt/v1.0/consents/purpose-categories(.*)` for managing purpose categories .\\n\\nThe `SelfSignUpConsentTest.java` uses the `CONSNT_ENDPOINT_SUFFIX` constant, which resolves to `/api/identity/consent-mgt/v1.0/consents`, to interact with the consent management API . The `getConsents` method in this test retrieves consents for a given `piiPrincipalId` (username) .\\n\\n### Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, describing its purpose, key components (PII Categories, Purposes, Purpose Categories, Consent Receipts), and how consent is collected and enforced . It also mentions the integration with OAuth2/OIDC for custom scopes and claims .\\n\\nThe \"Integration Tests\" wiki page further details the `SelfSignUpConsentTest` which specifically covers consent collection during self-registration .\\n\\n## Notes\\n\\nThe provided code snippets and wiki pages strongly suggest that `wso2/product-is` supports a Global Consent model. The ability to submit consent requests with only PSU identification (`piiPrincipalId`) and general purposes, without requiring specific account details in the initial consent request, is evident from the `getConsentReqBody` method . The enforcement of consent during token issuance and API responses further reinforces this . The term \"Global Consent\" itself is not explicitly used in the provided snippets, but the functionality described aligns with the concept.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_caa9d689-9210-4c9b-89f0-450af92c0295\\n', 'id': 'lc_e7d8164c-577e-4ebd-8241-a63a6a4fc231'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_753b3c29-e0cd-45f5-8260-a7c5370df0b1'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0106",
      "requirement": {
        "requirement_id": "ATOM_155",
        "requirement_text": "The PSU-IP-Address header SHALL be contained if and only if the request was actively initiated by the PSU",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0106_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to have explicit support for a \"PSU-IP-Address\" header or a mechanism to differentiate requests actively initiated by a PSU (Payment Service User) from other requests based on this header. The provided code snippets do not contain any references to \"PSU-IP-Address\" or related logic.\\n\\nHowever, the `catalina-server.xml.j2` template  shows that WSO2 Identity Server uses a `RemoteIpValve`  which can be configured to extract client IP addresses from request headers. This valve is part of the Tomcat configuration and is used to get the real client IP addresses via request headers.\\n\\n### Implementation Details\\n\\nThe `RemoteIpValve`  is a standard Tomcat valve that can be configured to identify the client\\'s IP address when the server is behind a proxy. It uses properties like `remoteIpHeader` , `protocolHeader` , and `proxiesHeader`  to determine the client\\'s IP. While this valve can extract IP addresses from headers, there\\'s no specific logic in the provided snippets to conditionally include or exclude a \"PSU-IP-Address\" header based on whether the request was PSU-initiated.\\n\\n### Configuration Options\\n\\nThe `RemoteIpValve`  can be enabled and configured within the `catalina-server.xml.j2` template  using the `catalinaValves.remoteIpValve` properties. You can specify `internalProxies`, `remoteIpHeader`, `protocolHeader`, and `trustedProxies` . However, this configuration is for extracting existing IP headers, not for generating or conditionally adding a new header like \"PSU-IP-Address\".\\n\\n### API Endpoints or Features\\n\\nBased on the provided context, there are no specific API endpoints or features that directly address the \"PSU-IP-Address\" header requirement. The \"API Layer\" described in the Architecture wiki page  focuses on administrative and user management APIs, but does not mention any functionality related to this specific header.\\n\\n### Documentation References\\n\\nThe provided wiki page on \"Architecture\"  gives a high-level overview of the system but does not contain any specific documentation regarding the \"PSU-IP-Address\" header or its conditional inclusion.\\n\\n## Notes\\n\\nThe `RemoteIpValve`  is designed to correctly identify the client\\'s IP address when requests pass through proxies. While it can read IP information from headers, it does not inherently provide the logic to determine if a request was \"actively initiated by the PSU\" or to conditionally add a \"PSU-IP-Address\" header. Implementing such a feature would likely require custom development, possibly involving a custom Tomcat Valve or a handler within the WSO2 Identity Server\\'s authentication framework to inspect the request and add the header if the conditions for a PSU-initiated request are met.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b00e61be-831e-463d-8d5d-febbf16954d7\\n', 'id': 'lc_60d771a3-2599-4c4f-9cfc-4a3d7949e880'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0106_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not directly support the automatic inclusion or exclusion of a `PSU-IP-Address` header based on whether a request was actively initiated by a PSU (Payment Service User). The provided code snippets indicate that the system, WSO2 API Manager (API-M), tracks IP addresses for security and analytical purposes, and allows for adding custom headers through policies, but there\\'s no explicit mechanism for automatically managing a `PSU-IP-Address` header as described.  \\n\\n### Implementation Details\\n\\nThe WSO2 API Manager tracks IP addresses for purposes such as detecting suspicious login attempts and deriving geographic information for analytics.   This tracking is done via HTTP requests, HTTP headers, and TCP/IP.  However, this is for internal system use and not directly exposed as a configurable `PSU-IP-Address` header.\\n\\nThe system does provide a mechanism to add custom headers to requests through \"Operation Policies\".  The `addHeader_v2.json` policy specification defines a policy named \"Add Header\" that allows you to add a new header to the request.  This policy can be applied to `request`, `response`, and `fault` flows. \\n\\n### Configuration Options\\n\\nTo implement the `PSU-IP-Address` header requirement, you would likely need to configure a custom policy using the \"Add Header\" operation policy.  This policy requires specifying the `headerName` and `headerValue`. \\n\\nThe `api_product_template.xml` and `prototype_template.xml` files show how properties, including authorization headers, can be set within the Synapse mediation flows.   While these templates demonstrate the ability to manipulate headers, they do not provide an out-of-the-box solution for dynamically adding a `PSU-IP-Address` header based on PSU initiation. You would need to implement custom logic within a mediation sequence to determine if a request is PSU-initiated and then conditionally add the header.\\n\\n### API Endpoints or Features\\n\\nThe WSO2 API Manager itself uses HTTP headers for security purposes, such as protecting accounts from unauthorized access.  The `addHeader` policy is a feature that allows API developers to inject custom headers into API requests or responses. \\n\\n### Documentation References\\n\\nThe `privacy-policy-content.jsp` files in both `all-in-one-apim` and `api-control-plane` modules serve as documentation for how WSO2 API Manager handles personal information, including IP addresses.   These documents explain that IP addresses are collected for security and analytical purposes.  \\n\\nThe `addHeader_v2.json` file itself acts as a specification for the \"Add Header\" policy, detailing its purpose, attributes, and applicability. \\n\\n## Notes\\n\\nThe provided snippets do not contain any direct references to \"PSU\" or \"Payment Service User\", nor do they define a specific `PSU-IP-Address` header. The capability to add custom headers exists, but the logic for determining a \"PSU-initiated request\" and conditionally adding the header would need to be custom-implemented. The `opaPolicy_v1.json` file describes a policy for validating requests based on an OPA policy engine, which could potentially be used to implement custom logic for header manipulation, but it\\'s not directly related to the `PSU-IP-Address` header.  The `self-registration-username-request.jsp` and `self-registration-with-verification.jsp` files are related to user registration and do not provide information about request headers.   Similarly, the `APIRevisionTestCase.java` and `key-manager.sh`/`key-manager.bat` files are related to API revisions and startup scripts, respectively, and are not relevant to the `PSU-IP-Address` header.   \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2ab27803-ecf6-49d5-8d33-fb89fb81be9a\\n', 'id': 'lc_26f6cc8c-6d9d-40a8-b536-550c24d35f3d'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0107",
      "requirement": {
        "requirement_id": "ATOM_049",
        "requirement_text": "The system MUST support payment initiation transaction status 'ACWC' (AcceptedWithChanges) when ASPSP applies changes to payment initiation parameters.",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0107_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_3",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_4",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_5",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support the payment initiation transaction status \\'ACWC\\' (AcceptedWithChanges) based on the provided code snippets. The `payment-initiation-openapi.yaml` defines a set of allowed payment statuses, but \\'ACWC\\' is not among them . The `PaymentService.java` in the demo backend also hardcodes the status to \"AcceptedSettlementCompleted\" .\\n\\n## Implementation Details\\n\\nThe `payment-initiation-openapi.yaml` file, which defines the API specification for Payment Initiation, lists the possible statuses for a payment transaction within the `obWritePaymentResponse5` schema . The `Status` field is an enum that includes:\\n*   `AcceptedCreditSettlementCompleted` \\n*   `AcceptedSettlementCompleted` \\n*   `AcceptedSettlementInProcess` \\n*   `AcceptedWithoutPosting` \\n*   `Pending` \\n*   `Rejected` \\n\\nThe status \\'ACWC\\' (AcceptedWithChanges) is not present in this enumeration .\\n\\nIn the demo backend, the `PaymentService.java` class contains a method `cacheAndGetPaymentResponse` which is responsible for setting the payment status . This method explicitly sets the status to \"AcceptedSettlementCompleted\"  and then updates the `dataObject` with this status . This indicates that the current implementation does not have logic to determine or set an \\'ACWC\\' status.\\n\\n## Configuration Options\\n\\nThe provided configuration files, such as `wso2is-7.0.0-deployment.toml`  and `wso2is-7.1.0-deployment.toml`  , primarily deal with Identity Server configurations, OAuth settings, and extension points. There are no explicit configuration options within these files that would allow for the dynamic setting or recognition of an \\'ACWC\\' payment status. The `financial_services.extensions.endpoint` section allows for external service integrations , which theoretically could be used to implement custom logic for payment status changes, but this would require custom development outside the existing framework.\\n\\n## API Endpoints or Features\\n\\nThe `payment-initiation-openapi.yaml` defines the API endpoints for payment initiation, including `/payment-consents` for creating payment consents and `/payment-consents/{consentId}` for retrieving payment consents  . The responses from these endpoints, specifically `obWritePaymentResponse5` and `obWritePaymentConsentResponse5`, include a `Status` field  . However, as noted, \\'ACWC\\' is not a defined value for this status . There are no specific API features or endpoints that directly support the \\'ACWC\\' status or mechanisms for ASPSP-initiated changes to payment parameters that would result in this status.\\n\\n## Documentation References\\n\\nThe \"Overview\" wiki page mentions that the accelerator supports \"payment initiation\"  and provides API specifications for it . However, it does not contain specific documentation or references regarding the \\'ACWC\\' payment status or how ASPSP-applied changes to payment initiation parameters are handled .\\n\\n## Notes\\n\\nThe `financial-services-accelerator` repository provides a framework for Open Banking, and the `payment-initiation-openapi.yaml` file defines the API contract for payment initiation . The absence of \\'ACWC\\' in the defined `Status` enum suggests that this specific status is not natively supported by the current API definition . To support \\'ACWC\\', modifications to the OpenAPI specification and the backend implementation would be necessary. The `PaymentService.java` is part of a demo backend , and its hardcoded status might not reflect the full capabilities or extensibility of a production system. However, based solely on the provided snippets, \\'ACWC\\' is not directly supported.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_112a1f28-93d3-4a6d-b0c5-d20478212918\\n', 'id': 'lc_a4516df5-8631-4596-ac92-34c378c71a13'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0108",
      "requirement": {
        "requirement_id": "ATOM_075",
        "requirement_text": "The TPP must control session fixation using the state parameter in redirect SCA approach",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0108_1",
          "text": "#Using Sample Resources\n\nFollowing configs can be used in test-config.xml to use sample SSA and keystores for DCR tests.\n\n    <DCR>\n        <SSAPath>Path.To.Directory/ssa.txt</SSAPath>\n        <!-- SSA SoftwareId -->\n        <SoftwareId>jFQuQ4eQbNCMSqdCog21nF</SoftwareId>\n        <!-- SSA Redirect Uri -->\n        <RedirectUri>https://www.google.com/redirects/redirect1</RedirectUri>\n    </DCR>\n\nUse signing.jks in 'signing-keystore' directory as the Application Keystore, and transport.jks in 'transport-keystore'\ndirectory as the Transport Keystore.\n\nSample Keystore information:\n\n- Signing Kid = 7eJ8S_ZgvlYxFAFSghV9xMJROvk\n\n- Signing keystore alias = tpp7-signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - 7x6UrhU-Yj1Aa9Ird03JJCcDurs\n\n- Transport keystore alias = tpp7-transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_2",
          "text": "### Run tests\n\n1. Use a tool and convert the private key (tpp.com.key) to a JWK. Use this JWK to update the value of the **keys** \n   array element in the JSON configuration.\n2. Log in to the test suite.\n3. Select the Open Banking test plan and client authentication type as follows:\n    - Test plan: `FAPI-CIBA-ID1: Authorization server test`\n    - Client Authentication Type `private_key_jwt` or `mtls`\n    - CIBA Mode: `poll`\n    - FAPI Profile: `plain_fapi`\n    - Client Registration Type: `static_client`\n    ![test_configuration](../assets/img/conformance/test-config.png)\n4. Copy the content in the modified JSON configuration file and paste it into the **JSON** tab. ![json_configuration](../assets/img/conformance/json-config.png)\n5. Click **Start Test Plan**.\n6. Run each given test in sequence. ![run_test](../assets/img/conformance/run-test.png)\n7. Refer to <https://openid.net/certification/instructions/> for more information.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_3",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_4",
          "text": "# redirect_endpoint config defines the user's succesfull authorisations redirect endpoint. This page displays the succesful CIBA flow completions.\nredirect_endpoint = \"https://localhost:9446/authenticationendpoint/ciba.jsp\"",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_5",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - 9ZzFFBxSLGEjPZogRAbvFd\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = BkHxeIHKyMKF6SgGwqYzLUvTQfk\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - _wYMMJDl96s6D8p93iO2ApHw1BE\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support session fixation control using the `state` parameter in redirect-based authentication flows, particularly within the context of OAuth 2.0 and OpenID Connect. The `state` parameter is used to maintain state between the authorization request and the callback, helping to mitigate Cross-Site Request Forgery (CSRF) attacks and session fixation. \\n\\n### Implementation Details\\n\\nThe `state` parameter is generated and included in the authorization request, and subsequently validated upon redirect. \\n\\n*   **Generation and Inclusion**: In test cases related to OAuth 2.0 and federated authentication, the `state` parameter is extracted from the `redirectURL` obtained during the initiation of the authentication flow. This `redirectURL` is typically part of the `additionalData` within the `metadata` of an authenticator in the client native authentication response. The extracted `state` is then included as a `NameValuePair` in subsequent requests, such as those for external federation. \\n*   **Validation**: The `state` parameter is validated upon redirect. For instance, in `MockOIDCIdentityProvider.java`, a WireMock stub is configured to expect a `state` query parameter in the `/authorize` endpoint, and it is then echoed back in the `Location` header of the redirect response. This ensures that the client receives the same `state` value it sent, allowing it to verify the integrity of the authentication flow. \\n\\n### Configuration Options\\n\\nWhile explicit configuration options for enabling/disabling the `state` parameter are not directly visible in the provided snippets, its usage is inherent in the OAuth 2.0 and OpenID Connect flows. The `infer.json` file indicates that `sessionDataKey` is a parameter used in authentication endpoint redirects, which is often associated with managing session state. \\n\\n### API Endpoints or Features\\n\\nThe primary API endpoint involved in this process is the OAuth 2.0 authorization endpoint, typically accessed via a redirect. \\n\\n*   **Authorization Endpoint**: The `initiateAuthRequest` method in `OAuth2RestClient.java` constructs the authorization request URL, including parameters like `response_type`, `client_id`, `scope`, and `redirect_uri`. While `state` is not explicitly added in this particular snippet, other test cases demonstrate its inclusion in the `redirectURL` and subsequent requests. \\n*   **Client Native Authentication**: The `validInitClientNativeAuthnResponse` methods in various test files (e.g., `JITUserAssociationTestCase.java`, `FederatedTokenSharingIDPConfigDisabledTestCase.java`, `ApplicationNativeAuthenticationFederationTestCase.java`, `FederatedTokenSharingTestCase.java`) parse the client native authentication JSON response to extract the `redirectURL`, from which the `state` parameter is then obtained. \\n\\n### Documentation References\\n\\nThe wiki page \"SAML and Identity Federation\" provides an overview of SAML and identity federation capabilities. While it doesn\\'t explicitly detail the `state` parameter for session fixation in the context of SCA, it does mention OAuth2 and OpenID Connect as separate topics, where the `state` parameter is commonly used. \\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which demonstrate the usage and validation of the `state` parameter in various authentication flows. The `TestPassiveSTS.java` file includes a test for \"Session Hijacking\" which, while not directly about the `state` parameter, indicates a general concern for session security. The `SAMLSSOTestCase.java` and `ChangeACSUrlTestCase.java` files, while related to SAML, do not explicitly show the use of a `state` parameter for session fixation control in the same manner as the OAuth 2.0 related tests. <cite repo=\"wso2/product-is\" path=\"modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/saml/ChangeACSUrlTestCase.java\"\\n\\nWiki pages you might want to explore:\\n- [SAML and Identity Federation (wso2/product-is)](/wiki/wso2/product-is#3.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_31affcca-831b-43eb-87c9-7f3ca4a03b9e\\n', 'id': 'lc_fb2fbf0f-53eb-41e5-a26b-8b337a13401a'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, `wso2/product-apim`, primarily uses OWASP CSRFGuard for Cross-Site Request Forgery (CSRF) protection, which is a different mechanism than controlling session fixation using a `state` parameter in a redirect-based Strong Customer Authentication (SCA) approach. The snippets indicate a focus on CSRF tokens and session management within the context of CSRF prevention, rather than OpenID Connect or OAuth 2.0 `state` parameter validation for session fixation during redirects.   \\n\\n## Implementation Details\\n\\nThe repository implements CSRF protection using OWASP CSRFGuard. This involves:\\n*   **CSRFGuard Filter**: A filter named `CSRFGuard` is mapped to `/*` in `web.xml.j2` files, indicating it intercepts all requests. \\n*   **Listeners**: `CsrfGuardServletContextListener` and `CsrfGuardHttpSessionListener` are configured to initialize CSRFGuard and generate per-session CSRF tokens. \\n*   **Token Injection**: The `Owasp.CsrfGuard.Carbon.properties` files show configurations for injecting CSRF tokens into HTML forms and potentially into URLs.   However, injection into GET forms and form actions is explicitly disabled to prevent token leakage.  \\n*   **Session Validation**: The `org.owasp.csrfguard.ValidateWhenNoSessionExists` property is set to `true`, meaning CSRF checks occur even if no session exists. \\n*   **Unprotected Methods**: HTTP GET requests are configured as unprotected methods for CSRF validation, as state-changing operations are not expected to be performed via GET. \\n\\n## Configuration Options\\n\\nThe primary configuration file for CSRF protection is `Owasp.CsrfGuard.Carbon.properties`.  Key configuration options include:\\n*   `org.owasp.csrfguard.Enabled`: Enables or disables the CSRFGuard filter. \\n*   `org.owasp.csrfguard.ValidateWhenNoSessionExists`: Determines if CSRF validation occurs when no session is present. \\n*   `org.owasp.csrfguard.UnprotectedMethods`: Specifies HTTP methods that are not protected by CSRFGuard, such as `GET`. \\n*   `org.owasp.csrfguard.Ajax`: Enables or disables support for Ajax requests, including verification of custom headers for CSRF tokens. \\n*   `org.owasp.csrfguard.action.*`: Defines actions to be taken when a CSRF attack is detected, such as logging the event. \\n\\n## API Endpoints or Features\\n\\nThe provided snippets do not directly expose API endpoints or features specifically designed for `state` parameter validation in a redirect SCA approach. The `login.jsp` file contains JavaScript functions like `getParameterByName` which can extract query parameters from a URL,  but there is no explicit code demonstrating its use for validating an OAuth 2.0 `state` parameter to prevent session fixation. The CSRFGuard implementation focuses on traditional CSRF tokens rather than the `state` parameter in OAuth/OpenID Connect flows.\\n\\n## Documentation References\\n\\nThe configuration files themselves contain extensive comments explaining the purpose and usage of various OWASP CSRFGuard properties.   These comments serve as internal documentation for configuring the CSRF protection.\\n\\n## Conclusion\\n\\nWhile the repository has robust CSRF protection using OWASP CSRFGuard, the provided snippets do not show direct support for controlling session fixation using the `state` parameter in a redirect SCA approach. The existing mechanisms are geared towards preventing CSRF attacks through token validation, which is a different security concern. \\n\\n## Notes\\n\\nThe user\\'s query specifically asks about \"session fixation using the state parameter in redirect SCA approach\". The provided code snippets primarily deal with CSRF protection using OWASP CSRFGuard, which uses CSRF tokens, not the `state` parameter for session fixation. While both are security mechanisms, they address different attack vectors. Session fixation with the `state` parameter is typically associated with OAuth 2.0 or OpenID Connect flows, where the `state` parameter is used to maintain state between the authorization request and the callback, and to prevent CSRF attacks. The current codebase\\'s CSRF implementation is more general-purpose and not explicitly tied to `state` parameter validation in redirect-based SCA.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_de2e4835-ba30-424e-af14-880fc2ff77a1\\n', 'id': 'lc_925bf7b6-9f23-4cab-a90c-8ce74e812c9b'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0109",
      "requirement": {
        "requirement_id": "ATOM_078",
        "requirement_text": "The ASPSP must validate Client ID, Redirect URI, and TPP Role in OAuth2 SCA approach",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0109_1",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0109_2",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0109_3",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0109_4",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0109_5",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0110",
      "requirement": {
        "requirement_id": "ATOM_186",
        "requirement_text": "A Signature header must be present when using signHTTP chapter 4",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0110_1",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_2",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_3",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_4",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_5",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of a `Signature` header in HTTP requests, particularly in the context of SAML and DPoP (Demonstrating Proof of Possession) related functionalities. The implementation details involve signing mechanisms for SAML requests and DPoP proofs, which implicitly or explicitly lead to the presence of signature information in HTTP communications.\\n\\n## Implementation Details\\n\\n### DPoP Proof Generation\\nThe `wso2/product-is` repository includes functionality to generate DPoP proofs, which are JSON Web Tokens (JWTs) that are signed by the client\\'s private key. These DPoP proofs are then sent in an `DPoP` header in HTTP requests. The `genarateDPoPProof` method in `OAuth2DPopTestCase.java` is responsible for creating these proofs  . The generated `dpopProof` is then added as a `DPOP_HEADER` to the HTTP request  . While this is a `DPoP` header and not a `Signature` header, it serves a similar purpose of providing proof of possession through a cryptographic signature.\\n\\n### SAML Request Signing\\nFor SAML requests, the `SAML2SSOTestBase.java` class contains methods to build and sign SAML authentication requests. The `addDeflateSignatureToHTTPQueryString` method is used to add a signature to the HTTP query string for SAML Redirect binding . This method calculates a signature based on the HTTP query string and appends it as `&Signature=` parameter . Similarly, the `setSignature` method is used to add a signature to SAML POST requests . These signatures are part of the SAML message itself, which is then transmitted over HTTP.\\n\\n## Configuration Options\\n\\n### DPoP Configuration\\nThe `oidc-metadata.json` file indicates support for various signature algorithms for `tokenEndpointSignatureAlgorithm`  and `requestObjectSignatureAlgorithm` . These configurations are relevant for DPoP as DPoP proofs are signed JWTs.\\n\\n### SAML Signature Configuration\\nFor SAML, the `create-saml-app-with-manual-config.json` file shows configuration options for `responseSigning` including `signingAlgorithm`  and `requestValidation` with `enableSignatureValidation` . The `TestServer.xml` also shows `doValidateSignatureInRequests` and `signingAlgorithmURI` . These settings control how SAML requests and responses are signed and validated.\\n\\n## API Endpoints or Features\\n\\n### DPoP Token Endpoint\\nThe `OAuth2DPopTestCase.java` demonstrates interaction with the `ACCESS_TOKEN_ENDPOINT` where DPoP proofs are sent in the `DPOP_HEADER`  . This indicates that the token endpoint is capable of processing requests with DPoP proofs.\\n\\n### SAML Endpoints\\nThe SAML implementation involves various endpoints for authorization and single logout, where signed SAML messages are exchanged. The `SAML2SSOTestBase.java` shows the construction of redirect URLs with appended signatures for SAML Redirect binding .\\n\\n## Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" mentions DPoP tokens as one of the supported token types, indicating that DPoP is a recognized feature within the system . It also discusses \"Token Binding\" and lists DPoP as a binding type .\\n\\n## Test Criteria Verification\\n\\nThe `OAuth2DPopTestCase.java` contains tests that verify the behavior of DPoP proofs. For instance, `testGetAccessTokenWithAuthorizationCodeUsingParWithDifferentThumbprint` tests a scenario where a DPoP proof is sent, and the system is expected to handle it . The `testGetAccessTokenWithAuthorizationCodeUsingPar` test case also explicitly adds the `DPOP_HEADER` to the request  and asserts that the `token_type` is `DPoP` .\\n\\nFor SAML, `SAMLSSOBySPConfigTestCase.java` includes tests like `validateSAMLResponseSignature` and `validateAssertionSignature` which confirm that SAML responses and assertions are signed and their signatures are validated .\\n\\n## Notes\\n\\nWhile the prompt specifically asks for a \"Signature header\", the codebase primarily uses a `DPoP` header for DPoP proofs and appends signature parameters to the URL for SAML Redirect binding. Both mechanisms serve the purpose of providing cryptographic proof of origin and integrity, which aligns with the spirit of a \"Signature header\". The `DPOP_HEADER` is a standard header for DPoP, and the SAML signature in the query string is part of the SAML 2.0 HTTP Redirect binding specification.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_a9509e0e-2a88-415e-80ef-847e582d5d7a\\n', 'id': 'lc_39d6f313-2198-4325-b72a-35ea029cb8a4'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository supports the inclusion of a `Signature` header when using `signHTTP` functionality, particularly within the context of WebSub subscriptions. The `WebsubSubscriptionConfigurationDTO.java` file defines a `signatureHeader` property, indicating that the system is designed to handle a custom header for sending the signature . The `websub_api_template.xml` files demonstrate how this `signatureHeader` is used for validation in incoming requests and how an `X-Hub-Signature` header is generated for outgoing requests  .\\n\\n## Implementation Details\\n\\nThe core implementation for handling the `Signature` header is found within the WebSub API templates.\\n\\n### Incoming Request Signature Validation\\nWhen an incoming request is received, the system checks for a signature header if security is enabled .\\n1.  A `generated_signature` property is created by concatenating a `$signingAlgorithm` with an HMAC generated from the `$ORIGINAL_PAYLOAD` and a `$secret` using a `$hmacSignatureGenerationAlgorithm` . This is handled by `senthuran16` in commit [95e6cbbb](https://github.com/wso2/product-apim/commit/95e6cbbb) on 2021-02-09.\\n2.  The `received_signature` is extracted from the transport header specified by `$signatureHeader` . This is also handled by `senthuran16` in commit [3df069ae](https://github.com/wso2/product-apim/commit/3df069ae) on 2021-02-09.\\n3.  A filter then compares the `received_signature` with the `generated_signature` . If they do not match, a log entry \"The signature validation failed\" is created, and the message is dropped . This logic is present in `all-in-one-apim/modules/distribution/resources/api_templates/websub_api_template.xml`  , `traffic-manager/modules/distribution/resources/api_templates/websub_api_template.xml` , `api-control-plane/modules/distribution/resources/api_templates/websub_api_template.xml` , and `gateway/modules/distribution/resources/api_templates/websub_api_template.xml`  .\\n\\n### Outgoing Request Signature Generation\\nFor outgoing requests, specifically for WebSub subscribers, an `X-Hub-Signature` header is generated if a `SUBSCRIBER_SECRET` is present . The `X-Hub-Signature` is constructed by concatenating \"sha1=\" with an HMAC generated from the `$ORIGINAL_PAYLOAD` and `$SUBSCRIBER_SECRET` . This is handled by `senthuran16` in commit [050bf78f](https://github.com/wso2/product-apim/commit/050bf78f) on 2021-02-09. This logic is present in `all-in-one-apim/modules/distribution/resources/api_templates/websub_api_template.xml` , `traffic-manager/modules/distribution/resources/api_templates/websub_api_template.xml` , `api-control-plane/modules/distribution/resources/api_templates/websub_api_template.xml` , and `gateway/modules/distribution/resources/api_templates/websub_api_template.xml` .\\n\\n## Configuration Options\\n\\nThe `WebsubSubscriptionConfigurationDTO` class includes properties related to signature handling:\\n*   `signingAlgorithm`: This property represents the algorithm used for signing . This is managed by `Tharindu Dharmarathna` in commit [aaa18674](https://github.com/wso2/product-apim/commit/aaa18674) on 2021-03-01.\\n*   `signatureHeader`: This property specifies the header used to send the signature . This is also managed by `Tharindu Dharmarathna` in commit [aaa18674](https://github.com/wso2/product-apim/commit/aaa18674) on 2021-03-01.\\n\\nThese properties are likely used to configure the behavior of the WebSub API templates, where `$signingAlgorithm` and `$signatureHeader` are placeholders that would be replaced with actual configuration values .\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint for this functionality appears to be `/webhooks_events_receiver_resource` which handles `POST` requests . This endpoint is configured within the `websub_api_template.xml` files across different modules    .\\n\\n## Documentation References\\n\\nWhile explicit documentation references for \"signHTTP chapter 4\" are not directly available in the provided snippets, the XML templates for WebSub APIs (`websub_api_template.xml`) serve as a form of internal documentation for how signature headers are handled . These templates define the flow for validating incoming signatures and generating outgoing `X-Hub-Signature` headers.\\n\\n## Test Criteria\\n\\nTo verify that HTTP requests using `signHTTP` include a `Signature` header, you would need to:\\n1.  Configure a WebSub subscription with security enabled, specifying a `signingAlgorithm` and `signatureHeader` using the `WebsubSubscriptionConfigurationDTO` .\\n2.  Send an HTTP request to the `/webhooks_events_receiver_resource` endpoint with a `Signature` header containing a valid signature generated using the configured algorithm and secret .\\n3.  Observe that the request is processed successfully, indicating that the signature validation passed.\\n4.  For outgoing notifications, ensure that if a `SUBSCRIBER_SECRET` is present, the `X-Hub-Signature` header is included in the outgoing request .\\n\\n## Notes\\n\\nThe term \"signHTTP chapter 4\" is not explicitly found in the provided codebase snippets <cite />. However, the codebase clearly demonstrates support for HTTP request signing, specifically within the context of WebSub, where a `Signature` header is expected for incoming requests and an `X-Hub-Signature` header is generated for outgoing requests  . The `WebsubSubscriptionConfigurationDTO` class provides the necessary configuration points for this functionality . The `FederatedUserJWTTestCase.java` and `BackendJWTUtil.java` files discuss JWT signature verification  , which is a related but distinct concept from the WebSub signature header. Similarly, the various `scenario*-policy.xml` files and `qos_proxy_samples.xml` files refer to WS-Security policies for signing and encryption  , which is also a different security mechanism.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_cd51f2ee-0ebd-4824-9709-5751ff64ea79\\n', 'id': 'lc_62ba32a0-54b2-41bc-bfca-9af84629e103'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0111",
      "requirement": {
        "requirement_id": "ATOM_077",
        "requirement_text": "The ASPSP must validate confirmationCode in transaction authorization confirmation requests",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0111_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_3",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_4",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_5",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the validation of a `confirmationCode` in transaction authorization confirmation requests through its consent management extensions. The validation logic is primarily handled by the `ConsentValidatorServiceExtension` class, which can be configured via the `financial-services.xml` and `wso2is-7.0.0-deployment.toml` files.   \\n\\n## Implementation Details\\n\\nThe core validation mechanism is provided by the `ConsentValidatorServiceExtension` class.  This class is responsible for validating consent-related data, which would include parameters like `confirmationCode` in transaction authorization confirmation requests. \\n\\nThe `financial-services.xml` configuration file specifies `org.wso2.financial.services.accelerator.consent.mgt.extensions.validate.impl.DefaultConsentValidator` as the default validator for consent.  This validator is part of the consent management extensions. \\n\\nThe `wso2is-7.0.0-deployment.toml` file also configures this validator under the `[financial_services.consent.validation]` section. \\n\\n## Configuration Options\\n\\nThe validation of the `confirmationCode` is configured within the `Consent` section of the `financial-services.xml` file.  Specifically, the `<Validation>` element points to the `DefaultConsentValidator`. \\n\\nSimilarly, in `wso2is-7.0.0-deployment.toml`, the `financial_services.consent.validation` section defines the `validator` property, which is set to `org.wso2.financial.services.accelerator.consent.mgt.extensions.validate.impl.DefaultConsentValidator`. \\n\\n## API Endpoints or Features\\n\\nThe `accelerator-extensions-v1.0.0.yaml` file defines an API endpoint `/validate` under the `Consent` tag, which is used for consent enforcement.  This endpoint accepts a JWT in the request body, which would contain the data to be validated, including potentially the `confirmationCode`. \\n\\nThe `funds-confirmation-openapi.yaml` defines API endpoints related to funds confirmations, including `/funds-confirmations` for creating funds confirmations.  The schema `obFundsConfirmation1` for this endpoint includes a `ConsentId` which is a unique identification for the funds confirmation consent resource.  While `confirmationCode` is not explicitly mentioned in this OpenAPI definition, the validation of the `ConsentId` and other related parameters would be handled by the configured consent validators. \\n\\n## Documentation References\\n\\nThe \"WSO2 Extensions\" wiki page provides an overview of the configuration management system, including how `financial-services.xml` is parsed by `FinancialServicesConfigParser` and how it contains financial services-specific configurations, such as consent management settings.   The \"Overview\" wiki page also highlights the consent management functionality as a core component of the accelerator. \\n\\n## Test Criteria\\n\\nThe integration tests in `fs-integration-test-suite` demonstrate validation of various parameters related to authorization and tokens. For example, `AuthorisationCodeGrantAccessTokenTest.groovy` includes tests for invalid authorization codes and already used authorization codes, which are analogous to validating a `confirmationCode`.   The `PARValidationTests.groovy` also contains tests for validating parameters in Pushed Authorization Requests, including cases where `consent-id` is null.  These tests indicate the presence of validation logic for critical parameters in authorization flows.   \\n\\n## Notes\\n\\nThe term `confirmationCode` is not explicitly found in the provided snippets. However, the codebase extensively uses `consentId` and other authorization-related parameters that undergo validation. It is highly probable that `confirmationCode` would be treated as a form of `consentId` or a similar authorization parameter and would be validated by the existing consent validation framework. The `DefaultConsentValidator` is the key component for this validation.  \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [WSO2 Extensions (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_a4972fc1-6734-4655-8177-84ffe67f6f0c\\n', 'id': 'lc_658363f9-3f94-45a7-86ae-052da57e0002'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0112",
      "requirement": {
        "requirement_id": "ATOM_187",
        "requirement_text": "The keyId field in the Signature header must be the serial number of the TPP's certificate included in the TPP-Signature-Certificate header",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0112_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the validation of the `keyId` field in the Signature header against the serial number of a certificate, particularly in the context of OAuth2 and OpenID Connect. The system includes functionalities for handling signed JWTs and managing keystores, which are essential for such validation.\\n\\n## Implementation Details\\n\\nThe `wso2/product-is` repository contains code that demonstrates the handling of signed JSON Web Tokens (JWTs) and the extraction of certificate information. The `OAuth2RequestObjectSignatureValidationTestCase.java`  test case, for instance, builds and validates signed JWTs. Specifically, the `buildSignedJWT` method within this class creates a signed JWT and sets a `keyID` in its header . While this `keyID` is currently a randomly generated UUID, the framework exists to populate it with a specific value like a certificate serial number.\\n\\nThe `Oauth2JWKSEndpointTestCase.java`  demonstrates how public keys are exposed via a JWKS endpoint and how certificate thumbprints (`x5t#S256`) are calculated and validated against the `x5c` (X.509 certificate chain) field . This indicates the system\\'s capability to process and validate certificate-related information.\\n\\nThe `DPoPProofGenerator.java`  class further illustrates the extraction of key thumbprints from DPoP proofs, which are signed JWTs. The `getKeyThumbprintOfKey` method parses a JWK and computes its thumbprint, verifying the signature with the public key . This mechanism could be adapted to extract and compare certificate serial numbers.\\n\\nKey management is handled through classes like `KeyStoreAdminClient.java`  and `ClientSignKeyDataHolder.java` , which interact with keystores to load private keys and certificate chains. The `initServiceProviderKeys` method in `OAuth2RequestObjectSignatureValidationTestCase.java`  loads private keys and X.509 public certificates from PKCS12 keystores, demonstrating the ability to access certificate details.\\n\\n## Configuration Options\\n\\nWhile explicit configuration options for directly mapping the `keyId` to a TPP\\'s certificate serial number in the `Signature` header are not directly visible in the provided snippets, the underlying components for certificate management and JWT processing are present. The system\\'s flexibility in handling JWKS endpoints  and loading certificates from keystores  suggests that such a configuration could be implemented. The `client_configs.py`  file in the `oidc-fapi-conformance-tests` directory shows how JWKS are defined for clients, including `kid` (key ID) and `x5c` (X.509 certificate chain) fields, which are relevant for certificate-based validation.\\n\\n## API Endpoints or Features\\n\\nThe system exposes a JWKS endpoint (`/oauth2/jwks`)  that provides public keys and associated certificate information, including SHA256 thumbprints (`x5t#S256`) . This endpoint is crucial for clients to retrieve the necessary public keys to verify signatures. The `KeystoreMgtRestClient.java`  indicates a REST API for managing certificates within keystores, including importing certificates .\\n\\n## Documentation References\\n\\nThe \"OAuth2 and OpenID Connect\" wiki page <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" /> provides a high-level overview of the OAuth2 and OIDC implementation in WSO2 Identity Server, mentioning ID Tokens and JWKS endpoints. It also highlights FAPI conformance <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" />, which often involves stricter security requirements for certificate-based authentication and signature validation.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which demonstrate the capabilities of the WSO2 Identity Server rather than directly implementing the production logic for `keyId` validation. While the tests show the ability to handle signed JWTs, extract certificate information, and manage keystores, the exact mechanism for enforcing that the `keyId` in the Signature header *must* be the serial number of the TPP\\'s certificate is not explicitly detailed. However, the presence of robust JWT processing, JWKS endpoints, and certificate management features strongly suggests that the necessary building blocks are in place to implement and enforce such a requirement. Further investigation into the core OAuth2/OIDC validation logic would be needed to confirm the precise implementation of this specific validation rule.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2483172c-515b-4dc2-928e-d552a988ff52\\n', 'id': 'lc_ddf3b4bf-a4fe-4a55-9f10-7633366a558d'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0112_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the verification of the `keyId` field in a JWT header against a JWKS endpoint, but not specifically against the serial number of a certificate in a `TPP-Signature-Certificate` header. The provided code snippets indicate support for various security policies related to X.509 tokens and JWT signature verification.  \\n\\n### Implementation Details\\n\\nThe `wso2/product-apim` repository includes test cases that verify JWT signatures and the presence of a `kid` (key ID) claim in the JWT header.  The `BackendJWTUtil.java` file contains a `verifyJWTHeader` method that asserts the presence of the `kid` claim and, if a `jwksKidClaim` is provided, verifies that the `kid` in the JWT header matches it.  This suggests that the system can validate the `keyId` in a JWT header against a known key ID from a JWKS endpoint. \\n\\nSeveral policy XML files, such as `scenario2-policy.xml`, `scenario11-policy.xml`, `scenario15-policy.xml`, `scenario6-policy.xml`, `scenario13-policy.xml`, `scenario10-policy.xml`, `scenario14-policy.xml`, `scenario3-policy.xml`, `scenario4-policy.xml`, `scenario12-policy.xml`, `scenario5-policy.xml`, and `scenario9-policy.xml`, define security policies that include `<sp:MustSupportRefIssuerSerial/>`.   This element indicates that the system must support referencing certificates by their issuer and serial number.  While this is related to certificate serial numbers, it\\'s within the context of WS-Security policies and not directly linked to the `keyId` in a `Signature` header or a `TPP-Signature-Certificate` header as described in the prompt. \\n\\n### Configuration Options\\n\\nThe `WebsubSubscriptionConfigurationDTO.java` file contains fields for `signingAlgorithm` and `signatureHeader`.   The `signatureHeader` field is described as \"The header uses to send the signature\".  This suggests that the system allows configuration of which header carries the signature. However, there is no explicit mention of configuring the `keyId` to be the serial number of a certificate from a `TPP-Signature-Certificate` header. \\n\\n### API Endpoints or Features\\n\\nThe provided snippets do not directly expose API endpoints or features that explicitly link the `keyId` in a `Signature` header to the serial number of a certificate in a `TPP-Signature-Certificate` header. The `URLSafeJWTTestCase.java` tests JWT generation and validation, including the `kid` claim, but this is in the context of JWTs and not the specific `Signature` and `TPP-Signature-Certificate` headers mentioned. \\n\\n### Documentation References\\n\\nNo explicit documentation references were provided in the given codebase context that directly address the specific requirement of matching the `keyId` in the `Signature` header with the serial number from the `TPP-Signature-Certificate` header. <cite />\\n\\n## Notes\\n\\nThe codebase shows strong support for JWT signature verification and the use of `kid` claims within JWTs.  It also indicates support for referencing certificates by issuer and serial number in WS-Security policies.  However, there is no direct evidence in the provided snippets that explicitly implements or configures the `keyId` in a `Signature` header to be the serial number of a certificate from a `TPP-Signature-Certificate` header. The `WebsubSubscriptionConfigurationDTO` mentions a `signatureHeader` but does not detail its content or validation logic. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_15603ec2-ebb1-4d76-8d62-cac69436b0bf\\n', 'id': 'lc_c2d2950e-5a1f-4b0a-8d48-7e4081f95007'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0113",
      "requirement": {
        "requirement_id": "ATOM_110",
        "requirement_text": "The ASPSP SHALL check that the payment-product matches the payment initiation addressed by paymentId",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0113_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_2",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_4",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_5",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, specifically the WSO2 Financial Services Accelerator, supports the validation of payment initiation requests, including checks related to the payment product. The validation logic is primarily handled within the `DefaultConsentManageValidator.java` file . The API endpoints for payment initiation are defined in `payment-initiation-openapi.yaml` .\\n\\n## Implementation Details\\n\\nThe `DefaultConsentManageValidator.java` class contains the static method `validatePaymentRequestPayload(JSONObject request)` which is responsible for validating the payment initiation request payload . This method performs several checks, including validating the `Data` object and the `Initiation` object within the request .\\n\\nA key part of this validation is performed by the `validatePaymentInitiationPayload(JSONObject initiation)` method . This method specifically validates the `LocalInstrument` field within the initiation object . The `LocalInstrument` is checked against a predefined set of valid values using `ConsentManageUtils.validateLocalInstrument()` . If the `LocalInstrument` value is invalid, a `ConsentPayloadValidationResult` indicating a bad request is returned .\\n\\nThe `LocalInstrument` corresponds to the `payment-product` in your query, and its allowed values are defined in the OpenAPI specification for Payment Initiation . These include values like \"UK.OBIE.BACS\", \"UK.OBIE.FPS\", and \"UK.OBIE.SEPACreditTransfer\" .\\n\\n## API Endpoints and Features\\n\\nThe Payment Initiation API defines several endpoints related to payments :\\n*   `/payment-consents`: Used for creating payment consents .\\n*   `/payment-consents/{consentId}`: Used to retrieve specific payment consents .\\n*   `/payment-consents/{consentId}/funds-confirmation`: Used to get funds confirmation for a payment consent .\\n*   `/payments`: Used for creating payments .\\n*   `/payments/{paymentId}`: Used to retrieve specific payment details .\\n\\nThe `paymentId` parameter is used in the `GET /payments/{paymentId}` endpoint to retrieve details of a specific payment . The `obWritePayment2` schema, referenced when creating payments via `POST /payments`, includes an `Initiation` object which contains the `LocalInstrument` field  . This `LocalInstrument` field is where the payment product is specified .\\n\\nThe `PaymentService.java` in the demo backend also exposes a `/paymentservice/payments` endpoint for payment submission . This service processes the incoming request and caches the payment response .\\n\\n## Configuration Options\\n\\nThe validation of the `LocalInstrument` (payment-product) is hardcoded against a list of enumerated values within the OpenAPI specification . There are no explicit configuration options provided in the snippets to modify this list dynamically. However, the system does support external service integration for various extension points, including validation . It is possible that a custom external validation service could be configured to perform more dynamic checks on the payment product, although this is not explicitly shown for the `LocalInstrument` validation in the provided snippets.\\n\\n## Documentation References\\n\\nThe OpenAPI specification for Payment Initiation provides detailed documentation on the API endpoints, request/response schemas, and parameters, including the `LocalInstrument` field    . The wiki page \"Overview\" also mentions that the accelerator implements regulatory standards for consent management and secure API access, supporting payment initiation use cases . The \"External Service Integration\" wiki page describes the framework for extending functionality through external services, which could potentially be used for custom validation logic .\\n\\n## Notes\\n\\nThe provided code snippets indicate that the validation of the `payment-product` (referred to as `LocalInstrument`) is performed during the payment initiation request processing . The `paymentId` is a path parameter used to retrieve an existing payment, not to initiate one . Therefore, the check for `payment-product` matching the `paymentId` as stated in the prompt is not directly applicable in the context of the provided code, as `paymentId` identifies an *existing* payment, while `payment-product` is part of the *initiation* of a new payment. The system validates the `payment-product` during the creation of a payment consent or payment, ensuring it matches the allowed types .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [External Service Integration (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#5)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f17465b0-e190-4f33-897b-f51505391f0f\\n', 'id': 'lc_417e46d5-66ef-4be3-b45c-3cf5751b682c'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0114",
      "requirement": {
        "requirement_id": "ATOM_157",
        "requirement_text": "The Authorization header SHALL be included only if OAuth2 based authentication or SCA was performed",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0114_1",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_2",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_3",
          "text": "### setOauthAppProperties method\nThis method lets you enable OAuth 2.0 properties related to the application. For example, ID token encryption.\n\n``` java\npublic void setOauthAppProperties(boolean isRegulatoryApp, OAuthConsumerAppDTO oauthApplication, Map<String, Object> spMetaData)\nthrows OpenBankingException {\n\n  oauthApplication.setIdTokenEncryptionEnabled(true);\n  oauthApplication.setIdTokenEncryptionAlgorithm(\"RSA-OAEP\");\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_4",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_5",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of the `Authorization` header specifically for OAuth2-based authentication flows. The `Authorization` header is used to carry client credentials (Basic authentication) when requesting access tokens in OAuth2 flows, such as the authorization code grant type.  \\n\\n### Implementation Details\\n\\nThe `Authorization` header is explicitly set in test cases related to OAuth2 token requests. For instance, in the `OAuth2ServiceAuthCodeGrantTestCase`, when obtaining an access token, the `Authorization` header is constructed using `Basic` authentication with the `consumerKey` and `consumerSecret`.  The `getBase64EncodedString` method is used to encode these credentials.  This is further demonstrated in the `OAuth2ServiceResourceOwnerTestCase` and `OAuth2ServiceAuthCodeGrantCacheDisabledTestCase` where the `Authorization` header is set for token requests.  \\n\\nThe `OAuth2Constant.java` file defines the constant `AUTHORIZATION_HEADER` as \"Authorization\" and `BASIC_HEADER` as \"Basic\", which are used in constructing this header.  \\n\\nFor other authentication methods, such as the initial authorization request in the authorization code flow, the `Authorization` header is not explicitly included. Instead, parameters like `client_id` and `response_type` are sent as URL parameters. \\n\\n### Configuration Options\\n\\nThe `backupIdentity.xml` and `identity-identitymgtlistener-enabled.xml` files show configuration for `ClientAuthHandlers` within the `<OAuth>` section.   The `BasicAuthClientAuthHandler` is listed as a supported client authentication method, indicating that the system is configured to process `Authorization: Basic` headers for client authentication.  \\n\\n### API Endpoints or Features\\n\\nThe primary API endpoint where the `Authorization` header is used for OAuth2 client authentication is the token endpoint, specifically `ACCESS_TOKEN_ENDPOINT`.  This is evident from the `HttpPost` requests made to this endpoint in the test cases. \\n\\nThe `Features and Capabilities` wiki page also highlights \"OAuth 2.0 Grant Types\" and \"Advanced OAuth Features\" such as \"JWT Access Tokens\" and \"Token Introspection\", which often involve the use of `Authorization` headers. \\n\\n### Documentation References\\n\\nThe `Features and Capabilities` wiki page provides an overview of the supported authentication protocols, including OAuth 2.0.  While it doesn\\'t explicitly detail the `Authorization` header usage, it confirms the system\\'s adherence to OAuth 2.0 standards, which mandate the use of the `Authorization` header for client authentication in certain flows. \\n\\n## Notes\\n\\nThe provided code snippets are primarily integration tests, which demonstrate the expected behavior of the system. They confirm that the `Authorization` header is indeed included for OAuth2 token requests using Basic authentication. The term \"SCA\" (Strong Customer Authentication) was not explicitly found in the provided context, but OAuth2 flows can be part of SCA implementations. The test criteria for verifying the presence of the `Authorization` header for OAuth2 flows and its absence for other authentication methods is directly supported by the test cases shown.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_8639e6b0-aa7e-4851-a5a5-7ffbc4c0d878\\n', 'id': 'lc_656b004a-8b82-4c4e-9e79-094225f8b2f7'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_f499dd7c-9938-4510-b524-e5f4b9ca9ed3'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0115",
      "requirement": {
        "requirement_id": "ATOM_065",
        "requirement_text": "The system MUST include location header containing link to created resource in payment initiation and consent request responses.",
        "strength": "MUST",
        "capability": "General",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0115_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of a `Location` header containing a link to the created resource in responses for resource creation operations. This is evident in various API endpoints, particularly within the Application Management and Identity Provider Management APIs, as well as other resource creation operations like Claim Management and Organization Management. The `Location` header is consistently checked in integration tests to ensure its presence and correct format.\\n\\n## Implementation Details\\n\\nThe `Location` header is set in HTTP responses when a new resource is successfully created via a `POST` request. The value of this header typically contains the URI of the newly created resource. This pattern is observed across several management APIs within the `wso2/product-is` repository.\\n\\nFor instance, in the Application Management API, when creating a new application, the response includes a `Location` header. The integration test `testCreateApplicationsWithConflictingInboundKeys` in  asserts that the `Location` header is not null after a successful application creation. Similarly, the `Application Management` wiki page explicitly states that \"The response includes a Location header with the ID of the created application\" for application creation .\\n\\nThe Identity Provider Management API also follows this pattern. The `addIdPConflict` test in  verifies the presence of the `Location` header with a non-null value upon successful IdP creation. The `addIdPWithoutAuthenticator` test in  and `addIdPWithDuplicatedOIDCScopes` in  further confirm this behavior for different IdP creation scenarios.\\n\\nOther examples include:\\n*   **Claim Management API**: When adding a local claim, the `testAddLocalClaim` method in  asserts the `Location` header is present and extracts the `localClaimId` from it. Similarly, `testAddExternalClaim` in  does the same for external claims.\\n*   **Organization Management API**: The `testSelfOnboardOrganization` method in  and  verifies the `Location` header after creating an organization.\\n*   **Workflow Management API**: The `testAddWorkflowAssociation` method in  checks for the `Location` header when adding a workflow association.\\n*   **API Resource Management**: The `createAPIResource` method in `APIResourceManagementClient.java`  and `OAuth2RestClient.java`  extracts the ID of the created resource from the `Location` header.\\n\\nThe `Location` header is typically retrieved using `response.getFirstHeader(HttpHeaders.LOCATION)`  or `response.getFirstHeader(OAuth2Constant.HTTP_RESPONSE_HEADER_LOCATION)`  and then asserted to be non-null. The resource ID is then extracted from the header value by parsing the URI string .\\n\\nFor consent requests, specifically in OAuth2 flows, the `Location` header is used for redirection after approval. The `performConsentApproval` method in `OAuthAppsWithSameClientIdTestCase.java`  asserts the presence of the `Location` header and extracts the authorization code from its value. Similarly, `testSendAuthorizationRequestWithPar` in `OAuth2DPopTestCase.java`  also checks for the `Location` header in authorization request responses.\\n\\n## API Endpoints or Features\\n\\nThe `Location` header is a standard HTTP header used in `201 Created` responses to indicate the URI of the newly created resource. This behavior is consistently implemented across various RESTful APIs within the `wso2/product-is` repository for resource creation.\\n\\nKey API endpoints and features where this is observed include:\\n\\n*   **Application Management API**: `POST /applications` for creating new applications .\\n*   **Identity Provider Management API**: `POST /identity-providers` for creating new identity providers .\\n*   **Claim Management API**: `POST /claim-dialects/local/claims` for creating local claims  and `POST /claim-dialects/{dialectId}/claims` for creating external claims .\\n*   **Organization Management API**: `POST /o/server/v1/organizations` for creating new organizations .\\n*   **Workflow Management API**: `POST /workflow-associations` for creating workflow associations .\\n*   **API Resource Management**: `POST /api-resources` for creating API resources .\\n*   **OAuth2 Consent Approval**: Responses to consent approval requests also include a `Location` header for redirection .\\n\\n## Test Criteria\\n\\nThe test criteria for verifying the `Location` header are consistently applied in the integration tests:\\n\\n1.  **Presence of `Location` header**: Assert that `response.getFirstHeader(HttpHeaders.LOCATION)` or `response.getFirstHeader(OAuth2Constant.HTTP_RESPONSE_HEADER_LOCATION)` returns a non-null value .\\n2.  **HTTP Status Code**: Verify that the HTTP status code of the response is `201 Created` for resource creation operations . For consent approval, it\\'s typically a redirection status code (e.g., 302) .\\n3.  **Extraction of Resource ID**: The resource ID is extracted from the `Location` header value, usually by parsing the URI string .\\n\\n## Notes\\n\\nThe provided code snippets are primarily integration tests, which demonstrate that the system is designed and tested to include the `Location` header in resource creation responses. While the snippets don\\'t show the exact server-side code responsible for setting the header, the consistent testing across various APIs strongly indicates that this is a fundamental and implemented feature. The `Server APIs` wiki page also outlines the general architecture and common API patterns, including resource creation, which implies the use of standard HTTP practices like the `Location` header <wiki_page repo_name=\"wso2/product-is\" id=\"4.1\" page_name=\"Server APIs\" />.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_884f2cf0-4314-410a-aaa8-d2c4a4568c1d\\n', 'id': 'lc_aa4273ef-6223-4f8d-ad97-934e585a6062'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0115_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the inclusion of a `Location` header containing a link to the created resource in responses for various resource creation operations. This is evident in the OpenAPI specifications for several APIs, including those for creating APIs, documents, mediation policies, advanced throttling policies, deny policies, and subscriptions.       The system also includes integration tests to verify this behavior. \\n\\n## Implementation Details\\n\\nThe `Location` header is explicitly defined in the OpenAPI specifications for the `201 Created` HTTP response status code.  For example, when creating a new API, the `publisher-api.yaml` file specifies that a `201` response will include a `Location` header with the URL of the newly created resource.  Similar definitions exist for other resource creation endpoints, such as adding a document to an API , adding a custom rule , and creating a subscription .\\n\\nThe `Location` header is also defined in the `openapi.yaml` files for the admin and publisher APIs, indicating its presence across different administrative and publishing functionalities.  \\n\\n## Configuration Options\\n\\nThe OpenAPI specifications define the `Location` header as a string type with a description indicating it holds the URL of the newly created resource.  There are no explicit configuration options mentioned in the provided snippets for enabling or disabling this behavior, suggesting it\\'s a standard part of the API responses for resource creation.\\n\\n## API Endpoints or Features\\n\\nThe `Location` header is included in responses for various resource creation operations across different APIs:\\n\\n*   **API Creation**: When a new API is created using a `POST` request to `/apis`, the `201 Created` response includes a `Location` header with the URL of the new API. \\n*   **Document Addition**: Adding a document to an API via a `POST` request to `/apis/{apiId}/documents` also results in a `201 Created` response with a `Location` header pointing to the new document. \\n*   **Mediation Policy Updates**: While the `Location` header is described as \"The URL of the newly created resource\" in the context of a `200 OK` response for updating a mediation policy, this might be a documentation oversight as `200 OK` typically indicates success of the request, not creation.  However, the `admin-api.yaml` for the common clients correctly associates the `Location` header with a `201 Created` response for mediation policies. \\n*   **Advanced Throttling Policy Creation**: A `POST` request to create an advanced throttling policy returns a `201 Created` response with a `Location` header. \\n*   **Deny Policy Creation**: Similarly, adding a deny policy using a `POST` request results in a `201 Created` response including the `Location` header. \\n*   **Subscription Creation**: Creating a subscription via a `POST` request to `/subscriptions/multiple` also provides a `Location` header in the `201 Created` response. \\n\\n## Documentation References\\n\\nThe OpenAPI specification files themselves serve as documentation for the API endpoints and their expected responses, including the presence and description of the `Location` header.   Additionally, the `ApplicationsApi.md` documentation for the store API explicitly states that a `201 Created` response will include a `Location` header. \\n\\n## Test Criteria Verification\\n\\nThe repository includes integration tests that specifically verify the `Location` header. The `LocationHeaderTestCase.java`  and `RelativeUrlLocationHeaderTestCase.java`  classes contain tests that assert the presence and correctness of the `Location` header in HTTP responses. For instance, `LocationHeaderTestCase.java` checks that the `Location` header does not contain additional slashes and ends with the expected path.  `RelativeUrlLocationHeaderTestCase.java` verifies that the `Location` header contains a specific relative URL.  These tests indicate that the system is designed and tested to include the `Location` header in resource creation responses.\\n\\n## Notes\\n\\nThe user\\'s query specifically mentions \"payment initiation and consent request responses\". While the provided code snippets demonstrate the inclusion of `Location` headers in various resource creation responses within the `wso2/product-apim` repository, there are no direct references to \"payment initiation\" or \"consent request\" APIs. It is possible that these specific functionalities are handled by other parts of the system not included in the provided context, or that the `Location` header behavior is a general pattern applied across all resource creation, including payment and consent-related resources if they involve creation. The examples provided are for creating APIs, documents, policies, and subscriptions.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4ed999af-fdcc-4dbc-810e-d6d1838d7a3d\\n', 'id': 'lc_716bd1ab-d067-4f55-b24b-396560e3de7f'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0116",
      "requirement": {
        "requirement_id": "ATOM_001",
        "requirement_text": "The ASPSP SHALL use TLS version 1.2 or higher for all communication between TPP and ASPSP.",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0116_1",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_2",
          "text": "which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it is required to check whether a given certificate is revoked by its issuer. That can be done through two protocols: ####Certificate Revocation List (CRL) CRL is a list of digital certificates that have been revoked by the issuing CA. ####Online Certificate Status Protocol (OCSP) OCSP is an internet protocol used for obtaining the revocation status of a digital certificate based on the certificate serial number. The OCSP validation is faster compared to the CRL validation. By default, WSO2 Open Banking Accelerator verifies the revocation status of a certificate using the OCSP validation. If the OCSP validation is unsuccessful, the revocation status is verified using the CRL information. The certificate is rejected if none of these protocols is successful or if the required revocation information is not found on the certificate. ###Validate external API consumers This validation allows banks to validate API consumers from the NCAs. This is done by validating the transport layer certificate an API consumer has obtained. ###Role validation According to the [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), API consumers have roles for the services they provide. The API consumer\u2019s role is defined in the API consumer\u2019s transport certificate (QWAC certificate that they obtain from an NCA), which WSO2 Open Banking Accelerator checks in the API and Dynamic Client Registration flows. If the role exists in the transport certificate, WSO2 Open Banking Accelerator allows the API consumer to invoke the API. Following are the roles that an API consumer can have: | Role | Description | |---------|--------- | |Account Information Service Provider|Provides an online service by sharing information on payment accounts held by a payment service user with payment service providers.| |Payment Initiation Services Provider|Provides an online service to initiate a payment order at the request of the payment service user with respect to a payment account held at another payment service provider.| |Card-Based Payment Instrument Issuer|Issues card-based payment instruments that can be used to initiate a payment transaction from a payment account held with another payment service provider.| !!!tip An API consumer can have one or more roles. For example, if an API consumer provides an application to view account information as well as to initiate payments, the roles of the API consumer are **Account Information Service Provider** and **Payment Initiation Services Provider**. ###eIDAS The **electronic IDentification, Authentication and trust Services (eIDAS)** regulation provides unique identity schemas for individuals and businesses to access the publicly available online services in Europe. Among electronic Identification (eID) solutions, PSD2 recommends Qualified Website Authentication Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_3",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_4",
          "text": "Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a secure TLS channel and protect the transport layer communication from potential attackers on the network. WSO2 Open Banking Accelerator validates the following aspects of the QWAC if it is used for an API invocation: - The certificate is qualified, technically correct, and is not expired. - The PSD2 information in the certificate such as PSD2 roles, Authorization Number matches with the API being invoked. - The certificate is not revoked using CRL or Online OCSP validations. ####Qualified e-Seal Certificate (QSealC) QSealC seals application data and sensitive information to ensure that the origin of the document is trusted. WSO2 Open Banking Accelerator allows using QSealC as the signing certificates in application layer security to ensure protecting the data or messages from potential attackers during or after the communication. <hr> Generally, open banking flows always consist of 3 different types of API requests by the client applications. The following section lists the different security measures taken at each of the request types.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_5",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the use of TLS version 1.2 or higher for communication. The configuration for TLS protocols is primarily managed within the Apache Tomcat connector settings, which can be customized through a templating system. You can configure the minimum TLS version and enable or disable specific protocols.\\n\\n## Implementation Details\\nWSO2 Identity Server utilizes Apache Tomcat\\'s connector configuration to manage TLS/SSL settings . The core configuration is defined in the `catalina-server.xml` template file . This system uses a templating engine (Jinja2) to generate the final `catalina-server.xml` file from `default.json` and `infer.json` . The HTTPS connector supports both standard JSSE (Java Secure Socket Extension) and OpenSSL implementations .\\n\\n## Configuration Options\\nThe key configuration property for TLS protocol versions is `transport.https.sslHostConfig.properties.protocols` . In the `catalina-server.xml` file, this is represented by the `sslEnabledProtocols` attribute within the `<Connector>` element .\\n\\nBy default, the configuration includes `+TLSv1,+TLSv1.1,+TLSv1.2` . To enforce TLS 1.2 or higher, you would modify this property to explicitly include only `TLSv1.2` and potentially `TLSv1.3` if supported and desired, and remove `TLSv1` and `TLSv1.1`. The `+` prefix indicates that the protocol should be added to the enabled list .\\n\\nFor example, to enforce TLSv1.2 and higher, you would configure the `sslEnabledProtocols` attribute in the HTTPS connector to `TLSv1.2,TLSv1.3` (assuming TLSv1.3 is also desired and supported by the underlying Java/OpenSSL version) .\\n\\nThe `catalina-server.xml.j2` template dynamically generates the connector configuration based on properties defined in `default.json` .\\n\\n## API Endpoints or Features\\nThe configuration discussed primarily affects the underlying communication layer of the server, specifically the HTTPS connector used by Tomcat . This means all API endpoints and features exposed by the WSO2 Identity Server will adhere to the configured TLS protocols. There are no specific API endpoints or features dedicated solely to configuring TLS versions; rather, it\\'s a server-wide setting.\\n\\nThe system also supports Mutual TLS (mTLS) for client authentication, which can be configured via `tls_client_auth` in application management metadata . This is a security feature that relies on the underlying TLS configuration.\\n\\n## Documentation References\\nThe \"Security Configuration\" wiki page provides an overview of TLS/SSL configuration, keystore management, and security valves . It specifically mentions `transport.https.sslHostConfig.properties.protocols` as controlling enabled TLS protocol versions . The wiki also recommends enabling only TLSv1.2 or higher in production as a best practice .\\n\\n## Notes\\nThe `openssl-tls.sh` script is related to enabling OpenSSL for TLS and post-quantum cryptography support . While it deals with TLS, its primary focus is on enabling advanced cryptographic features rather than directly configuring the minimum TLS version for standard communication. The `deployment.toml` file contains general server configurations, including keystore details, but not specific TLS protocol versions .\\n\\nWiki pages you might want to explore:\\n- [Security Configuration (wso2/product-is)](/wiki/wso2/product-is#5.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3e523b32-d4c7-41ef-a589-71dd8940f12b\\n', 'id': 'lc_cfc80d79-de4a-4506-83a5-96342f315b5c'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_6",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Yes, this repository supports the use of TLS version 1.2 or higher for communication. The configuration files explicitly list TLSv1.2 as an enabled protocol for various transports and listeners.    \\n\\n## Implementation Details\\n\\nThe WSO2 API Manager codebase, specifically within the `wso2/product-apim` repository, configures TLS protocols at several points for both listeners (servers) and senders (clients) across different transport mechanisms.\\n\\n### Passthru HTTPS Transport\\nFor the `passthru_https` transport, both listeners and senders are configured to support `TLSv1`, `TLSv1.1`, and `TLSv1.2`.   This configuration is found in the `default.json` files for `all-in-one-apim`, `api-control-plane`, and `gateway` modules.   \\n\\n### Binary Receiver Transport\\nThe `transport.binary.receiver` also explicitly lists `TLSv1`, `TLSv1.1`, and `TLSv1.2` as enabled protocols.  This applies to the `all-in-one-apim`, `api-control-plane`, and `traffic-manager` modules.   \\n\\n### WebSocket Secure (WSS) Transport\\nFor WebSocket Secure (WSS) communication, the `apim.wss.ssl_enabled_protocols` setting specifies `TLSv1.1,TLSv1.2`.  This is present in the `default.json` files for `all-in-one-apim`, `api-control-plane`, and `gateway` modules.   \\n\\n### Tomcat Connector Configuration\\nThe `catalina-server.xml` files, used for Tomcat configurations in `traffic-manager`, `all-in-one-apim`, and `gateway` modules, include an `sslEnabledProtocols` attribute for the HTTPS connector.   This attribute is commented with \"Added sslEnabledProtocols=\"TLSv1,TLSv1.1,TLSv1.2\" for poodle vulnerability fix\", and the `SSLHostConfig` explicitly sets `protocols=\"+TLSv1,+TLSv1.1,+TLSv1.2\"`.  \\n\\n### Listener Profiles\\nThe `listenerprofiles.xml.j2` template files also reference `HttpsProtocols` using a variable `{{transport.passthru_https.listener.parameters.HttpsProtocols}}`.  This indicates that the TLS protocols for listeners can be configured dynamically. \\n\\n### Testing\\nA test case `APIMANAGER4568TLSTestCase.java` exists to verify the TLS version used when the gateway communicates with the backend.  This test specifically looks for \"ClientHello, TLSv1.2\" in the SSL debug log, asserting that TLSv1.2 is used.  \\n\\n## Configuration Options\\n\\nYou can configure the supported TLS versions by modifying the `default.json` files and `catalina-server.xml` files within the respective product modules.\\n\\n*   **`transport.passthru_https.listener.parameters.HttpsProtocols`**: This property in `default.json` controls the TLS protocols enabled for HTTPS listeners.  To enforce TLSv1.2 or higher, you would set this to `\"TLSv1.2\"`.\\n*   **`transport.passthru_https.sender.parameters.HttpsProtocols`**: Similarly, this property in `default.json` configures the TLS protocols for HTTPS senders.  To enforce TLSv1.2 or higher, you would set this to `\"TLSv1.2\"`.\\n*   **`transport.binary.receiver.sslEnabledProtocols`**: This array in `default.json` specifies the enabled SSL protocols for the binary receiver.  To enforce TLSv1.2 or higher, you would modify this array to include only `\"TLSv1.2\"` (and potentially higher versions if supported).\\n*   **`apim.wss.ssl_enabled_protocols`**: This property in `default.json` defines the enabled SSL protocols for WSS.  To enforce TLSv1.2 or higher, you would set this to `\"TLSv1.2\"`.\\n*   **`catalina-server.xml`**: Within the `<Connector>` element for the HTTPS port (e.g., 9443), the `SSLHostConfig` section contains a `protocols` attribute.  This should be set to `\"+TLSv1.2\"` to explicitly enable only TLSv1.2 and higher, or `\"-TLSv1,-TLSv1.1,+TLSv1.2\"` to disable lower versions.\\n\\n## API Endpoints or Features\\n\\nThe configuration options described above apply to the underlying transport mechanisms used by the WSO2 API Manager. There are no specific API endpoints or features directly exposed for configuring TLS versions at a granular API level. The TLS protocol enforcement is handled at the transport layer for all communications.\\n\\n## Documentation References\\n\\nThe comments in `catalina-server.xml` explicitly mention the addition of `sslEnabledProtocols=\"TLSv1,TLSv1.1,TLSv1.2\"` for \"poodle vulnerability fix\", indicating a historical context for these configurations.  The `default.json` files serve as the primary configuration points for these settings. \\n\\n## Test Criteria Verification\\n\\nTo verify that TLS connections use version 1.2 or higher and reject connections with lower TLS versions, you would:\\n\\n1.  **Configure the system**: Modify the relevant `default.json` and `catalina-server.xml` files to explicitly allow only `TLSv1.2` (or higher) and remove `TLSv1` and `TLSv1.1` from the enabled protocols.\\n2.  **Enable SSL Debugging**: As suggested by the `APIMANAGER4568TLSTestCase.java` test, start the WSO2 API Manager with SSL debugging enabled (e.g., `./wso2server.sh -Djavax.net.debug=ssl:handshake > /tmp/ssl_debug.log`). \\n3.  **Perform a test connection**: Attempt to establish a connection using a client configured to use TLSv1.2. Verify that the connection is successful and that the SSL debug logs show \"ClientHello, TLSv1.2\".  \\n4.  **Attempt a lower TLS connection**: Attempt to establish a connection using a client configured to use TLSv1.0 or TLSv1.1. Verify that these connections are rejected and that the SSL debug logs do not show successful handshakes with these lower TLS versions.\\n\\n## Notes\\n\\nThe configuration files show that TLSv1 and TLSv1.1 are currently enabled by default alongside TLSv1.2.   To strictly enforce TLSv1.2 or higher, these older versions would need to be explicitly removed from the configuration. The `APIMANAGER4568TLSTestCase.java` test case only asserts the presence of TLSv1.2, not the exclusion of lower versions. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ff4dfd9f-381f-4fe3-8cd4-a9108293369f\\n', 'id': 'lc_15145730-c1e6-4d6c-b51a-147bea6cf6c0'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0117",
      "requirement": {
        "requirement_id": "ATOM_113",
        "requirement_text": "The TPP-Redirect-URI header SHALL be mandatory for Redirect SCA Approach when TPP-Redirect-Preferred equals true",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0117_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_2",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_3",
          "text": "### Step 2: Sign in to the Developer Portal as the TPP\n\n1. Now, sign in to the [Developer portal](https://<APIM_HOST>:9443/devportal) as the TPP.\n\n2. Enter the username and the password you entered when signing up as a TPP.\n\n3. Click Continue. Now, you are on the home page of the Developer Portal.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_4",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_5",
          "text": "## How WSO2 Open Banking supports App-to-App redirection [ ![](../assets/img/learn/app-to-app-redirection/app-to-app-redirection-sequence-flow.png) ](../assets/img/learn/app-to-app-redirection/app-to-app-redirection-sequence-flow.png) WSO2 Open Banking supports the App-to-App redirection flow as follows: The API consumer mobile application invokes the `authorize` endpoint, similar to a basic browser-based auth-code/hybrid redirect flow. When the bank\u2019s mobile application is installed in the customer\u2019s device with a deep link connected to this authorize request, the request is handled by the bank\u2019s mobile application instead of the browser. !!! note If the bank\u2019s mobile application is not available in the customer\u2019s device, the customer is taken through a typical browser-based flow. Once the mobile application handles the customer authentication and consent, it obtains a callback URI. This is the URL to the API consumer application. Using deep links, the bank application redirects the customer to the API consumer\u2019s mobile application. Here, similar to the initial scenario, the callback URI is deep linked to the API consumer\u2019s mobile application. Using this, the flow continues from the bank\u2019s mobile application to the API consumer\u2019s mobile application again. In the App-to-App redirection method, the flow should be handled in the bank\u2019s mobile application as follows: 1. The bank\u2019s mobile application is opened using the deep link. 2. The application invokes the `/authorize` endpoint to initiate the authorization flow. The response redirect is sent by an authenticator that is customized to the app-based flow. !!! note You need to configure custom authenticators that address the requirements of both browser-based and app-based redirection flows. For more information, see [Adding Custom Authenticators](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-local-authenticator/#writing-a-custom-local-authenticator). If this is not an error page or application callback redirect, the application can gain the authentication of the bank customer. For example, using biometrics. !!! info Based on the user agent of the auth request in the adaptive authentication script, a mobile app-based flow can be detected. This states which authenticators need to be invoked in each scenario. 3. Once the authentication is provided, a `/commonauth` request has to be made. This is processed by the authenticator mentioned above. In a biometric scenario, since the verification happens in the mobile application, this request should guarantee non-repudiation and client identification. Given below is a sample request, modify the payload according to your requirements: ``` cURL curl -X POST \\ https://<IS_HOST>:9446/commonauth \\ -H 'Content-Type: application/x-www-form-urlencoded' \\ -d 'sessionDataKey=value&username=value&password=value' ``` - It is recommended to have a key pair for the mobile application. So that the response can be included with a signed JWT, which helps to identify the client with guaranteed non-repudiation. 4. Successful authentication prompts a redirection response to the consent page that contains `sessionDataKeyConsent`. This value is extracted and will be used in the next step. 5. The `authorize/retrieve` request has to be sent with the `SessionDataKeyConsent`. This is to retrieve the data that is required to display on the consent page. 6. After the user approves/denies the consent and selects the accounts, a `PATCH authorize/persist` request is made to persist the consent information. 7. Finally, if the persistence is successful, to complete the flow the `/authorize` endpoint is invoked. This results in a redirection to the callback URL of the API",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the concept of redirect URIs in the context of OAuth2 and OpenID Connect flows, but there is no direct evidence or explicit mention of \"TPP-Redirect-URI\" or \"TPP-Redirect-Preferred\" headers within the provided code snippets or wiki pages.  The codebase handles `redirect_uri` parameters in various OAuth2 flows, including authorization code grant and Pushed Authorization Requests (PAR). \\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository implements OAuth2 and OpenID Connect protocols, which inherently involve redirect URIs.  For instance, in the `OAuth2PushedAuthRequestTestCase.java`, the `OAuth2Constant.OAUTH2_REDIRECT_URI` is used as a parameter when sending a Pushed Authorization Request.  Similarly, `OAuth2ServiceAuthCodeGrantTestCase.java` includes `redirect_uri` in authorization requests.  The `OAuthDCRMTestCase.java` demonstrates the registration of `redirect_uris` for a client application. \\n\\n### Configuration Options\\n\\nClient applications can be configured with `redirect_uris`.  The `oidc-fapi-conformance-tests/constants_fapi.py` file shows examples of client application configurations that include `redirect_uris`.  These configurations are used in conformance tests for FAPI. \\n\\n### API Endpoints or Features\\n\\nThe `oauth2/authorize` endpoint is used for authorization requests, which typically include a `redirect_uri`.  The `oauth2/par` endpoint is used for Pushed Authorization Requests, where `redirect_uri` is also a parameter.  The system validates the provided `redirect_uri` against registered ones, as seen in `testSendParWithInvalidRedirectURI` which asserts an \"invalid_request\" error for a mismatch. \\n\\n### Documentation References\\n\\nThe \"OAuth2 and OpenID Connect\" wiki page provides an overview of the OAuth2 and OIDC implementation, including supported grant types and token management.  It mentions that WSO2 Identity Server implements OAuth2 and OpenID Connect as core authentication and authorization protocols.  The \"Testing Framework\" wiki page describes the testing infrastructure, which includes integration tests for OAuth2/OIDC. \\n\\n## Notes\\n\\nThe terms \"TPP-Redirect-URI\" and \"TPP-Redirect-Preferred\" are not explicitly found in the provided codebase snippets or wiki pages. However, the concept of a `redirect_uri` is fundamental to OAuth2 and OpenID Connect, which are extensively supported and tested in this repository. The codebase demonstrates validation of the `redirect_uri` parameter, rejecting requests with invalid or missing values in certain contexts.  It is possible that \"TPP-Redirect-URI\" is a domain-specific term that maps to the standard `redirect_uri` within the context of a specific TPP (Third Party Provider) integration, but this cannot be confirmed from the given information.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Testing Framework (wso2/product-is)](/wiki/wso2/product-is#6)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_7d92c882-76a4-4bc2-a39a-ddee73cf6cd8\\n', 'id': 'lc_7a31c188-4396-493b-a692-d2a99e0ff4e3'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_85dbea1e-eef8-48bb-b928-4b613789ab21'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0118",
      "requirement": {
        "requirement_id": "ATOM_188",
        "requirement_text": "The keyId must be formatted as keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\" where XXX is the certificate serial number in hexadecimal and YYYYYYYYYYYYYYYY is the full Distinguished Name of the Certification Authority",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0118_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the `keyId` format `keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\"` where `XXX` is the certificate serial number in hexadecimal and `YYYYYYYYYYYYYYYY` is the full Distinguished Name of the Certification Authority. The codebase primarily deals with `kid` (Key ID) in the context of JSON Web Key Sets (JWKS) and X.509 certificate thumbprints.     \\n\\n### Implementation Details\\n\\nThe codebase uses `kid` to represent a Key ID within JWKS, which is typically a string identifier for a cryptographic key.  For X.509 certificates, it calculates and uses `x5t#S256` (X.509 certificate SHA-256 thumbprint) as a key identifier.  The `Oauth2JWKSEndpointTestCase.java` file demonstrates how the JWKS endpoint is tested, validating the presence of `kid` and `x5t#S256` in the returned JSON object.   The `getX509CertSHA256Thumbprint` method in this file calculates the SHA-256 thumbprint of an X.509 certificate. \\n\\nThe `SSOAgentX509KeyStoreCredential` class handles X.509 credentials by loading them from a keystore and extracting the public key, private key, and X.509 certificate.  It does not appear to construct a `keyId` in the format you specified. \\n\\n### Configuration Options\\n\\nThe `IdPSuccessTest.java` file shows how an Identity Provider (IdP) can be updated with a JWKS URI or certificates.   The `IdentityProviderPOSTRequest` model includes a `certificate` field which can contain a list of certificates.  However, there are no explicit configuration options for defining a `keyId` in the `SN=XXX,CA=YYYYYYYYYYYYYYYY` format. \\n\\n### API Endpoints or Features\\n\\nThe `KeystoreMgtRestClient` class provides an API endpoint for uploading certificates to the tenant keystore.  This API expects a `CertificateRequest` object, but the format of the `keyId` within this request is not specified to match your requirement. \\n\\nThe `Oauth2JWKSEndpointTestCase` tests the `/oauth2/jwks` endpoint, which returns a JSON Web Key Set.  The `kid` values in the JWKS are typically thumbprints or other identifiers, not the `SN=XXX,CA=YYYYYYYYYYYYYYYY` format.   \\n\\n### Documentation References\\n\\nThe \"Features and Capabilities\" wiki page mentions \"JWKS Endpoint\" as an OpenID Connect feature.  However, it does not provide specific details about the `keyId` format. \\n\\n## Notes\\n\\nThe provided code snippets primarily focus on the use of `kid` for JWKS and `x5t#S256` for X.509 certificate thumbprints. There is no direct evidence in the provided context that the system supports or expects the `keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\"` format. The `saml-metadata-super-tenant.json` file contains a list of Distinguished Names (DNs) for various Certificate Authorities, but these are used as identifiers in a list, not as part of a `keyId` attribute in the specified format. \\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_715778a5-5cfb-469a-bdcc-28adc1535d6e\\n', 'id': 'lc_85248d07-0a95-40d9-8eed-fe6327bdbe25'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0118_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the `keyId` format `keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\"` through its WS-SecurityPolicy configurations.     Specifically, the presence of `<sp:MustSupportRefIssuerSerial/>` within the security policies indicates support for referencing certificates by their issuer and serial number.    \\n\\n## Implementation Details\\n\\nThe support for the specified `keyId` format is implemented through WS-SecurityPolicy assertions in XML policy files.     Specifically, the `<sp:MustSupportRefIssuerSerial/>` element within a `<sp:Wss10>` or `<sp:Wss11>` policy block mandates that the system must support referencing security tokens by their X.509 Issuer Serial.   This directly corresponds to the `SN=XXX,CA=YYYYYYYYYYYYYYYY` format, where `SN` is the serial number and `CA` is the certificate authority\\'s distinguished name. \\n\\nExamples of this implementation can be found in various security policy test resources:\\n*   `scenario11-policy.xml`: Contains `<sp:MustSupportRefIssuerSerial/>` within `<sp:Wss10>`. \\n*   `scenario15-policy.xml`: Includes `<sp:MustSupportRefIssuerSerial/>` within both `<sp:Wss11>` and a nested `<sp:Wss11>` block.  \\n*   `scenario2-policy.xml`: Features `<sp:MustSupportRefIssuerSerial/>` under `<sp:Wss10>`. \\n*   `scenario9-policy.xml`: Contains `<sp:MustSupportRefIssuerSerial/>` within `<sp:Wss10>` and `<sp:Wss11>`.  \\n\\nThese policy files are located in `all-in-one-apim/modules/integration/tests-integration/tests-backend/src/test/resources/security/policies/` and are used for integration testing of security scenarios. \\n\\n## Configuration Options\\n\\nThe configuration for supporting this `keyId` format is primarily done through the WS-SecurityPolicy XML files.  To enable this, you would include the `<sp:MustSupportRefIssuerSerial/>` assertion within the relevant WS-SecurityPolicy for your service. \\n\\n## API Endpoints or Features\\n\\nThe provided snippets do not directly expose API endpoints that explicitly handle the `keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\"` format as an input parameter. <cite/> However, the `ClientCertificatesApi` in `org.wso2.am.integration.clients.publisher.api.v1` deals with client certificates, including operations like `updateAPIClientCertificateByKeyTypeAndAlias` and `getAPIClientCertificateContentByKeyTypeAndAlias`.   These APIs use `alias` and `keyType` to identify certificates, but the specific `keyId` format with serial number and CA Distinguished Name is handled at a lower WS-Security layer, as indicated by the policy files.  \\n\\n## Documentation References\\n\\nThe WS-SecurityPolicy XML files themselves serve as documentation for the supported security mechanisms.  The presence of `<sp:MustSupportRefIssuerSerial/>` is a direct reference to the WS-SecurityPolicy specification regarding how certificates can be referenced. \\n\\n## Notes\\n\\nThe provided code snippets are primarily test resources for security policies.  While they demonstrate the capability to support the specified `keyId` format, they do not show the exact code that parses or validates this format. <cite/> The `ClientCertificatesApi` is a generated client for a publisher API and handles certificate management at a higher level, using `alias` and `keyType` rather than the detailed `keyId` format.  The actual parsing and validation of the `keyId` format would likely occur within the underlying WS-Security implementation of the WSO2 API Manager. <cite/>\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_572c3e18-1752-4767-aa57-a4fdf1046ce2\\n', 'id': 'lc_4ab70055-6c82-4a9b-841a-2b6d942c7b85'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0119",
      "requirement": {
        "requirement_id": "ATOM_112",
        "requirement_text": "The API SHALL return HTTP response code 202 when DELETE requires PSU authorization for payment cancellation",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0119_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_3",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_4",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_5",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports returning an HTTP `202 Accepted` response code when a `DELETE` operation for payment cancellation requires PSU (Payment Services User) authorization. This functionality is primarily handled through an external service integration point during the consent revocation process.  \\n\\n## Implementation Details\\n\\nThe core of this functionality lies within the consent revocation operations, which can be extended to include external pre-revocation processing.  When external pre-revocation is enabled, the system calls an external service.  This external service can then determine if PSU authorization is required for the payment cancellation. \\n\\nThe `DefaultConsentAdminHandler` class coordinates these administrative consent operations, including revocation.  The `PRE_PROCESS_CONSENT_REVOKE` extension point is specifically designed for handling pre-revocation validations.  The external service\\'s response can indicate whether token revocation is required, which implies a need for further authorization. \\n\\nThe `ResponseStatus` enum defines `ACCEPTED` with a status code of `202`.  While the provided OpenAPI specification for `/pre-process-consent-revoke` only explicitly lists `200 OK`, `400 Bad Request`, and `500 Server Error` responses,  the framework\\'s extensibility allows for custom handling and response codes.\\n\\n## Configuration Options\\n\\nThe external service integration for consent revocation is configured through the `PRE_PROCESS_CONSENT_REVOKE` extension type.  This configuration would typically involve defining the external service endpoint, authentication methods, and retry policies within the `financial-services.xml` file.  \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint for pre-processing consent revocation is `/pre-process-consent-revoke`.  This endpoint is a `POST` request that handles pre-consent revocation validations when a TPP (Third Party Provider) calls consent `/DELETE`. \\n\\nFor actual consent revocation, the `AdminApi` provides a `DELETE /admin/revoke` endpoint.  This endpoint is used to revoke consents. \\n\\n## Documentation References\\n\\nThe \"Admin Operations\" wiki page provides an overview of the consent revocation process and its integration with external services.  It details how the `DefaultConsentAdminHandler` and `ExternalAPIConsentAdminUtils` are involved in the revocation flow.  \\n\\nThe `accelerator-extensions-v1.0.0.yaml` file defines the OpenAPI specification for the `/pre-process-consent-revoke` endpoint. \\n\\n## Notes\\n\\nThe provided code snippets and wiki documentation indicate that the system is designed to be extensible, allowing for custom logic to be injected into the consent revocation flow. While a `202 Accepted` response is not explicitly defined in the `accelerator-extensions-v1.0.0.yaml` for the `/pre-process-consent-revoke` endpoint, the presence of the `ACCEPTED` status in the `ResponseStatus` enum  and the external service integration framework suggest that such a response could be returned by a custom external service when PSU authorization is required. The `FSAPIMConnectorTest.groovy` file shows an example of `doConsentRevocation` which performs a `DELETE` request, but it does not explicitly test for a `202` status code in the context of requiring PSU authorization. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Admin Operations (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6066fda5-ab8c-4f01-81f8-a80497398dda\\n', 'id': 'lc_6fd8f31c-cd1c-40f0-b00e-98fe4840314b'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0120",
      "requirement": {
        "requirement_id": "ATOM_035",
        "requirement_text": "The ASPSP SHALL return HTTP response code 200 for successful PUT and GET requests, including repeated requests due to timeout",
        "strength": "SHALL",
        "capability": "Error Handling",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0120_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support returning HTTP 200 for successful PUT and GET requests, including in scenarios that might involve retries due to timeouts. This is primarily demonstrated through its integration tests for various REST APIs. The tests explicitly assert for `HttpStatus.SC_OK` (which is 200) on successful GET and PUT operations.\\n\\n### Implementation Details\\n\\nThe core implementation for making HTTP requests and asserting their status codes is found within the integration tests. The `RESTTestBase.java` class provides utility methods for performing GET and PUT requests. For instance, `getResponseOfGet` methods handle GET requests  and `getResponseOfPutWithNoFilter` and `getResponseOfPut` methods handle PUT requests . These methods use the RestAssured library to construct and send HTTP requests.\\n\\nThe `validateHttpStatusCode` method is used to assert that the response status code matches the expected HTTP status code, which is frequently `HttpStatus.SC_OK` (200) for successful operations .\\n\\nFor example, in `ApplicationManagementPassiveStsSuccessTest.java`, a PUT operation to update Passive STS inbound configurations explicitly asserts for a 200 OK status code . Similarly, GET requests for Passive STS inbound details also assert for a 200 OK status .\\n\\nThe `OAuth2TokenRevocationWithRevokedAccessToken.java` test case also demonstrates this behavior for a token revocation request, where a successful revocation returns a 200 status code .\\n\\nWhile the provided snippets do not explicitly show \"timeout retry scenarios,\" the consistent assertion of HTTP 200 for successful operations implies that the system is designed to return this status code upon successful completion, regardless of whether it\\'s an initial request or a retry. The `MockApplicationServer.java` also configures mock endpoints to return a 200 status for various GET and POST requests, further indicating this expected behavior .\\n\\n### API Endpoints or Features\\n\\nThe repository exposes various REST API endpoints that are tested for successful GET and PUT operations returning HTTP 200. Examples include:\\n\\n*   **Application Management API**: Used for managing applications, including Passive STS configurations.\\n    *   PUT requests to update Passive STS inbound configurations .\\n    *   GET requests to retrieve Passive STS inbound details .\\n*   **Authenticator Management API**: PUT requests are used to update authenticator configurations, and these are expected to return 200 OK for successful updates .\\n*   **Identity Provider (IdP) Management API**: GET requests for retrieving IdP details or lists of IdPs are expected to return 200 OK  .\\n*   **Server Configuration Management API**: GET requests for various server configurations (e.g., authenticators, SAML inbound configs, Passive STS inbound configs) are tested to return 200 OK   . PUT requests to update workflow configurations also expect a 200 OK .\\n*   **SCIM2 API**: PUT requests to update roles are expected to return 200 OK . The `scim2.yaml` Swagger definition also indicates 200 OK for successful GET and PUT operations on Groups  .\\n\\n### Configuration Options\\n\\nThe provided context does not explicitly detail configuration options that directly control the HTTP status code returned for successful PUT and GET requests. The behavior of returning HTTP 200 for successful operations appears to be a fundamental design choice and standard practice for REST APIs within this repository.\\n\\n### Documentation References\\n\\nThe \"Features and Capabilities\" wiki page  and \"OAuth2 and OpenID Connect\" wiki page  provide high-level overviews of the system\\'s capabilities, including support for various protocols and API security. These documents describe the functionality of the APIs but do not delve into specific HTTP status code requirements for successful operations. The expectation of HTTP 200 for success is a standard REST API practice, and the integration tests serve as the primary documentation for this specific behavior.\\n\\n## Notes\\n\\nThe provided code snippets are primarily integration tests, which are excellent indicators of expected system behavior. They consistently assert for `HttpStatus.SC_OK` (200) for successful GET and PUT operations across various API endpoints. While \"timeout retry scenarios\" are not explicitly tested in the provided snippets, the general expectation of a 200 OK for successful completion implies that if a retry eventually succeeds, it would also result in a 200 OK. The `RestBaseClient.java`  shows the underlying HTTP client usage, but the status code handling is primarily within the test assertions.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c43e1277-df29-4c18-ab33-4626fcd0d66e\\n', 'id': 'lc_e406f49d-3c77-4b61-89a1-d369c667e41f'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0120_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, demonstrates support for returning HTTP 200 status codes for successful PUT and GET requests, including scenarios that might involve retries. This is primarily evidenced through integration tests and OpenAPI definitions that explicitly define 200 as the success status for these operations.\\n\\n## Implementation Details\\n\\nThe WSO2 API Manager (APIM) platform, as represented in this repository, uses OpenAPI (formerly Swagger) definitions to specify API behavior, including expected HTTP response codes. For instance, various API definitions explicitly state that successful GET and PUT operations should return a `200 OK` status.\\n\\n### OpenAPI Definitions\\nSeveral OpenAPI definition files within the repository specify `200` as the success status code for both GET and PUT operations.\\nFor example, in the `admin-api.yaml` file, the `put` operation for updating an Application Throttling policy is defined to return a `200` status code upon success . Similarly, the `put` operation for updating an Advanced Throttling Policy also specifies `200` as the success code .\\n\\nThe `publisher/api/openapi.yaml` file also shows that `PUT` operations, such as updating an AsyncAPI definition, are expected to return `200 OK` . The same applies to `GET` requests for environment-specific API properties .\\n\\nA more general example can be found in `CORSApi.yaml`, where both `get` and `put` methods for a generic path (`/*`) are configured to return `200` for successful responses  .\\n\\n### Integration Tests\\nThe repository includes integration tests that verify the expected HTTP status codes.\\nThe `APIMANAGER4533BackendReturningStatusCode200TestCase.java` test case explicitly asserts that a `GET` request to an API invocation URL returns an HTTP status code of `200` . This test simulates a full API lifecycle, from creation and publishing to subscription and invocation, confirming the expected `200` response for successful API calls .\\n\\nTest data files like `APITestCase.txt` and `ApplicationWithCustomAttributesTestCase.txt` also contain assertions for `200` status codes for `GET` and `PUT` operations     . These files are used to define test scenarios and their expected outcomes, reinforcing the requirement for `200` responses on success.\\n\\n## Configuration Options\\n\\nThe OpenAPI definitions serve as a form of configuration, explicitly stating the expected HTTP response codes for various API operations. These definitions are used to generate client SDKs and documentation, ensuring consistency in API behavior.\\n\\n## API Endpoints or Features\\n\\nThe WSO2 API Manager exposes various API endpoints that adhere to this requirement. Examples include:\\n*   **Updating Application Throttling Policies**: The `PUT` operation to `/api/am/admin/v4/throttling/policies/application/{policyId}` is designed to return `200 OK` on successful updates .\\n*   **Updating Advanced Throttling Policies**: Similarly, `PUT` requests to `/api/am/admin/v4/throttling/policies/advanced/{policyId}` also return `200 OK` .\\n*   **Updating AsyncAPI Definitions**: The `PUT` operation for `/apis/{apiId}/asyncapi` in the Publisher API is expected to return `200 OK` .\\n*   **Retrieving Environment Specific API Properties**: `GET` requests to `/apis/{apiId}/environments/{envId}/keys` in the Publisher API return `200 OK` .\\n*   **Updating Applications in the Store**: The `PUT` operation for `/applications/{applicationId}` in the Store API is documented to return `200 OK`  .\\n\\n## Documentation References\\n\\nThe OpenAPI definition files themselves serve as documentation for the API endpoints and their expected responses. For example, `ApplicationsApi.md` explicitly states that `applicationsApplicationIdGet` returns `200 OK`  and `applicationsApplicationIdPut` also returns `200 OK` . Similarly, `ApIsApi.md` documents `200 OK` for successful `apisApiIdAsyncapiPut` and `apisApiIdEnvironmentsEnvIdKeysGet` calls  .\\n\\n## Notes\\n\\nThe provided code snippets primarily focus on the WSO2 API Manager\\'s backend and integration tests. While the requirement mentions \"ASPSP\" (Account Servicing Payment Service Provider), the codebase context does not explicitly refer to ASPSP-specific implementations or Open Banking standards. However, the general principle of returning HTTP 200 for successful PUT and GET requests is consistently applied across the WSO2 API Manager\\'s internal APIs, which would be a foundational behavior for any API exposed through the platform, including those that might serve as an ASPSP. The snippets do not provide specific details on \"timeout retry scenarios\" but the consistent assertion of 200 for successful operations implies that once a request is successfully processed (even after retries), a 200 status is expected.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_51f7ae9a-e97d-4a18-bb31-4b451185d29b\\n', 'id': 'lc_279928ec-4729-41a3-af3e-92b8564160b0'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0121",
      "requirement": {
        "requirement_id": "ATOM_084",
        "requirement_text": "ASPSP SHALL return HTTP status code 201 (Created) when credentials are validated successfully in Start Authorization Response",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0121_1",
          "text": "### postProcessRequest method\n\nThis method handles the requests after API Authentication.\n\n``` java\npublic void postProcessRequest(OBAPIRequestContext obapiRequestContext);\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_2",
          "text": "### preProcessRequest method\n\nThis method handles the requests before API Authentication.\n\n``` java\npublic void preProcessRequest(OBAPIRequestContext obapiRequestContext);\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_3",
          "text": "### setAuthenticators method\nThis method lets you configure authenticators to be invoked during the authorization flow.\n\n``` java\npublic void setAuthenticators (boolean isRegulatoryApp, String tenantDomain, ServiceProvider serviceProvider,\n                               LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\n        throws OpenBankingException {\n\n    if (isRegulatoryApp) {\n\n        List<AuthenticationStep> authSteps = new ArrayList<>();\n\n        //Step 1 - Default basic authentication\n        LocalAuthenticatorConfig localAuthenticatorConfig = new LocalAuthenticatorConfig();\n        LocalAuthenticatorConfig[] localAuthenticatorConfigs = new LocalAuthenticatorConfig[1];\n        AuthenticationStep basicAuthenticationStep = new AuthenticationStep();\n\n        String authenticatorDisplayName = \"<PRIMARY_AUTHENTICATOR_DISPLAY_NAME>\";\n        String authenticatorName = \"<PRIMARY_AUTHENTICATOR_NAME>\";\n\n        localAuthenticatorConfig.setDisplayName(authenticatorDisplayName);\n        localAuthenticatorConfig.setEnabled(true);\n        localAuthenticatorConfig.setName(authenticatorName);\n        localAuthenticatorConfigs[0] = localAuthenticatorConfig;\n\n        basicAuthenticationStep.setStepOrder(1);\n        basicAuthenticationStep.setLocalAuthenticatorConfigs(localAuthenticatorConfigs);\n        basicAuthenticationStep.setAttributeStep(true);\n        basicAuthenticationStep.setSubjectStep(true);\n        //set step 1\n        authSteps.add(basicAuthenticationStep);\n\n         if (logger.isDebugEnabled()) {\n            logger.debug(String.format(\"Authentication step 1 added: %s\", authenticatorName));\n        }\n\n        localAndOutboundAuthenticationConfig.setAuthenticationSteps(authSteps.toArray(\n                    new AuthenticationStep[0]));\n    }\n}\n```\n\n!!! tip\n    You can change the name of the Identity Provider by configuring the following tag in the \n    `<IS_HOME>/repository/conf/deployment.toml` file. For example:\n    ``` xml\n    [open_banking.sca.idp]\n    name = \"SMSAuthentication\"\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_4",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_5",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports returning an HTTP status code `201 (Created)` for successful credential validation, particularly in the context of user and application creation via its REST APIs. This behavior is consistently demonstrated in various integration tests for different API endpoints.\\n\\n### Implementation Details and API Endpoints\\n\\nThe codebase includes several integration tests that verify the `201 Created` status code upon successful resource creation. This indicates that the underlying API implementations are designed to return this status for successful credential validation or resource creation.\\n\\nFor instance, when creating a user via the SCIM2 API, the `SCIM2GroupTestCase.java` test explicitly asserts that the HTTP response status code is `201` after a user is successfully created . The `createUser` method constructs an HTTP POST request to the user creation endpoint and then verifies the status code of the response . Similarly, the `SCIM2RoleTestCase.java` also asserts a `201` status code for successful user creation .\\n\\nThe `SCIM2RestClient.java` further illustrates this by providing an `attemptUserCreation` method that returns the status code and user ID if the creation is successful, specifically checking for `HttpServletResponse.SC_CREATED` (which corresponds to HTTP 201) .\\n\\nBeyond user management, the `201 Created` status is also used for other resource creation operations:\\n*   **Application Management**: The `ApplicationManagementSuccessTest.java` verifies that creating an application results in an HTTP `201` status code . The `ApplicationManagementOAuthSuccessTest.java` also confirms this behavior for OAuth2/OIDC application creation .\\n*   **Identity Provider Management**: The `IdPSuccessTest.java` asserts a `201` status code when a new Identity Provider is successfully added  and .\\n*   **Organization Management**: The `OrganizationManagementSuccessTest.java` confirms that self-onboarding an organization also returns an HTTP `201` status code  and .\\n*   **OIDC Custom Scopes**: The `OIDCCustomScopesLoginTest.java` shows that creating a custom OIDC scope also results in a `201` status code .\\n\\nThe `scim2.yaml` OpenAPI definition for the SCIM2 `/Me` endpoint explicitly documents `201` as the response for successful user creation .\\n\\n### Configuration Options\\n\\nThe provided snippets do not directly expose configuration options related to changing the HTTP status code for successful credential validation. The `201 Created` status appears to be a standard part of the API design for resource creation operations.\\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoints that return `201 Created` upon successful credential validation (in the context of creating a new resource) include:\\n*   `/scim2/Users` for user creation .\\n*   `/scim2/Groups` for group creation .\\n*   `/api/server/v1/applications` for application creation .\\n*   `/api/server/v1/identity-providers` for Identity Provider creation .\\n*   `/api/server/v1/organizations` for organization creation .\\n*   `/api/identity/oauth2/v1.0/oidc-scopes` for OIDC scope creation .\\n\\n### Documentation References\\n\\nThe \"User APIs\" wiki page mentions that User APIs are designed with a RESTful architecture and follow SCIM 2.0 standards where applicable . It also states that User APIs implement standardized error handling, returning appropriate HTTP status codes . The \"Server APIs\" wiki page similarly describes Server APIs as RESTful interfaces that use JSON and follow REST principles . The `scim2.yaml` file explicitly defines the `201` status code for the `POST /Me` endpoint, indicating successful user creation .\\n\\n## Notes\\n\\nThe user\\'s query specifically mentions \"Start Authorization Response\" and \"ASPSP\". While the codebase demonstrates the use of HTTP `201 (Created)` for successful resource creation and credential validation in general, there is no direct evidence within the provided snippets that explicitly links this behavior to an \"ASPSP\" (Account Servicing Payment Service Provider) or a \"Start Authorization Response\" in the context of Open Banking or PSD2. The examples primarily relate to internal user, group, application, and organization management within the WSO2 Identity Server. However, the consistent use of `201 Created` for successful resource creation, including user accounts (which involve credential validation), aligns with the general principle of the requirement.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n- [User APIs (wso2/product-is)](/wiki/wso2/product-is#4.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_ceb4c029-1762-42c9-a819-4c2736f50f5d\\n', 'id': 'lc_484011ae-d0bd-4385-937f-7bcee2501075'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_a4fe02fb-d75a-4a33-be5f-c0bd7a1a2f1d'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0122",
      "requirement": {
        "requirement_id": "ATOM_189",
        "requirement_text": "The Algorithm parameter in the Signature header is mandatory",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0122_1",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0122_2",
          "text": "## Inbuilt Gateway Enforcements\n\n- [Dynamic Client Registration Request Policy](../learn/dcr-request-policy.md)\n- [Dynamic Client Registration Response Policy](../learn/dcr-response-policy.md)\n- [Consent Enforcement Policy](../learn/consent-enforcement-policy.md)\n- [Dynamic Endpoint Policy](../learn/dynamic-endpoint-policy.md)\n- [MTLS Enforcement Policy](../learn/mtls-enforcement-policy.md)\n- [UK JWS Header Processing Policy](../learn/uk-jws-header-processing-policy.md)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0122_3",
          "text": "## OBIdentityFilterValidator  \n   \nTo perform validations at the filter level use the following class:\n\n``` java\ncom.wso2.openbanking.accelerator.identity.token.validators.OBIdentityFilterValidator\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0122_4",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the \"Algorithm\" parameter in the Signature header for various cryptographic operations related to OAuth2 and OpenID Connect tokens. Specifically, it allows configuration of signing algorithms for ID Tokens, Request Objects, and token endpoint authentication.\\n\\n## Implementation Details\\n\\nThe system uses various signing algorithms for different components. For instance, the `DPoPProofGenerator.java`  class handles DPoP (Demonstrating Proof of Possession) proof generation and verification, which involves signing with algorithms like `ES256` and `RS384` . The `getThumbprintOfKeyFromDpopProof` method in this class extracts the JWK from the DPoP proof and verifies its signature using the appropriate verifier based on the key type (EC or RSA) .\\n\\nFor ID Tokens, the `OAuth2IDTokenEncryptionTestCase.java`  demonstrates how encryption algorithms and methods are asserted in the ID Token header. While this specific test focuses on encryption, the underlying mechanism for handling algorithms in headers is similar for signatures.\\n\\n## Configuration Options\\n\\nThe `oidc-metadata.json`  file, which defines metadata for OIDC applications, explicitly lists various signature algorithms that can be configured:\\n\\n*   **`tokenEndpointSignatureAlgorithm`**: This property specifies the allowed signature algorithms for the token endpoint. Options include `PS256`, `ES256`, `ES384`, `RS384`, and `SHA256withRSA` .\\n*   **`idTokenSignatureAlgorithm`**: This defines the signature algorithms for ID Tokens, with options like `PS256`, `ES256`, and `SHA256withRSA` .\\n*   **`requestObjectSignatureAlgorithm`**: This specifies the signature algorithms for Request Objects, offering `PS256`, `ES256`, and `SHA256withRSA` .\\n\\nThese configuration options are managed through the `OIDCMetaData` class , which includes fields for `tokenEndpointSignatureAlgorithm`, `idTokenSignatureAlgorithm`, and `requestObjectSignatureAlgorithm` . The `sort` method in `OIDCMetaData` also explicitly sorts the options for these signature algorithms .\\n\\nThe `default-identity.xml`  and `saml-assertion-query-enabled-identity.xml`  files also show `SignatureAlgorithm` configurations for `AuthorizationContextTokenGeneration` and `OpenIDConnect` sections, typically set to `SHA256withRSA`  .\\n\\n## API Endpoints or Features\\n\\nThe `ApplicationManagementOAuthFailureTest.java`  includes tests for scenarios where an OIDC application is created with an invalid signature algorithm for both ID Tokens and Request Objects . This indicates that the system validates the `Algorithm` parameter in the Signature header during application creation. The `create-oauth-app-with-invalid-request-object-signing-algorithm.json`  and `create-oauth-app-with-invalid-id-token-signing-algorithm.json`  files are used in these tests to simulate invalid configurations, confirming that the `requestObjectSigningAlg` and `idTokenSignedResponseAlg` parameters are expected and validated.\\n\\n## Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\"  provides a high-level overview of the OAuth2 and OpenID Connect implementation in WSO2 Identity Server, mentioning ID Tokens and their configurable signing algorithms . It also references the `oidc-metadata.json`  file, which contains the detailed configuration options for signature algorithms.\\n\\n## Test Criteria\\n\\nThe presence of tests like `testCreateOAuthApplicationsWithInvalidIdTokenSigningAlgorithm`  and `testCreateOAuthApplicationsWithInvalidRequestObjectSigningAlgorithm`  in `ApplicationManagementOAuthFailureTest.java`  confirms that the system validates the `Algorithm` parameter. These tests specifically check for `BAD_REQUEST` responses when an unsupported or invalid algorithm is provided, indicating that the `Algorithm` parameter is mandatory and must conform to a set of supported values.\\n\\n## Notes\\n\\nThe term \"Signature header\" in the prompt is interpreted broadly to include the `alg` (algorithm) parameter within JWT headers, which are commonly used for signatures in OAuth2 and OpenID Connect contexts (e.g., ID Tokens, Request Objects, DPoP proofs). The codebase primarily deals with JWT-based signatures where the algorithm is specified within the JWT header itself, rather than a generic HTTP \"Signature\" header.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_aea01a1c-8b00-47af-8e7c-a58c70f516d2\\n', 'id': 'lc_895ce520-3cfa-4f3e-86f0-3cf5ce294bd4'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0122_5",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the inclusion of an `Algorithm` parameter in the `Signature` header, particularly in the context of WebSub subscriptions and JWT generation. The `signingAlgorithm` property within `WebsubSubscriptionConfigurationDTO` suggests that an algorithm can be specified for WebSub signatures. Additionally, the `api-manager.xml` configuration files indicate that a `SignatureAlgorithm` can be configured for JWTs, with options like \"SHA256withRSA\" or \"NONE\".\\n\\n### Implementation Details\\n\\nFor WebSub subscriptions, the `WebsubSubscriptionConfigurationDTO` class includes a `signingAlgorithm` field, which is used to specify the algorithm for signing. This field is serialized as \"signingAlgorithm\" . The `websub_api_template.xml` shows how a signature, specifically `X-Hub-Signature`, is generated using `hmac-generate` with a `SUBSCRIBER_SECRET` . While this snippet explicitly shows `sha1=`, the presence of `signingAlgorithm` in the DTO suggests that the algorithm could be configurable.\\n\\nFor JWTs, the `APIMTestCaseUtils.java` file contains a method `isJwtSignatureValid` that extracts the `alg` parameter from the JWT header to determine the signature algorithm . This method then maps common JWT algorithm names like \"RS256\" to Java Security API algorithm names like \"SHA256withRSA\" .\\n\\n### Configuration Options\\n\\nThe `api-manager.xml` configuration files, such as `all-in-one-apim/modules/integration/tests-integration/tests-config/src/test/resources/artifacts/AM/fullConfigurations/scenario1/expected/repository/conf/api-manager.xml`, include a `JWTConfiguration` section where the `SignatureAlgorithm` can be specified . The comment indicates that it accepts \"SHA256withRSA\" or \"NONE\" to disable signing . This directly addresses the \"Algorithm parameter in the Signature header is mandatory\" requirement for JWTs, as it allows explicit configuration of the algorithm.\\n\\n### API Endpoints or Features\\n\\nThe `WebsubSubscriptionConfigurationDTO` is part of the publisher API\\'s DTOs, suggesting that the `signingAlgorithm` and `signatureHeader` properties are exposed through an API for configuring WebSub subscriptions . This implies that when creating or updating a WebSub subscription, you can specify the desired signing algorithm and the header to be used for the signature.\\n\\n### Documentation References\\n\\nThe XML configuration files themselves serve as a form of documentation, with comments explaining the purpose and accepted values for the `SignatureAlgorithm` parameter within the `JWTConfiguration` . For WebSub, the `ApiModelProperty` annotations in `WebsubSubscriptionConfigurationDTO` provide inline documentation for the `signingAlgorithm` field, stating \"The algorithm used for signing\" .\\n\\n## Notes\\n\\nThe provided snippets indicate support for specifying an algorithm for both WebSub signatures and JWTs. For JWTs, the `SignatureAlgorithm` parameter in `api-manager.xml` directly controls this. For WebSub, the `signingAlgorithm` in `WebsubSubscriptionConfigurationDTO` suggests configurability, although the `websub_api_template.xml` currently shows a hardcoded `sha1=` prefix for the `X-Hub-Signature` header. Further investigation would be needed to confirm if the `signingAlgorithm` from the DTO dynamically influences the actual algorithm used in the `hmac-generate` function or if it\\'s primarily for informational purposes or future extensibility. The `APIMTestCaseUtils.java` file demonstrates how different JWT algorithms are recognized and handled during signature validation.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_eb5549af-3f53-4c8e-8e72-bd57b310e4a9\\n', 'id': 'lc_da74a76e-70ca-4732-8b11-ce914ce79122'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0123",
      "requirement": {
        "requirement_id": "ATOM_083",
        "requirement_text": "TPP MUST provide PSU credentials (User-ID and Password) in the Start Authorization Request body for embedded SCA approach",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0123_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0123_2",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0123_3",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0123_4",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0123_5",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0124",
      "requirement": {
        "requirement_id": "ATOM_072",
        "requirement_text": "ASPSPs SHALL validate eIDAS certificate, request syntax, TPP role, and semantics during payment initiation",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "648825991d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0124_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support aspects of eIDAS certificate validation and TPP role authorization, particularly within the context of Financial-grade API (FAPI) and OAuth 2.0/OpenID Connect flows. The codebase includes features for validating X.509 certificates and their thumbprints, which are crucial for eIDAS certificate validation. It also defines an `AuthorizationDetailsType` that includes a `payment_initiation` type, suggesting support for payment initiation semantics.\\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository demonstrates certificate validation through the `Oauth2JWKSEndpointTestCase.java` file . This test case retrieves public key sets from JWKS endpoints and validates the `x5c` (X.509 certificate chain) and `x5t#S256` (X.509 certificate SHA-256 thumbprint) values . Specifically, the `getX509CertSHA256Thumbprint` method  parses an X.509 certificate and computes its SHA-256 thumbprint, which is then compared against the `x5t#S256` value from the JWKS endpoint . This mechanism is directly relevant to validating eIDAS certificates.\\n\\nIn a related context, the `resource-server.py` file within the `oidc-fapi-conformance-tests` directory  further illustrates certificate-bound access token validation. This Python script, part of FAPI conformance tests, validates that the SHA256 thumbprint from the client certificate (`X-Ssl-Cert` header) matches the `x5t#S256` claim in the access token\\'s `cnf` (confirmation) parameter . This demonstrates a strong binding between the client certificate and the access token, which is a key aspect of eIDAS and PSD2 compliance for TPPs. The `computeSHA256Thumbprint` function  in this script calculates the SHA256 thumbprint from a client certificate.\\n\\nThe `AuthorizationDetailsType.java` file defines a model for authorization details, including a `type` field that can be set to `payment_initiation` . This suggests that the system is designed to handle specific authorization types related to payment initiation, which would involve semantic validation.\\n\\n### Configuration Options\\n\\nThe `identity-ssoservice-entityid-changed.xml` , `backupIdentity.xml` , and `identity-default.xml`  configuration files show a `<TokenValidationPolicy>CertValidate</TokenValidationPolicy>` setting. This indicates a configurable option to enable certificate validation for tokens, which is essential for eIDAS certificate validation.\\n\\n### API Endpoints or Features\\n\\nThe `Features and Capabilities` wiki page mentions \"Financial-grade API (FAPI) Support\"  and \"OAuth 2.0 for API Security\" . FAPI is a set of profiles that add security and interoperability to OAuth 2.0 for financial services, often relying on strong authentication mechanisms like client certificates and DPoP (Demonstrating Proof of Possession). The presence of FAPI support implies the capability to validate eIDAS certificates and TPP roles.\\n\\nThe `Oauth2JWKSEndpointTestCase.java` file tests the `/oauth2/jwks` endpoint , which provides public keys in JWKS format. These keys are used for validating signatures and certificates, including those from eIDAS.\\n\\nThe `resource-server.py` script also interacts with an introspection endpoint (`https://localhost:9443/oauth2/introspect`)  to validate access tokens and retrieve confirmation data (`cnf`) , which can contain certificate thumbprints.\\n\\n### Documentation References\\n\\nThe `Features and Capabilities` wiki page provides a high-level overview of the system\\'s capabilities, including \"OAuth 2.0 and OpenID Connect\"  and \"API Security\" . It specifically mentions \"Financial-grade API (FAPI) Support\"  and \"DPoP (Demonstrating Proof of Possession)\" , which are relevant to the validation of eIDAS certificates and TPP roles in payment initiation.\\n\\n## Notes\\n\\nThe provided snippets primarily focus on the technical aspects of certificate validation and FAPI conformance. While the presence of `payment_initiation` as an `AuthorizationDetailsType`  suggests support for payment-specific semantics, the exact implementation details for TPP role validation and comprehensive semantic compliance beyond certificate binding are not explicitly detailed in the provided context. The `SAMLSSOBySPConfigTestCase.java` file  shows SAML response and assertion signature validation, which is a form of certificate validation but not directly tied to eIDAS in the provided context.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_77d3f07b-d96f-410e-8a3e-2be3b3648a25\\n', 'id': 'lc_fb7c11ca-c519-4288-85e7-7e73b2ba99d8'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0124_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, `wso2/product-apim`, appears to offer functionalities related to managing client and endpoint certificates, but there is no direct evidence or explicit mention of support for eIDAS certificate validation, TPP role authorization, or semantic compliance during payment initiation.  The snippets primarily focus on the lifecycle management of generic client and endpoint certificates, such as uploading, deleting, retrieving information, and updating them. \\n\\n### Implementation Details\\n\\nThe `ClientCertificatesApi.java` and `EndpointCertificatesApi.java` files define methods for managing certificates.  These APIs allow for operations such as:\\n\\n*   **Uploading Certificates**:\\n    *   `addAPIClientCertificate`  and `addAPIClientCertificateOfGivenKeyType`  in `ClientCertificatesApi` for API-related client certificates.\\n    *   `addEndpointCertificate`  in `EndpointCertificatesApi` for endpoint certificates.\\n*   **Retrieving Certificate Information**:\\n    *   `getAPIClientCertificateByAlias`  and `getAPIClientCertificateByKeyTypeAndAlias`  for client certificates.\\n    *   `getEndpointCertificateByAlias`  for endpoint certificates.\\n*   **Downloading Certificates**:\\n    *   `getAPIClientCertificateContentByAlias`  for client certificates.\\n    *   `getEndpointCertificateContentByAlias`  for endpoint certificates.\\n*   **Updating Certificates**:\\n    *   `updateAPIClientCertificateByAlias`  and `updateAPIClientCertificateByKeyTypeAndAlias`  for client certificates.\\n    *   `updateEndpointCertificateByAliasAsync`  for endpoint certificates.\\n\\nThese operations handle the storage and retrieval of certificate files, but the code snippets do not detail any specific validation logic for eIDAS certificates, TPP roles, or payment initiation semantics. \\n\\nThe `validate.xml` files  describe a generic XML schema validation mediator, which can be used for syntax validation against an XSD schema. However, this is a general-purpose XML validation feature and does not specifically mention eIDAS, TPP roles, or payment initiation. \\n\\n### Configuration Options\\n\\nThe certificate management APIs require parameters such as `apiId`, `alias`, `certificate` (the file itself), `keyType`, and `tier` or `endpoint`.  These parameters configure how the certificates are stored and associated within the system. There are no explicit configuration options for eIDAS-specific validation rules or TPP role mappings visible in the provided snippets. \\n\\nThe `validate` mediator documentation mentions a `synapse.schema.resolver` property that can be configured in `synapse.properties` for resolving imported schemas.  This is a general configuration for XML schema validation. \\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoints are exposed through the `ClientCertificatesApi` and `EndpointCertificatesApi` classes.  These include:\\n\\n*   `/client-certificates` for managing client certificates. \\n*   `/endpoint-certificates` for managing endpoint certificates. \\n\\nThe `validate` mediator is a feature that can be applied to API flows for XML schema validation. \\n\\n### Documentation References\\n\\nThe provided documentation snippets are for the `ClientCertificatesApi`  and `EndpointCertificatesApi`  APIs, detailing their operations, parameters, return types, and HTTP response codes.  Additionally, there is documentation for a generic `validate` mediator, explaining its features and providing an example of its usage for XML schema validation. \\n\\nThere is no specific documentation within the provided context that addresses eIDAS certificate validation, TPP role authorization, or semantic compliance for payment initiation. \\n\\n## Notes\\n\\nThe provided code snippets are primarily related to the management of client and endpoint certificates within the WSO2 API Manager. While certificate management is a prerequisite for eIDAS validation, the snippets do not contain any logic or explicit references to eIDAS-specific validation, TPP role checking, or payment initiation semantics. The `validate` mediator is a general XML schema validation tool and not tailored for the specific requirements of eIDAS or payment initiation. Therefore, based solely on the provided context, it is not possible to confirm if this repository supports the detailed requirements for ASPSPs validating eIDAS certificates, request syntax, TPP role, and semantics during payment initiation.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_eec6c44d-612f-4ff3-9de7-002861464275\\n', 'id': 'lc_b9f00ecf-15e1-43c1-919f-d3db9990701d'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0125",
      "requirement": {
        "requirement_id": "ATOM_160",
        "requirement_text": "The Read Card Account List endpoint SHALL be accessible via GET /v1/card-accounts",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0125_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_3",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_4",
          "text": "### Retrieve a consent \n- An API consumer can retrieve a consent resource that they have created to check its status. In order to make this request, \nthe API consumer must have an access token issued by the bank using the client credentials grant.\n\n??? tip \"Click here to find how to generate an application access token...\"\n    - Generate an application access token using the following command: \n      ```\n      curl -X POST \\\n      https://<IS_HOST>:9446/oauth2/token \\\n      --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n      -d 'grant_type=client_credentials&scope=accounts%20openid&client_assertion=eyJraWQiOiJEd01LZFdNbWo3UFdpbnZvcWZReVhWe\n      nlaNlEiLCJhbGciOiJQUzI1NiJ9.eyJzdWIiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OT\n      Q0Ni9vYXV0aDIvdG9rZW4iLCJpc3MiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiZXhwIjoxNjg0MDk5ODEyLCJpYXQiOjE2ODQwOTk4\n      MTMsImp0aSI6IjE2ODQwOTk4MTIifQ.EMZ2q3jciJ4MmrsH93kH_VGacrt2izbLaCBchGWiyUltdWwj3GwDMKfhpeMHtThd0DszwV8LUPKZaMT3wUS\n      oH3adY2IBC8aa2GKeb_vaQB5b0ZO6WpYQ45y_xIttAVj56d6oPli8wN4MlJoJsFPUlaxQohCLunN43BxSr-kFgeFMj7ynEsVbQvuYuEiTppwTSyXlt\n      Jmv70-nwpGU9UyuPCkXUsU53ShICrY0nC-3NUhY6oNpZclJP4MwG8mP4ZOvUIez_PSoP3AiaNithWhPCfLuKd68OLAReTBGdItqidsWWnn8lPVbM2F\n      LvehukHDCJhf9-ev1pdWIiwDSVDV7uQ&redirect_uri=www.wso2.com'\n      ```\n      - The request payload contains a client assertion in the following format:\n      ```\n      {\n      \"alg\": \"<<The algorithm used for signing>>\",\n      \"kid\": \"<<The KID value of the signing jwk set>>\",\n      \"typ\": \"JWT\"\n      }\n        \n      {\n      \"iss\": \"<<This is the issuer of the token. For example, client ID of your application>>\",\n      \"sub\": \"<<This is the subject identifier of the issuer. For example, client ID of your application>>\",\n      \"exp\": <<This is epoch time of the token expiration date/time>>,\n      \"iat\": <<This is epoch time of the token issuance date/time>>,\n      \"jti\": \"<<This is an incremental unique value>>\",\n      \"aud\": \"<<This is the audience that the ID token is intended for. For example, https://<APIM_HOST>:8243/token>>\"\n      }\n        \n      <signature: For DCR, the client assertion is signed by the private key of the signing certificate. Otherwise the private\n      signature of the application certificate is used.>\n      ```\n      - Upon successful token generation, you obtain a token as follows:\n      ```\n      {\n         \"access_token\":\"aa8ce78b-d81e-3385-81b1-a9fdd1e71daf\",\n         \"scope\":\"accounts payments  openid\",\n         \"id_token\":\"eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5HWXdZbU00WlRBM01XSTJOREF6WkdRek5HTTBaR1JsTmpKa09ERmtaRFJpT1RGa01XRmhNelUyWkdWbE5nX1JTMjU2IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiaHVBcS1GbzB0N2pFZmtiZ1A4TkJwdyIsImF1ZCI6WyJrYkxuSkpfdVFMMlllNjh1YUNSYlBJSk9SNFVhIiwiaHR0cDpcL1wvb3JnLndzbzIuYXBpbWd0XC9nYXRld2F5Il0sInN1YiI6ImFkbWluQHdzbzIuY29tQGNhcmJvbi5zdXBlciIsIm5iZiI6MTYwMTk5MzA5OCwiYXpwIjoia2JMbkpKX3VRTDJZZTY4dWFDUmJQSUpPUjRVYSIsImFtciI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwic2NvcGUiOlsiYW1fYXBwbGljYXRpb25fc2NvcGUiLCJvcGVuaWQiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo4MjQzXC90b2tlbiIsImV4cCI6MTYwMTk5NjY5OCwiaWF0IjoxNjAxOTkzMDk4fQ.cGdQ-9qK5JvKW32lK_PqhyJZyRb3r_86UPRFI2hlgiScnLYD8RsXDBNalmmnHiAbfb06e69QHQnmEKa6pcSSFWor0OAuzisBb6C5V51E9vH0eCr4hIa_lBtmjvLmsSue7puRUaYcyptwiuUkwjLFb-3_cpeuzWH29Knwne6zVD8gav_FPi1ub4vkrkX8ktLZH_JQG20fim1Ai5j2Q7jcnaMIHShYnC9sLBP5usp3thFLdQEyH8KCHJK79yNKzaruUntkq9yqqO_MQvY7VevLlDEDPllniRVih0r4TICdGrgJ0Ibr4wh_xFksVhYqa2_6x71ed_K9SX3hG-6T6pBUVA\",\n         \"token_type\":\"Bearer\",\n         \"expires_in\":3600\n      }\n      ```\n- A sample request to retrieve a consent looks as follows:\n```\ncurl GET \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- A sample response looks as follows:\n```\n{\n    \"Meta\": {\n        \"TotalPages\": 1\n    },\n    \"Risk\": {},\n    \"Links\": {\n        \"Self\": \"https://<IS_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID>\"\n    },\n    \"Data\": {\n        \"Status\": \"Authorised\",\n        \"StatusUpdateDateTime\": \"2020-10-07T12:46Z\",\n        \"CreationDateTime\": \"2020-10-07T09:29Z\",\n        \"TransactionToDateTime\": \"2020-10-09T10:28:49+05:30\",\n        \"ExpirationDateTime\": \"2020-10-11T10:28:49+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"41042513-fa45-4da8-93be-1513b3caffac\",\n        \"TransactionFromDateTime\": \"2020-10-06T10:28:49+05:30\"\n    }\n}\n```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_5",
          "text": "This document provides step by step instructions to tryout the flow with Manual Client Registration. This includes\n\n- Setting up WSO2 FInancial Services Key Manager\n- Create application using Manual Client Registration\n- Tryout Accounts Information Flow using application created using Manual Client Registration",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support a \"Read Card Account List\" endpoint via `GET /v1/card-accounts`. The provided `account-info-swagger.yaml`  defines endpoints for general accounts, such as `GET /accounts`  and `GET /accounts/{AccountId}` , but not specifically for \"card accounts\" or the `/v1/card-accounts` path.\\n\\n### API Endpoints and Features\\nThe `wso2/financial-services-accelerator` repository provides API specifications for Account Information Services, Payment Initiation Services, and Confirmation of Funds Services . The `account-info-swagger.yaml` file details endpoints related to general accounts, balances, and transactions.\\n\\nSpecifically, it includes:\\n*   `GET /accounts`: To retrieve a list of accounts . This endpoint is secured with `PSUOAuth2Security` and requires the `accounts` scope .\\n*   `GET /accounts/{AccountId}`: To retrieve details of a specific account .\\n*   `GET /accounts/{AccountId}/balances`: To retrieve balances for a specific account .\\n*   `GET /accounts/{AccountId}/transactions`: To retrieve transactions for a specific account .\\n\\nWhile the `OBExternalAccountSubType1Code` definition in `account-info-swagger.yaml` includes `ChargeCard`, `CreditCard`, and `PrePaidCard` as possible account subtypes , there is no dedicated endpoint `/v1/card-accounts` or similar path specifically for card accounts. The existing `/accounts` endpoint would likely return all account types, including card accounts, if they are configured in the backend.\\n\\n### Implementation Details\\nThe `AccountService.java`  in the `demo.backend` module provides a demo implementation for `GET /accountservice/accounts` . This service returns a hardcoded JSON response containing two `Account` objects . The `AccountSubType` for these demo accounts is `CurrentAccount`  , not specifically card accounts.\\n\\nIntegration tests in `FSAPIMConnectorTest.groovy`  and `EndToEndAccountFlowTest.groovy`  demonstrate the retrieval of accounts using the `accountsPath` which is set to `AISP_PATH + \"accounts\"` . These tests verify the functionality of the general account retrieval endpoint.\\n\\n### Configuration Options\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, is used for centralized configuration . While the overview mentions configuration for consent management, identity server extensions, and event notifications, there\\'s no specific configuration option mentioned for enabling or disabling a dedicated \"card account list\" endpoint. The system\\'s behavior regarding card accounts would likely be governed by how the backend systems integrate with the generic `/accounts` endpoint.\\n\\n### Documentation References\\nThe `Overview` wiki page  provides a high-level overview of the WSO2 Financial Services Accelerator and mentions \"Account Information APIs\" . The `account-info-swagger.yaml`  serves as the primary documentation for the Account and Transaction API Specification.\\n\\n## Notes\\nThe prompt specifically asks for `GET /v1/card-accounts`. The provided codebase does not contain an explicit endpoint with this exact path. Instead, it offers a more general `GET /accounts` endpoint  which, based on the `OBExternalAccountSubType1Code`  definition, could potentially return card accounts as part of a broader account list. To verify the requirement, you would need to confirm if the existing `/accounts` endpoint is sufficient or if a dedicated `/v1/card-accounts` endpoint is strictly necessary.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_cc3a3841-5e33-4c1a-80d9-1a90593c494c\\n', 'id': 'lc_73f71b63-5982-42c5-b782-dfd0cca921f3'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0126",
      "requirement": {
        "requirement_id": "ATOM_008",
        "requirement_text": "Message parameters SHALL be encoded in Spinal-case (starting capital letters) on HTTP header level.",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0126_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not explicitly enforce or support Spinal-case formatting for HTTP header parameters. The provided code snippets primarily demonstrate the use of standard HTTP headers like `Content-Type`, `Authorization`, and `User-Agent`, which are typically in a \"Header-Case\" or \"Title-Case\" format (e.g., \"Content-Type\") rather than Spinal-case (e.g., \"Content-Type\").       There are no explicit configuration options or API features within the provided context that would enable or enforce Spinal-case for HTTP headers. <cite/>\\n\\n## Implementation Details\\n\\nThe codebase primarily uses standard HTTP client libraries, such as Apache HttpClient, to construct and send HTTP requests.   When setting headers, the `BasicHeader` class is used, which takes a header name and a value as strings.   The header names are consistently defined using conventional casing (e.g., `AUTHORIZATION_HEADER`, `USER_AGENT_ATTRIBUTE`, `CONTENT_TYPE_ATTRIBUTE`), which are then directly used to set the HTTP headers.    There is no code that transforms header names into Spinal-case. <cite/>\\n\\nFor example, in `OAuth2DeviceFlowTestCase.java`, the `User-Agent` header is set directly using `request.setHeader(CommonConstants.USER_AGENT_HEADER, OAuth2Constant.USER_AGENT);`.  Similarly, in `SCIM2RestClient.java`, headers are created as `new BasicHeader(USER_AGENT_ATTRIBUTE, OAuth2Constant.USER_AGENT)` and `new BasicHeader(AUTHORIZATION_ATTRIBUTE, BASIC_AUTHORIZATION_ATTRIBUTE + Base64.encodeBase64String((username + \":\" + password).getBytes()).trim())`.  These examples show that the header names are used as provided, without any case transformation to Spinal-case. <cite/>\\n\\n## Configuration Options\\n\\nThe `catalina-server.xml` file, which configures the Tomcat server, includes a `RequestCorrelationIdValve` that maps incoming headers to a `Correlation-ID`.  Specifically, it maps `activityid` to `Correlation-ID` and `RelayState` (from query parameters) to `Correlation-ID`.  While this valve processes header information, it does not provide any mechanism to enforce or convert header names to Spinal-case. <cite/>\\n\\n## API Endpoints or Features\\n\\nThe provided context does not indicate any specific API endpoints or features designed to handle or enforce Spinal-case for HTTP header parameters. <cite/> The various test cases for OAuth2, SCIM2, and other services demonstrate setting standard HTTP headers, but none suggest support for Spinal-case.   \\n\\n## Documentation References\\n\\nThe \"Testing Framework\" and \"OAuth2 and OpenID Connect\" wiki pages describe the architecture and components of the WSO2 Identity Server, including how HTTP requests are handled in tests.   However, neither of these documents mentions any specific requirement or support for Spinal-case formatting of HTTP header parameters. <cite/> The focus is on standard protocol compliance and general HTTP utility functions.  \\n\\n## Notes\\n\\nThe term \"Spinal-case\" for HTTP headers is not a standard convention. HTTP header fields are typically case-insensitive, but the conventional format is \"Header-Case\" (e.g., `Content-Type`, `User-Agent`). The provided code consistently uses this conventional casing for HTTP headers. There is no indication in the codebase that Spinal-case is supported or enforced.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Testing Framework (wso2/product-is)](/wiki/wso2/product-is#6)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-m_6fa304cf-0549-45dd-8b77-abcf8ef05a02\\n', 'id': 'lc_c77add70-8a69-4a22-b434-1612fac4276a'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0126_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not explicitly enforce or provide configuration options for HTTP header parameters to be encoded in Spinal-case (starting capital letters with hyphens) at a global level. However, it does allow for the definition and manipulation of HTTP headers, which could be used to implement such a requirement. \\n\\n### Implementation Details\\n\\nThe `wso2/product-apim` repository includes policy definitions that allow adding custom headers to requests.  Specifically, the `addHeader_v2.json` policy, found in `api-control-plane/modules/distribution/resources/operation_policies/specifications/addHeader_v2.json`, `gateway/modules/distribution/resources/operation_policies/specifications/addHeader_v2.json`, and `traffic-manager/modules/distribution/resources/operation_policies/specifications/addHeader_v2.json`, defines a mediation policy to add a new header to a request.  This policy has attributes for `headerName` and `headerValue`, both of which are strings and are required.  This means you can define a header with a name in Spinal-case using this policy. \\n\\nThe `api.yaml` and `admin-api.yaml` files define various API endpoints and their parameters, including headers.  For example, `api.yaml` defines headers like `xWSO2Tenant` and `X-WSO2-KEY-MANAGER` which are already in a Spinal-case-like format.  Similarly, `admin-api.yaml` defines standard HTTP headers such as `Accept`, `Content-Type`, `If-None-Match`, `If-Modified-Since`, and `If-Match`, which follow a Spinal-case convention.  These definitions indicate that the system is capable of handling headers in this format. \\n\\n### Configuration Options\\n\\nWhile there isn\\'t a direct configuration option to *enforce* Spinal-case for all headers, the `addHeader` policy allows you to *define* headers with Spinal-case names.  This policy can be applied to different flows (request, response, fault) and is supported by the Synapse Gateway. \\n\\nThe `default.json` configuration files in `api-control-plane/modules/distribution/product/src/main/resources/conf/default.json` and `gateway/modules/distribution/product/src/main/resources/conf/default.json` show a property `passthru_http.\\'http.headers.preserve\\'` which is set to `Content-Type`.  This indicates that specific headers can be configured to be preserved, but it doesn\\'t directly relate to enforcing a naming convention. \\n\\n### API Endpoints or Features\\n\\nThe API definitions in `api.yaml` and `admin-api.yaml` demonstrate the use of headers in API requests and responses.  For instance, the `/apis` endpoint in `api.yaml` includes a reference to `#/parameters/Accept`, which is defined as an HTTP header.  This shows that the system processes and expects headers in its API interactions. \\n\\n### Documentation References\\n\\nThe `extensions_guide.xml` files in `all-in-one-apim/docs/xdoc/extensions_guide.xml`, `api-control-plane/docs/xdoc/extensions_guide.xml`, and `traffic-manager/docs/xdoc/extensions_guide.xml` discuss the XPath Extension Framework and how to access transport headers using `$trp:SOME_TRANSPORT_HEADER`.  This indicates that transport headers are accessible and can be manipulated within the Synapse configuration, which is the underlying mediation engine.  While this doesn\\'t directly enforce Spinal-case, it provides a mechanism to inspect and potentially modify header names if custom mediation logic were to be implemented. \\n\\n## Notes\\n\\nThe codebase does not contain an explicit, built-in feature or configuration to automatically enforce Spinal-case for all HTTP header parameters. The existing header definitions and the `addHeader` policy demonstrate that headers can be *created* or *expected* in Spinal-case, but there\\'s no global validation or transformation mechanism for this specific naming convention visible in the provided snippets. To meet the \"SHALL\" requirement, custom mediation policies or handlers would likely need to be implemented to validate and/or transform header names to Spinal-case.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-m_4c2eb6da-cbb4-4402-aa03-f7a078a8ffa8\\n', 'id': 'lc_2f826667-f9cd-4026-b60c-e989db9fdcd4'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0127",
      "requirement": {
        "requirement_id": "ATOM_073",
        "requirement_text": "The ASPSP must validate the eIDAS certificate for payment initiation requests in redirect SCA approach",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0127_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, appears to support certificate validation, which is a prerequisite for eIDAS certificate validation. Specifically, it includes an API for certificate validation management and features related to X.509 certificate validation. However, direct support for eIDAS certificates or specific validation for payment initiation requests in a redirect SCA approach is not explicitly detailed in the provided snippets.\\n\\n### Implementation Details\\nThe WSO2 Identity Server includes a feature group for X.509 certificate validation, indicated by `org.wso2.carbon.extension.identity.x509Certificate.validation.server.feature.group` . This suggests that the system has capabilities to handle and validate X.509 certificates. Additionally, there\\'s an API for certificate validation management: `org.wso2.carbon.identity.api.server.certificate.validation.management.v1` and `org.wso2.carbon.identity.api.server.certificate.validation.management.common` .\\n\\nA Python script, `resource-server.py`, within the `oidc-fapi-conformance-tests` module, demonstrates how client certificates are processed for FAPI (Financial-grade API) compliance . This script extracts the client certificate from the `X-Ssl-Cert` header  and computes its SHA256 thumbprint . It then compares this thumbprint with one obtained from the access token\\'s `cnf` claim . This process is crucial for client authentication and ensuring the integrity of the communication in financial transactions.\\n\\n### Configuration Options\\nWhile specific configuration options for eIDAS certificates are not explicitly mentioned, the presence of `org.wso2.carbon.identity.api.server.keystore.management.v1` and `org.wso2.carbon.identity.api.server.keystore.management.common`  suggests that keystore management is available. This would be essential for managing trusted certificates, including potentially eIDAS certificates. The `automation.xml` file also shows configurations for keystores and truststores, specifying file paths, types (e.g., PKCS12), and passwords .\\n\\n### API Endpoints or Features\\nThe API for certificate validation management is exposed through `org.wso2.carbon.identity.api.server.certificate.validation.management.v1` . This API would likely provide functionalities to manage and configure certificate validation rules. The system also supports FAPI compliance, which often involves strong client authentication using certificates . The `AuthorizationDetailsType` class includes a `type` field that can be set to `payment_initiation`, indicating support for defining authorization details specific to payment initiation requests .\\n\\n### Documentation References\\nThe provided context does not include direct documentation references for eIDAS certificate validation. However, the \"Overview\" wiki page mentions that WSO2 Identity Server supports FAPI compliance , which is a standard relevant to secure financial transactions and often involves strong certificate-based authentication.\\n\\n## Notes\\nThe provided code snippets indicate a strong foundation for certificate management and validation, particularly in the context of FAPI compliance. While eIDAS is not explicitly named, the mechanisms for X.509 certificate validation and keystore management are present. The `oidc-fapi-conformance-tests/resource-server/resource-server.py` script demonstrates a practical application of client certificate validation, which is a core component of eIDAS validation in a redirect SCA approach. Further investigation into the `org.wso2.carbon.extension.identity.x509Certificate.validation.server.feature.group` and the certificate validation management APIs would be necessary to confirm explicit eIDAS support and its integration with payment initiation flows.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_744ab709-1035-4921-983d-254ac9a72d2c\\n', 'id': 'lc_369fbee5-127c-4ff9-aac6-7bbccce78f17'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0127_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support certificate validation, including certificate chain validation and revocation checks, which are crucial for validating eIDAS certificates in payment initiation requests. The system allows for the configuration of certificate revocation validation and provides APIs for managing client certificates.     \\n\\n## Implementation Details\\n\\nThe WSO2 API Manager, represented by the `wso2/product-apim` repository, includes functionality for validating client certificates. Specifically, the `APISecurityMutualSSLCertificateChainValidationTestCase.java` test case demonstrates the capability to upload and utilize root and intermediate certificates for mutual SSL authentication.   This implies that the system can perform certificate chain validation.  \\n\\nThe `axis2.xml.j2` configuration files in both `all-in-one-apim` and `gateway` modules indicate support for `CertificateRevocationVerifier`.   This verifier can be enabled to perform checks such as `FullChainValidation` and `ExpiryValidation`, which are essential for robust eIDAS certificate validation.  \\n\\n## Configuration Options\\n\\nCertificate revocation validation can be configured by setting the `transport.passthru_https.listener.cert_revocation_validation.enable` parameter to `true` in the `axis2.xml.j2` files.   Additional parameters like `CacheSize`, `CacheDelay`, `FullChainValidation`, and `ExpiryValidation` can also be configured within the `CertificateRevocationVerifier` section.  \\n\\n## API Endpoints or Features\\n\\nThe `ClientCertificatesApi` provides operations for managing client certificates, including uploading, deleting, and retrieving certificate information.   Specifically, the `uploadCertificate` method in the `restAPIPublisher` is used in the test case to upload certificates associated with an API.  This suggests that client certificates can be managed programmatically. \\n\\nThe `ClientCertificatesApi` includes the following key operations:\\n*   `deleteAPIClientCertificateByKeyTypeAndAlias`: Deletes a client certificate by key type and alias. \\n*   `getAPIClientCertificateByAlias`: Retrieves information about a client certificate using its alias. \\n*   `getAPIClientCertificateByKeyTypeAndAlias`: Retrieves information about a client certificate of a given key type and alias. \\n*   `updateAPIClientCertificateByKeyTypeAndAlias`: Updates an existing client certificate. \\n\\n## Documentation References\\n\\nThe `ClientCertificatesApi.md` file provides documentation for the API endpoints related to client certificate management.   This documentation details the parameters, return types, and HTTP response codes for each operation.  \\n\\n## Notes\\n\\nThe provided snippets strongly suggest that the WSO2 API Manager supports the validation of client certificates, including certificate chain and revocation checks, which are essential for eIDAS certificate validation in payment initiation requests.   The `APISecurityMutualSSLCertificateChainValidationTestCase` specifically tests mutual SSL with certificate chain validation, indicating that this is an implemented feature.  The `ClientCertificatesApi` provides the necessary programmatic interface for managing these certificates. \\n\\nWhile the snippets do not explicitly mention \"eIDAS\" or \"payment initiation requests,\" the underlying mechanisms for certificate validation (mutual SSL, certificate chain validation, and revocation checks) are directly applicable to the requirement.      The system provides the necessary building blocks to meet the specified requirement.  \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_52f372a3-3f2a-4c98-b1f6-1f920a886f09\\n', 'id': 'lc_be805f43-bbb0-4117-a16d-0ef2b797e5c3'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0128",
      "requirement": {
        "requirement_id": "ATOM_054",
        "requirement_text": "The system MUST support payment initiation transaction status 'PART' (PartiallyAccepted) for bulk payments when only some contained payments are processed successfully.",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0128_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_2",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_3",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_4",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support a \\'PART\\' (PartiallyAccepted) status for bulk payment initiation transactions. The OpenAPI specification for Payment Initiation defines several payment statuses, but \\'PartiallyAccepted\\' is not among them.  The system primarily focuses on single payment initiation and consent management. \\n\\n### Implementation Details\\n\\nThe `PaymentInitiationAPI` OpenAPI specification, defined in `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml`, outlines the structure for payment initiation and consent.  The `obWritePaymentResponse5` schema, which represents the response for a payment submission, includes a `Status` field.   The allowed enumeration values for this `Status` are: \\n*   `AcceptedCreditSettlementCompleted`\\n*   `AcceptedSettlementCompleted`\\n*   `AcceptedSettlementInProcess`\\n*   `AcceptedWithoutPosting`\\n*   `Pending`\\n*   `Rejected`\\n\\nThere is no `PartiallyAccepted` status defined within this enumeration.  The `Initiation` object within the `obWritePaymentResponse5` schema describes a single payment, indicating that the current API design is for individual payment processing rather than bulk payments with partial success scenarios. \\n\\nThe `PaymentService.java` in the demo backend handles payment submissions and caches payment responses.  This service currently returns a `201 Created` status for successful submissions, and there is no explicit logic for handling partial success of bulk payments. \\n\\n### Configuration Options\\n\\nThe `financial-services.xml` configuration file, parsed by `FinancialServicesConfigParser`, manages various aspects of the accelerator, including consent management and identity extensions.  However, there are no specific configuration options related to enabling or defining a \\'PartiallyAccepted\\' status for bulk payments.  The `ConsentExtensionConstants.java` defines various consent statuses like `AwaitingAuthorisation`, `Authorised`, `Revoked`, `Rejected`, and `Created`, but not `PartiallyAccepted`. \\n\\n### API Endpoints or Features\\n\\nThe `PaymentInitiationAPI` defines endpoints for creating payment consents (`/payment-consents`) and submitting payments (`/payments`).   The `/payments` endpoint is used for creating payments, and its response schema `obWritePaymentResponse5` does not include a \\'PartiallyAccepted\\' status.  \\n\\nWhile there are constants for various payment-related paths in `ConnectorTestConstants.groovy`, such as `SUBMISSION_PATH_DOMESTIC_PAYMENTS` and `SUBMISSION_PATH_FILE_PAYMENTS`, there is no explicit mention or definition of bulk payment processing that would necessitate a \\'PartiallyAccepted\\' status. \\n\\n### Documentation References\\n\\nThe \"Overview\" wiki page for the `wso2/financial-services-accelerator` mentions \"payment initiation\" as a supported use case.  However, it does not provide specific details on bulk payment processing or the handling of partial success scenarios with a \\'PartiallyAccepted\\' status. \\n\\n## Notes\\n\\nThe current codebase does not appear to support the \\'PART\\' (PartiallyAccepted) status for bulk payments. The existing OpenAPI specification for payment initiation only defines statuses for individual payments, and \\'PartiallyAccepted\\' is not among them. To implement this feature, modifications would be required in the OpenAPI specification to include the new status and corresponding backend logic to handle partial processing of bulk payments.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_8b8f46d2-c0f7-4004-952d-317fd2903a3d\\n', 'id': 'lc_fd428ff1-c870-4fe4-a3fb-9a67ba2063b4'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0129",
      "requirement": {
        "requirement_id": "ATOM_060",
        "requirement_text": "The system MUST support consent status values 'received', 'rejected', and 'valid' during the AIS consent initiation phase.",
        "strength": "MUST",
        "capability": "Consent Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "unknown",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0129_1",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_2",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_3",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0130",
      "requirement": {
        "requirement_id": "ATOM_085",
        "requirement_text": "ASPSP SHALL provide SCA challenge data (e.g. Photo OTP bitmap) in Authorization Response when only one SCA method is available",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0130_1",
          "text": "##Writing a custom claim provider\n\nThe `OBClaimProvider` class is an extension that lets you customize and create your own claim provider and add \nadditional claims to the authorization and/or token responses. You can add any claims according to your open banking \nrequirements. \n\n``` java\ncom.wso2.openbanking.accelerator.identity.claims.OBClaimProvider\n```\n\nTo customize claims, override relevant methods of this class. Given below is a brief description of each method.\n\n###getAdditionalClaims method - Authorization response\n\nThis method lets you add additional claims to the authorization response. Given below is the method signature.\n\n``` java\n@Override\npublic Map < String, Object > getAdditionalClaims(OAuthAuthzReqMessageContext authAuthzReqMessageContext,\n  OAuth2AuthorizeRespDTO authorizeRespDTO)\nthrows IdentityOAuth2Exception;\n```\n\n??? tip \"Click here to see a sample implementation:\"\n\n    Given below is a sample implementation of the `getAdditionalClaims` method. You can add the required claims to a \n    map and return it as follows:\n    \n    ``` java\n    @Override\n    public Map < String, Object > getAdditionalClaims(OAuthAuthzReqMessageContext authAuthzReqMessageContext,\n      OAuth2AuthorizeRespDTO authorizeRespDTO)\n    throws IdentityOAuth2Exception {\n    \n      Map < String, Object > claims = new HashMap < > ();\n      //auth_time claim indicates the time when authentication occurs\n      claims.put(AUTH_TIME_CLAIM, authAuthzReqMessageContext.getCodeIssuedTime());\n    \n      return claims;\n    \n    }\n    ```\n\n###getAdditionalClaims method - Access token response\n\nThis method lets you add additional claims to the access token response. Given below is the method signature.\n\n``` java\n@Override\npublic Map < String, Object > getAdditionalClaims(OAuthTokenReqMessageContext tokenReqMessageContext,\n  OAuth2AccessTokenRespDTO tokenRespDTO)\nthrows IdentityOAuth2Exception;\n```\n\nOnce implemented, build a JAR file for your custom claim provider and place it in the \n`<IS_HOME>/repository/components/dropins` directory. \n\n##Configuring a custom claim provider\n\n1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n2. Add the following tags and configure your custom claim provider using its Fully Qualified Name (FQN) :\n\n``` toml\n[open_banking.identity.extensions]\nclaim_provider=\"com.wso2.openbanking.accelerator.identity.claims.OBDefaultClaimProvider\"\n```\n\n##Configuring Claims for an Identity Provider\n\nConfiguring claims for an identity provider involves mapping the claims available in the identity provider to claims \nthat are local to the WSO2 Identity Server. This is done so that the Identity Server can identify the user attributes \nin the response sent from the identity provider. \n\nFor more information, see [Configuring Claims for an Identity Provider](https://is.docs.wso2.com/en/5.9.0/learn/configuring-claims-for-an-identity-provider/#configuring-claims-for-an-identity-provider) \nin WSO2 Identity Server documentation.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0130_2",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0130_3",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0130_4",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0130_5",
          "text": "### executeInitialStep method\n\nThis method lets you modify the token response and add any additional claims. Given below is the method signature.\n\n``` java\npublic void executeInitialStep(OAuth2AccessTokenRespDTO oAuth2AccessTokenRespDTO, OAuthTokenReqMessageContext tokReqMsgCtx);\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0130_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support various multi-factor authentication (MFA) methods, including SMS OTP and Email OTP, which could be used as SCA methods. However, there is no direct evidence within the provided snippets to confirm explicit support for providing \"Photo OTP bitmap\" or other generic \"SCA challenge data\" in the authorization response when only one SCA method is available, as specified in your query. The codebase primarily focuses on the integration and testing of different authenticators and their respective flows.\\n\\n### Implementation Details\\nThe WSO2 Identity Server architecture includes an \"Authentication Framework\" that supports various authenticators, including \"Multi-factor Authenticators\" like `TOTP Authenticator`, `SMS OTP Authenticator`, and `Email OTP Authenticator`  . The `pom.xml` file lists dependencies for `org.wso2.carbon.identity.local.auth.emailotp` and `org.wso2.carbon.identity.local.auth.smsotp`, indicating their inclusion as features .\\n\\nFor SMS OTP, a `MockSMSProvider` is used in integration tests to simulate sending and receiving SMS messages, extracting the OTP from the content . The `transform` method in `MockSMSProvider` extracts a 6-digit OTP from the SMS content .\\n\\n### Configuration Options\\nThe system uses a \"Configuration System\" that includes `default.json`, `infer.json`, `key-mappings.json`, and `deployment.toml` for managing configurations . These files, along with Jinja2 templates, are used to generate runtime configuration files . Specific configurations for authenticators would likely be managed through this system. For example, the `ChallengeQuestionsUITestCase` demonstrates how `ADD_CHALLENGE_QUESTIONS_CONFIG` (a TOML file) is applied to the server configuration  .\\n\\n### API Endpoints or Features\\nThe `ApplicationNativeAuthentication2FATestCase` demonstrates interaction with authentication flows using POST requests to an unspecified endpoint (`href`) . The request body includes a `flowId` and `selectedAuthenticator` with an `authenticatorId` and `params` for providing authentication details like `OTPCode` for Email OTP . This suggests that authentication responses are handled through these API interactions. However, the specific format of the authorization response and whether it includes \"Photo OTP bitmap\" or similar challenge data is not detailed in the provided snippets.\\n\\n### Documentation References\\nThe provided context includes a wiki page on \"Architecture\"  which gives a high-level overview of the WSO2 Identity Server components, including \"Protocol Support\" and \"Authentication Framework\" . This wiki page mentions `OAuth2/OIDC` as a supported protocol . While it describes the general structure and supported authenticators, it does not delve into the specifics of SCA challenge data in authorization responses.\\n\\n## Notes\\nThe provided code snippets and wiki page do not contain explicit information about \"Photo OTP bitmap\" or the mechanism for providing generic \"SCA challenge data\" directly within the authorization response when only one SCA method is available. The focus is more on the integration and testing of various OTP-based authenticators (SMS OTP, Email OTP). While the system supports MFA, the specific requirement of including challenge data like a Photo OTP bitmap in the authorization response is not directly addressed by the provided context. Further investigation into the OAuth2/OIDC implementation and the authentication framework\\'s response handling would be necessary to confirm this capability.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_c7f91949-426c-4415-8f9d-9d11fea334bb\\n', 'id': 'lc_6c3a198c-dba4-4501-90ba-64591ac59031'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0130_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_9b46ac4a-f81e-45eb-b78d-8ead018d83c6'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0131",
      "requirement": {
        "requirement_id": "ATOM_004",
        "requirement_text": "The TPP SHALL use a qualified certificate for website authentication issued by a qualified trust service provider according to eIDAS regulation.",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0131_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the use of X.509 certificates for website authentication, which is a foundational component for implementing the requirement of using qualified certificates issued by eIDAS-compliant trust service providers. The system includes a `X509CertificateAuthenticationValve` for processing X.509 certificates and provides configuration options for managing keystores and truststores.    While the codebase demonstrates the technical capability to handle X.509 certificates, explicit references to \"qualified certificates,\" \"eIDAS regulation,\" or \"qualified trust service providers\" are not directly found within the provided snippets. <cite/>\\n\\n## Implementation Details\\n\\nThe core implementation detail for X.509 certificate authentication is the `X509CertificateAuthenticationValve` in the `wso2/product-is` repository.  This valve is configured within the `catalina-server.xml.j2` template, which is part of the Tomcat configuration for the WSO2 Identity Server.  The presence of this valve indicates that the system is designed to process and utilize X.509 certificates for authentication purposes. \\n\\nAdditionally, the `pom.xml` file includes a dependency for `org.wso2.carbon.extension.identity.authenticator.outbound.x509Certificate`, specifically `org.wso2.carbon.extension.identity.authenticator.x509Certificate.connector`.  This suggests a dedicated connector for X.509 certificate authentication, further supporting its implementation within the system. \\n\\nThe `ClientSignKeyDataHolder` class is used for handling signing keys and certificates, loading them from a PKCS12 keystore.   This class is responsible for initializing private and public keys, and issuer certificates from a given keystore path, password, and key alias. \\n\\n## Configuration Options\\n\\nThe system provides configuration options related to keystores and truststores, which are essential for managing certificates.  \\n\\n*   **Keystore Configuration**: The `automation.xml` files, used in integration tests, define a `keystore` element with `fileName`, `type`, `password`, `keyAlias`, and `keyPassword` properties.  This allows for specifying the keystore to be used for encrypting/decrypting passwords and other sensitive information. \\n*   **Truststore Configuration**: Similarly, a `truststore` element is defined with `fileName`, `type`, and `password` to maintain certificates of all trusted parties. \\n*   **System Properties**: The `ISIntegrationTest` class sets system properties for `javax.net.ssl.trustStore`, `javax.net.ssl.trustStorePassword`, and `javax.net.ssl.trustStoreType`, indicating how the truststore is configured at a system level. \\n*   **Identity Provider Certificate**: The `IdentityProviderMgtServiceTestCase` demonstrates setting a certificate for an Identity Provider using `idProvider.setCertificate(sampleCertificate)`.  This suggests that certificates can be associated with identity providers. \\n*   **API for Certificate Management**: The `IdPSuccessTest` includes tests for patching an Identity Provider\\'s certificate, including adding and removing certificates.  This indicates API endpoints for managing certificates associated with Identity Providers. \\n\\n## API Endpoints or Features\\n\\nThe `IdPSuccessTest` reveals API endpoints for managing Identity Provider certificates.  Specifically, it shows how to use PATCH requests to add and remove certificates from an Identity Provider\\'s configuration.  The API path used is `IDP_API_BASE_PATH + PATH_SEPARATOR + idPId`, suggesting a RESTful API for Identity Provider management. \\n\\nThe `oidc-fapi-conformance-tests` directory contains `client_configs.py` and `serverjwks.py` which define JWKS (JSON Web Key Set) for clients and servers, including `x5c` (X.509 certificate chain) and `x5u` (X.509 URL) properties.   This indicates support for using X.509 certificates within the context of OpenID Connect (OIDC) and Financial-grade API (FAPI) profiles, which often have stringent security requirements for certificate validation.  \\n\\n## Documentation References\\n\\nThe provided context does not include direct documentation references that explicitly mention \"eIDAS regulation,\" \"qualified certificates,\" or \"qualified trust service providers.\" <cite/> However, the \"Architecture\" wiki page provides a high-level overview of WSO2 Identity Server\\'s components, including \"Protocol Support\" for FAPI and \"Authentication Framework\" which would be relevant for understanding the broader context of certificate usage.  \\n\\n## Notes\\n\\nThe codebase demonstrates robust support for X.509 certificates, which is a prerequisite for implementing the specified requirement.   The configuration options for keystores and truststores, along with API endpoints for managing Identity Provider certificates, provide the necessary mechanisms for handling certificates.    However, the specific validation of whether a certificate is a \"qualified certificate\" issued by an \"eIDAS-compliant qualified trust service provider\" would likely depend on external configurations or custom extensions that are not explicitly detailed in the provided snippets. <cite/> The `oidc-fapi-conformance-tests` indicate that the system is designed to meet high security standards, which often involve advanced certificate validation.   Further investigation into the `X509CertificateAuthenticationValve` implementation and related certificate validation logic would be necessary to confirm direct support for eIDAS-specific requirements. \\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b00350b7-83b8-41c0-93e5-ce341c97492e\\n', 'id': 'lc_7caf888e-dfc7-483c-831b-c97a73af63da'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0131_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': '# Answer\\n\\nBased on my review of the codebase, **this repository does not contain explicit support for eIDAS-compliant qualified certificates for TPP (Third Party Provider) website authentication**. <cite/>\\n\\nThe codebase shows certificate management capabilities, but these are focused on different use cases:\\n\\n## What the Repository Supports\\n\\n### Certificate Management APIs\\nThe repository provides certificate management endpoints through the Publisher API, including:\\n\\n-  - APIs for uploading, retrieving, updating, and deleting endpoint certificates\\n-  - APIs for managing client certificates\\n\\n### Certificate Features\\nThe implementation supports:\\n- Certificate upload and storage with alias-based identification\\n- Certificate metadata retrieval (subject, validity dates, version)\\n- Certificate usage tracking across APIs\\n- Mutual SSL/TLS configuration for API endpoints\\n\\n shows certificate information retrieval including subject and validity details.\\n\\n## What is Missing for eIDAS Compliance\\n\\nThe codebase does **not** contain:\\n\\n1. **eIDAS Validation Logic** - No code validates that certificates are issued by eIDAS-qualified trust service providers\\n2. **Qualified Certificate Detection** - No mechanism to identify or enforce qualified certificate requirements\\n3. **eIDAS-Specific Configuration** - No configuration options for eIDAS compliance settings\\n4. **Compliance Documentation** - No references to eIDAS regulation requirements in the code or documentation\\n\\nThe certificate handling is generic and does not distinguish between regular certificates and eIDAS-qualified certificates.\\n\\n## Notes\\n\\nThe repository is WSO2 API Manager (APIM), which provides general-purpose certificate management for API security (mutual SSL/TLS, endpoint authentication). The certificate features are designed for API gateway operations, not for regulatory compliance with eIDAS requirements for TPP authentication. To meet the eIDAS requirement, you would need to implement additional validation logic outside this codebase to verify certificate qualification status against eIDAS-registered trust service providers.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d8f60e91-d5cf-4a84-8d4d-f17f1b757151\\n', 'id': 'lc_d58a6a91-7373-47c2-9d09-1bea8874bee3'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0132",
      "requirement": {
        "requirement_id": "ATOM_191",
        "requirement_text": "The Algorithm parameter must identify SHA-256 or SHA-512 as the hash algorithm",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0132_1",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0132_2",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports SHA-256 and SHA-512 as hash algorithms for OAuth2 tokens and password hashing. The configuration for these algorithms can be found in the `identity_hash_enabled.toml` file, which is used in integration tests to verify the functionality. The system also uses SHA-256 for various thumbprint calculations.\\n\\n## Implementation Details\\n\\nThe system uses SHA-256 for generating access token hashes in DPoP (Demonstrating Proof of Possession) proofs . Specifically, the `generateAccessTokenHash` method in `DPoPProofGenerator.java` explicitly uses `MessageDigest.getInstance(\"SHA-256\")` to hash access tokens .\\n\\nSHA-256 is also used for computing X.509 certificate thumbprints, as seen in the `getX509CertSHA256Thumbprint` method within `Oauth2JWKSEndpointTestCase.java` . Similarly, the `computeSHA256Thumbprint` function in `resource-server.py` also uses SHA256 for certificate thumbprints .\\n\\nFor PKCE (Proof Key for Code Exchange) code challenges, SHA-256 is used as the hashing algorithm . The `getPKCECodeChallenge` method in `OAuth2PKCETestCase.java` explicitly calls `MessageDigest.getInstance(\"SHA-256\")` .\\n\\nThe system also supports SHA-256 for password hashing, as indicated by the `PasswordDigest` property with a `defaultValue` of \"SHA-256\" in `get-user-store_by_type_id_response.json` .\\n\\n## Configuration Options\\n\\nThe hash algorithm for OAuth tokens can be configured using the `hash_token_algorithm` property under the `[oauth]` section in a TOML configuration file . The `identity_hash_enabled.toml` file demonstrates setting this to \"SHA-512\" .\\n\\nAdditionally, various signing algorithms, including SHA256withRSA, are supported for ID Tokens, request objects, and authorization context token generation   . The `oidc-metadata.json` file lists \"PS256\", \"ES256\", and \"SHA256withRSA\" as options for `idTokenSignatureAlgorithm` and `requestObjectSignatureAlgorithm`  .\\n\\nFor SAML responses, SHA-256 and SHA-512 are available as options for `responseDigestAlgorithm` .\\n\\n## API Endpoints or Features\\n\\nThe `Oauth2HashAlgorithmTestCase.java` integration test class specifically verifies the hashing support for access tokens, refresh tokens, and authorization codes by changing the default hash algorithm to SHA-512 . This test case applies a configuration from `identity_hash_enabled.toml` to enable SHA-512 hashing .\\n\\nThe `Oauth2JWKSEndpointTestCase.java` tests the JWKS endpoint, which provides public keys used to verify signatures of ID tokens . This endpoint includes the `x5t#S256` parameter, which represents the SHA-256 thumbprint of the X.509 certificate .\\n\\n## Documentation References\\n\\nThe \"OAuth2 and OpenID Connect\" wiki page provides an overview of the OAuth2 and OIDC implementation in WSO2 Identity Server, covering token handling and conformance with standards . It mentions that ID Tokens are JWTs that can be configured with various signing algorithms .\\n\\n## Notes\\n\\nThe provided snippets indicate strong support for SHA-256 and SHA-512 across various cryptographic operations within the `wso2/product-is` repository, particularly in the context of OAuth2 and OpenID Connect. The `identity_hash_enabled.toml` file and `Oauth2HashAlgorithmTestCase.java` are key in demonstrating the configurability and testing of these hash algorithms for tokens. While the prompt specifically asks about the \"Algorithm parameter,\" the context shows that these algorithms are used in various parameters and configurations related to hashing and signing.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_57061571-6652-480b-af4b-64f2e9110bf4\\n', 'id': 'lc_7ed78191-a88d-4db6-abe6-4777009154ca'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0132_3",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': '# Answer\\n\\nBased on the codebase context, the WSO2 API Manager repository **does support SHA-256 and SHA-512 hash algorithms**, but with important limitations regarding how they are configured.\\n\\n## Configuration Support\\n\\nThe repository supports hash algorithm configuration through the `SignatureAlgorithm` parameter in JWT configuration.  shows the configuration accepts `\"SHA256withRSA\"` as a signature algorithm value.\\n\\nAdditionally,  demonstrates TOML-based configuration with `signing_algorithm = \"SHA256withRSA\"`.\\n\\n## Implementation Details\\n\\nThe codebase includes algorithm mapping logic in , which maps JWT header algorithm identifiers to Java signature algorithm names:\\n- `RS256` maps to `SHA256withRSA`\\n- `RS512` maps to `SHA512withRSA` (referenced as `RS515` in the code, likely a typo)\\n- `RS384` maps to `SHA384withRSA`\\n\\n## Critical Limitation\\n\\n**The requirement cannot be fully met as stated.** The configuration parameter accepts algorithm values in the format `\"SHA256withRSA\"` or `\"SHA512withRSA\"` (RSA-based signatures), not bare `\"SHA-256\"` or `\"SHA-512\"` values. The algorithm parameter identifies the **signature algorithm** (combining hash + signing method), not the hash algorithm alone.\\n\\nThe documentation in configuration files states:  \"Signature algorithm. Accepts \"SHA256withRSA\" or \"NONE\".\"\\n\\n## Notes\\n\\nThe codebase focuses on JWT signature algorithms rather than standalone hash algorithm parameters. If your requirement specifically needs an `Algorithm` parameter that accepts `\"SHA-256\"` or `\"SHA-512\"` as discrete values (not combined with RSA), this exact format is not present in the provided code snippets. The repository supports SHA-256 and SHA-512 hashing, but only as part of RSA signature algorithms (`SHA256withRSA`, `SHA512withRSA`).\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_93bbf18d-508a-4c4d-bec7-5a90d3547ac0\\n', 'id': 'lc_de812d46-aedd-4108-b95b-f77a1d6282d2'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0133",
      "requirement": {
        "requirement_id": "ATOM_161",
        "requirement_text": "The Read Card Account Details endpoint SHALL be accessible via GET /v1/card-accounts/{account-id}",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0133_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0133_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0133_3",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0133_4",
          "text": "### Retrieve a consent \n- An API consumer can retrieve a consent resource that they have created to check its status. In order to make this request, \nthe API consumer must have an access token issued by the bank using the client credentials grant.\n\n??? tip \"Click here to find how to generate an application access token...\"\n    - Generate an application access token using the following command: \n      ```\n      curl -X POST \\\n      https://<IS_HOST>:9446/oauth2/token \\\n      --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n      -d 'grant_type=client_credentials&scope=accounts%20openid&client_assertion=eyJraWQiOiJEd01LZFdNbWo3UFdpbnZvcWZReVhWe\n      nlaNlEiLCJhbGciOiJQUzI1NiJ9.eyJzdWIiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OT\n      Q0Ni9vYXV0aDIvdG9rZW4iLCJpc3MiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiZXhwIjoxNjg0MDk5ODEyLCJpYXQiOjE2ODQwOTk4\n      MTMsImp0aSI6IjE2ODQwOTk4MTIifQ.EMZ2q3jciJ4MmrsH93kH_VGacrt2izbLaCBchGWiyUltdWwj3GwDMKfhpeMHtThd0DszwV8LUPKZaMT3wUS\n      oH3adY2IBC8aa2GKeb_vaQB5b0ZO6WpYQ45y_xIttAVj56d6oPli8wN4MlJoJsFPUlaxQohCLunN43BxSr-kFgeFMj7ynEsVbQvuYuEiTppwTSyXlt\n      Jmv70-nwpGU9UyuPCkXUsU53ShICrY0nC-3NUhY6oNpZclJP4MwG8mP4ZOvUIez_PSoP3AiaNithWhPCfLuKd68OLAReTBGdItqidsWWnn8lPVbM2F\n      LvehukHDCJhf9-ev1pdWIiwDSVDV7uQ&redirect_uri=www.wso2.com'\n      ```\n      - The request payload contains a client assertion in the following format:\n      ```\n      {\n      \"alg\": \"<<The algorithm used for signing>>\",\n      \"kid\": \"<<The KID value of the signing jwk set>>\",\n      \"typ\": \"JWT\"\n      }\n        \n      {\n      \"iss\": \"<<This is the issuer of the token. For example, client ID of your application>>\",\n      \"sub\": \"<<This is the subject identifier of the issuer. For example, client ID of your application>>\",\n      \"exp\": <<This is epoch time of the token expiration date/time>>,\n      \"iat\": <<This is epoch time of the token issuance date/time>>,\n      \"jti\": \"<<This is an incremental unique value>>\",\n      \"aud\": \"<<This is the audience that the ID token is intended for. For example, https://<APIM_HOST>:8243/token>>\"\n      }\n        \n      <signature: For DCR, the client assertion is signed by the private key of the signing certificate. Otherwise the private\n      signature of the application certificate is used.>\n      ```\n      - Upon successful token generation, you obtain a token as follows:\n      ```\n      {\n         \"access_token\":\"aa8ce78b-d81e-3385-81b1-a9fdd1e71daf\",\n         \"scope\":\"accounts payments  openid\",\n         \"id_token\":\"eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5HWXdZbU00WlRBM01XSTJOREF6WkdRek5HTTBaR1JsTmpKa09ERmtaRFJpT1RGa01XRmhNelUyWkdWbE5nX1JTMjU2IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiaHVBcS1GbzB0N2pFZmtiZ1A4TkJwdyIsImF1ZCI6WyJrYkxuSkpfdVFMMlllNjh1YUNSYlBJSk9SNFVhIiwiaHR0cDpcL1wvb3JnLndzbzIuYXBpbWd0XC9nYXRld2F5Il0sInN1YiI6ImFkbWluQHdzbzIuY29tQGNhcmJvbi5zdXBlciIsIm5iZiI6MTYwMTk5MzA5OCwiYXpwIjoia2JMbkpKX3VRTDJZZTY4dWFDUmJQSUpPUjRVYSIsImFtciI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwic2NvcGUiOlsiYW1fYXBwbGljYXRpb25fc2NvcGUiLCJvcGVuaWQiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo4MjQzXC90b2tlbiIsImV4cCI6MTYwMTk5NjY5OCwiaWF0IjoxNjAxOTkzMDk4fQ.cGdQ-9qK5JvKW32lK_PqhyJZyRb3r_86UPRFI2hlgiScnLYD8RsXDBNalmmnHiAbfb06e69QHQnmEKa6pcSSFWor0OAuzisBb6C5V51E9vH0eCr4hIa_lBtmjvLmsSue7puRUaYcyptwiuUkwjLFb-3_cpeuzWH29Knwne6zVD8gav_FPi1ub4vkrkX8ktLZH_JQG20fim1Ai5j2Q7jcnaMIHShYnC9sLBP5usp3thFLdQEyH8KCHJK79yNKzaruUntkq9yqqO_MQvY7VevLlDEDPllniRVih0r4TICdGrgJ0Ibr4wh_xFksVhYqa2_6x71ed_K9SX3hG-6T6pBUVA\",\n         \"token_type\":\"Bearer\",\n         \"expires_in\":3600\n      }\n      ```\n- A sample request to retrieve a consent looks as follows:\n```\ncurl GET \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- A sample response looks as follows:\n```\n{\n    \"Meta\": {\n        \"TotalPages\": 1\n    },\n    \"Risk\": {},\n    \"Links\": {\n        \"Self\": \"https://<IS_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID>\"\n    },\n    \"Data\": {\n        \"Status\": \"Authorised\",\n        \"StatusUpdateDateTime\": \"2020-10-07T12:46Z\",\n        \"CreationDateTime\": \"2020-10-07T09:29Z\",\n        \"TransactionToDateTime\": \"2020-10-09T10:28:49+05:30\",\n        \"ExpirationDateTime\": \"2020-10-11T10:28:49+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"41042513-fa45-4da8-93be-1513b3caffac\",\n        \"TransactionFromDateTime\": \"2020-10-06T10:28:49+05:30\"\n    }\n}\n```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0133_5",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0133_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports a \"Read Account Details\" endpoint, which is accessible via `GET /accounts/{AccountId}`.  This endpoint is part of the Account Information APIs and is designed to retrieve details for a specific account. \\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` repository includes a demo backend service, `AccountService.java`, which implements the `GET /accounts/{AccountId}` endpoint.  This service is configured in `cxf-servlet.xml` to handle requests to the `/accounts` path.  The `getOneAccount` method in `AccountService.java` extracts the `AccountId` from the path and constructs a JSON response containing mock account details.  \\n\\n## API Endpoints and Features\\n\\nThe API endpoint for reading account details is defined in the OpenAPI specification `account-info-swagger.yaml` as `GET /accounts/{AccountId}`.  This endpoint requires an `AccountId` as a path parameter and supports various headers such as `x-fapi-auth-date`, `x-fapi-customer-ip-address`, `x-fapi-interaction-id`, and `Authorization`.  The successful response for this endpoint is defined as `200AccountsAccountIdRead`, which returns an `OBReadAccount4` schema.   The endpoint is secured with `PSUOAuth2Security` and requires the `accounts` scope. \\n\\n## Configuration Options\\n\\nThe `financial-services-accelerator` uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class.  While the provided snippets do not show specific configuration options directly related to enabling or disabling the `/v1/card-accounts/{account-id}` endpoint, the system\\'s modular architecture and configuration management suggest that such endpoints would be managed through the API Manager extensions and potentially configured within `financial-services.xml`. \\n\\n## Documentation References\\n\\nThe `account-info-swagger.yaml` file serves as the OpenAPI specification for the Account Information APIs, including the `GET /accounts/{AccountId}` endpoint.  This file details the endpoint\\'s parameters, responses, and security requirements.  Additionally, the \"Overview\" wiki page mentions \"Account Information APIs\" as one of the supported API categories. \\n\\n## Test Criteria\\n\\nIntegration tests verify the functionality of the account retrieval endpoints. For instance, the `EndToEndAccountFlowTest.groovy` includes a test case \"Verify Retrieving a Specific Account for a Authorised Consent\" which asserts that a `GET` request to `ConnectorTestConstants.ACCOUNT_SINGLE_PATH` (which resolves to `/accounts/{AccountId}`) returns a `200 OK` status code after a consent has been authorized.  The `AccountsRetrievalRequestBodyValidationTests.groovy` also contains tests for account retrieval with valid consent IDs, expecting a `200 OK` response. \\n\\n## Notes\\n\\nThe user\\'s prompt specifically asks about `GET /v1/card-accounts/{account-id}`. The provided codebase context shows support for `GET /accounts/{AccountId}`.  While the path prefix `/v1/card-accounts` is not explicitly found, the core functionality of retrieving account details by ID is present under `/accounts/{AccountId}`. It is possible that `/v1/card-accounts` is an alias, a different version, or a specific implementation detail not fully covered by the provided snippets. However, the `AccountService.java` and `account-info-swagger.yaml` clearly define and implement the retrieval of account details using an `AccountId`.  \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9f5d3869-7cc6-41ed-96e7-11c0d182125c\\n', 'id': 'lc_de695e8a-a18e-45e2-8e01-286a26f6f251'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0134",
      "requirement": {
        "requirement_id": "ATOM_074",
        "requirement_text": "The ASPSP must validate request syntax and TPP role semantics during payment initiation",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0134_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_2",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_3",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_4",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_5",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0135",
      "requirement": {
        "requirement_id": "ATOM_192",
        "requirement_text": "The Headers parameter in the Signature header is mandatory",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0135_1",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_2",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_3",
          "text": "## Inbuilt Gateway Enforcements\n\n- [Dynamic Client Registration Request Policy](../learn/dcr-request-policy.md)\n- [Dynamic Client Registration Response Policy](../learn/dcr-response-policy.md)\n- [Consent Enforcement Policy](../learn/consent-enforcement-policy.md)\n- [Dynamic Endpoint Policy](../learn/dynamic-endpoint-policy.md)\n- [MTLS Enforcement Policy](../learn/mtls-enforcement-policy.md)\n- [UK JWS Header Processing Policy](../learn/uk-jws-header-processing-policy.md)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_4",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_5",
          "text": "### MTLS Enforcement Policy\n\nMTLS Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires MTLS to be mandatory. It will perform the below tasks.\n\n- Mandates MTLS for the request using the request context\n- Mandates MTLS for the request when the transport certificate is sent as a header\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require MTLS enforcement. Find the details to create the policy below.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support or enforce the \"Headers\" parameter within a \"Signature\" header as a mandatory element. The provided context primarily focuses on OAuth2 and OpenID Connect (OIDC) implementations, including token management, signature validation for request objects, and SAML SSO, but there is no explicit mention or implementation detail regarding a \"Signature\" header with a mandatory \"Headers\" parameter.\\n\\n### Implementation Details \\nThe `wso2/product-is` repository includes functionality for validating signatures of OAuth2 request objects . This is demonstrated in `OAuth2RequestObjectSignatureValidationTestCase.java`, where tests are performed for signed and unsigned JWT request objects  . The `JWSHeader` class from the Nimbus JOSE + JWT library is used to build the header of a JSON Web Signature (JWS) . However, the tests do not specifically check for a \"Headers\" parameter within this `JWSHeader`  .\\n\\nAnother relevant area is DPoP (Demonstrating Proof of Possession) token binding, where `DPoPProofGenerator.java` handles the generation and validation of DPoP proofs . This involves parsing a `SignedJWT` and extracting its `JWSHeader` . While the header is accessed, there\\'s no indication of a mandatory \"Headers\" parameter within the DPoP context either .\\n\\n### Configuration Options \\nThe system allows for enabling or disabling the validation of request object signatures through the `setValidateRequestObjectSignature(true)` method on an `OpenIDConnectConfiguration` object . This configuration is then updated for a specific application . However, this setting pertains to the overall signature validation of the request object and does not provide granular control or mandate a specific \"Headers\" parameter within the signature itself .\\n\\n### API Endpoints or Features \\nThe `getAuthzRequestUrl` method is used to construct authorization request URLs, which can include a request object . The system then processes these requests, and if signature validation is enforced, it will redirect to an error page for invalid signatures . There are no specific API endpoints or features mentioned that explicitly handle or require a \"Headers\" parameter within a \"Signature\" header .\\n\\n### Documentation References \\nThe \"OAuth2 and OpenID Connect\" wiki page provides a comprehensive overview of the implementation of these protocols in WSO2 Identity Server . It details various aspects such as ID Token components, including the header, payload, and signature . While it mentions \"alg, typ, kid\" as part of the ID Token Header, it does not specify a mandatory \"Headers\" parameter within a \"Signature\" header . The FAPI conformance section also discusses allowed signature algorithms, but again, no mention of a mandatory \"Headers\" parameter .\\n\\n## Notes\\nThe query specifically asks about a \"Signature header\" containing a \"Headers parameter\". In the context of JWTs (JSON Web Tokens) and JWS (JSON Web Signatures), the \"header\" itself contains parameters like `alg` (algorithm), `typ` (type), and `kid` (key ID). It\\'s possible the user is referring to a specific standard or profile that mandates a parameter named \"Headers\" within the JWT/JWS header, which is not explicitly covered in the provided codebase snippets. The existing code primarily deals with the overall signature validation of JWTs and DPoP proofs, where the standard JWT header parameters are implicitly handled.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_097aed74-773e-4a1b-b7c3-a007f335002d\\n', 'id': 'lc_01de195c-df9f-4d96-b139-3c85ba8fed40'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"I need to clarify your question to ensure I'm looking at the right system.\\n\\nBased on the codebase context provided (wso2/product-apim), you're asking about whether the WSO2 API Manager repository supports a requirement that **the `Headers` parameter in the `Signature` header must be mandatory**.\\n\\nThis appears to be related to HTTP signature authentication or webhook signature verification (possibly WebSub/WebHook signatures). However, the code snippets provided don't contain clear evidence of:\\n\\n1. A `Signature` header implementation with a `Headers` parameter\\n2. Validation logic that enforces the `Headers` parameter as mandatory\\n3. Configuration options for this requirement\\n4. API endpoints or features related to this\\n\\nThe closest relevant code I found is , which shows `signatureHeader` configuration for WebSub subscriptions, but this doesn't show the `Headers` parameter requirement you're asking about.\\n\\n**To properly answer your question, I would need:**\\n\\n- Code files that implement HTTP signature verification or webhook signature handling\\n- The actual signature validation logic\\n- Configuration schemas or DTOs that define the `Signature` header structure\\n- Test cases that verify the `Headers` parameter requirement\\n\\nCould you provide more context about:\\n1. Which feature or module this relates to (WebSub, OAuth, API Key validation, etc.)?\\n2. Are you looking for HTTP Signature (RFC 9421) support?\\n3. Any specific file paths or class names where this might be implemented?\\n\\n<cite/>\\n\\n## Notes\\n\\nThe provided snippets focus on general header handling, custom headers, and WebSub configuration, but don't contain the specific signature header validation logic you're asking about. Without more targeted code context, I cannot definitively confirm whether this requirement is implemented.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c6377a7d-c5ca-44ed-ab39-ccb61e5e28c1\\n\", 'id': 'lc_27a4a5bb-96ac-4246-8d89-8bbdf0936709'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0136",
      "requirement": {
        "requirement_id": "ATOM_086",
        "requirement_text": "TPP MUST submit OTP authentication data in Authorization-Update Request body when responding to SCA challenge",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0136_1",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_2",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_3",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_4",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_5",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, supports OTP authentication, including Email OTP and SMS OTP, which can be used as a second factor in authentication flows. The system allows for the submission of OTP data in the request body during an authentication challenge.  \\n\\n### Implementation Details\\nThe WSO2 Identity Server\\'s authentication framework includes multi-factor authenticators such as `TOTP Authenticator`, `SMS OTP Authenticator`, and `Email OTP Authenticator`.   These authenticators are integrated into the system\\'s architecture as part of the \"Authentication Framework\". \\n\\nFor Email OTP, the `ApplicationNativeAuthentication2FATestCase.java` demonstrates how an OTP is extracted from an email and then submitted in a POST request body to respond to an authentication challenge.  The `OTPCode` parameter is included in the `params` object within the `selectedAuthenticator` in the JSON request body.  Similarly, `PasswordLessEmailOTPAuthTestCase.java` shows the submission of an OTP via a POST request to the common authentication URL. \\n\\nFor SMS OTP, the `PasswordlessSMSOTPAuthTestCase.java` and `MockSMSProvider.java` illustrate the process of sending and receiving SMS OTPs. The `MockSMSProvider` captures the OTP from the SMS content.  The `PasswordlessSMSOTPAuthTestCase` then uses this OTP to perform user login. \\n\\n### Configuration Options\\nOTP authenticators can be configured within the WSO2 Identity Server. The `email_otp_config.toml` file shows configuration parameters for the Email OTP authenticator, such as `usecase`, `secondaryUserstore`, `EMAILOTPMandatory`, and `EmailOTPEnableByUserClaim`.  These configurations allow administrators to customize the behavior of the Email OTP authenticator. \\n\\nThe `modules/p2-profile-gen/pom.xml` file indicates the inclusion of various OTP-related features during the build process, such as `org.wso2.carbon.extension.identity.authenticator.totp.connector.feature.group`, `org.wso2.carbon.identity.authenticator.emailotp.feature.group`, and `org.wso2.carbon.identity.local.auth.smsotp.feature.group`.    This suggests that these OTP authenticators are modular components that can be enabled or disabled. \\n\\n### API Endpoints or Features\\nThe `ApplicationNativeAuthentication2FATestCase.java` uses a generic `getResponseOfJSONPost` method to send JSON POST requests to an endpoint, which is used for submitting OTP data.  The `href` variable in the test case likely represents the API endpoint for authentication updates. \\n\\nThe `PasswordLessEmailOTPAuthTestCase.java` sends OTP data to the `COMMON_AUTH_URL` endpoint.  This indicates a common authentication endpoint that handles OTP submissions as part of a multi-step authentication flow. \\n\\n### Documentation References\\nThe provided context does not include direct documentation references for TPP (Third Party Provider) specific requirements or API specifications for Authorization-Update Request bodies. However, the `Architecture` wiki page provides a high-level overview of the WSO2 Identity Server\\'s components, including the \"API Layer\" and \"Authentication Framework\", which would be relevant for understanding the overall system.  \\n\\n## Notes\\nThe provided code snippets are primarily integration tests, which demonstrate the functional aspects of OTP authentication within the WSO2 Identity Server. While they show how OTP data is submitted in request bodies, they do not explicitly define the \"Authorization-Update Request body\" in the context of a TPP responding to an SCA (Strong Customer Authentication) challenge with dynamic linking to transaction details. The term \"TPP\" is not explicitly mentioned in the provided code or wiki pages. The examples focus on native application authentication and passwordless authentication flows.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_131dd6d1-4e5f-45ef-9a97-c7f5379f1c4b\\n', 'id': 'lc_f7ae53ed-cb81-409a-9722-c651aea86757'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_d337faa7-1723-4476-8636-8b3a26ab6739'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0137",
      "requirement": {
        "requirement_id": "ATOM_006",
        "requirement_text": "The TPP certificate SHALL indicate all roles the TPP is authorised to use.",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0137_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the management of roles within Identity Providers (IdPs) and can be configured to handle role claims, which could be used to indicate TPP (Third Party Provider) roles like PISP, AISP, or PIISP. The system allows for the definition and mapping of roles within an IdP configuration, and these roles can be included in tokens.\\n\\n### Implementation Details\\nThe WSO2 Identity Server allows for the configuration of Identity Providers, including the management of claims and roles associated with them . Specifically, the `IdPSuccessTest.java` file demonstrates how to update and retrieve IdP claims and roles . The `testUpdateIdPRoles()` method shows how to update role mappings for an IdP, where `idpRole` can be mapped to a `localRole` . Similarly, `testGetIdPRoles()` retrieves these configured role mappings .\\n\\nThe system also supports provisioning policies based on user roles, as seen in `provisioning_role_based_policy_template.xml` . This XML policy defines rules to permit or deny provisioning requests based on whether a user possesses specific roles (e.g., `ROLE_1`, `ROLE_2`) . This indicates that roles are a fundamental concept within the system\\'s authorization and provisioning mechanisms.\\n\\n### Configuration Options\\nWhen configuring an Identity Provider, you can define `roleClaim` within the claims configuration . This `roleClaim` can have a `uri` that specifies where the role information is located . Additionally, role mappings can be configured, allowing `idpRole` values (such as PISP, AISP, PIISP) to be mapped to `localRole` values within the WSO2 Identity Server .\\n\\n### API Endpoints or Features\\nThe REST API for Identity Provider management includes endpoints for managing claims and roles. For instance, `IDP_API_BASE_PATH + PATH_SEPARATOR + idPId + PATH_SEPARATOR + IDP_CLAIMS_PATH` is used to update and retrieve IdP claims, including the `roleClaim`  . Similarly, `IDP_API_BASE_PATH + PATH_SEPARATOR + idPId + PATH_SEPARATOR + IDP_ROLES_PATH` is used for updating and retrieving IdP role mappings  .\\n\\nThe `OAuth2RoleClaimTestCase.java` demonstrates how role claims are handled within OAuth2 ID tokens . It shows that the ID token can be checked for role claims after roles are updated . This implies that the system can issue tokens containing role information, which is crucial for TPP certificates to indicate authorized roles.\\n\\n### Documentation References\\nThe \"Features and Capabilities\" wiki page for `wso2/product-is` provides an overview of the system\\'s capabilities, including \"Claim Management\" and \"Role Management\" under \"Identity Management Capabilities\"  . It highlights that WSO2 Identity Server provides flexible claim management capabilities, including defining local claims, mapping external claims, and supporting different claim formats . This general capability would extend to handling TPP roles within certificates.\\n\\n## Notes\\nThe provided code snippets and wiki page indicate that WSO2 Identity Server has robust features for managing roles and claims within Identity Providers, and these can be configured to be included in tokens. While the snippets do not explicitly mention \"TPP certificates\" or the specific roles \"PISP, AISP, PIISP\", the underlying mechanisms for role management, claim mapping, and token issuance are present and can be leveraged to meet the requirement. The `certificate` field in `add-oidc-idp.json`  and the `certificate.certificates` and `certificate.jwksUri` properties in `IdPSuccessTest.java`  suggest that certificate management is also a feature, which would be relevant for TPP certificates. The connection between the roles configured in the IdP and their inclusion in a TPP certificate would likely be handled through claim mapping and token customization.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e5d5436d-4472-4129-a620-f4ef54c108c0\\n', 'id': 'lc_c3b128ac-f093-43b9-af9a-a32ced530158'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0137_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"I appreciate your question, but I need to clarify what you're asking about. Based on the codebase context provided (which is from `wso2/product-apim` - WSO2 API Manager), I can see this repository contains:\\n\\n- Role management APIs and validation endpoints \\n- Certificate management for endpoints \\n- Role-based access control configurations \\n\\nHowever, your query is asking about **TPP (Third Party Provider) certificates** with specific role indicators like **PISP, AISP, PIISP** - these are terms from **PSD2 (Payment Services Directive 2)** and **Open Banking** specifications, not general API management.\\n\\n<cite/>\\n\\nThe WSO2 API Manager codebase I'm viewing does not appear to contain:\\n- TPP certificate-specific implementations\\n- PSD2/Open Banking role indicators (PISP, AISP, PIISP)\\n- Certificate role mapping for payment service providers\\n\\n**This is not in my current capabilities** - I cannot confirm whether this repository supports PSD2 TPP certificate requirements without access to code specifically implementing Open Banking or PSD2 compliance features. The role management and certificate APIs present are generic API management features, not PSD2-specific implementations.\\n\\n## Notes\\n\\nThe codebase shows generic role validation and certificate management, but these are for API endpoint certificates and user roles within API Manager, not for TPP certificates as defined in PSD2 specifications. You may need to check if WSO2 has a separate Open Banking or PSD2-specific product/module for this requirement.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6b4bef2e-568e-4010-a3bf-ea93fdf99196\\n\", 'id': 'lc_595bdb28-102f-4c77-aa09-314d265cf1ca'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0138",
      "requirement": {
        "requirement_id": "ATOM_193",
        "requirement_text": "The Headers parameter must include digest and x-request-id",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0138_1",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_2",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_3",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_4",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_5",
          "text": "### handleFilterRequest method\n\nThis method lets you modify the token request. Given below is the method signature.\n\n``` java\npublic ServletRequest handleFilterRequest(ServletRequest request) throws ServletException;\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'I\\'ve reviewed the codebase context provided, and I need to clarify your question to ensure I\\'m addressing the right concern.\\n\\n## Clarification Needed\\n\\nYour prompt asks about \"The Headers parameter must include digest and x-request-id\" as a requirement. However, based on my examination of the WSO2 Identity Server codebase (wso2/product-is), I cannot find evidence of:\\n\\n1. **`digest` header** - A standard HTTP header for message integrity verification\\n2. **`x-request-id` header** - A custom header for request tracking\\n\\nin the API implementations shown in the codebase context.\\n\\n## What I Found Instead\\n\\nThe codebase shows various header implementations across different REST APIs:\\n\\n\\n\\n\\n\\n\\n\\nThese implementations include standard headers like `Authorization`, `Content-Type`, and `User-Agent`, but **not** `digest` or `x-request-id`.\\n\\n## Next Steps\\n\\nTo help you effectively, I need clarification:\\n\\n1. **Are you asking about a specific API or feature** that should support these headers?\\n2. **Is this a requirement you\\'re implementing** that needs to be added to the codebase?\\n3. **Are you looking for existing support** for HTTP Signature authentication (which uses the `digest` header)?\\n\\n## Notes\\n\\nThe codebase I reviewed focuses on OAuth2, SCIM2, and REST API implementations for identity management. If you\\'re looking for support for request signing or request ID tracking, these features may not be currently implemented in the visible code, or they may be in a different module not shown in the provided context.\\n\\n<cite/>\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_da7d1b5d-58a2-4490-81a2-a353f119fee4\\n', 'id': 'lc_a112f9f5-a9ac-4aec-bd2d-b3131d918694'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"I need to clarify your question to provide an accurate answer.\\n\\nBased on the codebase context provided from the `wso2/product-apim` repository, I can see references to:\\n\\n1. **Digest authentication** - There are test cases and API configurations for digest authentication \\n\\n2. **Header handling** - The codebase includes header processing capabilities \\n\\nHowever, **I cannot find any evidence in the provided codebase context that supports a requirement for Headers parameter to include both `digest` and `x-request-id` together.**\\n\\nSpecifically:\\n- The digest authentication support exists, but it's for backend endpoint authentication, not as a header parameter requirement\\n- There is no mention of `x-request-id` header requirements in any of the provided snippets\\n- The header handling code shows generic header processing, not specific validation for these two headers\\n\\n**To properly answer your question, I would need:**\\n- Clarification on which API endpoint or feature you're asking about\\n- Whether this is a requirement for request headers, response headers, or both\\n- The specific API or module where this requirement should be implemented\\n- Any documentation or specification files that define this requirement\\n\\nCould you provide more context about where this requirement should be enforced?\\n\\n## Notes\\n\\nThe codebase does support digest authentication as an endpoint authentication type, but this is separate from the header parameter requirement you're asking about. The header processing infrastructure exists but doesn't show specific validation for `digest` and `x-request-id` headers together.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d1d1eb0b-aa90-412c-addf-4cbdec003ade\\n\", 'id': 'lc_133963ff-6fa1-4d48-bdc1-17cdc9e55461'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0139",
      "requirement": {
        "requirement_id": "ATOM_105",
        "requirement_text": "The payment-service path parameter SHALL accept values 'payments', 'bulk-payments', and 'periodic-payments'",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0139_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_2",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_3",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_4",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_5",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the `payment-service` path parameter with the values \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\' through its API definitions and internal service implementations. The `payment-initiation-openapi.yaml` defines the `/payments` endpoint, and the `PaymentService.java` handles payment submissions. The `ConnectorTestConstants.groovy` file also defines various payment-related paths, including those for domestic, scheduled, and standing order payments, which align with the \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\' concepts.\\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` repository implements payment services primarily through the `PaymentInitiationAPI` defined in `payment-initiation-openapi.yaml` . This OpenAPI specification details the API endpoints for payment initiation. The `PaymentService.java`  class, annotated with `@Path(\"/paymentservice/\")`, acts as the backend service for handling payment-related requests.\\n\\nThe `payment-initiation-openapi.yaml`  defines a `/payments` endpoint that accepts `POST` requests for creating payments. This endpoint is secured with `PSUOAuth2Security` and requires the `payments` scope . The `PaymentService.java`  contains a `paymentSubmission` method that handles `POST` requests to the `/payments` path, processing the incoming payment request and returning a response.\\n\\nWhile the `payment-initiation-openapi.yaml`  explicitly defines `/payments` and `/payment-consents`, the concepts of \\'bulk-payments\\' and \\'periodic-payments\\' are implicitly supported through various consent and submission paths defined in `ConnectorTestConstants.groovy` . These include paths for `domestic-scheduled-payment-consents`, `domestic-standing-order-consents`, `international-payment-consents`, `international-standing-order-consents`, `international-scheduled-payment-consents`, and `file-payment-consents`, which correspond to different types of bulk or periodic payments.\\n\\n## Configuration Options\\n\\nThe `financial-services.xml`  configuration file, used for Dynamic Client Registration (DCR), includes `payments` as an `AllowedValue` for a parameter, indicating that `payments` is a recognized service type within the system. This suggests that the system is configured to handle payment-related operations.\\n\\n## API Endpoints or Features\\n\\nThe `PaymentInitiationAPI`  provides the following key endpoints related to payments:\\n*   `/payment-consents`: Used for creating and retrieving payment consents .\\n*   `/payment-consents/{consentId}/funds-confirmation`: Used to get funds confirmation for a specific payment consent .\\n*   `/payments`: Used for submitting payments .\\n*   `/payments/{paymentId}`: Used for retrieving details of a specific payment .\\n\\nThe `ConnectorTestConstants.groovy`  defines various paths for different payment types, including `domestic-payment-consents`, `domestic-scheduled-payment-consents`, `domestic-standing-order-consents`, `international-payment-consents`, `international-standing-order-consents`, `international-scheduled-payment-consents`, and `file-payment-consents`. These paths indicate support for various payment services, including those that could be categorized as \\'bulk-payments\\' (e.g., `file-payment-consents`) and \\'periodic-payments\\' (e.g., `domestic-scheduled-payment-consents`, `domestic-standing-order-consents`).\\n\\n## Documentation References\\n\\nThe `Overview` wiki page for `wso2/financial-services-accelerator`  mentions that the solution supports multiple financial service use cases, including \"payment initiation\" . It also categorizes API specifications into \"Payment Initiation APIs\" , which include `PaymentConsents`, `Payments`, and `FundsConfirmation` . This aligns with the `payments` value for the `payment-service` parameter.\\n\\n## Test Criteria\\n\\nThe `ConsentMgtCoreServiceTests.java`  includes a test case `testGetConsentIdByConsentAttributeNameAndValue` that specifically checks for \"domestic-payments\" as a `payment-type` attribute value. This indicates that the system is designed to recognize and process different payment types. The `ConsentDataProviders.groovy`  also defines `PAYMENTS_TYPE` and `PAYMENT_CONSENT_PATH` for testing payment initiation, further supporting the existence of payment service validation.\\n\\n## Notes\\n\\nThe prompt specifically asks about a `payment-service` path parameter. While the `payment-initiation-openapi.yaml`  defines a `version` path parameter within the base path `/open-banking/{version}/pisp`, it does not explicitly define a `payment-service` path parameter with the exact specified values. However, the various API paths and constants related to different payment types (domestic, scheduled, standing orders, file payments) strongly suggest that the system handles these distinct payment services, which could be mapped to the requested `payment-service` values. The `PaymentService.java`  uses `/paymentservice/` as its base path, and then has sub-paths like `/payments` , which aligns with the `payments` value. The other values (\\'bulk-payments\\', \\'periodic-payments\\') are represented by distinct API paths and consent types within the system, as seen in `ConnectorTestConstants.groovy` .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2fe30c85-2a53-43fd-bdca-f80a00ab3eba\\n', 'id': 'lc_14508e97-a9f2-4b11-a531-8722ce45f5a7'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0140",
      "requirement": {
        "requirement_id": "ATOM_194",
        "requirement_text": "The Headers parameter must conditionally include psu-id if and only if PSU-ID is included as a header of the HTTP-Request",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0140_1",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0140_2",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"I cannot find evidence in the provided codebase that this repository supports the requirement you're describing.\\n\\n## Analysis\\n\\nYou're asking whether the WSO2 Identity Server repository supports conditional inclusion of a `psu-id` parameter in HTTP request headers based on whether a `PSU-ID` header is present in the incoming HTTP request. <cite/>\\n\\nThe codebase context provided shows extensive OAuth 2.0, OpenID Connect, SAML 2.0, and identity management capabilities, but there is no mention of:\\n\\n- A `psu-id` or `PSU-ID` header handling mechanism <cite/>\\n- Conditional header parameter logic based on incoming request headers <cite/>\\n- Any implementation details for this specific requirement <cite/>\\n\\nThe closest related concepts I found are:\\n\\n1. **Header handling in HTTP requests**: The codebase shows general HTTP header management (e.g., `Authorization`, `Content-Type`, `User-Agent` headers in test cases), but no specific logic for `PSU-ID` header processing. \\n\\n2. **Authenticator endpoint configuration**: The codebase shows endpoint authentication types (BASIC, BEARER) and properties, but not conditional header inclusion based on incoming request headers. \\n\\n## Notes\\n\\nThe `PSU-ID` header is typically associated with Open Banking standards (PSD2, etc.) for identifying Payment Service Users. If this is what you're looking for, you may need to check:\\n\\n1. A different repository or module specifically for Open Banking/PSD2 compliance\\n2. Custom extensions or plugins not shown in the provided codebase context\\n3. Configuration files or documentation not included in these code snippets\\n\\nI would need access to additional codebase sections, particularly around HTTP request/response interceptors, header processors, or Open Banking-specific modules, to provide a definitive answer.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_68bd4d90-652b-4c8e-9aa9-f20e283972dc\\n\", 'id': 'lc_bcfc5b4a-5555-4bc4-b553-919c28eea3c1'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0140_3",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"I cannot find evidence in the codebase that this repository supports the requirement you're describing. <cite/>\\n\\n## Analysis\\n\\nBased on my search through the `wso2/product-apim` repository, I found no implementation, configuration, or documentation related to:\\n\\n- Conditional inclusion of a `psu-id` parameter in HTTP headers\\n- Logic that checks for the presence of a `PSU-ID` header in incoming requests\\n- Any mechanism to conditionally propagate `PSU-ID` headers to downstream parameters\\n\\n<cite/>\\n\\n## What I Found Instead\\n\\nThe codebase contains general header handling capabilities:\\n\\n1. **Generic Header Addition Policy**: The repository includes an `addHeader` operation policy  that allows adding arbitrary headers to requests, but this is a static configuration mechanism, not conditional logic based on incoming headers.\\n\\n2. **Header Parameter Processing**: There is a `processHeaderParams` method  that processes header parameters, but it does not implement conditional logic for `psu-id`.\\n\\n3. **Header Mediator**: Documentation exists for a header mediator  that can set or remove headers, but again, this is static configuration without conditional logic based on request headers.\\n\\n<cite/>\\n\\n## Notes\\n\\nThe requirement you're describing appears to be related to PSD2 (Payment Services Directive 2) compliance, where `PSU-ID` (Payment Service User ID) is a standard header. However, I found no evidence that this repository implements the specific conditional logic you're looking for. The repository does support general header manipulation, but not the conditional propagation of `PSU-ID` based on its presence in the incoming request.\\n\\nIf this feature exists, it may be in a different repository or module not included in the provided codebase context, or it may need to be implemented as a custom policy or mediator.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_169c28f4-00cb-4c9a-b17a-ffbc76d2d20a\\n\", 'id': 'lc_a44bcb59-e507-4644-a325-e34de8e4b9b7'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0141",
      "requirement": {
        "requirement_id": "ATOM_092",
        "requirement_text": "Multiple SCA processes in multilevel authorization MAY be performed simultaneously",
        "strength": "MAY",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0141_1",
          "text": "as a Java Map in the Worker Java implementation. You can use these properties to implement the logic you want. 3. Worker Name - This is the name of the Worker. !!! note Provide the same name you configured in the `deployment.toml` file as the Worker name in the third step. !!! info You can implement multiple workers, give them different names, and use them in the adaptive authentication script. Below is a sample adaptive authentication script that uses this Worker extension: ``` java var psuChannel = \"Online Banking\"; var onLoginRequest = function (context) { publishAuthData(context, \"AuthenticationAttempted\", { psuChannel: psuChannel, }); executeStep(1, { onSuccess: function (context) { Log.info(\"Authentication Successful\"); publishAuthData(context, \"AuthenticationSuccessful\", { psuChannel: psuChannel, }); OBAuthenticationWorker(context, {}, \"psuAuthenticated\"); }, onFail: function (context) { Log.info(\"Authentication Failed\"); publishAuthData(context, \"AuthenticationFailed\", { psuChannel: psuChannel, }); OBAuthenticationWorker(context, {}, \"psuAuthenticated\"); }, }); OBAuthenticationWorker(context, {}, \"finalised\"); }; ``` !!! note To add these to one or more existing applications, log into the Carbon console as the super admin and update the script. Follow the steps in the [Adaptive Authentication - Overview](https://is.docs.wso2.com/en/latest/guides/adaptive-auth/configure-adaptive-auth/) documentation.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_2",
          "text": "## Writing a custom Gateway Executor\n\nThe WSO2 Open Banking Accelerator contains extension points known as Open Banking Executors that can validate and \nmanipulate API requests. The executors can mediate and enforce different policies based on regulatory and other \nrequirements. You can use the executors to perform the following: \n\n- Intercept requests and responses before and after API authentication \n- Modify request/response headers and payloads\n- Configure custom error messages\n- Add custom attributes. For example, data reporting  \n\nFor the executors, you can configure context attributes (for example, consent ID) provided by swagger definitions. \nThese context attributes are shared through a particular request/response flow. You can also define the order of \nexecution by the flow. \n\nTo build your own executor, implement the following interface:\n\n``` java\ncom.wso2.openbanking.accelerator.gateway.executor.core.OpenBankingGatewayExecutor\n```\n\n!!! note\n    The `com.wso2.openbanking.accelerator.gateway-3.0.0.jar` JAR file inside the \n    `<APIM_HOME>/repository/components/dropins` directory contains all the Java implementations related to gateway \n    executors.\n\nUse the following data model and implement the interface methods according to your requirements:",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_3",
          "text": "## Configuring a custom Push Authenticator  \n\n1. Once implemented, build a JAR file for your project.\n2. Place the above-created JAR file in the `<IS_HOME>/repository/components/dropins` directory.\n3. Open the `<IS_HOME>/repository/conf/deployment.toml` file and configure your custom authenticator using the Fully \nQualified Name (FQN):\n\n      ``` toml\n      [open_banking.sca.idp]\n      name = \"CIBA-Push-Auth\"\n      ```\n    \n4. Save the configurations and restart the Identity Server.\n5. Follow the [Set up CIBA flow](../learn/ciba-set-up-flow.md#configuring-authenticator) documentation and try out the \nflow.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_4",
          "text": "## Consent Authorization\n\n- Once you enter a properly constructed authorization request in your web browser, based on the `bank_code` in the \n  request object, you will be redirected to ABC bank or DCB Bank. \n\n- A bank customer needs to enter their credentials and sign in. \n    ![sign_in](../../assets/img/toolkit/regulatory-aggregator/sign-in.png)\n- Then redirected to the Aggregator's Account selection page.\n    ![account_selection](../../assets/img/toolkit/regulatory-aggregator/account-selection.png)\n- Once the bank customer selects the accounts they want to share, the whole consent agreement is displayed.\n    ![consent_agreement](../../assets/img/toolkit/regulatory-aggregator/consent-agreement.png)\n- Once the bank customer approves this consent, the aggregator will redirect you to the registered callback URL with an \n  authorization code in the query parameters.\n   ```\n   https://wso2.com/#code=1390032d-622f-3977-a976-923505035571&id_token=eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJhdWQiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwiY19oYXNoIjoiNXFNeEhhY0d2d2IxX2ZDT29GWmlNZyIsInN1YiI6ImFiY3VzZXJAY2FyYm9uLnN1cGVyIiwic19oYXNoIjoiOU9WMVpnRXVfWWExanFxU3hWelg1ZyIsImF6cCI6IngwVWkyR2k3YTVCNGp1cTdXcHdkcFdyTjlsRWEiLCJhbXIiOlsiQ3VzdG9tRmVkZXJhdGVkQXV0aGVudGljYXRvciJdLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0Ojk0NDZcL29hdXRoMlwvdG9rZW4iLCJleHAiOjE2NTM0ODI2ODAsImlhdCI6MTY1MzQ3OTA4MCwibm9uY2UiOiJqQlhoT21PS0NCIiwic2lkIjoiZmRlODZlMzMtNjljYi00ZTIwLTgxZTMtOTFiMDJhYjlmMjM3In0.OQmAuO3yH-Ap3bPzb1NpbbFN628BdIuKYZ6kZqeDRJwLK2Z5GqtO5P2VZpEoMlRSPi15Z0eg_8Uxv1ns1Na8djpIs1UyK2zK20HzHCZh4flpXlW0AMbvoxUUbAsfDzaH8r0xpzweA471vD0HX9rja2Xio0AhsP6VPJasBxC3jnAt9H9wjqB_qXYw8-TQwVPjkFONNgEZHQ44eJFRxK7Um5TOv1fHb6Ivz4URc0R91vL1LEyaIRy8w7afGePNDQn5BHObbfzwX6O4hI_jsUVeOybG0M3-ofhEwYcvkMuiMPsLeF2Oqa849bNNr11P75TajKV7ozUBo1UJquTs7VfSnA&state=0pN0NBTHcv&session_state=13831b535eebb5527056f57766e0b5a1d66caea43afbe041f75d27adcdb954f1.PNSwGdfigyA_dxaCi45fPA \n   ```\n   - The authorization code from the above URL is in the code parameter `1390032d-622f-3977-a976-923505035571`. \n   - Extract this code for the next step.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_5",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the concept of \"Rich Authorization Requests\" (RAR), which allows for multiple authorization details types to be associated with API resources and applications. While the provided context does not explicitly state that \"multiple SCA processes in multilevel authorization MAY be performed simultaneously,\" the framework for defining and managing multiple authorization details types suggests that concurrent authorization processes could be supported through the configuration of these types.\\n\\n## Implementation Details\\nThe core of this functionality revolves around `AuthorizationDetailsType` objects, which define different types of authorization details. These types are associated with API resources and applications.\\n\\n### Authorization Details Type Definition\\nAn `AuthorizationDetailsType` object has an `id`, `type`, `name`, `description`, and a `schema` to define its structure . The `type` field is a unique identifier for the authorization detail type .\\n\\n### API Resource Management\\nAPI resources can be created with a list of `AuthorizationDetailsType` objects . The `OAuth2RestClient` class provides methods to `addAuthorizationDetailsTypes`, `getAuthorizationDetailsType`, and `updateAuthorizationDetailsType` for a given API resource   .\\n\\n### Application Authorization\\nApplications can be authorized to use specific API resources and their associated authorization details types . The `AuthorizedAPICreationModel` is used to specify the API resource ID and a list of authorization details types that an application is authorized for . The `AuthorizedAPIResponse` object includes a list of `authorizedAuthorizationDetailsTypes` .\\n\\n## Configuration Options\\nThe configuration of multiple SCA processes would involve defining various `AuthorizationDetailsType` objects, each representing a distinct SCA process or a level in a multilevel authorization scheme.\\n\\n### Defining Authorization Details Types\\nYou can define multiple authorization details types, such as `TEST_TYPE_1`, `TEST_TYPE_2`, and `TEST_TYPE_3`, as seen in the `RichAuthorizationRequestsUtils` class . These types can then be associated with API resources.\\n\\n### Associating with API Resources\\nWhen creating an API resource, you can provide a list of `AuthorizationDetailsType` objects that it supports . This allows an API resource to declare its support for multiple authorization details.\\n\\n### Authorizing Applications\\nApplications can be granted authorization for specific `AuthorizationDetailsType` objects associated with an API resource . This means an application can be configured to handle multiple types of authorization details.\\n\\n## API Endpoints or Features\\nThe API layer provides endpoints for managing API resources and their authorization details.\\n\\n### API Resource Management Endpoints\\nThe `OAuth2RestClient` class interacts with API resource management endpoints. For example, `addAuthorizationDetailsTypes` uses an HTTP PUT request to an endpoint structured as `apiResourceManagementApiBasePath + PATH_SEPARATOR + apiId + AUTHORIZATION_DETAILS_TYPES_PATH` . Similarly, `getAuthorizationDetailsType` uses an HTTP GET request to retrieve a specific authorization detail type .\\n\\n### Application Authorization Endpoints\\nThe `addAPIAuthorizationToApplication` method in `OAuth2ServiceAbstractIntegrationTest` (which `OAuth2RichAuthorizationRequestsGrantTypesTestCase` extends) is used to authorize an application for specific API resources and their authorization details types . This suggests an API endpoint for managing application-specific authorizations.\\n\\n## Documentation References\\nThe provided wiki page \"API Layer\" describes the overall API architecture, including API organization, versioning, and authentication/authorization mechanisms . While it doesn\\'t specifically detail \"Rich Authorization Requests\" or \"SCA processes,\" it lays the groundwork for understanding how new API features are integrated. The API Layer supports both Server APIs for administrative tasks and User APIs for self-service operations .\\n\\n## Concurrent Authorization Processes\\nThe presence of methods like `getDoubleTestAuthorizationDetails()` and `getTripleTestAuthorizationDetails()` in `RichAuthorizationRequestsUtils`   indicates that the system is designed to handle multiple authorization details simultaneously within a single request. The `testHybridFlowsWithAuthorizationDetails` method in `OAuth2RichAuthorizationRequestsGrantTypesTestCase` demonstrates how multiple authorization details can be included in an authorization request and processed . This suggests that the system can process multiple authorization details concurrently rather than requiring sequential completion.\\n\\n## Notes\\nThe term \"SCA processes\" is not explicitly found in the provided code snippets. However, the concept of \"Rich Authorization Requests\" and the ability to define and manage multiple \"Authorization Details Types\" strongly align with the idea of supporting multiple authorization processes, potentially including Strong Customer Authentication (SCA) in a multilevel authorization context. The integration tests demonstrate the handling of multiple authorization details within a single flow, implying concurrent processing rather than strict sequential completion.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-m_cb6d1e38-bfd7-4de5-bb23-958ff80c3d9f\\n', 'id': 'lc_9ae643f5-b699-425e-be9b-52e6078a54e0'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_9837803d-ee64-4296-9110-94e73a06c5e6'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0142",
      "requirement": {
        "requirement_id": "ATOM_197",
        "requirement_text": "No other entries beyond the specified mandatory and conditional headers may be included in the Headers parameter",
        "strength": "MAY",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0142_1",
          "text": "#### Policy Attributes\n\n| Attribute Name              | Display Name                                                        | Description                                                                                         | Required | Type    | Example Values                  |\n|-----------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|----------|---------|--------------------------------|\n| transportCertAsHeaderEnabled | Is the Transport Certificate Present as a Header in the Request?    | Switch to determine if the transport certificate is sent as a header in the request                | false    | Boolean |                                |\n| transportCertHeaderName     | Transport Certificate Header Name                                   | The name of the transport certificate header                                                       | false    | String  | x-wso2-client-certificate       |\n| isClientCertificateEncoded  | Is the Transport Certificate Present as a Header in the Request Encoded? | Switch to determine if the transport certificate sent as a header in the request is encoded | false    | Boolean |                                |",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_2",
          "text": "## Inbuilt Gateway Enforcements\n\n- [Dynamic Client Registration Request Policy](../learn/dcr-request-policy.md)\n- [Dynamic Client Registration Response Policy](../learn/dcr-response-policy.md)\n- [Consent Enforcement Policy](../learn/consent-enforcement-policy.md)\n- [Dynamic Endpoint Policy](../learn/dynamic-endpoint-policy.md)\n- [MTLS Enforcement Policy](../learn/mtls-enforcement-policy.md)\n- [UK JWS Header Processing Policy](../learn/uk-jws-header-processing-policy.md)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_3",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_4",
          "text": "### MTLS Enforcement Policy\n\nMTLS Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires MTLS to be mandatory. It will perform the below tasks.\n\n- Mandates MTLS for the request using the request context\n- Mandates MTLS for the request when the transport certificate is sent as a header\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require MTLS enforcement. Find the details to create the policy below.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_5",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, demonstrates how HTTP headers are constructed and used in various REST client implementations for API interactions. The provided code snippets show that headers are explicitly defined and populated, suggesting that only specified headers are included in requests. There are no explicit configuration options or API features that directly enforce a strict \"no other entries beyond specified mandatory and conditional headers\" policy at a global level. However, the implementation details of the REST clients indicate a controlled construction of header lists.\\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository contains several REST client implementations that define how HTTP headers are constructed for outgoing requests. These clients typically create an array of `Header` objects and populate them with specific `BasicHeader` instances.\\n\\nFor example, in `OAuth2RestClient.java`, the `getHeaders()` method creates a `Header` array of size 3 and populates it with `USER_AGENT_ATTRIBUTE`, `AUTHORIZATION_ATTRIBUTE` (for basic authentication), and `CONTENT_TYPE_ATTRIBUTE` . Similarly, `getHeadersWithBearerToken()` also creates a `Header` array of size 3, including `USER_AGENT_ATTRIBUTE`, `AUTHORIZATION_ATTRIBUTE` (for bearer token), and `CONTENT_TYPE_ATTRIBUTE` .\\n\\nOther REST clients, such as `SCIM2RestClient.java` , `UserStoreMgtRestClient.java` , `APIResourceManagementClient.java` , `ActionsRestClient.java` , and `OrgMgtRestClient.java` , follow a similar pattern of explicitly defining the headers to be sent. This explicit construction implies that only the headers specified in these methods will be included in the outgoing HTTP requests.\\n\\nThe `RestBaseClient.java` class, which is extended by many of these REST clients, provides methods like `getResponseOfHttpGet()` that accept a `Header[]` array as a parameter . The `HttpGet` object then has its headers set using `request.setHeaders(headers)` . This mechanism ensures that only the headers provided by the calling methods (like `getHeaders()` or `getHeadersWithBearerToken()`) are included in the request.\\n\\n### Configuration Options\\n\\nThere are no explicit configuration options found in the provided snippets that allow a user to define a whitelist or blacklist of headers to enforce the \"no other entries\" requirement. The control over headers appears to be at the code implementation level within each REST client.\\n\\n### API Endpoints or Features\\n\\nThe API Layer wiki page describes various API categories and endpoints, but it does not mention any specific API endpoints or features designed to validate or restrict additional headers beyond mandatory and conditional ones . The focus of the API Layer documentation is on API organization, versioning, authentication, and error handling.\\n\\n### Documentation References\\n\\nThe provided context does not include specific documentation references that directly address the policy of disallowing extra headers in the `Headers` parameter. The API Layer wiki provides a high-level overview of the API architecture and implementation , but it does not delve into the granular details of header validation policies.\\n\\n## Notes\\n\\nThe user\\'s query asks about a \"MAY\" requirement strength, implying that the system *may* support this behavior. Based on the explicit construction of headers in the REST client implementations, it is highly probable that only the intended headers are sent. However, without a dedicated validation layer or configuration, it\\'s not possible to definitively state that the system actively *rejects* requests with additional, unspecified headers if they were to be sent by a client not using these specific internal REST clients. The provided code snippets are primarily from integration tests, which demonstrate how the system *sends* requests, not necessarily how it *validates* incoming request headers from external clients.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-n_4a0da49c-9ee5-4ba4-8d83-abd779dbec45\\n', 'id': 'lc_2089c14a-de4d-4d4c-b210-35ba7642ab46'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the specification of mandatory and conditional headers, and it appears to allow only explicitly defined headers in certain contexts. The OpenAPI specifications for various APIs within the repository define specific headers that are accepted for requests and returned in responses. Additionally, there are mediation policies that allow for adding or removing headers, which implies a level of control over what headers are processed.\\n\\n### Implementation Details and API Endpoints\\n\\nThe OpenAPI specifications, such as those found in `all-in-one-apim/modules/integration/tests-common/clients/admin/api/openapi.yaml`  and `all-in-one-apim/modules/integration/tests-common/clients/store/api/openapi.yaml` , explicitly list expected headers like `Accept`, `If-None-Match`, `If-Modified-Since`, `Content-Type`, `If-Match`, and `If-Unmodified-Since`. These definitions indicate that the API expects a predefined set of headers. For example, the `openapi.yaml` for the admin client defines `Accept`, `If-None-Match`, and `If-Modified-Since` as request headers . Similarly, the store client\\'s `openapi.yaml` defines `X-WSO2-Tenant` and `If-None-Match` .\\n\\nThe `ApiClient.java` file in `all-in-one-apim/sample-scenarios/clients/store/src/main/java/org/wso2/carbon/apimgt/samples/utils/store/rest/client/ApiClient.java`  contains a `processHeaderParams` method that iterates through a map of header parameters and adds them to a request builder. This method also checks if default headers are already present before adding them, suggesting a controlled approach to header management .\\n\\n### Configuration Options\\n\\nThe system provides configuration options for managing headers, particularly for Cross-Origin Resource Sharing (CORS). The `api-manager.xml` configuration file, seen in `all-in-one-apim/modules/integration/tests-integration/tests-backend/src/test/resources/artifacts/AM/configFiles/revokejwttest/api-manager.xml` , includes a `<CORSConfiguration>` section. This section allows enabling/disabling CORS headers and defining specific headers like `Access-Control-Allow-Origin`, `Access-Control-Allow-Methods`, and `Access-Control-Allow-Headers` . This explicitly defines which headers are allowed in CORS responses.\\n\\nMediation policies, such as `apkAddHeader_v1.json`  and `addHeader_v2.json` , allow administrators to add new headers to requests or responses. These policies specify `headerName` and `headerValue` as required attributes, with validation regexes for their values . This indicates that while headers can be added, it\\'s done through a controlled policy mechanism rather than arbitrary inclusion.\\n\\n### Documentation References\\n\\nDocumentation for the \"Header Mediator\" is available in `api-control-plane/docs/xdoc/mediators/header.xml` , `gateway/docs/xdoc/mediators/header.xml` , and `all-in-one-apim/docs/xdoc/mediators/header.xml` . These documents describe how the header mediator can be used to set or remove specified headers from the current SOAP info-set . The syntax for the header mediator explicitly shows `name` and `action` attributes, where `action` can be \"set\" or \"remove\" . This further supports the idea that header manipulation is a controlled process.\\n\\n### Test Criteria\\n\\nThe `CORSHeadersTestCase.java`  demonstrates testing for specific CORS headers. It asserts the presence and values of `Access-Control-Allow-Origin`, `Access-Control-Allow-Methods`, and `Access-Control-Allow-Headers` . It also explicitly asserts that `Access-Control-Allow-Credentials` should *not* be present if certain conditions are met . This test case verifies that only allowed headers are included, aligning with the requirement.\\n\\nThe `CustomHeaderTestCase.java`  further illustrates this by testing that when a custom authorization header is configured, using the default \"Authorization\" header results in an unauthorized response. This implies that the system enforces the use of specified headers and rejects others .\\n\\n## Notes\\n\\nThe provided snippets strongly suggest that the `wso2/product-apim` repository supports the control and validation of headers, allowing only specified mandatory and conditional headers in various contexts. This is evident through explicit OpenAPI definitions, configurable CORS settings, mediation policies for header manipulation, and dedicated test cases that verify header behavior. The \"MAY\" requirement strength is met as the system provides mechanisms to enforce this behavior.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-n_78594b43-9ce9-420e-99af-3f16e99d1685\\n', 'id': 'lc_2a4ad12d-cfb9-42ae-9444-e8c272529b33'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0143",
      "requirement": {
        "requirement_id": "ATOM_203",
        "requirement_text": "OAuth2 response type 'code' is recommended for authorization requests",
        "strength": "RECOMMENDED",
        "capability": "Authentication",
        "section_id": "13.1",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "unknown",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0143_1",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0143_2",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0143_3",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0143_4",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0143_5",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0144",
      "requirement": {
        "requirement_id": "ATOM_025",
        "requirement_text": "TPPs SHOULD send PSU context data elements in all request messages within payment initiation or consent initiation transaction flows for enhanced risk management",
        "strength": "SHOULD",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0144_1",
          "text": "### Initiate a consent\n\nPlease refer to the Step 1 and 2 in the [try-out-flow.md](..%2Fget-started%2Ftry-out-flow.md) for the more information on initiation of the consent.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0144_2",
          "text": "## Assumptions\n- User's mobile number should be configured.\n- Users will receive the notification as web links to authenticate and authorize the consent.\n- For multiple users involved scenarios, Identity server will assume only one user is authenticated (ID Token will contain the details of only one user (Ex: Primary user) ) and the OB consent tables will contain the authentication status of other users. (This user's identity can be customised by extending and overriding `OBCibaResponseTypeHandler.issue()` method.)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0144_3",
          "text": "## Multi auth user flows\n\nFor example of multi authorisation flow, we can think joint account scenario where all the users need to approve the consent. Below steps are mainly involved for multi auth user flows,\n\n- Sending CIBA request with login_hint.\n- Identifying multiple users involved in the CIBA request using the given `login_hint`.\n- Sending auth weblinks via SMS for **each** user.\n- Access token can **only** be retrieved after all users have approved the consents.\n- Currently `getAuthenticatedUsers()` method is identifying list of users (Ex: `admin@wso2.com, ann@wso2.com`) , However this can be customised to identify users based on any input (Ex: Bank account number etc.)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0144_4",
          "text": "### MTLS Enforcement Policy\n\nMTLS Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires MTLS to be mandatory. It will perform the below tasks.\n\n- Mandates MTLS for the request using the request context\n- Mandates MTLS for the request when the transport certificate is sent as a header\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require MTLS enforcement. Find the details to create the policy below.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0144_5",
          "text": "### Authorization Request\n\nWSO2 Open Banking Accelerator supports the following security features and fulfil FAPI requirements \nduring Authorization flows:\n\n  - OIDC Hybrid Flow\n    - Request object verification\n    - Pushed Authorization Request validation\n    - Pairwise Identifier support for ID tokens\n  - Authorization Code Flow\n    - When a request object is not available, support authentication mechanisms such as PKCE\n\nYou can use the provided extension points and customize the authorization flows. For more information, refer to the\n[Authorization Flow Customization](../develop/keyid-provider.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0144_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the inclusion of PSU (Payment Services User) context data elements in payment initiation and consent initiation transaction flows, particularly through its OAuth2/OIDC implementation and API resource management features. The system allows for defining and managing authorization details types, which can include information relevant to payment initiation.\\n\\n## Implementation Details\\n\\nThe `wso2/product-is` repository includes a class `AuthorizationDetailsType`  that defines a structure for authorization details, including a `type` field that can be set to \"payment_initiation\" . This suggests that the system is designed to handle specific types of authorization details, such as those related to payment initiation. The `schema` property within `AuthorizationDetailsType`  can be used to define the structure of the data, which could include PSU context data elements like IP address, user agent, or device ID.\\n\\nThe `OAuth2RichAuthorizationRequestsTestCase`  demonstrates how API resources can be registered with these authorization details types. For instance, the `testRegisterApiResourceWithAuthorizationDetails` method  registers an API resource with predefined `AuthorizationDetailsType` objects. This indicates that the system can associate specific authorization requirements, potentially including PSU context data, with API resources.\\n\\nThe `catalina-server.xml.j2` template  shows the configuration of a `RemoteIpValve`, which can extract client IP addresses from request headers. This suggests that the system is capable of capturing and processing client IP addresses, which is a type of PSU context data.\\n\\n## Configuration Options\\n\\nThe `AuthorizationDetailsType` class allows for flexible configuration of the schema for authorization details . This schema can be customized to include specific PSU context data elements required for risk management.\\n\\nThe `RemoteIpValve` in `catalina-server.xml.j2`  can be configured with `remoteIpHeader`, `protocolHeader`, and `proxiesHeader` to correctly identify the client\\'s IP address, even when requests pass through proxies.\\n\\n## API Endpoints or Features\\n\\nThe system exposes API endpoints for managing API resources and their associated authorization details. The `OAuth2RichAuthorizationRequestsTestCase`  interacts with these endpoints to create, retrieve, and update API resources with authorization details. The `oidcMetadataEndpoints` also expose `authorization_details_types_supported` , indicating that the system advertises its capabilities regarding authorization details.\\n\\nWhile not explicitly shown in the provided snippets, the presence of `sendPOSTConsentMessage` in `Utils.java`  and `sendApprovalPostWithConsent` in `OAuth2ServiceAbstractIntegrationTest.java`  suggests that there are mechanisms for handling consent flows, which are integral to payment initiation. These methods handle `sessionDataKey` and `consentClaims`, implying that additional data can be passed during the consent process.\\n\\n## Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\"  provides a comprehensive overview of the OAuth2 and OIDC implementation, including supported grant types and token management. The \"Integration Tests\" wiki page  details the testing framework, which includes tests for OAuth2/OIDC functionality and consent management.\\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests, which demonstrate the functionality of the system rather than being the core implementation itself. However, these tests provide strong evidence of the system\\'s capabilities. The `AuthorizationDetailsType` class, with its `type` and `schema` properties, is a key component for supporting flexible authorization requirements, including the inclusion of PSU context data. The `RemoteIpValve` configuration further supports the capture of client-side information.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_542d59fc-cec5-4311-b566-a42e5814db9b\\n', 'id': 'lc_416846e4-9fe8-4664-a4f9-cccbbcc84ad7'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0144_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the inclusion of PSU (Payment Services User) context data elements like IP address and device ID for risk management, primarily through its API Management capabilities and integration with an Open Policy Agent (OPA) engine. The system collects and uses certain personal information, including IP addresses and device IDs, for purposes such as detecting suspicious login attempts and providing personalized user experiences   .\\n\\n### Implementation Details\\n\\nThe WSO2 API Manager (API-M) collects personal information, including IP addresses and device IDs . This data is used for security purposes, such as detecting suspicious login attempts, and for providing a personalized user experience  . The collection of this information occurs through tracking technologies like HTTP requests, HTTP headers, and TCP/IP .\\n\\nA key feature for enhanced risk management is the \"Validate Request with OPA\" policy . This policy allows the API Gateway to extract predefined metadata from incoming requests and query an external Open Policy Agent (OPA) engine . The OPA engine then evaluates this metadata against configured policies to determine whether to allow or block the request .\\n\\n### Configuration Options\\n\\nThe OPA policy can be configured with `additionalProperties` . This attribute allows you to specify a comma-separated list of message context (request context) properties to be included in the OPA input payload . This mechanism can be used to send PSU context data elements like IP address, user agent, or device ID to the OPA engine for evaluation.\\n\\nOther configurable attributes for the OPA policy include:\\n*   `serverUrl`: The URL of the OPA server .\\n*   `accessKey`: An access key for the validation request, used if token authentication is enabled at the OPA server .\\n*   `policy`: The policy to be validated by OPA .\\n*   `rule`: The rule within the policy to validate .\\n*   `sendAccessToken`: A boolean to indicate whether to send the access token to the OPA payload .\\n\\n### API Endpoints or Features\\n\\nThe core feature enabling this is the \"Validate Request with OPA\" policy, which can be applied to API requests . This policy acts as an enforcement point where PSU context data can be sent to an external policy engine for real-time risk assessment during payment or consent initiation flows.\\n\\n### Documentation References\\n\\nThe `privacy-policy-content.jsp` files   describe how WSO2 API Manager captures and uses personal information, including IP addresses and device IDs. These documents explain the purpose of capturing this data, such as for detecting suspicious login attempts and providing personalized user experiences.\\n\\nThe `opaPolicy_v1.json` files    provide the specification for the OPA policy, detailing its attributes and how it functions to validate requests. The `description` field within these JSON files explains that the gateway extracts metadata from requests and queries OPA for validation . The `additionalProperties` attribute is particularly relevant as it explicitly mentions including \"message context (request context) properties\" in the OPA input .\\n\\n## Notes\\n\\nThe provided code snippets indicate that WSO2 API Manager has the capability to collect and process PSU context data. The integration with an Open Policy Agent (OPA) via the `opaPolicy` allows for externalized policy enforcement, where specific context data can be passed to OPA for risk assessment. While the snippets confirm the technical capability to send such data, the exact implementation of \"payment initiation or consent initiation transaction flows\" would depend on how these policies are applied to specific APIs within the API Manager. The `privacy-policy-content.jsp` files are primarily informational regarding data collection practices within the product itself, rather than direct implementation details for TPPs sending data. The `self-registration-username-request.jsp` and `self-registration-with-verification.jsp` files are related to user registration and do not directly address the sending of PSU context data in payment/consent flows. The `fips.bat` and `fips.sh` scripts, and `XMLSchema.xsd` are unrelated to the user\\'s query.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c81da69f-0998-431d-811b-3e951b0e138b\\n', 'id': 'lc_6e48f5ed-ddde-4a32-abb2-aa2b7d5bf23f'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0145",
      "requirement": {
        "requirement_id": "ATOM_103",
        "requirement_text": "ASPSP MAY return XML payment status in pain.002 format for XML-encoded payment initiation requests",
        "strength": "MAY",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0145_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_3",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_4",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_5",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, appears to support the processing of XML-encoded payment initiation requests, including the comparison of XML payloads for idempotency. However, there is no direct evidence within the provided snippets to confirm that the ASPSP (Account Servicing Payment Service Provider) *may* return payment status in `pain.002` XML format. The existing code primarily focuses on handling incoming XML for payment initiation and consent management.\\n\\n### Implementation Details\\nThe `IdempotencyValidator` class in `financial-services-accelerator/components/org.wso2.financial.services.accelerator.consent.mgt.extensions/src/main/java/org/wso2/financial/services.accelerator.consent.mgt.extensions/common/idempotency/IdempotencyValidator.java` includes a private method `isXMLPayloadSimilar()` . This method is designed to compare two XML payloads to determine if they are equal . It uses `DocumentBuilderFactory` to parse the XML strings into `Document` objects and then compares them using `isEqualNode()` . This indicates the system\\'s capability to process and understand XML structures.\\n\\nA test file, `IdempotencyValidatorTests.java`, contains a constant `FILE_UPLOAD_REQUEST_BODY` , which is an example of a `pain.001.001.08` XML message . This suggests that the system is designed to handle ISO 20022 XML formats for payment initiation.\\n\\n### Configuration Options\\nThe `IdempotencyValidator` can be configured to enable or disable idempotency validation and specify the idempotency header name . The wiki page on Consent Management also mentions `isIdempotencyValidationEnabled()` and `getIdempotencyHeaderName()` as configuration properties . While these configurations relate to idempotency, they do not specifically address the format of the *response* from the ASPSP.\\n\\n### API Endpoints or Features\\nThe `payment-initiation-openapi.yaml` file defines API endpoints related to payments . It specifies `application/json` and `application/jose+jwe` as content types for responses, but does not explicitly list `application/xml` or `pain.002` as a possible response content type for payment status . The `Status` field within the `obWritePaymentResponse5` schema indicates various payment statuses like \"AcceptedSettlementCompleted\" or \"Rejected\" , but this is within a JSON schema definition.\\n\\n### Documentation References\\nThe provided wiki page on \"Consent Management\"  details the architecture, authorization flows, and management APIs. It discusses external service integration and idempotency, including the handling of XML payloads for idempotency validation . However, it does not contain specific documentation regarding the ASPSP returning payment status in `pain.002` XML format.\\n\\nBased on the provided code snippets, the system has the capability to process XML, as evidenced by the `isXMLPayloadSimilar` method and the `pain.001.001.08` example. However, there is no explicit indication or configuration option that the ASPSP *may* return payment status in `pain.002` XML format. The `payment-initiation-openapi.yaml` primarily defines JSON responses for payment status.\\n\\n## Notes\\nThe prompt specifically asks about the ASPSP *returning* `pain.002` XML. While the codebase demonstrates the ability to *process* XML (specifically `pain.001.001.08` for initiation requests) for idempotency validation , there is no direct evidence in the provided snippets of the system generating or expecting `pain.002` XML as a response for payment status. The `payment-initiation-openapi.yaml`  defines JSON as the response format for payment status. Therefore, while the system can handle XML input, its support for XML output in `pain.002` format for payment status is not evident from the given context.\\n\\nWiki pages you might want to explore:\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_c6705770-8ada-47bd-a766-a98812c6ada9\\n', 'id': 'lc_dff9910b-f8b2-43c0-975c-c2c552851fe1'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0146",
      "requirement": {
        "requirement_id": "ATOM_027",
        "requirement_text": "TPP redirect URIs SHOULD comply with the domain secured by the eIDAS QWAC certificate in the CN or SubjectAltName fields",
        "strength": "SHOULD",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0146_1",
          "text": "Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a secure TLS channel and protect the transport layer communication from potential attackers on the network. WSO2 Open Banking Accelerator validates the following aspects of the QWAC if it is used for an API invocation: - The certificate is qualified, technically correct, and is not expired. - The PSD2 information in the certificate such as PSD2 roles, Authorization Number matches with the API being invoked. - The certificate is not revoked using CRL or Online OCSP validations. ####Qualified e-Seal Certificate (QSealC) QSealC seals application data and sensitive information to ensure that the origin of the document is trusted. WSO2 Open Banking Accelerator allows using QSealC as the signing certificates in application layer security to ensure protecting the data or messages from potential attackers during or after the communication. <hr> Generally, open banking flows always consist of 3 different types of API requests by the client applications. The following section lists the different security measures taken at each of the request types.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_2",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_3",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_4",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_5",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the management and validation of redirect URIs within its OAuth2/OpenID Connect implementation. However, there is no direct evidence in the provided snippets that explicitly links redirect URI validation to eIDAS QWAC certificate domains. The system does enforce that redirect URIs are registered and valid, and it includes mechanisms for handling invalid redirect URIs.   \\n\\n### Implementation Details\\n\\nThe WSO2 Identity Server, as implemented in this repository, manages OAuth2/OIDC applications, including their redirect URIs. The `OpenIDConnectConfiguration` model includes a `callbackURLs` property, which is a list of authorized redirect URIs for an application.  These URIs are used during the OAuth2 authorization flow. \\n\\nThe system performs validation on these redirect URIs. For instance, the `OAuth2PushedAuthRequestTestCase` demonstrates a test case where an \"invalid_redirect_URI\" leads to a `BAD_REQUEST` response.  Similarly, `ApplicationManagementOAuthFailureTest` includes tests for creating OAuth applications with no or empty redirect URIs, which also result in `BAD_REQUEST` errors.  The `OAuthDCRMTestCase` further confirms this by testing the registration of an OAuth app with an authorization code grant and no redirect URIs, expecting a 400 status code. \\n\\nThe `oidc-conformance-tests/config/browser_configuration.py` also contains test configurations that verify registered redirect URIs, indicating that the system checks if the provided redirect URI is registered.   \\n\\n### Configuration Options\\n\\nRedirect URIs are configured as part of the OAuth2/OIDC application registration. When creating or updating an application, a list of `callbackURLs` can be provided.  The `DCRTestCase` shows how `redirect_uris` are included in the Dynamic Client Registration (DCR) request JSON.  The `OAuth2CommonClient` also demonstrates how `redirect_uris` can be set or cleared when creating an OAuth2 application via the DCR endpoint. \\n\\n### API Endpoints or Features\\n\\nThe primary API endpoint for managing OAuth2/OIDC applications and their redirect URIs is the Dynamic Client Registration (DCR) endpoint. The `OAuth2CommonClient` constructs the DCR endpoint URL as `/api/identity/oauth2/dcr/v1.1/register`.  This endpoint is used to create and update OAuth2 applications, including their `redirect_uris`.  \\n\\nThe `OpenIDConnectConfiguration` class, used in the Application Management REST API, exposes `callbackURLs` as a property for OIDC applications. \\n\\n### Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" provides a high-level overview of the OAuth2 and OIDC implementation in WSO2 Identity Server.  It mentions \"Callback URLs\" as part of the \"Application Management\" integration point, indicating that these are configurable for OAuth2/OIDC clients. \\n\\nHowever, none of the provided snippets or the wiki page explicitly mention \"eIDAS QWAC certificate\" or validation of redirect URI domains against certificate fields (CN or SubjectAltName). While the system validates the presence and format of redirect URIs, there\\'s no direct evidence in the given context to confirm support for the specific eIDAS QWAC certificate domain compliance requirement.\\n\\n## Notes\\n\\nThe provided code snippets demonstrate robust handling of redirect URIs, including their registration, validation for existence and format, and error handling for invalid configurations. However, the specific requirement of complying with eIDAS QWAC certificate domains is not explicitly addressed in the provided context. It\\'s possible this functionality exists elsewhere in the codebase or is handled by an external component, but it cannot be confirmed from the given information. The `oidc-fapi-conformance-tests/constants_fapi.py` file defines `redirect_uris` for FAPI conformance tests, which are related to financial-grade APIs and often involve stricter security requirements, but it does not explicitly mention eIDAS QWAC certificate validation.   \\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_197d7ed2-e5d2-4280-a34b-6e518daff3c2\\n', 'id': 'lc_181bdcd7-43c4-47a4-9b80-bd55869d58cf'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"Based on the provided code snippets, this repository, `wso2/product-apim`, does not appear to directly support the specific requirement of verifying that TPP redirect URIs comply with the domain secured by the eIDAS QWAC certificate in the CN or SubjectAltName fields <cite/>. The snippets primarily deal with API endpoint certificates and general redirect mechanisms, but not the specific eIDAS QWAC certificate validation for TPP redirect URIs  .\\n\\n### Implementation Details and API Endpoints/Features\\nThe `APIEndpointCertificateTestCase.java` file contains integration tests related to uploading and searching API endpoint certificates . This test case interacts with `restAPIPublisher` to manage certificates, including methods like `getEndpointCertificiates` and `getendpointCertificateContent` . However, these operations are focused on the certificates used by the API endpoints themselves, not on validating TPP redirect URIs against eIDAS QWAC certificates . The `CertMetadataDTO` and `CertificateInfoDTO` objects are used to represent certificate information, including subject and validity  . There is no explicit mention of TPPs, eIDAS, or QWAC certificates in this context <cite/>.\\n\\nThe `SubscriptionWFHTTPRedirectTest.java` file demonstrates a test for HTTP redirects in a subscription workflow . This test checks if a custom subscription workflow response returns a redirect URI . While it involves redirect URIs, it does not relate to certificate-based domain validation for TPPs .\\n\\n### Configuration Options\\nThe `deployment.toml` file shows general server and API Manager configurations, including keystore settings . The `keystore.tls` section defines the filename, type, password, and alias for the TLS keystore . This is for the server's own certificates and not directly related to validating TPP redirect URIs against eIDAS QWAC certificates <cite/>.\\n\\nThe `Owasp.CsrfGuard.Carbon.properties` files in both `gateway` and `traffic-manager` modules contain configurations for CSRF protection, including actions for redirecting users upon attack detection  . These are security configurations for the application itself and do not pertain to the validation of TPP redirect URIs <cite/>.\\n\\n### Documentation References\\nNo specific documentation references related to TPP redirect URI validation against eIDAS QWAC certificates were found in the provided snippets <cite/>.\\n\\n## Notes\\nThe provided code snippets do not contain any direct evidence or implementation details regarding the validation of TPP-Redirect-URI and TPP-Nok-Redirect-URI domains against eIDAS QWAC certificate fields (CN or SubjectAltName) <cite/>. The `APIEndpointCertificateTestCase.java` deals with API endpoint certificates, which are different from TPP certificates . The other snippets are related to general application configuration and HTTP redirects, not the specific eIDAS QWAC certificate validation  . It is possible that this functionality exists elsewhere in the codebase not provided, or is handled by an external component or policy enforcement point <cite/>.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_7d87eac4-c9e7-4ca2-a6c3-05996cab7ff7\\n\", 'id': 'lc_06469580-10a4-4933-821f-0ff731c11754'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0147",
      "requirement": {
        "requirement_id": "ATOM_067",
        "requirement_text": "The system MAY add additional data attributes to response messages and MUST document such extensions in ASPSP XS2A interface documentation.",
        "strength": "MAY",
        "capability": "General",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0147_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the addition of extra data attributes to response messages, particularly within the context of application management and OAuth/OIDC configurations. These extensions are primarily handled through the API layer, which provides RESTful APIs for managing various aspects of the Identity Server. The documentation of such extensions would typically be found in the API\\'s Swagger/OpenAPI definitions. \\n\\n## Implementation Details\\n\\nThe system allows for additional data attributes through various models and configurations. For instance, the `AdvancedApplicationConfiguration` class includes a `List<AdditionalSpProperties> additionalSpProperties` field, which can be used to store extra properties for a Service Provider (SP) or application.   This indicates a mechanism for extending application configurations with custom data.\\n\\nIn the context of OAuth/OIDC, additional attributes can be configured for inbound protocols. For example, the `ApplicationManagementOAuthSuccessTest` demonstrates how to create and update OAuth applications with \"additional OIDC attributes\" such as `idTokenSignedResponseAlg`, `tokenEndpointAuthMethod`, and `requestObjectSigningAlg`.   These attributes are part of the OAuth inbound configuration and are handled by the API. \\n\\nThe `LocalClaimRes` class also shows how claims can have `subAttributes`, which could be a way to extend claim data.  This is further supported by the `scim2.yaml` Swagger definition, which defines `SchemasAttributeResponse` and `SchemasSubAttributeResponse` for attributes and their sub-attributes, allowing for flexible schema extensions.  \\n\\n## Configuration Options\\n\\nConfiguration options for additional data attributes are exposed through the REST APIs. For application management, the `AdvancedApplicationConfiguration` model allows setting various flags and lists, including `additionalSpProperties`.   The `ApplicationPatchTest` demonstrates how to update these advanced configurations using a PATCH request to the `/api/server/v1/applications/{applicationId}` endpoint. \\n\\nFor OAuth/OIDC specific extensions, the `INBOUND_PROTOCOLS_OIDC_CONTEXT_PATH` is used to configure additional OIDC attributes.  This is done via PUT requests to update the OAuth inbound details. \\n\\n## API Endpoints or Features\\n\\nThe primary API endpoint for managing application configurations, including additional data attributes, is `/api/server/v1/applications`.  This endpoint supports `POST` for creation, `GET` for retrieval, `PATCH` for partial updates, and `PUT` for full updates of application configurations.   \\n\\nSpecifically for OAuth/OIDC related extensions, the endpoint `/api/server/v1/applications/{applicationId}/inbound-protocols/oidc` is used.  This allows for detailed configuration of OIDC attributes. \\n\\nThe API Layer wiki page provides a general overview of the API architecture, including server APIs and user APIs, and mentions that the API layer is designed to be extensible. \\n\\n## Documentation References\\n\\nThe system relies on Swagger/OpenAPI definitions for API documentation. The `ExtensionManagementBaseTest` class references `extension-management.yaml` as the API definition for extension management.  Similarly, the `scim2.yaml` file defines the schema for SCIM attributes, including sub-attributes, which would document how data extensions are structured for SCIM-related operations.  These YAML files serve as the primary documentation for the API endpoints and the data models they use, including any extensions.\\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests and model definitions within the `wso2/product-is` repository. While these snippets demonstrate the capability to handle additional data attributes and their configuration through REST APIs, they do not directly show the ASPSP XS2A interface documentation. However, the presence of Swagger/OpenAPI definitions (`.yaml` files) suggests that these extensions would be documented within those specifications, which is a common practice for RESTful APIs. The test cases also imply that the system is designed to handle and process these additional attributes.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4a9d224c-09bc-4fb5-ba6d-1597423433de\\n', 'id': 'lc_9e2b75c4-7c16-485b-8b10-01c9f92140f1'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0147_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the addition of custom data attributes to response messages and provides mechanisms for documenting these extensions. The system leverages an XPath Extension Framework to allow for custom XPath variables and functions, which can be used to manipulate and expose additional data within the message context.  This framework enables developers to define and integrate custom data into the message flow. \\n\\n## Implementation Details\\n\\nThe core of extending data attributes lies within the XPath Extension Framework.  This framework allows for the implementation of custom XPath variables and functions. \\n\\n### Custom XPath Variables\\nTo implement a custom XPath variable, you need to create a Java class that implements the `org.apache.synapse.util.xpath.ext.SynapseXpathVariableResolver` interface.  This interface requires two methods: `getResolvingQName` to define the variable\\'s qualified name and `resolve` to provide the logic for resolving the variable\\'s value from the `MessageContext`.  An example of this is shown with the `HelloWorldXpathVariableResolver` class, which exposes an XML message as a custom XPath variable named `HELLO_WORLD`. \\n\\n### MessageContext Interface\\nThe `MessageContext` interface is central to message processing in Synapse, defining the per-message context passed through mediators.  Mediators can store local message properties into the `MessageContext` for subsequent retrieval.  The `MessageContext` provides access to the `SynapseConfiguration` and `SynapseEnvironments`. \\n\\n## Configuration Options\\n\\nExtensions are loaded from the runtime classpath using the J2SE Service Provider model.  This involves placing JAR files containing the extension implementations in the classpath, with a `META-INF/services` directory containing text files that list the fully qualified class names of the implementations. \\n\\n## API Endpoints or Features\\n\\nThe system supports documenting API extensions through its Publisher REST API.  The `APIM625AddDocumentationToAnAPIWithDocTypeSupportForumThroughPublisherRestAPITestCase` demonstrates adding documentation of type `SUPPORT_FORUM` with a `URL` source type to an API.  This indicates that custom data attributes and their usage can be documented and associated with specific APIs.\\n\\nThe `OASBaseUtils.java` file shows validation of Swagger extension data in the Publisher, including custom extensions like `x-wso2-auth-header`, `x-throttling-tier`, `x-wso2-basePath`, `x-wso2-cors`, `x-wso2-production-endpoints`, `x-wso2-sandbox-endpoints`, and `x-wso2-transports`.  This suggests that the system can handle and document custom extensions within the OpenAPI Specification (OAS) for APIs.\\n\\n## Documentation References\\n\\nThe `extensions_guide.xml` files in various modules (`all-in-one-apim`, `api-control-plane`, `traffic-manager`, `gateway`) provide detailed information on extending the system.     These documents specifically mention the \"Xpath Extension Framework\" and provide examples for implementing custom XPath variables and functions. \\n\\n## Notes\\n\\nThe provided snippets primarily focus on the WSO2 API Manager\\'s extensibility through Synapse\\'s XPath Extension Framework and its ability to document API-related information. The term \"ASPSP XS2A interface documentation\" is not explicitly found in the provided code context. However, the general mechanisms for adding and documenting extensions are present, which could be adapted to specific interface documentation requirements. The `deployment.toml` file shows configuration for application attributes and throttling, which are forms of data extensions, but not directly related to response messages.  \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_49c94085-ffbd-4efa-945d-673e9a0c01a1\\n', 'id': 'lc_6ed92885-f251-4fc5-a0ae-df0e440894a9'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0148",
      "requirement": {
        "requirement_id": "ATOM_022",
        "requirement_text": "ASPSPs MAY offer a signing-baskets endpoint to support grouping of several transactions for common authorisation process",
        "strength": "MAY",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0148_1",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0148_2",
          "text": "## Java based extensions (Old approach)\n\n- [Open Banking Gateway](open-banking-gateway.md)\n- [Open Banking Event Executor](custom-event-executor.md)\n- [Data Publishing](authentication-flow-for-data-publishing.md)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0148_3",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0148_4",
          "text": "### Account Information Service\n\nIf the API consumer application is aggregating account information on behalf of the bank user, the APP-to-APP redirection \nflow is as follows: \n\n[ ![](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Account Information Service, it is known as an Account Information Service Provider (AISP).\n\n| Implementation | Requirement | Participant |\n|----------------|-------------|-------------|\n| A- AISP requests the bank customer to identify the bank. | Required | AISP |\n| B- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | bank |\n| C- The customer consents to the accounts, which the AISP is allowed to have access | Required | Bank |\n| D- Confirms the completion of AIS request | Recommended | AISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0148_5",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0148_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase context, there is no direct support for a \"signing-baskets endpoint\" to group several transactions for a common authorization process. The WSO2 Identity Server primarily focuses on Identity and Access Management (IAM) functionalities, including OAuth2/OpenID Connect, SAML, and user management. \\n\\n### Implementation Details, Configuration Options, and API Endpoints\\n\\nThe codebase does not contain any explicit implementation, configuration options, or API endpoints related to \"signing-baskets\" or grouping transactions for authorization. The existing OAuth2 implementation handles various grant types  and token issuance , but these are for individual authorization requests rather than grouped transactions. \\n\\nThe `identity-default.xml` file shows configurations for supported OAuth grant types like `password`, `refresh_token`, `client_credentials`, and `saml2-bearer` . It also includes configurations for OpenID Connect, such as `IDTokenBuilder` and `UserInfoEndpointClaimDialect` . However, none of these relate to the concept of signing baskets. \\n\\nThe `Oauth2ImpersonationTestCase.java` demonstrates how access tokens are obtained and validated for individual authorization flows , but again, this is not related to grouping multiple transactions. \\n\\n### Documentation References\\n\\nThe provided wiki page \"Overview\" for `wso2/product-is` describes the general capabilities of WSO2 Identity Server, including its support for OAuth 2.0/OpenID Connect and various API layers . It details server and user API endpoints for managing applications, identity providers, and user profiles . However, there is no mention of \"signing-baskets\" or similar functionality within the documentation. \\n\\n## Notes\\n\\nThe concept of a \"signing-baskets endpoint\" is often associated with specific financial-grade APIs (FAPI) or PSD2 (Revised Payment Services Directive) requirements, which involve grouping payment transactions for a single authorization. While WSO2 Identity Server does support FAPI compliance , the provided codebase snippets do not indicate direct support for the \"signing-baskets\" feature as described. It\\'s possible that such functionality might be implemented as an extension or a separate module not visible in the provided context, or it might be a feature that needs to be developed.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_45e9e327-2a13-4eb1-a6f9-db7bf2f7d0a9\\n', 'id': 'lc_2ca73758-7147-45d0-a5de-e62deb758d35'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0148_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_8aaf7c27-217f-4172-b849-a2af2994e254'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0149",
      "requirement": {
        "requirement_id": "ATOM_002",
        "requirement_text": "The ASPSP SHALL follow NIST recommendations on cryptographical strength for cipher suite selections.",
        "strength": "SHOULD",
        "capability": "Security",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0149_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports NIST recommendations for cryptographic strength, particularly through its FIPS (Federal Information Processing Standards) compliance features and configurable cryptographic algorithms for SAML and OIDC protocols. The system allows for enabling and disabling FIPS mode, which involves managing Bouncy Castle FIPS-certified libraries. Additionally, various cryptographic algorithms for signing, digest, and encryption are configurable for SAML assertions and OIDC ID tokens.\\n\\n## Implementation Details\\n\\nThe `wso2/product-is` repository includes scripts to manage FIPS compliance, specifically by enabling or disabling FIPS mode. The `fips.bat`  and `fips.sh`  scripts handle the installation and removal of Bouncy Castle FIPS-certified JARs (e.g., `bc-fips*.jar`, `bcpkix-fips*.jar`, `bcutil-fips*.jar`) from the product\\'s `repository/components/lib` directory. These scripts also manage the non-FIPS Bouncy Castle JARs (`bcprov-jdk18on*.jar`, `bcpkix-jdk18on*.jar`) by moving them to and from a backup directory to ensure only the appropriate libraries are active. The scripts verify the integrity of downloaded FIPS JARs using SHA1 checksums .\\n\\nFor SAML, the system allows configuration of signing, digest, assertion encryption, and key encryption algorithms. These are defined in files like `saml-metadata-tenant.json`  and `saml-metadata-super-tenant.json` . Similarly, for OIDC, ID token encryption algorithms and methods are configurable, as seen in `default-identity.xml`  and `oidc-metadata.json` .\\n\\n## Configuration Options\\n\\n### FIPS Mode Configuration\\n\\nThe FIPS mode can be enabled or disabled using the `fips.sh`  (for UNIX) or `fips.bat`  (for Windows) scripts.\\n*   To enable FIPS mode, run the script without arguments or with specific arguments to provide local JAR paths or Maven repository URLs .\\n*   To disable FIPS mode, use the `DISABLE` argument .\\n*   To verify FIPS compliance, use the `VERIFY` argument .\\n\\n### Cryptographic Algorithm Configuration\\n\\nFor SAML, the following algorithms can be configured:\\n*   `responseSigningAlgorithm`: Options include `rsa-sha256`, `ecdsa-sha256`, `rsa-sha512`, etc. The default is `rsa-sha256` .\\n*   `responseDigestAlgorithm`: Options include `sha256`, `sha512`, `sha1`, etc. The default is `sha256` .\\n*   `assertionEncryptionAlgorithm`: Options include `aes256-cbc`, `aes128-gcm`, `aes256-gcm`, etc. The default is `aes256-cbc` .\\n*   `keyEncryptionAlgorithm`: Options include `rsa-oaep-mgf1p`, `rsa-1_5`, `rsa-oaep`. The default is `rsa-oaep-mgf1p` .\\n\\nFor OIDC, ID token encryption algorithms and methods are configured in `default-identity.xml` :\\n*   `IDTokenEncryptionAlgorithm`: Default is `RSA-OAEP`. Supported options include `RSA1_5` and `RSA-OAEP` .\\n*   `IDTokenEncryptionMethod`: Default is `A128GCM`. Supported options include `A128GCM`, `A192GCM`, `A256GCM`, `A128CBC-HS256`, and `A128CBC+HS256` .\\n\\n## API Endpoints or Features\\n\\nThe configuration of cryptographic algorithms is exposed through the application management APIs, as evidenced by the `saml-metadata-tenant.json`  and `oidc-metadata.json`  files, which are used in backend integration tests for the REST API for server application management. These JSON files define the available options and default values for cryptographic settings within SAML and OIDC service provider configurations.\\n\\n## Documentation References\\n\\nThe `README.txt`  file explicitly mentions \"Crypto Notice\" and lists cryptographic software used, such as Apache Rampart, Apache WSS4J, Apache Santuario, and Bouncycastle. It also refers to the WSO2 Identity Server documentation at `https://is.docs.wso2.com/en/6.0.0`  for further details, which would likely contain comprehensive information on security configurations and compliance.\\n\\n## Notes\\n\\nThe provided snippets indicate a strong focus on cryptographic security and compliance, particularly with FIPS. The `ciphertool.sh` script mentioned in `README.txt`  is used for encrypting sensitive elements and passwords, which is a related security feature, though not directly about cipher suite selection for communication protocols. The `UserStorePasswordEncryption.java`  file demonstrates the use of Bouncy Castle for decryption, further highlighting the reliance on this cryptographic library within the system.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6bfa8e41-7ca1-4658-a941-31bc399a75a5\\n', 'id': 'lc_366a1e09-dd58-4e8a-b6e2-d1f2b694f778'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0149_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"This repository, `wso2/product-apim`, appears to support NIST recommendations for cryptographic strength, specifically through its integration with FIPS (Federal Information Processing Standards) compliant Bouncy Castle libraries.  The presence of `fips.bat` and `fips.sh` scripts indicates mechanisms for enabling, disabling, and verifying FIPS compliance within the product.  Additionally, security policies defined in XML files specify `AlgorithmSuite` elements, which include `<sp:Basic256/>`, suggesting a baseline for cryptographic algorithms. \\n\\n## Implementation Details\\n\\nThe core implementation for NIST recommendations on cryptographic strength is facilitated by the integration of Bouncy Castle FIPS-certified libraries.  The `fips.bat` and `fips.sh` scripts manage the lifecycle of these libraries.  These scripts are responsible for downloading, verifying checksums, and placing the `bc-fips` and `bcpkix-fips` JARs in the appropriate `components/lib` directory.  They also ensure that non-FIPS compliant Bouncy Castle provider JARs (e.g., `bcprov-jdk` and `bcpkix-jdk`) are removed from various `bundles.info` files to enforce FIPS compliance. \\n\\nThe scripts define expected versions for the Bouncy Castle FIPS JARs, such as `BC_FIPS_VERSION=1.0.2.5` and `BCPKIX_FIPS_VERSION=1.0.7`.  Checksums are also defined to verify the integrity of the downloaded FIPS JARs. \\n\\n## Configuration Options\\n\\nThe FIPS mode can be enabled, disabled, or verified using command-line arguments passed to the `fips.bat` or `fips.sh` scripts. \\n*   To disable FIPS mode, you can pass `DISABLE` or `disable` as an argument. \\n*   To verify FIPS mode, you can pass `VERIFY` or `verify` as an argument. \\n*   If no arguments are passed, the script proceeds to enable FIPS mode. \\n\\nThe scripts also allow for specifying a custom path for the FIPS JARs using the `-f` argument, and a custom Maven repository using the `-m` argument, though the latter's usage is not fully detailed in the provided snippets. \\n\\nSecurity policies, such as those found in `scenario1-policy.xml`, define the `AlgorithmSuite` to be used.  For example, `<sp:Basic256/>` is specified, indicating the use of basic 256-bit encryption algorithms. \\n\\n## API Endpoints or Features\\n\\nThe provided snippets do not directly expose API endpoints related to cipher suite selection or NIST compliance. However, the FIPS enablement process affects the cryptographic providers used by the entire WSO2 API Manager product, which would implicitly impact any API endpoints or features relying on cryptographic operations.  The various `bundles.info` files referenced in the FIPS scripts (e.g., `api_publisher_bundles_info`, `api_devportal_bundles_info`, `api_key_manager_bundles_info`) suggest that FIPS compliance is enforced across different components of the API Manager. \\n\\n## Documentation References\\n\\nThe provided code snippets do not contain direct links to external documentation. However, the scripts themselves serve as a form of operational documentation for enabling and verifying FIPS compliance.  The copyright notice mentions WSO2 LLC and the Apache License, Version 2.0, which might point to WSO2's official documentation for further details on their FIPS compliance and cryptographic configurations. \\n\\n## Notes\\n\\nThe FIPS scripts are present in multiple modules (`api-control-plane`, `all-in-one-apim`, `gateway`) within the `wso2/product-apim` repository, indicating that FIPS compliance is a cross-cutting concern for the product.    The `scenario*-policy.xml` files demonstrate how cryptographic algorithm suites are declared within security policies, specifically using `<sp:Basic256/>`.  While these policies specify an algorithm suite, the actual enforcement of NIST recommendations for cipher suite selections would be handled by the underlying FIPS-compliant cryptographic provider (Bouncy Castle FIPS) once enabled. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_1f58ef39-c9da-4a2d-8c1a-6c3526947eb0\\n\", 'id': 'lc_8b2fc3b5-f3e1-41a0-bd19-04e7757656d7'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0150",
      "requirement": {
        "requirement_id": "ATOM_088",
        "requirement_text": "TPP SHOULD filter available SCA methods if not all authentication methods can be technically supported",
        "strength": "SHOULD",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0150_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0150_2",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0150_3",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0150_4",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0150_5",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0150_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support filtering of authentication methods, which could be leveraged for filtering SCA methods. The system uses an \"Authentication Framework\" that includes various authenticators, and its configuration files suggest that specific authentication methods can be enabled or disabled.  \\n\\n### Implementation Details\\n\\nThe WSO2 Identity Server\\'s \"Authentication Framework\" is a core component that manages various authentication mechanisms, including local, federated, social, and multi-factor authenticators.     The system\\'s architecture allows for the integration of various authenticators, which are essentially different methods of authentication.  The `pom.xml` file lists numerous authenticator dependencies, such as `org.wso2.carbon.identity.application.authenticator.basicauth.jwt` for basic authentication, `org.wso2.carbon.extension.identity.authenticator.outbound.emailotp` for email OTP, and `org.wso2.carbon.extension.identity.authenticator.outbound.totp` for TOTP.    These authenticators are packaged as features during the build process. \\n\\nThe system also includes \"Conditional authenticator functions\" which suggest a mechanism for dynamic control over authentication flows.  These functions, such as `org.wso2.carbon.identity.conditional.auth.functions.user` and `org.wso2.carbon.identity.conditional.auth.functions.notification`, could potentially be used to implement logic for filtering SCA methods based on technical support. \\n\\n### Configuration Options\\n\\nConfiguration files like `identity-default.xml` and `backupIdentity.xml` show how different authentication-related components are configured.   Specifically, within the `<OAuth>` section, there are `<ClientAuthHandlers>` and `<SupportedGrantTypes>` elements.   These sections list the authentication methods that are supported, such as `BasicAuthClientAuthHandler` for client authentication and various grant types like `authorization_code`, `password`, and `refresh_token`.   By modifying these configurations, it should be possible to enable or disable specific authentication methods, effectively filtering them.\\n\\nThe `OAuth2PKCETestCase.java` file demonstrates how OAuth2 application configurations can be updated, including settings related to PKCE (Proof Key for Code Exchange).  This suggests that authentication method support can be dynamically configured per application. \\n\\n### API Endpoints or Features\\n\\nThe \"API Layer\" of WSO2 Identity Server provides RESTful APIs for administration and user management.   While specific API endpoints for filtering SCA methods are not explicitly detailed in the provided snippets, the presence of \"Server APIs\" and \"Application Management API\" suggests that there are programmatic ways to manage application configurations, including supported authentication methods.   The `OAuth2PKCETestCase.java` file shows an example of updating application inbound configurations, which implies an API for managing these settings. \\n\\n### Documentation References\\n\\nThe provided context includes a wiki page on \"Architecture\" which gives a high-level overview of WSO2 Identity Server.  This wiki page mentions \"Configuration System\" and \"Authentication Framework\" as key components, which are relevant to understanding how authentication methods are managed and configured.   Further details on specific configuration options and API usage would likely be found in the official WSO2 Identity Server documentation, which is not part of this codebase context. <cite/>\\n\\n## Notes\\n\\nThe term \"SCA methods\" is not explicitly found in the provided codebase snippets. However, the codebase extensively covers various \"authentication methods\" and \"authenticators\" which are likely analogous to SCA methods in the context of strong customer authentication. The ability to configure and manage these authenticators, as seen in the `pom.xml` dependencies and `identity-default.xml` configurations, suggests that the system has the technical capability to filter and present only supported methods. The `OAuth2PKCETestCase.java` further supports this by showing how application-specific authentication configurations can be updated.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b184550e-d411-4e92-a17c-95c479266e44\\n', 'id': 'lc_dd22707c-de3c-4b94-b1ce-913a4aeaad9e'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0150_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_6f709b3e-06a4-437b-a106-b1a3af9e13d4'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0151",
      "requirement": {
        "requirement_id": "ATOM_055",
        "requirement_text": "The system MAY provide optional 'fundsAvailable' boolean data element in GET Status Response Message for ASPSPs not booking money directly from account.",
        "strength": "MAY",
        "capability": "Funds Confirmation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0151_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"Based on the provided codebase, there is no direct support for an optional `fundsAvailable` boolean data element in GET Status Response Messages for ASPSPs (Account Servicing Payment Service Providers) <cite/>. The codebase primarily focuses on Identity and Access Management (IAM) functionalities, including OAuth2/OpenID Connect, SAML, SCIM, and API management .\\n\\nThe provided snippets do not contain any references to financial services APIs, payment initiation, account information services, or specific data elements like `fundsAvailable` <cite/>. The `OpenIDConnectConfiguration` class, for instance, mentions FAPI (Financial-grade API) conformance, but this refers to security standards for financial APIs rather than specific data elements related to funds availability .\\n\\nTherefore, I cannot provide implementation details, configuration options, API endpoints, or documentation references for a `fundsAvailable` field within this repository <cite/>.\\n\\n## Notes\\n\\nThe user's query pertains to a specific data element (`fundsAvailable`) often found in financial services APIs, particularly in the context of Payment Initiation Service Providers (PISPs) or Account Information Service Providers (AISPs) interacting with ASPSPs <cite/>. While the WSO2 Identity Server codebase supports FAPI (Financial-grade API) conformance , which is a security standard relevant to financial services, it does not appear to implement the specific business logic or data models for financial transactions or funds availability checks <cite/>. The FAPI conformance mentioned in `OpenIDConnectConfiguration.java`  refers to the security profile for APIs, not the functional aspects of financial transactions <cite/>.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_65dbaa88-ccef-41d4-a334-908c50f3b240\\n\", 'id': 'lc_7ea23650-fc72-4990-812f-e89a044e3325'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0151_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not appear to directly support the specific `fundsAvailable` boolean data element in GET Status Response Messages as described in your query. The provided code snippets primarily relate to a sample JAX-RS application for a coffee shop (`StarbucksOutletServiceImpl.java` ), general API management configurations, and documentation for properties within the WSO2 API Manager.\\n\\n### Implementation Details\\nThe `StarbucksOutletServiceImpl.java`  contains a `doPayment` method that checks for \"Insufficient Funds\" . However, this is part of a sample service and returns a `PaymentStatus` object with a string message, not a `fundsAvailable` boolean in a GET status response . The `PaymentStatus` object itself does not seem to contain a `fundsAvailable` field based on the provided context. The `doPayment` method was last modified by dharshanaw on 2015-02-27 in commit [51351fe2](https://github.com/wso2/product-apim/commit/51351fe2).\\n\\n### Configuration Options\\nThe provided documentation snippets, such as `properties_guide.xml`  and `configuration_language.xml` , discuss generic properties and their usage within the WSO2 API Manager. These properties are for controlling message flow and behavior within the ESB, and there is no mention of a specific configuration option to enable or disable a `fundsAvailable` field in status responses  . These documents were last updated by Tharika Madurapperuma on 2025-02-08 in commit [cf0398ec](https://github.com/wso2/product-apim/commit/cf0398ec).\\n\\n### API Endpoints or Features\\nThe `PeopleRestService.java`  shows examples of REST endpoints for managing \"people\" resources, including `GET`, `POST`, `DELETE`, and `OPTIONS` methods . However, none of these endpoints or the associated features indicate support for a `fundsAvailable` boolean in their response messages. This file was last modified by dharshanaw on 2015-02-27 in commit [51351fe2](https://github.com/wso2/product-apim/commit/51351fe2).\\n\\n### Documentation References\\nThe provided documentation snippets do not contain any references to a `fundsAvailable` data element or similar functionality related to financial transactions or account status checks in the context of API responses  .\\n\\n## Notes\\nThe provided code snippets are primarily from integration tests and sample applications within the `wso2/product-apim` repository. While there is a `Payment` related service (`StarbucksOutletServiceImpl.java` ), it\\'s a simplified example and does not demonstrate the specific `fundsAvailable` boolean field in GET Status Response Messages as requested. The documentation focuses on general API management properties and configurations, not specific financial transaction response elements.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ded2472a-41c5-4275-a5ee-896124902bbe\\n', 'id': 'lc_5e9a9f1d-6f35-4cdb-bbfa-a4f9d9afc73f'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0152",
      "requirement": {
        "requirement_id": "ATOM_080",
        "requirement_text": "ASPSPs and TPPs should follow OAuth2 Security Best Practice definitions as defined in OA-SecTop",
        "strength": "SHOULD",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0152_1",
          "text": "### Authorization Request\n\nWSO2 Open Banking Accelerator supports the following security features and fulfil FAPI requirements \nduring Authorization flows:\n\n  - OIDC Hybrid Flow\n    - Request object verification\n    - Pushed Authorization Request validation\n    - Pairwise Identifier support for ID tokens\n  - Authorization Code Flow\n    - When a request object is not available, support authentication mechanisms such as PKCE\n\nYou can use the provided extension points and customize the authorization flows. For more information, refer to the\n[Authorization Flow Customization](../develop/keyid-provider.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0152_2",
          "text": "# API Security Open Banking allows API consumers to access financial data through open APIs, which requires greater API security. Therefore, open banking standards provide guidelines for security implementations so that only the intended party can access information that the customer has given prior consent. To achieve this, different specifications mandate security requirements via the relevant specification, which is built upon existing standards defined in OAuth 2.0 and OpenID specifications. The diagram below provides a brief idea of how certain specifications are built upon these specifications. ![fapi_strcutre](../assets/img/learn/api-security/fapi-structure.png) While some open banking specifications, such as the Open Banking Standard - UK and Consumer Data Standards - Australia mandated FAPI, others do not. However, regardless of your regional specification, WSO2 Open Banking Accelerator provides FAPI security standards because of the robust security standards offered by FAPI. ###MTLS enforcement Authentication is a crucial requirement in open banking to verify the authenticity of an API consumer before sharing the customer\u2019s banking information. When an API consumer invokes APIs, their private credentials can be shared in the requests, and it leads to credential leakages and data thefts. Therefore, Mutual Transport Layer Security (MTLS) is introduced as an authentication protocol where the API consumers do not need to send their private credentials. MTLS handshake at the transport layer ensures that the corresponding API consumer possesses a secret key that is associated with the X509 certificate issued by a trusted Certificate Authority (CA). In WSO2 Open Banking Accelerator, MTLS is enforced at the API Manager level to check if - the message context contains the transport certificate to make sure that the MTLS handshake is successful at the gateway - the transport certificate bound to the application when invoking the APIs There are two scenarios to consider for the MTLS validation: 1. If the client directly initiates an MTLS connection with the WSO2 API Manager Gateway, the issuer of the certificate needs to be present in the truststore of the gateway. 2. If the MTLS terminates at the load balancer prior to the gateway, the WSO2 API Manager Gateway expects the load balancer to send the client certificate as a header. In such scenarios, the WSO2 API Manager gateway expects the load balancer to perform the issuer validation. ###Certificate Revocation Validation A certificate is issued by a trusted organization commonly known as a CA. It is also known as a Trust Service Provider (TSP). These certificates are expected to be in use for their entire validity period. However, certain circumstances may cause a certificate to become invalid prior to the expiration of the validity period. For example, a compromise or suspected compromise of the corresponding private key may cause a certificate to become invalid prior to the expiration. A revocation request can originate from the National Competent Authority (NCA), which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0152_3",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0152_4",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0152_5",
          "text": "which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it is required to check whether a given certificate is revoked by its issuer. That can be done through two protocols: ####Certificate Revocation List (CRL) CRL is a list of digital certificates that have been revoked by the issuing CA. ####Online Certificate Status Protocol (OCSP) OCSP is an internet protocol used for obtaining the revocation status of a digital certificate based on the certificate serial number. The OCSP validation is faster compared to the CRL validation. By default, WSO2 Open Banking Accelerator verifies the revocation status of a certificate using the OCSP validation. If the OCSP validation is unsuccessful, the revocation status is verified using the CRL information. The certificate is rejected if none of these protocols is successful or if the required revocation information is not found on the certificate. ###Validate external API consumers This validation allows banks to validate API consumers from the NCAs. This is done by validating the transport layer certificate an API consumer has obtained. ###Role validation According to the [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), API consumers have roles for the services they provide. The API consumer\u2019s role is defined in the API consumer\u2019s transport certificate (QWAC certificate that they obtain from an NCA), which WSO2 Open Banking Accelerator checks in the API and Dynamic Client Registration flows. If the role exists in the transport certificate, WSO2 Open Banking Accelerator allows the API consumer to invoke the API. Following are the roles that an API consumer can have: | Role | Description | |---------|--------- | |Account Information Service Provider|Provides an online service by sharing information on payment accounts held by a payment service user with payment service providers.| |Payment Initiation Services Provider|Provides an online service to initiate a payment order at the request of the payment service user with respect to a payment account held at another payment service provider.| |Card-Based Payment Instrument Issuer|Issues card-based payment instruments that can be used to initiate a payment transaction from a payment account held with another payment service provider.| !!!tip An API consumer can have one or more roles. For example, if an API consumer provides an application to view account information as well as to initiate payments, the roles of the API consumer are **Account Information Service Provider** and **Payment Initiation Services Provider**. ###eIDAS The **electronic IDentification, Authentication and trust Services (eIDAS)** regulation provides unique identity schemas for individuals and businesses to access the publicly available online services in Europe. Among electronic Identification (eID) solutions, PSD2 recommends Qualified Website Authentication Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0152_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports several OAuth2 Security Best Practices, including FAPI conformance and DPoP, which are relevant to ASPSPs and TPPs as defined in OA-SecTop. The system provides configuration options for these features and includes integration tests to verify their implementation.\\n\\n## Implementation Details\\nWSO2 Identity Server implements various OAuth2 security features that align with best practices for ASPSPs and TPPs.\\n\\n### FAPI Conformance\\nThe system undergoes regular FAPI conformance testing, indicating its adherence to Financial-grade API specifications. This is explicitly mentioned in the \"OAuth2 and OpenID Connect\" wiki page . The FAPI conformance tests are defined in the GitHub Actions workflow file `fapi-oidc-conformance-test.yml` .\\n\\n### Demonstrating Proof of Possession (DPoP)\\nWSO2 Identity Server supports DPoP, which enhances token security by binding tokens to specific contexts . The `OAuth2DPopTestCase.java` file contains integration tests for DPoP, demonstrating its implementation . This test case includes methods for generating DPoP proofs and extracting key thumbprints .\\n\\n### Pushed Authorization Requests (PAR)\\nThe system supports Pushed Authorization Requests (PAR), which is another security best practice in OAuth2 . The `OAuth2PushedAuthRequestTestCase.java` file includes tests for PAR, such as sending PAR with invalid client IDs or without client IDs, and with invalid response types .\\n\\n### PKCE (Proof Key for Code Exchange)\\nPKCE support is available to mitigate authorization code interception attacks . The `OAuth2PKCETestCase.java` file demonstrates how PKCE is implemented and tested, including scenarios for mandatory PKCE and support for plain transformation algorithms  .\\n\\n## Configuration Options\\nWSO2 Identity Server provides various configuration options to enable and manage these security features.\\n\\n### Token Binding Configuration\\nToken binding, including DPoP, can be configured for applications. The `oidc-metadata.json` file shows options for `accessTokenBindingType`, which includes \"DPoP\" . The `UserDiscoverableApplicationServiceTestBase.java` file demonstrates how `AccessTokenConfiguration` can be set, including `bindingType` and `validateTokenBinding` .\\n\\n### Client Authentication Methods\\nThe `identity-original-530-cache-disabled.xml` file, along with other `identity.xml` configurations, specifies supported client authentication methods, such as `BasicAuthClientAuthHandler` . The `oidc-metadata.json` also lists various `tokenEndpointAuthMethods` like `private_key_jwt`, `tls_client_auth`, and `client_secret_basic` .\\n\\n### Signature and Encryption Algorithms\\nThe `oidc-metadata.json` file outlines configurable options for `tokenEndpointSignatureAlgorithm`, `idTokenSignatureAlgorithm`, `requestObjectSignatureAlgorithm`, `requestObjectEncryptionAlgorithm`, and `requestObjectEncryptionMethod` . These options allow for strong cryptographic practices. The `OAuth2RequestObjectSignatureValidationTestCase.java` file demonstrates the use of `JWSAlgorithm` and `JWSSigner` for request object signature validation .\\n\\n## API Endpoints or Features\\nSeveral API endpoints and features contribute to OAuth2 security best practices.\\n\\n### OAuth2/OIDC Endpoints\\nThe `identity-original-530-cache-disabled.xml` file defines various OAuth2 and OIDC endpoints, including `/oauth2/authorize`, `/oauth2/token`, `/oauth2/revoke`, `/oauth2/introspect`, `/oauth2/userinfo`, and `/oauth2/jwks` . These endpoints are fundamental for secure OAuth2 and OIDC flows.\\n\\n### Pushed Authorization Request (PAR) Endpoint\\nThe `OAuth2Constant.PAR_ENDPOINT` is used in the `OAuth2PushedAuthRequestTestCase.java` for testing Pushed Authorization Requests .\\n\\n## Documentation References\\nThe `README.md` file highlights \"Best API security available anywhere, using the powerful FAPI standard\" and mentions \"Additional security features built on top of the OAuth2 standard\" . The \"OAuth2 and OpenID Connect\" wiki page provides a comprehensive overview of the OAuth2 and OpenID Connect implementation, including supported grant types, token handling, and conformance with standards like FAPI .\\n\\n## Notes\\nThe provided context primarily consists of integration tests and configuration files. While these demonstrate the implementation and configuration of various OAuth2 security features, they do not directly reference \"OA-SecTop\" by name. However, the features like FAPI conformance, DPoP, PAR, and PKCE are widely recognized as OAuth2 Security Best Practices, which are typically covered in documents like OA-SecTop. The strength of the requirement \"SHOULD\" suggests that these practices are highly recommended, and the presence of dedicated tests and configuration options indicates that WSO2 Identity Server aims to adhere to these recommendations.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_32c372ac-d16c-4ebc-ae32-2675a5b70f61\\n', 'id': 'lc_797c99bc-c9e1-44a6-a1d9-15d64f409874'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0152_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, WSO2 API Manager, supports OAuth2 as a core component for API security, including various grant types and configuration options. While the provided context indicates strong support for OAuth2, it does not explicitly mention adherence to the \"OAuth2 Security Best Practice definitions as defined in OA-SecTop\" document. \\n\\n## Implementation Details\\nWSO2 API Manager leverages OAuth2 for API access control, supporting various grant types such as `implicit`, `authorization code`, `client credentials`, `SAML`, and `IWA Grant type`.  The system allows applying security policies for authentication and authorization to APIs. \\n\\nThe `identity.xml` configuration file shows the supported OAuth grant types and their respective handler classes :\\n*   `authorization_code`: Handled by `org.wso2.carbon.apimgt.keymgt.handlers.ExtendedAuthorizationCodeGrantHandler`. \\n*   `password`: Handled by `org.wso2.carbon.apimgt.keymgt.handlers.ExtendedPasswordGrantHandler`. \\n*   `refresh_token`: Handled by `org.wso2.carbon.identity.oauth2.token.handlers.grant.RefreshGrantHandler`. \\n*   `client_credentials`: Handled by `org.wso2.carbon.apimgt.keymgt.handlers.ExtendedClientCredentialsGrantHandler`. \\n*   `urn:ietf:params:oauth:grant-type:saml2-bearer`: Handled by `org.wso2.carbon.apimgt.keymgt.handlers.ExtendedSAML2BearerGrantHandler`. \\n*   `iwa:ntlm`: Handled by `org.wso2.carbon.identity.oauth2.token.handlers.grant.iwa.ntlm.NTLMAuthenticationGrantHandler`. \\n\\nThe system also supports token persistence processing, with an `EncryptionDecryptionPersistenceProcessor` configured by default, indicating that tokens can be encrypted before storage. \\n\\n## Configuration Options\\nOAuth2 related configurations can be found in `identity.xml` . Key configurable parameters include:\\n*   `AppInfoCacheTimeout`, `AuthorizationGrantCacheTimeout`, `SessionDataCacheTimeout`, `ClaimCacheTimeout` \\n*   Default validity periods for `AuthorizationCode`, `AccessToken`, `UserAccessToken`, and `RefreshToken`. \\n*   `TimestampSkew` \\n*   `EnableOAuthCache` \\n*   `RenewRefreshTokenForRefreshGrant` \\n*   `TokenPersistenceProcessor` \\n*   `ClientAuthHandlers` for client authentication methods, such as `BasicAuthClientAuthHandler`. \\n*   `SupportedResponseTypes` and `SupportedGrantTypes` \\n*   `OAuthCallbackHandlers` \\n*   `OAuthScopeValidator` \\n*   `EnableAssertions` for embedding parameters into access tokens. \\n*   `EnableAccessTokenPartitioning` and `AccessTokenPartitioningDomains` for managing access tokens across multiple user stores. \\n*   `AuthorizationContextTokenGeneration` for generating JWT tokens. \\n\\n## API Endpoints or Features\\nThe WSO2 API Manager provides features for controlling access and enforcing security using OAuth2.  This includes the ability to restrict API access tokens to domains/IPs, block subscriptions, and revoke access tokens. \\n\\nThe `ApIsApi.md` and `ApiDocumentsApi.md` documentation files indicate that API operations are secured using `OAuth2Security`.  This is configured by setting the access token for `OAuth2Security` on the `ApiClient`. \\n\\nTest cases like `AddEndPointSecurityPerTypeTestCase.java` and `ChangeEndPointSecurityPerTypeTestCase.java` demonstrate how to configure OAuth endpoint security for APIs, including `CLIENT_CREDENTIALS` and `PASSWORD` grant types.  These tests show the structure of the `endpoint_security` configuration, specifying `type`, `tokenUrl`, `clientId`, `clientSecret`, and `grantType`. \\n\\nThe `endpoint_template.xml` file in the `gateway` module demonstrates how OAuth authentication is applied to endpoints, dynamically configuring `clientCredentials` or `passwordCredentials` based on the grant type. \\n\\n## Documentation References\\nThe `README.md` and `README.txt` files for the `wso2/product-apim` repository mention that WSO2 API Manager relies on the OAuth2 standard for API access.  The \"Overview\" wiki page also lists OAuth2 as part of the authentication technology stack. \\n\\n## Notes\\nThe provided codebase snippets confirm extensive support for OAuth2 within WSO2 API Manager, including various grant types, configurable parameters, and API security features. However, there is no explicit mention or reference to \"OAuth2 Security Best Practice definitions as defined in OA-SecTop\" in the provided context. Therefore, it is not possible to verify if the implementation specifically follows the guidelines of that particular reference document based on the given information.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-apim)](/wiki/wso2/product-apim#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_fabb7ffa-28ea-4b24-aef1-6584cd766cf4\\n', 'id': 'lc_fc8206df-b46a-495f-b497-06e9ef61cb3d'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0153",
      "requirement": {
        "requirement_id": "ATOM_179",
        "requirement_text": "A signature of the request by the TPP on application level might be mandated by ASPSP.",
        "strength": "MAY",
        "capability": "Security",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0153_1",
          "text": "### MTLS Enforcement Policy\n\nMTLS Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires MTLS to be mandatory. It will perform the below tasks.\n\n- Mandates MTLS for the request using the request context\n- Mandates MTLS for the request when the transport certificate is sent as a header\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require MTLS enforcement. Find the details to create the policy below.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_2",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_3",
          "text": "### Resource Request\n\nAfter an API consumer application obtains an access token, it is used to invoke a resource endpoint. In this request, \nthe following validations will be performed:\n\n- Token validity verification\n- Token type verification (User Access Token/Application Access Token)\n- Scopes/roles validation\n- Token-bound certificate validation\n- Consent validation\n\nThe resource requests go through token-bound certificate validations according to\n[rfc8705](https://datatracker.ietf.org/doc/html/rfc8705)\nThe MTLS token binding happens once a token is issued to a particular client. This ensures that at the resource endpoint,\nthe provided MTLS certificate can be validated against the certificate bound to the token. Self-contained tokens are\nused for this purpose and are bound to the tokens via a claim named `cnf`. For more information,\nsee [Token Authentication](token-authentication.md#certificate-bound-access-tokens).\n\nConsent validation ensures that the API consumer application's resource requests adhere to the consent provided \nby the bank customers. This is a custom implementation as the behaviour of consent is defined by an open banking \nspecification. You can use the [Consent Validate](../develop/consent-management-validate.md) endpoint and define the \nconsent validations by comparing the resource requests against the user-provided consent.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_4",
          "text": "which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it is required to check whether a given certificate is revoked by its issuer. That can be done through two protocols: ####Certificate Revocation List (CRL) CRL is a list of digital certificates that have been revoked by the issuing CA. ####Online Certificate Status Protocol (OCSP) OCSP is an internet protocol used for obtaining the revocation status of a digital certificate based on the certificate serial number. The OCSP validation is faster compared to the CRL validation. By default, WSO2 Open Banking Accelerator verifies the revocation status of a certificate using the OCSP validation. If the OCSP validation is unsuccessful, the revocation status is verified using the CRL information. The certificate is rejected if none of these protocols is successful or if the required revocation information is not found on the certificate. ###Validate external API consumers This validation allows banks to validate API consumers from the NCAs. This is done by validating the transport layer certificate an API consumer has obtained. ###Role validation According to the [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), API consumers have roles for the services they provide. The API consumer\u2019s role is defined in the API consumer\u2019s transport certificate (QWAC certificate that they obtain from an NCA), which WSO2 Open Banking Accelerator checks in the API and Dynamic Client Registration flows. If the role exists in the transport certificate, WSO2 Open Banking Accelerator allows the API consumer to invoke the API. Following are the roles that an API consumer can have: | Role | Description | |---------|--------- | |Account Information Service Provider|Provides an online service by sharing information on payment accounts held by a payment service user with payment service providers.| |Payment Initiation Services Provider|Provides an online service to initiate a payment order at the request of the payment service user with respect to a payment account held at another payment service provider.| |Card-Based Payment Instrument Issuer|Issues card-based payment instruments that can be used to initiate a payment transaction from a payment account held with another payment service provider.| !!!tip An API consumer can have one or more roles. For example, if an API consumer provides an application to view account information as well as to initiate payments, the roles of the API consumer are **Account Information Service Provider** and **Payment Initiation Services Provider**. ###eIDAS The **electronic IDentification, Authentication and trust Services (eIDAS)** regulation provides unique identity schemas for individuals and businesses to access the publicly available online services in Europe. Among electronic Identification (eID) solutions, PSD2 recommends Qualified Website Authentication Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_5",
          "text": "### Authorization Request\n\nWSO2 Open Banking Accelerator supports the following security features and fulfil FAPI requirements \nduring Authorization flows:\n\n  - OIDC Hybrid Flow\n    - Request object verification\n    - Pushed Authorization Request validation\n    - Pairwise Identifier support for ID tokens\n  - Authorization Code Flow\n    - When a request object is not available, support authentication mechanisms such as PKCE\n\nYou can use the provided extension points and customize the authorization flows. For more information, refer to the\n[Authorization Flow Customization](../develop/keyid-provider.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the configuration of application-level request signatures, which can be mandated by an ASPSP (Account Servicing Payment Service Provider) . This functionality is primarily related to OAuth2/OpenID Connect applications and SAML-based authentication  .\\n\\n## Implementation Details\\n\\nThe system allows for the configuration of request object signature validation for OAuth2/OpenID Connect applications . Specifically, the `requestObjectSignatureAlgorithm` property in the OIDC metadata defines the supported algorithms for signing request objects .\\n\\nFor SAML, there are configurations to enable request signing for `AuthnRequests` and `LogoutRequests` . Additionally, the system can validate signatures in SAML requests .\\n\\n## Configuration Options\\n\\n### OAuth2/OpenID Connect\\nYou can configure the `requestObjectSignatureAlgorithm` for OAuth2 applications . The available options for signing algorithms include \"PS256\", \"ES256\", and \"SHA256withRSA\" .\\n\\nThe `requestObjectSignatureValidationEnabled` flag within the OAuth application configuration determines if request object signature validation is enabled . This can be set to `true` or `false` .\\n\\n### SAML\\nFor SAML, the `SAML2.EnableRequestSigning` property in `travelocity.properties` files controls whether `AuthnRequests` and `LogoutRequests` should be signed . This property can be set to `true` or `false` .\\n\\nThe `doValidateSignatureInRequests` flag in the `samlssoServiceProviderDTO` configuration, as seen in `TestServer.xml`, indicates whether signatures in SAML requests should be validated .\\n\\n## API Endpoints or Features\\n\\nThe `oidc-metadata.json` file, which defines metadata for OIDC applications, includes configuration options for `requestObjectSignatureAlgorithm` . This suggests that these settings are exposed through an API for managing OAuth2/OIDC application configurations.\\n\\nFor SAML, the `ConfigSuccessTest.java` file demonstrates API calls to update SAML inbound authentication configurations, including `enableRequestSigning` for Passive STS . This indicates that there are API endpoints to manage request signing settings for SAML.\\n\\n## Documentation References\\n\\nThe \"OAuth2 and OpenID Connect\" wiki page provides a comprehensive overview of the OAuth2 and OIDC implementation in WSO2 Identity Server . It covers token management, including DPoP tokens which are a form of signed tokens . While it doesn\\'t explicitly detail \"application-level signatures mandated by ASPSP\", the sections on \"ID Token\" and \"Token Binding\" are relevant to understanding how signatures are handled within the system . The `oidc-metadata.json` file is also referenced in the wiki as a source for OIDC metadata .\\n\\n## Test Criteria\\n\\nThe `ConfigSuccessTest.java` file includes tests that verify the configuration of request signing for Passive STS . Specifically, `testUpdatePassiveSTSInboundAuthConfigs` checks if `enableRequestSigning` can be set to `true` and if the change persists . This directly addresses the test criteria of verifying that ASPSPs can configure whether TPP application-level signatures are mandatory for requests, at least for Passive STS.\\n\\nFor OAuth2, the `requestObjectSignatureValidationEnabled` property in the application configuration XML files  suggests that there are mechanisms to test this configuration. The `create-oauth-app-with-invalid-id-token-signing-algorithm.json` file also shows an example of configuring `requestObjectSigningAlg`, implying that the system validates these configurations .\\n\\n## Notes\\n\\nThe term \"TPP\" (Third Party Provider) and \"ASPSP\" (Account Servicing Payment Service Provider) are commonly used in the context of Open Banking and Financial-grade APIs (FAPI). The `wso2/product-is` repository includes FAPI conformance tests , indicating its relevance to such use cases. The configurations for request object signing and SAML request signing are key mechanisms that an ASPSP would use to mandate application-level signatures from TPPs.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_4771a4cf-f1b6-4158-872f-326ae643ddda\\n', 'id': 'lc_594ec784-4d37-4d8c-98db-b0bd3bed746e'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support application-level request signing through its JWT (JSON Web Token) configuration, allowing for the specification of a signature algorithm. While the provided snippets indicate the capability to configure JWT signing, they do not explicitly detail a mechanism for an ASPSP (Account Servicing Payment Service Provider) to mandate TPP (Third Party Provider) application-level signatures for requests.\\n\\n### Implementation Details\\nThe `JWTConfiguration` section within the `api-manager.xml` files suggests that JWT generation and signing are configurable features. Specifically, the `<SignatureAlgorithm>` element allows you to specify the algorithm used for signing JWTs.   The default value shown is `SHA256withRSA`, and it also accepts `NONE` to disable signing.   The `JWTGeneratorImpl` element points to `org.wso2.carbon.apimgt.keymgt.token.JWTGenerator` as the default implementation for generating tokens.  \\n\\n### Configuration Options\\nThe primary configuration for JWT signing is found within the `<JWTConfiguration>` section of the `api-manager.xml` files.  \\n\\nKey configuration elements include:\\n*   `<EnableJWTGeneration>`: This boolean flag enables or disables JWT generation.  \\n*   `<SignatureAlgorithm>`: Specifies the algorithm for signing the JWT.   Options are \"SHA256withRSA\" or \"NONE\".  \\n*   `<JWTGeneratorImpl>`: Defines the class responsible for generating the JWT.  \\n\\nThese configurations are typically found in `api-manager.xml` files, which are central configuration files for the API Manager.  \\n\\n### API Endpoints or Features\\nThe provided code snippets do not directly expose specific API endpoints or features that allow an ASPSP to *mandate* TPP application-level signatures. The configuration primarily deals with how the API Manager itself generates and signs JWTs.  The security policies found in `all-in-one-apim/modules/integration/tests-integration/tests-backend/src/test/resources/security/policies/` such as `scenario2-policy.xml`  and `scenario5-policy.xml`  indicate support for various WS-Security policies including signing (`<sp:SignedParts>`), but these are generally for SOAP-based services and not directly related to mandating TPP application-level signatures for REST APIs via JWTs.\\n\\n### Documentation References\\nThe provided context does not include direct documentation references for configuring mandatory TPP application-level signatures. However, the comments within the `api-manager.xml` files serve as inline documentation for the JWT configuration. For example, the comment for `<SignatureAlgorithm>` states: \"Signature algorithm. Accepts \"SHA256withRSA\" or \"NONE\". To disable signing explicitly specify \"NONE\".\" \\n\\n## Notes\\nThe provided snippets primarily focus on the internal JWT generation and signing capabilities of the WSO2 API Manager. While it supports signing JWTs, the mechanism for an ASPSP to *mandate* that TPPs provide application-level signatures on their requests is not explicitly detailed in these configuration files. The `api-manager.xml` files configure the behavior of the API Manager itself, not necessarily external TPP requirements. The security policies (`scenarioX-policy.xml`) are related to WS-Security for SOAP services and are distinct from application-level JWT signing for REST APIs.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_e4123eed-058c-48c0-a5d4-c9a9656d4877\\n', 'id': 'lc_3d75df27-9342-472c-8eaf-bacf3b95f363'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0154",
      "requirement": {
        "requirement_id": "ATOM_182",
        "requirement_text": "It is recommended that the ASPSP inform the TPP about incorrect password by adding a _links section in the additional error information and presenting a corresponding updatePsuAuthentication or updateEncryptedPsuAuthentication hyperlink.",
        "strength": "SHOULD",
        "capability": "Error Handling",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0154_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the specific Open Banking requirement of informing the TPP about incorrect passwords by adding a `_links` section with `updatePsuAuthentication` or `updateEncryptedPsuAuthentication` hyperlinks in the additional error information. <cite/>\\n\\nThe provided code snippets indicate that the system handles authentication flows and includes a `_links` section in some JSON responses, but not specifically for password authentication failures with the requested hyperlinks.      \\n\\n## Implementation Details\\n\\nThe `validInitClientNativeAuthnResponse` method in several test cases, such as `FederatedTokenSharingIDPConfigDisabledTestCase.java`, `FederatedTokenSharingTestCase.java`, and `JITUserAssociationTestCase.java`, checks for the presence of a `LINKS` key in the JSON response.    This `LINKS` section is then validated to contain an `HREF` attribute.    However, these tests are related to OAuth 2.0 authorization and federated token sharing, not specifically to password authentication failures or the `updatePsuAuthentication` hyperlinks.   \\n\\nThe `PreUpdatePasswordActionSuccessTest.java` and `PreUpdatePasswordActionFailureTest.java` test cases deal with pre-update password actions and their associated REST API endpoints.   These tests also check for a `links` section in the response, specifically for `self` links related to action management.  However, this is for managing actions themselves, not for informing a TPP about incorrect passwords with specific `updatePsuAuthentication` hyperlinks. \\n\\n## Configuration Options\\n\\nThe `automation.xml` file shows configuration for various aspects like execution environment, coverage, framework dashboard, browser type for UI tests, and database configurations.  It also includes keystore configurations for encrypting/decrypting passwords.  While this file contains password-related configurations, it does not provide options for configuring the `_links` section in error responses for incorrect passwords as described in the prompt. \\n\\nThe `application-authentication-default.xml` file lists various `AuthenticatorConfig` elements, including `BasicAuthenticator`, which is relevant to password authentication.   It also shows a commented-out parameter `showAuthFailureReason` for `BasicAuthenticator`, which might be related to providing more details on authentication failures.  However, there are no explicit configuration options for adding `_links` with `updatePsuAuthentication` or `updateEncryptedPsuAuthentication` hyperlinks in error responses. \\n\\n## API Endpoints or Features\\n\\nThe `PreUpdatePasswordActionSuccessTest.java` and `PreUpdatePasswordActionFailureTest.java` refer to an API endpoint related to `/api/server/v1/action-management/pre-update-password`.   This endpoint is for managing actions that occur *before* a password update, not for handling incorrect password attempts during authentication. \\n\\nThe test cases related to OAuth2, such as `FederatedTokenSharingIDPConfigDisabledTestCase.java`, `FederatedTokenSharingTestCase.java`, and `JITUserAssociationTestCase.java`, involve sending login requests with username and password.  While these tests simulate login, they do not specifically verify the presence of `updatePsuAuthentication` or `updateEncryptedPsuAuthentication` hyperlinks in error responses for incorrect passwords. \\n\\n## Documentation References\\n\\nNo explicit documentation references within the provided snippets directly address the requirement of including `updatePsuAuthentication` or `updateEncryptedPsuAuthentication` hyperlinks in error responses for incorrect passwords. <cite/>\\n\\n## Notes\\n\\nThe provided code snippets primarily consist of integration tests for various functionalities within the `wso2/product-is` repository.       While some tests validate the presence of a `_links` section in JSON responses, these are in different contexts (OAuth2 flow, action management API) and do not specifically address the Open Banking requirement for password authentication failures.   The `PreUpdatePasswordActionFailureTestCase.java` specifically tests failure scenarios related to password updates, but the expected responses do not include the requested `_links` section. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-i_9ca80767-64f6-410a-bc3d-40a62f37e96e\\n', 'id': 'lc_5e393527-f63e-4958-9e01-7e6f5b25de8a'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0154_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not appear to directly support the specific requirement of informing a TPP about an incorrect password by adding a `_links` section with `updatePsuAuthentication` or `updateEncryptedPsuAuthentication` hyperlinks in the error response. The provided code snippets primarily deal with password management, recovery, and authentication within the WSO2 API Manager\\'s internal mechanisms and user interfaces, rather than external TPP communication with specific `_links` sections in error responses.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThe codebase contains several files related to password management and authentication, but none of them explicitly implement the `_links` section in error responses as described in the prompt.\\n\\n### Password Change and Recovery\\nThe `wso2/product-apim` repository includes functionality for changing and recovering user passwords.\\nThe `RestAPIStoreImpl.java` file contains a `changePassword` method that allows a user to change their password . This method uses `usersApi.changeUserPasswordWithHttpInfo` to perform the password change . A test case, `PasswordChangeTestCase.java`, verifies this functionality by attempting to change a user\\'s password and then logging in with the new password .\\n\\nPassword recovery mechanisms are present in `password-recovery.jsp`  and `password-reset-complete.jsp` . These JSP files handle the user interface and backend calls for password recovery and reset processes. For instance, `password-reset-complete.jsp` uses a `NotificationApi` and `ResetPasswordRequest` to handle password reset requests . Email templates for password recovery and reset are defined in `email-admin-config.xml`  .\\n\\n### Error Handling\\nThe `basicauth.jsp` file displays error messages related to authentication failures, such as \"ACCOUNT_RESEND_FAIL_RESOURCE\"  or \"error.user.account.locked.incorrect.login.attempts\" . However, these error messages are for user-facing interfaces and do not include the `_links` section with `updatePsuAuthentication` or `updateEncryptedPsuAuthentication` hyperlinks as specified in the prompt.\\n\\n## Documentation References\\n\\nNo explicit documentation references within the provided snippets indicate support for the specific `_links` section in error responses for TPPs. The existing code focuses on internal password management and user authentication flows.\\n\\n## Notes\\n\\nThe prompt describes a specific requirement for ASPSPs (Account Servicing Payment Service Providers) to communicate with TPPs (Third Party Providers) regarding incorrect passwords, including a `_links` section in error responses. The provided codebase snippets from `wso2/product-apim` primarily deal with the WSO2 API Manager\\'s own user authentication, password recovery, and internal error handling mechanisms. While there is extensive functionality for password management, there is no direct evidence in the provided context that `wso2/product-apim` implements the specific ASPSP-TPP communication pattern with `_links` for `updatePsuAuthentication` or `updateEncryptedPsuAuthentication` hyperlinks in error responses. It\\'s possible this functionality exists in other parts of the codebase not provided, or in a different product designed for Open Banking compliance.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-i_08209b31-9e8e-4381-8ac5-327011874860\\n', 'id': 'lc_531c01c9-262e-4d98-ac3f-2dbee19053c8'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0155",
      "requirement": {
        "requirement_id": "ATOM_023",
        "requirement_text": "ASPSPs MAY restrict transaction grouping in signing baskets to payments only, individual payments only, or same payment product only",
        "strength": "MAY",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "unknown",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0155_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_2",
          "text": "### Account Information Service\n\nIf the API consumer application is aggregating account information on behalf of the bank user, the APP-to-APP redirection \nflow is as follows: \n\n[ ![](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Account Information Service, it is known as an Account Information Service Provider (AISP).\n\n| Implementation | Requirement | Participant |\n|----------------|-------------|-------------|\n| A- AISP requests the bank customer to identify the bank. | Required | AISP |\n| B- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | bank |\n| C- The customer consents to the accounts, which the AISP is allowed to have access | Required | Bank |\n| D- Confirms the completion of AIS request | Recommended | AISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_3",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_4",
          "text": "## Open banking / Open Finance regulations Open banking and Open Finance regulations provide a policy and legislative framework to help banks and API consumers deliver the benefits of open banking. - The **newest** regulation of Open Finance is the finalized **section 1033 rule from Consumer Financial Protection Bureau (CFPB) of the United States**.It requires financial institutions to make available to consumers the information they have about their financial products and services, upon request. - The first known open banking regulation is the **Payment Service Directive** in Europe. Administered by the European Commission (Directorate General Internal Market) regulates payment services and payment service providers throughout the European Union and European Economic Area (EEA). PSD1 came into force in 2007 followed by the PSD2 in 2015. - The Competition and Market Authority formed the **Open Banking Implementation Entity** in the UK. The Open Banking Implementation Entity adopted the PSD2 and issued its first version of the open banking standard in 2017. It specified how banks should allow an API consumer to access customer\u2019s information and request payments with the customer\u2019s consent. - The Berlin Group consists of almost 40 banks, associations and Payment Service Providers across the European Union. They have defined a common API standard called NextGenPSD2 for the use cases specified in PSD2. Based on the PSD2 and European Banking Authority - Regulatory Technical Standards (RTS) requirements, the Berlin Group has worked on detailed Access to Account (XS2A) Framework including implementation details for open banking named as **NextGenPSD2XS2A**.Now this has been expanded to Open Finance with the introduction of **Berlin Group openFinance API framework** - **Consumer Data Right** in Australia is a right provided by law under the Treasury Laws Amendment (Consumer Data Right) Act in 2019 to give Australians greater control over their data. It empowers consumers to choose to share their data with API consumers only for the purposes that they have authorized. - **Fintech law** in Mexico promotes data sharing as well as transparency among banks and subholding companies (example: broker-dealers, money exchangers, credit unions, popular, and community financial entities). The Fintech law defines guidelines for the regulated entities on the types of information and how to share them. Comisi\u00f3n Nacional Bancaria y de Valores, The Embassy of the United Kingdom, the FinTech Hub, C Minds, ODI and the Government of the Republic are involved in the regulation. - The Hong Kong Monetary Authority (HKMA) published the **Open API Framework** in 2018 to provide a secure, controlled, and convenient operating environment to financial institutions and third parties. It expects the banks and third parties to work together and build innovative banking services offering a better customer experience. The framework has a phased approach. - The Monetary Authority of Singapore (MAS) provided a legal framework for open banking in 2018. MAS introduced [APIX](https://www.mas.gov.sg/development/fintech/api-exchange) for the banks to open up their data and services encouraging openness among both the financial institutions and the API consumers. - Following the footsteps of the UK and Australia, New Zealand issued a government backed pilot plan in 2018 to design and develop open banking",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_5",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'I cannot answer your question about whether this repository supports restricting transaction grouping in signing baskets. The provided code snippets are primarily related to identity management, authentication, and authorization configurations within the WSO2 Identity Server, as seen in files like `default-identity.xml`  and `TestServer.xml` . These files define permissions, API endpoints for consent management, OAuth2 DCR, SCIM, and SAML configurations. There is no direct mention or indication of \"signing baskets,\" \"transaction grouping,\" \"payments,\" or \"payment products\" within the provided context. Therefore, I cannot provide implementation details, configuration options, API endpoints, or documentation references related to your query.\\n\\n## Notes\\nThe provided snippets are configuration files for the WSO2 Identity Server, primarily dealing with security, authentication, and API access control. They do not contain any information related to financial transactions, payment processing, or the specific concept of \"signing baskets\" as described in the prompt.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_3fe50c60-0a6c-4242-b178-8e93652d2111\\n', 'id': 'lc_0f0e15e9-cc89-4f8e-a429-4b6db72ed5c2'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_a8ae7cbd-e733-45a9-8179-c62676be0af5'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0156",
      "requirement": {
        "requirement_id": "ATOM_079",
        "requirement_text": "The ASPSP should provide PSU message to inform about decoupled authentication requirement",
        "strength": "SHOULD",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0156_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_2",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_3",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_4",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_5",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports decoupled authentication, which can be used to inform a Payment Service User (PSU) about the requirement to use a dedicated app or device for payment authorization in a decoupled Strong Customer Authentication (SCA) approach. The system provides features for advanced authentication, including multi-factor authentication (MFA) and adaptive authentication, which are crucial for implementing decoupled SCA. \\n\\n### Implementation Details\\nThe WSO2 Identity Server, which this repository is part of, offers \"Adaptive Authentication\" and \"Multi-factor Authentication\" capabilities . Adaptive authentication allows for risk-based, step-based, and conditional authentication flows, which can be configured using JavaScript-based authentication scripts . These scripts can be used to implement the logic for determining when decoupled authentication is required and to trigger the appropriate PSU message. The system also supports various MFA methods like SMS OTP, Email OTP, and TOTP .\\n\\n### Configuration Options\\nConfiguration for multi-factor authentication can be found in files like `identity-mgt-listener-enabled.xml`, which includes settings for XMPP-based authentication . While this specific snippet shows XMPP, the broader \"Multi-factor Authentication\" feature implies that other mechanisms for decoupled authentication can be configured . The system also allows for custom authenticators and authentication scripts, providing flexibility to integrate with dedicated apps or devices for payment authorization .\\n\\n### API Endpoints or Features\\nThe WSO2 Identity Server provides REST APIs for managing authenticators . These APIs can be used to programmatically configure and manage the authenticators required for decoupled SCA. The `AuthorizationDetailsType` class, for instance, defines a structure for authorization details, which could be extended or used to convey specific requirements for payment authorization . The platform also supports OAuth 2.0 and OpenID Connect, which are standard protocols for secure API access and authentication .\\n\\n### Documentation References\\nThe `README.md` file refers to official documentation for installation and environment compatibility . The \"Features and Capabilities\" wiki page provides a comprehensive overview of the WSO2 Identity Server\\'s features, including advanced authentication and API security, which are relevant to implementing decoupled authentication .\\n\\n## Notes\\nThe provided snippets indicate strong support for flexible authentication mechanisms, including adaptive and multi-factor authentication, which are foundational for implementing decoupled SCA. While there isn\\'t a direct mention of \"ASPSP\" or \"PSU message\" in the code, the extensibility of the platform through custom authenticators and scripting suggests that such specific requirements can be met. The `AuthorizationDetailsType` class could be a relevant model for defining the details of payment authorization in a decoupled flow.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_29b5c274-3c9c-45ab-9ebd-4f306f3aa30a\\n', 'id': 'lc_caacc141-6a2f-458c-8305-ebea56ffc906'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_c99d75e0-00c0-4f28-86e7-a58dab4c3727'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0157",
      "requirement": {
        "requirement_id": "ATOM_070",
        "requirement_text": "TPPs MAY send an SCA status request to follow the SCA process during implicit authorization",
        "strength": "MAY",
        "capability": "Payment Initiation",
        "section_id": "648825991d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0157_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0157_2",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0157_3",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0157_4",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports TPPs sending an SCA status request during implicit authorization. This functionality is primarily managed through the `Consent` and `AppRegistration` sections of the `financial-services.xml` configuration file, which defines Strong Customer Authentication (SCA) related settings and authorization flows. The system uses OAuth 2.0 flows, including implicit authorization, and allows for the configuration of primary authenticators for SCA.\\n\\n### Implementation Details\\n\\nThe core logic for handling consent creation and authorization, including implicit authorization, resides within the `ConsentCoreService` interface  and its implementation `ConsentCoreServiceImpl` . Specifically, the `createAuthorizableConsent` method in `ConsentCoreServiceImpl` handles the creation of an authorizable consent and, if `isImplicitAuth` is true, creates an authorization resource . This method checks for the presence of `authStatus` and `authType` when `isImplicitAuth` is enabled . The actual storage of the authorization resource is performed by `ConsentCoreServiceUtil.createAuthorizableConsentWithAuditRecord` , which stores an `AuthorizationResource` if `isImplicitAuthorization` is true .\\n\\nThe system defines OAuth 2.0 security schemes, including an `implicit` flow, which can be used for `fundsconfirmations` and `payments` scopes  . The `PSUOAuth2Security` scheme explicitly mentions that it is \"required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"  .\\n\\n### Configuration Options\\n\\nSCA-related configurations are found in the `financial-services.xml` file. The `AppRegistration` section contains an `SCA` element where a `PrimaryAuthenticator` can be defined, including its `Name` and `DisplayName` . These values are also accessible via constants like `PRIMARY_AUTHENTICATOR_NAME` and `PRIMARY_AUTHENTICATOR_DISPLAY_NAME` in `FinancialServicesConstants.java` .\\n\\nThe `financial_services.app_registration.sca` section in `wso2is-7.0.0-deployment.toml` also allows for configuring the primary authenticator, identity provider name, and step for SCA .\\n\\n### API Endpoints or Features\\n\\nThe OpenAPI specifications for Payments and Confirmation of Funds APIs define security schemes that include `PSUOAuth2Security` for scenarios requiring SCA  . While these specifications indicate the need for SCA, they do not explicitly define a separate endpoint for TPPs to query the SCA status during an implicit authorization flow. The `implicit` OAuth flow is defined for various scopes, including `fundsconfirmations` and `payments`  .\\n\\nThe `ConsentCoreService` provides methods like `getConsent` and `getDetailedConsent`  which allow retrieval of consent information, including authorization data. This could potentially be used by a TPP to monitor the status of an authorization, although it\\'s not a dedicated \"SCA status request\" endpoint.\\n\\n### Documentation References\\n\\nThe \"Overview\" wiki page mentions that the accelerator provides a framework for Open Banking APIs with built-in security and consent management . It also refers to \"Identity Extensions\" for OAuth/OIDC customizations and TPP onboarding . The \"WSO2 Extensions\" wiki page further details the configuration management system and Identity Server extensions, including OAuth and OIDC extensions <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"2.2\" end=\"2.2\" />. These documents provide a high-level understanding of the system\\'s capabilities regarding authorization and consent.\\n\\n## Notes\\n\\nThe provided code snippets and wiki pages indicate that the WSO2 Financial Services Accelerator is designed to handle SCA within its OAuth 2.0 flows, including implicit authorization. While there isn\\'t a specific API endpoint explicitly named \"SCA status request,\" the underlying consent management services and the OAuth 2.0 framework with its `PSUOAuth2Security` scheme suggest that the system is capable of managing and tracking SCA processes. TPPs might be able to infer SCA status by querying consent details, but a direct, dedicated endpoint for SCA status is not explicitly defined in the provided OpenAPI specifications. The `isImplicitAuth` parameter in `ConsentCoreService` methods is crucial for understanding how implicit authorization is handled internally .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [WSO2 Extensions (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0f4076d3-952b-46bf-a81e-ab81c385781a\\n', 'id': 'lc_e13e01c9-bbfa-4e55-ab78-f56a730a4e8b'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0158",
      "requirement": {
        "requirement_id": "ATOM_185",
        "requirement_text": "The only hash algorithms that may be used to calculate the Digest are SHA-256 and SHA-512 as defined in RFC5843",
        "strength": "MAY",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0158_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports SHA-256 and SHA-512 as hash algorithms for various purposes, including password digests in user stores and OAuth token hashing. While the codebase demonstrates the use of these algorithms, there is no direct evidence or configuration option specifically for a \"Digest header\" as defined in RFC5843.\\n\\n## Implementation Details\\n\\n### Password Digest in User Stores\\nThe system allows configuring the password hashing algorithm for user stores. The `PasswordDigest` property in user store configurations can be set to `SHA-256`    . This is evident in the `addSecondaryJDBCUserStore` method in `SecondaryStoreUserLoginTestCase.java` , `UsernameRecoveryTestCase.java` , and `IDENTITY4776SCIMServiceWithOAuthTestCase.java` . The `UserStoreConfigUtils.java` also provides methods to set these properties .\\n\\n### OAuth Token Hashing\\nThe system supports hashing OAuth tokens using SHA-512. This is configured via the `hash_token_algorithm` property under the `[oauth]` section in the `identity_hash_enabled.toml` file . The `Oauth2HashAlgorithmTestCase.java` specifically tests this functionality by applying a configuration that sets the OAuth token hashing to SHA-512 .\\n\\n### DPoP Proof Generation\\nFor Demonstrating Proof of Possession (DPoP), SHA-256 is used to generate the access token hash. The `generateAccessTokenHash` method in `DPoPProofGenerator.java` explicitly uses `MessageDigest.getInstance(\"SHA-256\")` to hash the access token .\\n\\n### PKCE Code Challenge\\nThe Proof Key for Code Exchange (PKCE) code challenge also utilizes SHA-256. The `getPKCECodeChallenge` method in `OAuth2PKCETestCase.java` uses `MessageDigest.getInstance(\"SHA-256\")` to hash the code verifier .\\n\\n### SAML Digest Algorithms\\nSAML configurations allow for various digest algorithms, including SHA-256 and SHA-512, as seen in `saml-metadata-super-tenant.json`  and `saml-metadata-tenant.json` . However, these are for SAML message integrity, not specifically for an RFC5843 Digest header.\\n\\n## Configuration Options\\n\\n### OAuth Token Hashing Algorithm\\nYou can configure the hashing algorithm for OAuth tokens by setting the `hash_token_algorithm` property in the `deployment.toml` file under the `[oauth]` section. For example, to use SHA-512:\\n```toml\\n[oauth]\\nhash_token_algorithm = \"SHA-512\" \\n```\\n\\n### User Store Password Digest\\nFor user stores, the `PasswordDigest` property can be set to `SHA-256` during user store creation or modification .\\n\\n## API Endpoints or Features\\n\\nThe codebase does not explicitly expose API endpoints or features specifically for calculating a \"Digest header\" as defined in RFC5843. However, hashing capabilities using SHA-256 and SHA-512 are integrated into internal processes such as OAuth token management and user store password handling.\\n\\n## Documentation References\\n\\nThe provided wiki page on \"OAuth2 and OpenID Connect\" <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"3.1\" end=\"3.1\" /> and \"SAML and Identity Federation\" <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"3.2\" end=\"3.2\" /> discuss various security aspects, including token types and standards compliance. While they mention signing and encryption, they do not specifically refer to RFC5843 Digest headers.\\n\\n## Notes\\n\\nThe query specifically asks about the \"Digest header\" as defined in RFC5843. While the repository extensively uses SHA-256 and SHA-512 for various hashing purposes (e.g., password digests, OAuth token hashing, DPoP, PKCE, SAML message integrity), there is no direct evidence in the provided snippets of an implementation or configuration option for an RFC5843 compliant \"Digest header\". The usage of SHA-256 and SHA-512 is prevalent, indicating the capability to use these algorithms, but their application to an RFC5843 Digest header is not explicitly shown.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [SAML and Identity Federation (wso2/product-is)](/wiki/wso2/product-is#3.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_5daf1245-a733-4faf-9dd5-4dc411224e4f\\n', 'id': 'lc_5ac8c106-3713-43c1-938d-74ac410d6c1d'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0158_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support Digest authentication, but the provided code snippets do not explicitly confirm that the Digest header uses only SHA-256 or SHA-512 algorithms as defined in RFC5843 for the digest calculation itself. The code primarily focuses on JWT signature algorithms and general Digest authentication setup.\\n\\n## Implementation Details\\n\\nThe `wso2/product-apim` repository includes integration tests for Digest authentication. The `DigestAuthenticationTestCase`   sets up an API with `digestAuth` as the endpoint authentication type . This test case verifies the functionality of an API secured with Digest authentication .\\n\\nThe `dummy_digest_api.xml` files   define a Synapse API named `DigestAuth_API` with a context `/digestAuth` . This API checks for the presence of the `Authorization` header . If the header is not present, it sends a `401 Unauthorized` response with a `WWW-Authenticate` header, including `Digest realm=\\'digestAuth\\', qop=\\'auth\\', nonce=\\'...\\'` . This indicates that the system initiates a Digest authentication challenge.\\n\\nHowever, the provided snippets do not contain the specific implementation logic for calculating the digest value itself, nor do they explicitly state which hash algorithms (SHA-256 or SHA-512) are used for the Digest header as per RFC5843. The `APIMTestCaseUtils.java` file  shows `isJwtSignatureValid` which deals with JWT signature algorithms like \"SHA256withRSA\" and \"SHA512withRSA\" , but this is for JWTs, not the Digest header. Another method, `getAliasForX509CertThumb`, uses `MessageDigest.getInstance(\"SHA-1\")`  for certificate thumbprint calculation, which is also not directly related to the Digest header calculation.\\n\\n## Configuration Options\\n\\nThe `deployment.toml`  and `api-manager.xml`  files show configuration options for JWT `SignatureAlgorithm`, which can be set to \"SHA256withRSA\" or \"NONE\" . There is also a `use_sha256_hash` option for JWTs . However, these configurations are specific to JWTs and do not appear to directly control the hash algorithms used for the Digest header in Digest authentication.\\n\\nThe `cache.xml` documentation files    mention a \"Hash Generator\" which defaults to `org.wso2.caching.digest.DOMHashGenerator` . This is for caching mechanisms and not directly related to the Digest authentication header.\\n\\n## API Endpoints or Features\\n\\nThe `DigestAuth_API` defined in the Synapse configuration files  exposes a `/digestAuth` context . This API is configured to handle Digest authentication challenges by sending a `WWW-Authenticate` header when no `Authorization` header is present . The `qop=\\'auth\\'` parameter is present in the `WWW-Authenticate` header , which is relevant to Digest authentication. However, the specific hash algorithms used for the digest calculation are not explicitly mentioned in these configuration files.\\n\\n## Documentation References\\n\\nThe provided snippets include documentation for the cache mediator   , which mentions a \"Hash Generator\" . This is a general hashing mechanism for caching and not directly related to the Digest header algorithms. The `api-manager.xml` files  also refer to \"Signature algorithm\" for JWTs, which can be \"SHA256withRSA\" . There is no explicit documentation within the provided snippets that specifies the allowed hash algorithms for the Digest header in Digest authentication as per RFC5843.\\n\\nBased on the provided code, while Digest authentication is supported, there is no explicit confirmation or configuration that restricts the Digest header calculation to only SHA-256 and SHA-512 as defined in RFC5843. The snippets primarily show JWT-related hash algorithm configurations and general Digest authentication setup without detailing the digest calculation itself.\\n\\n## Notes\\n\\nThe term \"Digest\" appears in two distinct contexts within the provided snippets:\\n1.  **Digest Authentication**: This refers to the HTTP Digest Access Authentication mechanism, as seen in the `dummy_digest_api.xml` files  and `DigestAuthenticationTestCase.java` . The user\\'s query specifically asks about the hash algorithms used in the Digest header for this mechanism.\\n2.  **Message Digest for Caching/Certificates**: This refers to general hashing for purposes like caching (`org.wso2.caching.digest.DigestGenerator` ) or certificate thumbprint calculation (`MessageDigest.getInstance(\"SHA-1\")` ). These are not directly related to the Digest header in HTTP Digest Access Authentication.\\n\\nThe `JWTConfiguration` sections in `deployment.toml`  and `api-manager.xml`  refer to `SignatureAlgorithm` for JSON Web Tokens (JWTs), which can be \"SHA256withRSA\" or \"SHA512withRSA\" (implied by \"RS515\" mapping to \"SHA512withRSA\" in `APIMTestCaseUtils.java` ). While these are SHA-256 and SHA-512 based algorithms, they are used for JWT signing, not for the Digest header in HTTP Digest Access Authentication. The user\\'s query specifically asks about the Digest header, not JWTs.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c4b68f08-4233-47b4-859b-3e63bb1786e1\\n', 'id': 'lc_3197e5c8-b1b3-47e0-a9e7-adeba3842174'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0159",
      "requirement": {
        "requirement_id": "ATOM_130",
        "requirement_text": "ASPSP MAY require an explicit consent extension by the PSU to deliver the account owner name",
        "strength": "MAY",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0159_1",
          "text": "#### Add ConsentPortalRole Role\n\nConsentPortalRole is required for users to log into the Consent Manager Portal and search for the consents granted by them.\n\nSimilarly create another role named as **ConsentPortalRole** and assign **consents:read_self** scope to the role.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0159_2",
          "text": "#### Add CustomerCareOfficerRole Role\n\nCustomerCareOfficerRole is required for bank users to log into the Consent Manager Portal and search for the consents granted by any user.\n\n1. Go to **Roles** under the **User Management** tab in the left pane.\n\n2. Click on **+ New Role**.<br/> \n![roles](../assets/img/learn/consent-manager/roles.png)\n\n3. Enter following details and click on Next button.\n    - Role Name: CustomerCareOfficerRole\n    - Role audience: Organization<br/> \n![create-cc-role](../assets/img/learn/consent-manager/create-cc-role.png)\n\n4. Select the created **API Resource** under the **Permission Selection** section.\n\n5. Add the **consents:read_all** permission from the API resource separately.<br/> \n![create-role-step2](../assets/img/learn/consent-manager/create-role-step2.png)\n\n6. Click on the **Finish** button.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0159_3",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0159_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0159_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0159_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the requirement for an ASPSP (Account Servicing Payment Service Provider) to optionally require an explicit consent extension by the PSU (Payment Services User) to deliver the account owner name. This functionality is primarily managed through the consent management features within the Identity Server.  \\n\\n### Implementation Details\\n\\nThe consent management system allows for the definition of PII (Personally Identifiable Information) categories, purposes, and purpose categories, which are then used to manage user consent for data sharing.  Explicit consent can be captured during processes like self-registration. \\n\\nThe `SelfSignUpConsentTest.java` integration test demonstrates how a user can self-register with consent, including providing consent for specific purposes.  The `selfRegister` method constructs a request body that includes consent information, such as the `financialPurposeId` and `piiCategoryId`, indicating that consent for certain data (like account owner name, if configured as a PII category) is being provided.  The `getConsentReqBody` method further details how the consent request body is structured, specifying `consentType` as `EXPLICIT`. \\n\\nThe `Utils.java` file contains utility methods for handling consent-related HTTP requests, such as `sendPOSTConsentMessage` and `getConsentRequiredClaimsFromResponse`.   These methods process claims that require user consent, indicating that the system can identify and prompt for consent for specific attributes.  \\n\\n### Configuration Options\\n\\nThe `default-identity.xml` configuration file includes a `<Consent>` section with `<EnableSSOConsentManagement>true</EnableSSOConsentManagement>`, which enables consent management during SSO.  This suggests that the system can be configured to require consent for various operations, including potentially the delivery of account owner names.\\n\\nAdditionally, the `AdvancedApplicationConfiguration.java` model includes a `useExternalConsentPage` property, which can be set to `true` or `false`.  This indicates that the system can be configured to use an external page for collecting consent, providing flexibility in how the consent step is presented to the PSU. The `oidc-fapi-conformance-tests/configure_is_fapi.py` script also shows how to `disable_skipping_consent` for an application, which forces the consent flow to be active. \\n\\n### API Endpoints or Features\\n\\nThe consent management functionality is exposed through REST API endpoints. The `ConsentMgtTestCase.java` refers to `CONSENT_ENDPOINT_SUFFIX = \"/api/identity/consent-mgt/v1.0/consents\"`.  This endpoint is used for managing PII categories, purposes, and receipts.  Specifically, the `addPurpose` and `addReceipt` methods in `ConsentMgtTestCase.java` demonstrate interactions with these endpoints to define consent-related entities.  \\n\\nThe `SelfSignUpConsentTest.java` also uses the `selfRegistrationMeEndpoint` for self-registration, which can include consent information in the request body. \\n\\n### Documentation References\\n\\nThe provided wiki page on \"Integration Tests\" mentions \"Self-Registration and Consent Tests\" and specifically highlights the `SelfSignUpConsentTest` for validating user self-registration functionality and consent management.  This indicates that the consent mechanism is an integral part of the user management and registration flows. The wiki also describes the test structure for `SelfSignUpConsentTest`, including consent collection during self-registration. \\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests, which demonstrate the functionality of the WSO2 Identity Server. While these tests confirm the existence and configurability of consent management, they do not directly show the specific configuration for \"account owner name\" as a PII category. However, the general mechanism for defining PII categories and purposes is present, implying that \"account owner name\" could be configured as such. The requirement strength \"MAY\" suggests that this is an optional feature, which aligns with the configurable nature of consent in the codebase.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_e756b7dc-313a-4cea-92cf-84832029dd6a\\n', 'id': 'lc_9939c96e-8675-4c39-91ce-00b4f53538c1'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0159_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_7d71fd48-b3ea-4a5b-89e6-3831cb8c1f3a'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0160",
      "requirement": {
        "requirement_id": "ATOM_010",
        "requirement_text": "The ASPSP MAY require the TPP to sign request messages using qualified certificates for electronic seals.",
        "strength": "MAY",
        "capability": "Authentication",
        "section_id": "eef9ab97432c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0160_1",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_2",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_3",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_4",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_5",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the signing of request messages using certificates, which is relevant to the requirement for TPPs to sign requests with qualified electronic seal certificates. The implementation details indicate support for various signing algorithms and client authentication methods, including Mutual TLS and Private Key JWT, which can leverage certificates.\\n\\n### Implementation Details\\nThe WSO2 Identity Server, implemented in this repository, supports the validation of signed request objects in OAuth2 and OpenID Connect flows. The `OAuth2RequestObjectSignatureValidationTestCase`  is an integration test specifically designed to verify this functionality. This test case involves generating service provider keys and updating application certificates, which are fundamental steps for enabling message signing with certificates .\\n\\nFor SAML-based authentication, the system also supports signing of authentication requests and responses. The `SAMLIdentityFederationTestCase`  demonstrates configuration options for signing SAML requests and responses, including properties like `IS_AUTHN_REQ_SIGNED` and `IS_AUTHN_RESP_SIGNED`  . The `ClientSignKeyDataHolder` class  is used to manage key and certificate data for the signing process, supporting both RSA and DSA algorithms .\\n\\n### Configuration Options\\nThe `oidc-metadata.json`  file outlines various configuration options related to token endpoint authentication methods and signature algorithms. Specifically, it lists `private_key_jwt` and `tls_client_auth` (Mutual TLS) as supported `tokenEndpointAuthMethod` options . These methods are crucial for TPPs to sign requests using certificates. The file also specifies various signature algorithms for `tokenEndpointSignatureAlgorithm`, `idTokenSignatureAlgorithm`, and `requestObjectSignatureAlgorithm` , including `PS256`, `ES256`, and `SHA256withRSA`, which are commonly used with qualified certificates.\\n\\nFor SAML, properties files like `travelocity.properties`  show configuration for `SAML2.EnableRequestSigning` , indicating that SAML authentication requests can be configured to be signed.\\n\\n### API Endpoints or Features\\nThe system supports FAPI (Financial-grade API) conformance, which includes FAPI2 Message Signing . This implies that the necessary API endpoints and features are in place to handle signed messages compliant with FAPI standards, which often require qualified electronic seals. The `oidc-fapi-conformance-tests/constants_fapi.py`  defines application configurations for `private_key_jwt` and `tls_client_auth` for FAPI conformance tests, demonstrating the use of these client authentication methods.\\n\\n### Documentation References\\nThe \"OAuth2 and OpenID Connect\" wiki page  provides an overview of the OAuth2 and OIDC implementation, including token management and token binding. It mentions \"Certificate\" as a binding type , which is directly relevant to using qualified certificates for electronic seals. The \"FAPI Conformance\" section  explicitly states support for FAPI2 Message Signing, which is a strong indicator of the system\\'s capability to handle signed requests from TPPs using qualified certificates.\\n\\n## Notes\\nThe provided context primarily focuses on the WSO2 Identity Server\\'s capabilities in handling signed messages within OAuth2/OIDC and SAML protocols. While the term \"qualified certificates for electronic seals compliant with eIDAS\" is not explicitly mentioned in the code snippets, the support for Mutual TLS (`tls_client_auth`), Private Key JWT (`private_key_jwt`), and various robust signing algorithms (e.g., `PS256`, `ES256`, `SHA256withRSA`) strongly suggests that the underlying mechanisms are in place to accommodate such requirements. The FAPI conformance further reinforces this, as FAPI often mandates advanced security features like client certificate-based authentication. The test cases and configuration files demonstrate the practical implementation and configuration options for message signing using certificates.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Testing Framework (wso2/product-is)](/wiki/wso2/product-is#6)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_915cac8c-2fee-49fb-8e05-cf6d66d95631\\n', 'id': 'lc_8e9b1596-2893-449f-8c78-c74cf24d1ece'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_a2fd933c-7be8-40e4-a14c-d842df0cb602'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0161",
      "requirement": {
        "requirement_id": "ATOM_039",
        "requirement_text": "The ASPSP MAY communicate additional error information using tppMessageInformation with category set to ERROR when 4xx or 5xx HTTP response codes occur",
        "strength": "MAY",
        "capability": "Error Handling",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0161_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, supports communicating additional error information when 4xx or 5xx HTTP response codes occur, but it does not explicitly use `tppMessageInformation` with a `category` set to `ERROR` as described in your query. Instead, it uses a standardized error response format that includes a `code`, `message`, `description`, and optionally a `traceId` .\\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server's REST APIs handle errors through a mechanism that validates HTTP status codes and provides structured error responses. The `RESTTestBase` class, which is extended by various API test classes, contains methods to validate these error responses .\\n\\nThe core error validation logic resides in the `validateErrorResponse` method . This method expects an error response to contain:\\n*   An HTTP status code .\\n*   An `errorCode` .\\n*   A `message` .\\n*   A `description` .\\n*   An optional `traceId` .\\n\\nThe `validateErrorResponse` method calls `validateHttpStatusCode` to check the HTTP status code . It also uses `validateResponseElement` to verify the presence and content of the `code`, `traceId`, `message`, and `description` fields . The `message` and `description` are validated against entries in `RESTAPIErrors.properties`  .\\n\\nAn example of this error handling can be seen in `ApplicationManagementFailureTest`, where various 4xx HTTP responses are tested, such as `SC_NOT_FOUND` (404)  and `SC_BAD_REQUEST` (400) . Similarly, `IdPFailureTest` validates `SC_BAD_REQUEST`  and `SC_NOT_FOUND`  responses.\\n\\n## Configuration Options\\n\\nThe error messages and descriptions are configurable through the `RESTAPIErrors.properties` file . This file maps error codes to human-readable messages and descriptions, which can include placeholders for dynamic values . For example, `CMT-50016.description` uses a placeholder `%s` for a claim dialect identifier .\\n\\n## API Endpoints or Features\\n\\nThe error handling mechanism is a general feature applied across various REST APIs within the WSO2 Identity Server. This includes, but is not limited to, the Application Management API , Identity Provider Management API , and Claim Management API . The `scim2.yaml` file also defines error response schemas for various HTTP status codes like 400, 401, 403, 404, 406, 409, 500, and 501, indicating a consistent error structure across SCIM 2.0 endpoints        .\\n\\n## Documentation References\\n\\nThe Server APIs wiki page provides an overview of the API architecture and mentions error handling through exception mappers . This indicates that there are specific classes responsible for mapping exceptions to the standardized error responses.\\n\\n## Notes\\n\\nWhile the repository supports providing additional error information with 4xx and 5xx HTTP response codes, it does not use the specific `tppMessageInformation` structure with a `category` of `ERROR` as requested. The error responses consistently include `code`, `message`, `description`, and `traceId` fields, which serve a similar purpose of conveying detailed error information to the client . The `validateFailedBasicAuthenticationResponseBody` method in `ApplicationNativeAuthentication2FATestCase` further confirms this structure by asserting the presence of these fields in error responses .\\n\\nWiki pages you might want to explore:\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_adcc5565-2759-4eda-bf62-30792de3ed26\\n\", 'id': 'lc_0627bc72-67ed-4d94-96be-7242278c9f23'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0161_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports communicating additional error information with 4xx or 5xx HTTP response codes. The error responses are typically structured as JSON objects containing `code`, `message`, `description`, `moreInfo`, and an array of `error` items. While the term `tppMessageInformation` with `category` set to `ERROR` is not explicitly found, the existing error handling mechanisms provide similar functionality for conveying detailed error information.\\n\\n## Implementation Details\\n\\nThe WSO2 API Manager uses a fault handling mechanism, often defined in Synapse configurations, to process and format error responses. For instance, the `jsonFault_v1.j2` template defines a payload structure for JSON fault responses . This template includes fields such as `am:code`, `am:type`, `am:message`, and `am:description` to convey error details . The `ERROR_CODE` and `ERROR_MESSAGE` properties from the message context are used to populate these fields .\\n\\nA test case, `APIMANAGER5326CustomStatusMsgTestCase.java`, demonstrates how custom status messages are handled for 400 HTTP responses . This test verifies that a custom \"Custom response\" message is included in the HTTP response for a 400 status code .\\n\\nAnother test, `ErrorMessageTypeTestCase.java`, confirms that authentication failures return a JSON error response containing a \"fault\" object . This indicates a general capability to return structured JSON error messages.\\n\\n## Configuration Options\\n\\nError handling configurations are often managed through Synapse sequences. The `fault` sequence, as seen in `synapseconfig.xml`, logs error details like `ERROR_CODE` and `ERROR_MESSAGE` . It also uses a `payloadFactory` to construct an XML fault message, which can be adapted for JSON responses . The `CUSTOM_HTTP_SC` property can be set to override the default HTTP status code, allowing for flexible error responses .\\n\\nThe `ERROR_CODE`, `ERROR_MESSAGE`, and `ERROR_DETAIL` are well-defined properties that can be set on the Synapse message context during a fault  . These properties are then used to construct the error response payload.\\n\\n## API Endpoints or Features\\n\\nThe OpenAPI specifications for various APIs within the `wso2/product-apim` repository define common error response structures for 4xx and 5xx HTTP codes. These specifications consistently refer to a shared `Error` schema    .\\n\\nThe `Error` schema typically includes:\\n*   `code`: An integer representing the error code .\\n*   `message`: A string providing a concise error message .\\n*   `description`: A detailed description of the error message .\\n*   `moreInfo`: An optional URL with more details about the error .\\n*   `error`: An array of `ErrorListItem` objects for multiple individual errors, such as validation errors .\\n\\nThe `ErrorListItem` further defines `code` and `message` for individual errors .\\n\\n## Documentation References\\n\\nThe documentation for the property mediator in Synapse configurations describes the `ERROR_CODE`, `ERROR_MESSAGE`, and `ERROR_DETAIL` properties that are used during fault handling  . These properties are crucial for populating the detailed error information in the response.\\n\\n## Notes\\n\\nThe user\\'s query specifically mentions `tppMessageInformation` with `category` set to `ERROR`. While the codebase does not explicitly use these exact terms, the functionality described (communicating additional error information with 4xx or 5xx HTTP response codes) is supported through the `Error` DTO and Synapse fault sequences. The `Error` DTO provides a structured way to include error `code`, `message`, `description`, and `moreInfo`, which aligns with the intent of providing additional error details. The `category` concept might be implicitly covered by the `type` field in the `am:fault` structure or the `message` and `description` fields in the `Error` DTO.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_67ff1269-3ce5-417a-8214-d76a5f47e561\\n', 'id': 'lc_3e6f540c-2ebf-4904-a460-6145caf25e92'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0162",
      "requirement": {
        "requirement_id": "ATOM_066",
        "requirement_text": "The system MAY include additional hyperlinks beyond specified requirements and MUST document these in ASPSP PSD2 documentation.",
        "strength": "MAY",
        "capability": "General",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\838576b0-1da9-498e-bcd3-b1f1d46287fc\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "unknown",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0162_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of additional hyperlinks in API responses, particularly within the context of pagination for Organization Discovery and Meta Attributes APIs. These hyperlinks are used for navigation (e.g., \"next\" and \"previous\" links) and are part of the API\\'s pagination mechanism. The system validates the presence and correctness of these links in integration tests.   \\n\\n## Implementation Details\\n\\nThe `wso2/product-is` repository implements hyperlinks primarily for pagination within its REST APIs. For instance, in the `OrganizationManagementSuccessTest.java` file, the `LINKS_PATH_PARAM` is used to extract a list of links from API responses.    These links typically include \"next\" and \"previous\" relations, as defined by `LINK_REL_NEXT` and `LINK_REL_PREVIOUS` constants.   The `getLink` method is responsible for extracting a specific link based on its relation. \\n\\nThe `validateOrganizationDiscoveryOffsetIsInLinks` method further demonstrates how the system parses and validates the `offset` parameter within these hyperlinks.  This indicates that the structure and content of these hyperlinks are explicitly managed and verified. \\n\\n## Configuration Options\\n\\nThe presence and behavior of these hyperlinks are implicitly configured through the API\\'s pagination parameters, such as `limit` and `offset`.   The system defines default limits, such as `DEFAULT_ORG_LIMIT` and `DEFAULT_META_ATTRIBUTES_LIMIT`, which influence when \"next\" links are generated.  \\n\\n## API Endpoints or Features\\n\\nThe hyperlinks are a feature of the pagination mechanism in several REST APIs, including:\\n\\n*   **Organization Discovery API**: Endpoints like `/api/server/v1/organizations/discovery` return paginated results with \"next\" and \"previous\" links.  The `testGetPaginatedOrganizationsDiscoveryWithOffset` and `testGetPaginatedOrganizationsDiscoveryForNumericEdgeCasesOfOffsetAndOffsetWithLimit` methods in `OrganizationManagementSuccessTest.java` specifically test these pagination links.  \\n*   **Organization Meta Attributes API**: The endpoint `/api/server/v1/organizations/meta-attributes` also provides paginated results with navigation links.  The `testGetPaginatedMetaAttributes` method verifies both forward and backward pagination using these links. \\n\\nThe API Layer wiki page also generally mentions that APIs returning collections of resources support pagination through `limit` and `offset` parameters, and the response includes pagination links for navigating the result set. \\n\\n## Documentation References\\n\\nThe presence and handling of these hyperlinks are documented through the integration tests themselves, which serve as executable specifications. For example, the `validatePaginationLinksForOrganizationDiscovery` method explicitly checks the conditions for the presence or absence of \"next\" and \"previous\" links based on whether it\\'s the first, last, or a middle page.  This ensures that the behavior of these hyperlinks is well-defined and can be safely ignored or utilized by TPPs as per standard pagination practices. \\n\\n## Notes\\n\\nThe user\\'s query specifically mentions \"ASPSP PSD2 documentation\". While the codebase demonstrates the implementation and testing of hyperlinks for API pagination, there is no explicit mention or reference to \"ASPSP PSD2 documentation\" within the provided snippets. Therefore, I cannot confirm if these specific hyperlinks are documented in that particular context. The hyperlinks are a standard feature of REST API pagination, and their behavior is consistent with common API design principles.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d4812122-ced3-44b5-93cc-7c446e5d6bc8\\n', 'id': 'lc_7b9aa3a0-ef31-45a6-8448-08dab0001f8d'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0162_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'I appreciate your question, but I need to clarify what you\\'re asking about. Your prompt references \"ASPSP PSD2 documentation\" and requirements about \"additional hyperlinks\" that \"MUST be documented\" and \"can be safely ignored by TPPs\" (Third Party Providers).\\n\\nThis terminology is specific to **PSD2 (Payment Services Directive 2)** compliance in European banking systems, particularly around Open Banking standards and ASPSP (Account Servicing Payment Service Provider) API specifications.\\n\\nHowever, the codebase I\\'m viewing is **WSO2 API Manager** (`wso2/product-apim`), which is a general-purpose API management platform. <cite/>\\n\\nThe code snippets available show:\\n- API documentation management features (adding, updating, removing documents) \\n- General API endpoint documentation \\n\\nBut I don\\'t see any PSD2-specific or ASPSP-specific implementation details, configuration options, or documentation in the provided codebase context. <cite/>\\n\\n**To properly answer your question, I would need:**\\n1. Confirmation that this WSO2 API Manager instance is being used for PSD2/Open Banking compliance\\n2. Access to PSD2-specific configuration files or modules\\n3. Documentation or code related to hyperlink handling in the context of PSD2 requirements\\n\\nCould you clarify if you\\'re asking about a PSD2-specific implementation within WSO2 API Manager, or if you\\'re looking at a different codebase?\\n\\n## Notes\\n\\nThe WSO2 API Manager codebase shown focuses on general API documentation management and doesn\\'t contain visible PSD2 or ASPSP-specific compliance features. If PSD2 support exists in this product, it would likely be in separate modules or configuration files not shown in the current context.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ed00d814-cd1d-48c7-bdfa-1a03b642824e\\n', 'id': 'lc_60d67ea6-a12a-4f70-89ef-03141f307318'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    }
  ],
  "fully_supported_count": 0,
  "partially_supported_count": 101,
  "not_supported_count": 56,
  "configuration_needed_count": 0,
  "remediable_gaps_count": 0
}