{
  "report_id": "f9e1eeca-7110-46e3-936e-698f10bbb420",
  "spec_source": "c11d1a51-22fa-4934-a589-afb65d38f081",
  "analysis_timestamp": "2026-01-16T02:41:06.716750",
  "total_requirements": 231,
  "gaps": [
    {
      "gap_id": "GAP_0001",
      "requirement": {
        "requirement_id": "ATOM_191",
        "requirement_text": "The GET /v1/card-accounts/{account-id}/transactions endpoint SHALL support dateFrom query parameter to specify the starting date of the transaction list.",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0001_1",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_2",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_3",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_4",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_5",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0001_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': \"Yes, the repository supports the `GET /v1/card-accounts/{account-id}/transactions` endpoint with a `dateFrom` query parameter to specify the starting date of the transaction list.  This functionality is defined within the OpenAPI specification for Account Information APIs. \\n\\n## Implementation Details\\n\\nThe `dateFrom` parameter corresponds to `TransactionFromDateTime` in the API's data models.  This parameter is used to specify the start date and time for a transaction query period.  If `TransactionFromDateTime` is not provided, the query will return data from the earliest available transaction. \\n\\nThe `ConsentAuthorizeUtil.java` file includes logic to populate `Transaction From Date Time` into consent data, indicating its use in authorization flows.  The `DefaultConsentManageValidator.java` validates the `TransactionFromDateTime` parameter, ensuring it is a valid ISO 8601 date-time format.  It also validates that `TransactionToDateTime` is after `TransactionFromDateTime` if both are provided. \\n\\n## Configuration Options\\n\\nThe `TransactionFromDateTime` and `TransactionToDateTime` are part of the `Data` object within the consent initiation payload.  These are configured as part of the `initiationPayload` in test frameworks, demonstrating their expected presence in API requests. \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `/accounts/{AccountId}/transactions` which supports the `GET` method.  This endpoint is part of the Account Information APIs, which are designed to provide account-related services, including transaction history. \\n\\n## Documentation References\\n\\nThe OpenAPI specification `account-info-swagger.yaml` explicitly defines `TransactionFromDateTime` and `TransactionToDateTime` as parameters for filtering transactions.  These fields are described as specifying the start and end dates for the transaction query period, respectively.  \\n\\n## Test Criteria\\n\\nThe presence of `TransactionFromDateTime` in test payloads, such as `ACCOUNT_AUTH_SERVLET_DATA` and `initiationPayload`, confirms that the system is designed to handle and test this parameter for filtering transactions.   The validation logic in `DefaultConsentManageValidator.java` also ensures that `TransactionFromDateTime` is a valid date and that it precedes `TransactionToDateTime`, which directly supports the test criteria of verifying that the `dateFrom` parameter filters transactions from the specified date inclusively.  \\n\\n## Notes\\n\\nThe user's query specifically mentions `/v1/card-accounts/{account-id}/transactions`. While the provided `account-info-swagger.yaml` defines `/accounts/{AccountId}/transactions`,  it is highly probable that `/v1/card-accounts/{account-id}/transactions` is a versioned or specialized endpoint that leverages the same underlying transaction filtering mechanisms and data models, given the consistent naming conventions and the presence of `TransactionFromDateTime` in the shared consent management components. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ef9cbd02-67ca-4af1-b948-124638eacfc7\\n\", 'id': 'lc_2ddf2e24-47fc-4940-82e6-0907155f46e3'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0002",
      "requirement": {
        "requirement_id": "ATOM_115",
        "requirement_text": "When XML status format is chosen, the system SHALL follow XML schema definitions of the original pain.001 schema",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0002_1",
          "text": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!--\n ~ Copyright (c) 2024, WSO2 LLC. (https://www.wso2.com).\n ~\n ~ WSO2 LLC. licenses this file to you under the Apache License,\n ~ Version 2.0 (the \"License\"); you may not use this file except\n ~ in compliance with the License.\n ~ You may obtain a copy of the License at\n ~\n ~     http://www.apache.org/licenses/LICENSE-2.0\n ~\n ~ Unless required by applicable law or agreed to in writing,\n ~ software distributed under the License is distributed on an\n ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n ~ KIND, either express or implied. See the License for the\n ~ specific language governing permissions and limitations\n ~ under the License.\n -->\n\n<web-app version=\"2.5\" xmlns=\"http://java.sun.com/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee\n         http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\">\n\n    <display-name>Financial-Services</display-name>\n\n    <servlet>\n        <servlet-name>AccountServiceJAXServlet</servlet-name>\n        <display-name>AccountService JAX-WS/JAX-RS Servlet</display-name>\n        <description>AccountService JAX-WS/JAX-RS Endpoint</description>\n        <servlet-class>\n            org.apache.cxf.jaxrs.servlet.CXFNonSpringJaxrsServlet\n        </servlet-class>\n        <init-param>\n            <param-name>service-list-stylesheet</param-name>\n            <param-value>servicelist.css</param-value>\n        </init-param>\n        <init-param>\n            <param-name>jersey.config.server.provider.classnames</param-name>\n            <param-value>org.glassfish.jersey.media.multipart.MultiPartFeature</param-value>\n        </init-param>\n\n        <load-on-startup>1</load-on-startup>\n\n        <init-param>\n            <param-name>jaxrs.serviceClasses</param-name>\n            <param-value>\n                org.wso2.financial.services.accelerator.demo.backend.services.AccountService\n            </param-value>\n        </init-param>\n    </servlet>\n\n    <servlet>\n        <servlet-name>PaymentServiceJAXServlet</servlet-name>\n        <display-name>PaymentService JAX-WS/JAX-RS Servlet</display-name>\n        <description>PaymentService JAX-WS/JAX-RS Endpoint</description>\n        <servlet-class>\n            org.apache.cxf.jaxrs.servlet.CXFNonSpringJaxrsServlet\n        </servlet-class>\n        <init-param>\n            <param-name>service-list-stylesheet</param-name>\n            <param-value>servicelist.css</param-value>\n        </init-param>\n        <init-param>\n            <param-name>jersey.config.server.provider.classnames</param-name>\n            <param-value>org.glassfish.jersey.media.multipart.MultiPartFeature</param-value>\n        </init-param>\n\n        <load-on-startup>1</load-on-startup>\n\n        <init-param>\n            <param-name>jaxrs.serviceClasses</param-name>\n            <param-value>\n                org.wso2.financial.services.accelerator.demo.backend.services.PaymentService\n            </param-value>\n        </init-param>\n    </servlet>\n\n    <servlet>\n        <servlet-name>VrpServiceJAXServlet</servlet-name>\n        <display-name>VrpService JAX-WS/JAX-RS Servlet</display-name>\n        <description>VrpService JAX-WS/JAX-RS Endpoint</description>\n        <servlet-class>\n            org.apache.cxf.jaxrs.servlet.CXFNonSpringJaxrsServlet\n        </servlet-class>\n        <init-param>\n            <param-name>service-list-stylesheet</param-name>\n            <param-value>servicelist.css</param-value>\n        </init-param>\n        <init-param>\n            <param-name>jersey.config.server.provider.classnames</param-name>\n            <param-value>org.glassfish.jersey.media.multipart.MultiPartFeature</param-value>\n        </init-param>\n\n        <load-on-startup>1</load-on-startup>\n\n        <init-param>\n            <param-name>jaxrs.serviceClasses</param-name>\n            <param-value>\n                org.wso2.financial.services.accelerator.demo.backend.services.VrpService\n            </param-value>\n        </init-param>\n    </servlet>\n\n    <servlet>\n        <servlet-name>FundsConfirmationServiceJAXServlet</servlet-name>\n        <display-name>FundsConfirmationService JAX-WS/JAX-RS Servlet</display-name>\n        <description>FundsConfirmationService JAX-WS/JAX-RS Endpoint</description>\n        <servlet-class>\n            org.apache.cxf.jaxrs.servlet.CXFNonSpringJaxrsServlet\n        </servlet-class>\n        <init-param>\n            <param-name>service-list-stylesheet</param-name>\n            <param-value>servicelist.css</param-value>\n        </init-param>\n        <init-param>\n            <param-name>jersey.config.server.provider.classnames</param-name>\n            <param-value>org.glassfish.jersey.media.multipart.MultiPartFeature</param-value>\n        </init-param>\n\n        <load-on-startup>1</load-on-startup>\n\n        <init-param>\n            <param-name>jaxrs.serviceClasses</param-name>\n            <param-value>\n                org.wso2.financial.services.accelerator.demo.backend.services.FundsConfirmationService\n            </param-value>\n        </init-param>\n    </servlet>\n\n    <servlet-mapping>\n        <servlet-name>AccountServiceJAXServlet</servlet-name>\n        <url-pattern>/services/accounts/*</url-pattern>\n    </servlet-mapping>\n    <servlet-mapping>\n        <servlet-name>PaymentServiceJAXServlet</servlet-name>\n        <url-pattern>/services/payments/*</url-pattern>\n    </servlet-mapping>\n    <servlet-mapping>\n        <servlet-name>VrpServiceJAXServlet</servlet-name>\n        <url-pattern>/services/domestic-vrps/*</url-pattern>\n    </servlet-mapping>\n    <servlet-mapping>\n        <servlet-name>FundsConfirmationServiceJAXServlet</servlet-name>\n        <url-pattern>/services/fundsConfirmation/*</url-pattern>\n    </servlet-mapping>\n\n    <session-config>\n        <session-timeout>60</session-timeout>\n    </session-config>\n\n</web-app>",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_2",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_4",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0002_5",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, demonstrates support for XML payload processing, including the `pain.001` schema, primarily within its idempotency validation mechanism.   While direct XML schema validation against `pain.001` for status responses isn\\'t explicitly detailed as a separate feature, the system\\'s ability to handle and compare XML payloads suggests a foundation for such a requirement. \\n\\n## Implementation Details\\n\\nThe `IdempotencyValidator` class in `financial-services-accelerator/components/org.wso2.financial.services.accelerator.consent.mgt.extensions/src/main/java/org/wso2/financial.services.accelerator.consent.mgt.extensions/common/idempotency/IdempotencyValidator.java` contains a private method `isXMLPayloadSimilar` that compares two XML payloads.  This method uses `DocumentBuilderFactory` to parse XML strings into `Document` objects and then compares them using `isEqualNode()`.  The `DocumentBuilderFactory` is configured to prevent XML External Entity (XXE) vulnerabilities and to ignore comments and whitespace for robust comparison. \\n\\nA test case in `IdempotencyValidatorTests.java` demonstrates the use of a `pain.001.001.08` XML structure as a `FILE_UPLOAD_REQUEST_BODY`.  This indicates that the system is designed to handle and process XML payloads conforming to the `pain.001` schema. \\n\\n## Configuration Options\\n\\nThe `IdempotencyValidator` can be enabled or disabled via the `isIdempotencyValidationEnabled()` configuration property.  While this directly controls idempotency validation, it implies that the underlying XML parsing and comparison capabilities are configurable.  The `IdempotencyValidator` also supports configurable time windows for validation. \\n\\n## API Endpoints or Features\\n\\nThe `ConsentManageEndpoint` exposes various management APIs, including `manageFileUploadPost()` and `manageFileGet()`, which handle file uploads and retrievals.  The `DefaultConsentManageHandler` processes these requests, and it\\'s within these operations that XML payloads, such as `pain.001`, could be handled.  The system also supports external service extensions like `PRE_PROCESS_CONSENT_FILE_UPLOAD` and `ENRICH_CONSENT_FILE_RESPONSE`, which could be used to implement custom XML schema validation logic. \\n\\n## Documentation References\\n\\nThe \"Consent Management\" wiki page provides an overview of the system\\'s architecture, including the `IdempotencyValidator` and its role in handling different payload types.   It also details the external service integration capabilities, which are relevant for implementing custom validation logic for XML status responses. \\n\\n## Notes\\n\\nWhile the repository demonstrates the ability to parse and compare XML payloads, including those conforming to `pain.001`, the explicit requirement for \"XML schema validation of the original pain.001 schema\" for *status responses* is not directly implemented as a dedicated feature. The existing XML handling is primarily for idempotency validation. To fully meet the requirement, an additional component or extension would likely be needed to perform explicit schema validation on outgoing XML status responses. The external service extension points could be utilized for this purpose.\\n\\nWiki pages you might want to explore:\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_753ea09b-a41a-4e86-9dfc-7941c3a1e598\\n', 'id': 'lc_42320b44-46ed-4192-92a3-7a6325c4b9ba'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0003",
      "requirement": {
        "requirement_id": "ATOM_223",
        "requirement_text": "ASPSP SHALL provide TPPs with configuration data conforming to the OAuth 2.0 Authorisation Server Metadata specification",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "13",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0003_1",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_2",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_3",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_4",
          "text": "The TPPs can create OAuth 2.0 client applications to facilitate banking services exposed via Bank APIs. WSO2 Open Banking provides the Client Registration feature to register the applications in the bank's back end. The TPP applications go through an in-depth verification during this process to make sure the application is authorized and secured before sharing customers\u2019 financial data.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0003_5",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0004",
      "requirement": {
        "requirement_id": "ATOM_192",
        "requirement_text": "The bookingStatus parameter SHALL be mandatory and support 'booked' status, with 'pending' and 'both' being optional for the ASPSP.",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0004_1",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, specifically within the `wso2/financial-services-accelerator` project, supports the `bookingStatus` parameter with \\'Booked\\' and \\'Pending\\' values. The `account-info-swagger.yaml` file defines the `OBEntryStatus1Code` enum, which explicitly lists these two statuses.  The concept of \\'both\\' is not explicitly defined as a `bookingStatus` value in the provided API specifications.\\n\\n## Implementation Details\\n\\nThe `bookingStatus` parameter is represented by the `Status` field within the `OBTransaction5` object, which is defined in the `account-info-swagger.yaml` file.   The `Status` field references the `OBEntryStatus1Code` definition. \\n\\nThe `OBEntryStatus1Code` enum specifies the allowed values for the transaction status:\\n*   `Booked`: This indicates that a transaction entry is posted to an account. \\n*   `Pending`: This indicates that a transaction entry is awaiting posting. \\n\\nAn example of a transaction response in the demo backend service, `AccountService.java`, shows a hardcoded `Status` as \"Booked\".  This demonstrates that the system is designed to handle the \"Booked\" status.\\n\\n## API Endpoints or Features\\n\\nThe `bookingStatus` parameter is relevant to the Account Information APIs, specifically when retrieving transaction details.  The `GET /accounts/{AccountId}/transactions` endpoint in the `AccountService.java` is an example of where transaction data, including the `Status` (booking status), would be returned. \\n\\n## Documentation References\\n\\nThe API specification for Account Information, `account-info-swagger.yaml`, serves as the primary documentation for the `bookingStatus` parameter and its allowed values.  The `Overview` wiki page also mentions \"Account Information APIs\" as one of the supported API categories. \\n\\n## Notes\\n\\nThe prompt mentions \"both\" as an optional status. However, the provided `OBEntryStatus1Code` enum in `account-info-swagger.yaml` only defines \"Booked\" and \"Pending\".  There is no explicit support for a \"both\" status in the current API definition. If \"both\" implies retrieving transactions with either \"Booked\" or \"Pending\" status, this would typically be handled by the API consumer making two separate requests or by the API supporting a query parameter that allows multiple status values.\\n\\nThe `payment-initiation-openapi.yaml` file also defines a `Status` enum for payments, which includes \"Pending\" but has a different set of \"Accepted\" statuses instead of \"Booked\".  This indicates that the `bookingStatus` concept is specific to transaction reporting in the Account Information APIs.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3433f84a-9985-4073-b8af-9d7d57e59293\\n', 'id': 'lc_98928772-94f8-4ab7-ba47-da7539dee887'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0005",
      "requirement": {
        "requirement_id": "ATOM_056",
        "requirement_text": "The system shall support transaction status ACWC (AcceptedWithChanges) to indicate successful checks with ASPSP-applied changes to payment initiation such as requested execution date modifications",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0005_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0005_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0005_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0005_4",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0005_5",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0005_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support the transaction status `ACWC` (AcceptedWithChanges) as defined in the prompt. The `payment-initiation-openapi.yaml`  defines a set of allowed payment statuses, but `ACWC` is not among them.\\n\\n### Implementation Details and API Endpoints\\n\\nThe `payment-initiation-openapi.yaml` file defines the API specification for payment initiation. The `obWritePaymentResponse5` schema, which represents the response for a payment submission, includes a `Status` field . The enumerated values for this `Status` field are:\\n*   `AcceptedCreditSettlementCompleted` \\n*   `AcceptedSettlementCompleted` \\n*   `AcceptedSettlementInProcess` \\n*   `AcceptedWithoutPosting` \\n*   `Pending` \\n*   `Rejected` \\n\\nThe `PaymentService.java`  in the demo backend sets the payment status to `AcceptedSettlementCompleted`  by default. This indicates that the current implementation does not include logic to return an `ACWC` status.\\n\\nThe API also includes `ExpectedExecutionDateTime`  and `ExpectedSettlementDateTime`  fields in the payment response, which could potentially be used to communicate changes in execution dates. However, there is no explicit status code like `ACWC` to indicate that these dates have been modified by the ASPSP.\\n\\n### Configuration Options\\n\\nThe `financial-services.xml` configuration file, parsed by `FinancialServicesConfigParser`, manages various settings for the accelerator . While it supports configurations for consent management, identity server extensions, and event notifications, there is no explicit configuration option mentioned in the provided context to enable or configure the `ACWC` transaction status .\\n\\n### Documentation References\\n\\nThe provided wiki page \"Overview\"  and \"Core Components\" <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"2.1\" end=\"2.1\" /> describe the overall architecture and components of the WSO2 Financial Services Accelerator. These documents mention support for payment initiation services , but they do not specifically detail the handling of `ACWC` status or ASPSP-applied changes to payment initiation parameters.\\n\\n## Notes\\n\\nThe `payment-initiation-openapi.yaml`  defines the API contract for payment initiation and includes various payment statuses. The absence of `ACWC` in the enumerated list of statuses suggests that this specific status is not directly supported by the current API definition. While the API allows for `ExpectedExecutionDateTime` and `ExpectedSettlementDateTime` to be returned, there is no explicit mechanism to signal that these values have been modified by the ASPSP. To support the `ACWC` status, modifications to the OpenAPI specification and the backend payment processing logic would be required.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_5ee009c1-32fc-4771-b942-7d8311400c73\\n', 'id': 'lc_c6076eb9-09fb-4d88-b2d0-956264d7e43c'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0006",
      "requirement": {
        "requirement_id": "ATOM_160",
        "requirement_text": "The system SHALL support Accept header for specifying preferred response formats including JSON, XML, and text/plain",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0006_1",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0006_2",
          "text": "All dates in the HTTP headers are represented as RFC 7231 Full Dates. An\n      example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0006_3",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0006_4",
          "text": "All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  StatusUpdateDateTime:\n    description: >-\n      Date and time at which the resource status was updated.All dates in the\n      JSON payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  OBExternalRequestStatus1Code:\n    description: Specifies the status of consent resource in code form.\n    type: string\n    enum:\n      - Authorised\n      - AwaitingAuthorisation\n      - Rejected\n      - Revoked\n  OBReadAccount4:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        type: object\n        properties:\n          Account:\n            type: array\n            items:\n              $ref: '#/definitions/OBAccount4'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadAccount5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        type: object\n        properties:\n          Account:\n            type: array\n            items:\n              $ref: '#/definitions/OBAccount4'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n    additionalProperties: false\n  OBAccount4:\n    type: object\n    description: >-\n      Unambiguous identification of the account to which credit and debit\n      entries are made.\n    required:\n      - AccountId\n      - Currency\n      - AccountType\n      - AccountSubType\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      Status:\n        $ref: '#/definitions/OBAccountStatus1Code'\n      StatusUpdateDateTime:\n        $ref: '#/definitions/StatusUpdateDateTime'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n      AccountType:\n        $ref: '#/definitions/OBExternalAccountType1Code'\n      AccountSubType:\n        $ref: '#/definitions/OBExternalAccountSubType1Code'\n      Description:\n        $ref: '#/definitions/Description'\n      Nickname:\n        $ref: '#/definitions/Nickname'\n      Account:\n        type: array\n        items:\n          type: object\n          description: Provides the details to identify an account.\n          required:\n            - SchemeName\n            - Identification\n          properties:\n            SchemeName:\n              $ref: '#/definitions/OBExternalAccountIdentification4Code'\n            Identification:\n              $ref: '#/definitions/Identification'\n            Name:\n              $ref: '#/definitions/Name'\n            SecondaryIdentification:\n              $ref: '#/definitions/SecondaryIdentification'\n      Servicer:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification5'\n  OBReadBalance1:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        type: object\n        required:\n          - Balance\n        properties:\n          Balance:\n            type: array\n            items:\n              type: object\n              description: Set of elements used to define the balance details.\n              required:\n                - AccountId\n                - CreditDebitIndicator\n                - Type\n                - DateTime\n                - Amount\n              properties:\n                AccountId:\n                  $ref: '#/definitions/AccountId'\n                CreditDebitIndicator:\n                  $ref: '#/definitions/OBCreditDebitCode'\n                Type:\n                  $ref: '#/definitions/OBBalanceType1Code'\n                DateTime:\n                  description: >-\n                    Indicates the date (and time) of the balance.All dates in\n                    the JSON payloads are represented in ISO 8601 date-time\n                    format.\n\n                    All date-time fields in responses must include the timezone.\n                    An example is below:\n\n                    2017-04-05T10:43:07+00:00\n                  type: string\n                  format: date-time\n                Amount:\n                  type: object\n                  required:\n                    - Amount\n                    - Currency\n                  description: Amount of money of the cash balance.\n                  properties:\n                    Amount:\n                      $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                    Currency:\n                      $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n                CreditLine:\n                  type: array\n                  items:\n                    type: object\n                    description: >-\n                      Set of elements used to provide details on the credit\n                      line.\n                    required:\n                      - Included\n                    properties:\n                      Included:\n                        description: >-\n                          Indicates whether or not the credit line is included\n                          in the balance of the account.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0006_5",
          "text": "Sun, 10 Sep 2017 19:43:31 UTC\n    pattern: >-\n      ^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\d{2}\n      (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\d{4} \\d{2}:\\d{2}:\\d{2}\n      (GMT|UTC)$\n  ConsentId:\n    name: ConsentId\n    in: path\n    description: ConsentId\n    required: true\n    type: string\n  AccountId:\n    name: AccountId\n    in: path\n    description: AccountId\n    required: true\n    type: string\n  x-fapi-interaction-id:\n    in: header\n    name: x-fapi-interaction-id\n    type: string\n    required: false\n    description: An RFC4122 UID used as a correlation id.\nresponses:\n  201AccountAccessConsentsCreated:\n    description: Account Access Consents Created\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadConsentResponse1'\n  200AccountAccessConsentsConsentIdRead:\n    description: Account Access Consents Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadConsentResponse1'\n  204AccountAccessConsentsConsentIdDeleted:\n    description: Account Access Consents Deleted\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  200AccountsRead:\n    description: Accounts Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadAccount5'\n  200AccountsAccountIdRead:\n    description: Accounts Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadAccount4'\n  200AccountsAccountIdBalancesRead:\n    description: Balances Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadBalance1'\n  200AccountsAccountIdTransactionsRead:\n    description: Transactions Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        required: true\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadTransaction5'\n  400Error:\n    description: Bad request\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\n  401Error:\n    description: Unauthorized\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  403Error:\n    description: Forbidden\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\n  404Error:\n    description: Not found\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  405Error:\n    description: Method Not Allowed\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  406Error:\n    description: Not Acceptable\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  415Error:\n    description: Unsupported Media Type\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  429Error:\n    description: Too Many Requests\n    headers:\n      Retry-After:\n        description: Number in seconds to wait\n        type: integer\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  500Error:\n    description: Internal Server Error\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    tokenUrl: 'https://authserver.example/token'\n    scopes:\n      accounts: Ability to read Accounts information\n    description: TPP client credential authorisation flow with the ASPSP\n    x-scopes-bindings:\n      accounts: Internal/consumer\n  PSUOAuth2Security:\n    type: oauth2\n    flow: accessCode\n    tokenUrl: 'https://authserver.example/token'\n    authorizationUrl: 'https://authserver.example/authorization'\n    scopes:\n      accounts: Ability to read Accounts information\n    description: >-\n      OAuth flow, it is required when the PSU needs to perform SCA with the\n      ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\n    x-scopes-bindings:\n      accounts: Internal/consumer\n  default:\n    type: oauth2\n    authorizationUrl: 'https://test.com'\n    flow: implicit\n    scopes:\n      accounts: Ability to read Accounts information\n    x-scopes-bindings:\n      accounts: Internal/consumer\ndefinitions:\n  OBReadConsent1:\n    type: object\n    required:\n      - Data\n      - Risk\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadData1'\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n  OBReadConsentResponse1:\n    type: object\n    required:\n      - Data\n      - Risk\n    properties:\n      Data:\n        type: object\n        required:\n          - ConsentId\n          - CreationDateTime\n          - StatusUpdateDateTime\n          - Permissions\n        properties:\n          ConsentId:\n            description: >-\n              Unique identification as assigned to identify the account access\n              consent resource.\n            type: string\n            minLength: 1\n            maxLength: 128\n          CreationDateTime:\n            $ref: '#/definitions/CreationDateTime'\n          Status:\n            $ref: '#/definitions/OBExternalRequestStatus1Code'\n          StatusUpdateDateTime:\n            $ref: '#/definitions/StatusUpdateDateTime'\n          Permissions:\n            type: array\n            items:\n              $ref: '#/definitions/OBExternalPermissions1Code'\n            minItems: 1\n          ExpirationDateTime:\n            description: >-\n              Specified date and time the permissions will expire.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0006_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': \"Yes, the WSO2 Financial Services Accelerator supports the `Accept` header for specifying preferred response formats including JSON and XML.  The system explicitly defines constants for `application/json`, `application/xml`, and `text/xml` content types.  While `text/plain` is not explicitly listed as an `Accept` header preference in the provided snippets, `text/xml` is supported. \\n\\n## Implementation Details\\n\\nThe `Gateway` component, specifically the `GatewayUtils` class, contains logic to check the content type of both requests and responses.  The `isEligibleRequest` method verifies if an incoming request's `Content-Type` header starts with `application/json`, `application/xml`, or `text/xml`.  Similarly, the `isEligibleResponse` method checks if a response's `Content-Type` header matches these formats.  These checks are performed using constants defined in `GatewayConstants` such as `JSON_CONTENT_TYPE`, `APPLICATION_XML_CONTENT_TYPE`, and `TEXT_XML_CONTENT_TYPE`. \\n\\nThe `payment-initiation-openapi.yaml` file, which defines the OpenAPI specification for payment initiation, explicitly lists `application/json` and `application/jose+jwe` as supported content types for various responses, including successful payment creations and reads, and error responses.       \\n\\n## Configuration Options\\n\\nThe `GatewayConstants` class defines the supported content types as static final strings.  These constants are used within the `GatewayUtils` for content type validation.  \\n\\n## API Endpoints or Features\\n\\nThe `payment-initiation-openapi.yaml` file specifies the `content` types for various API responses, indicating that the API endpoints are designed to return `application/json` and `application/jose+jwe`.  This implies that the system will respond with these formats based on the `Accept` header.\\n\\nIntegration tests, such as those found in `ConsentRequestBuilder.groovy`, `FSConnectorTest.groovy`, `ClientRegistrationRequestBuilder.groovy`, `AccountsRetrievalRequestBodyValidationTests.groovy`, `DCREndToEndFlowJSONPayload.groovy`, and `PaymentsInitiationRequestHeaderValidationTests.groovy`, demonstrate how `Accept` headers are used in requests and how content types are validated.    For example, `ConsentRequestBuilder.groovy` includes methods to build requests with specific `Accept` headers, including `ContentType.JSON` and `ContentType.XML`, and also tests for invalid `Accept` header values.    The `PaymentsInitiationRequestHeaderValidationTests.groovy` specifically tests for `415 Unsupported Media Type` when an invalid `Content-Type` is sent, indicating that the system enforces content type validation. \\n\\n## Documentation References\\n\\nThe `Core Components` wiki page provides an overview of the `Gateway` component, which is responsible for API processing.   The `GatewayUtils` class, which handles content type validation, is part of this component.  The OpenAPI specification in `payment-initiation-openapi.yaml` serves as a documentation reference for the supported response formats for the payment initiation endpoints. \\n\\n## Notes\\n\\nThe provided code snippets confirm support for `application/json`, `application/xml`, and `text/xml` through explicit constants and validation logic.    While `text/plain` is not explicitly mentioned in the constants or validation methods, `text/xml` is supported.  The OpenAPI specification also indicates support for `application/jose+jwe` in addition to `application/json` for responses.  The integration tests confirm that the system validates and enforces these content type preferences. \\n\\nWiki pages you might want to explore:\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_61f368e3-9092-4131-a312-5d2db54c6566\\n\", 'id': 'lc_a385a55e-6ed5-4580-a8c3-3ae52fe35471'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0007",
      "requirement": {
        "requirement_id": "ATOM_101",
        "requirement_text": "ASPSPs MUST support selection of SCA authentication method by PSU when multiple methods are available",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0007_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_2",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_3",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_4",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_5",
          "text": "## Configuring a custom Push Authenticator  \n\n1. Once implemented, build a JAR file for your project.\n2. Place the above-created JAR file in the `<IS_HOME>/repository/components/dropins` directory.\n3. Open the `<IS_HOME>/repository/conf/deployment.toml` file and configure your custom authenticator using the Fully \nQualified Name (FQN):\n\n      ``` toml\n      [open_banking.sca.idp]\n      name = \"CIBA-Push-Auth\"\n      ```\n    \n4. Save the configurations and restart the Identity Server.\n5. Follow the [Set up CIBA flow](../learn/ciba-set-up-flow.md#configuring-authenticator) documentation and try out the \nflow.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support multiple authentication methods, which is a prerequisite for allowing a PSU (Payment Services User) to select an SCA (Strong Customer Authentication) method. However, the provided context does not contain explicit implementation details, configuration options, or API endpoints specifically for the *selection* of an SCA authentication method by a PSU within an `Authorisation-Update Request` as described in your query.\\n\\n## Implementation Details and Configuration Options\\n\\nThe WSO2 Identity Server, as described in its architecture, includes an \"Authentication Framework\" that supports various authentication mechanisms, including local, federated, social, and multi-factor authenticators . This framework is designed to be extensible, allowing for the addition of new authentication methods .\\n\\nThe `pom.xml` file lists several authenticators that are part of the product, such as `BasicAuthenticator`, `FIDOAuthenticator`, `EmailOTPAuthenticator`, `SMSOTPAuthenticator`, `TOTPAuthenticator`, and `MagicLinkAuthenticator` . These authenticators represent different methods that could potentially be used for SCA.\\n\\nConfiguration of these authenticators is typically done via `AuthenticatorConfig` elements, as seen in `application-authentication-tanantDropdown-enabled.xml` and `application-authentication-default.xml`  . These configurations enable or disable specific authenticators and allow for parameterization.\\n\\nThe `Authentication Framework` also includes \"Flow Orchestration\" , which suggests that it can manage the sequence of authentication steps. This capability is further supported by the `StepBasedSequenceHandler` and `Sequences` defined in the `application-authentication-tanantDropdown-enabled.xml` and `application-authentication-default.xml` files  . While this indicates the system can handle multiple authentication steps, it does not explicitly detail how a PSU would *select* an SCA method when multiple are available.\\n\\n## API Endpoints or Features\\n\\nThe provided context mentions an \"API Layer\" with \"Server APIs\" and \"User APIs\" . However, there are no specific API endpoints or features detailed in the provided snippets that directly address the selection of an SCA authentication method by a PSU in an `Authorisation-Update Request`. The `sample-sp-import-tenant_updated.xml` file shows configurations for `InboundAuthenticationRequestConfig` for `oauth2`, `passivests`, and `openid` , but this relates to the initial authentication setup for a service provider, not dynamic SCA method selection by a user.\\n\\n## Documentation References\\n\\nThe \"Architecture\" wiki page provides a high-level overview of WSO2 Identity Server . It mentions \"Features and Capabilities\" as a separate section for specific features, but this document is not provided in the context . Without access to more detailed documentation, it\\'s not possible to confirm explicit support for PSU selection of SCA methods.\\n\\n## Conclusion\\n\\nBased on the provided codebase context, WSO2 Identity Server supports a wide range of authentication methods and has an extensible authentication framework that can orchestrate authentication flows. This suggests the underlying capability to support multiple SCA methods. However, the specific mechanism for a PSU to *select* an SCA authentication method during an `Authorisation-Update Request` and the corresponding API endpoints or configuration options are not explicitly detailed in the given snippets. To confirm this \"MUST\" requirement, further investigation into the `identity.application.authentication.framework` module and its related APIs would be necessary.\\n\\n## Notes\\n\\nThe provided snippets primarily focus on the general authentication framework, the inclusion of various authenticators as dependencies, and basic configuration examples. While the presence of multiple authenticators (e.g., TOTP, SMS OTP, Email OTP) indicates support for different SCA methods , the explicit user interface or API for a PSU to choose among these methods during an authorization update is not visible. The `ChallengeQuestionPostAuthnHandlerTestCase.java`  shows a post-authentication handler for challenge questions, which is a form of SCA, but it doesn\\'t involve user selection of the method.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_63f069df-c536-4727-b3d3-a741668af88e\\n', 'id': 'lc_3cc53518-dc1d-4667-86aa-79a49fec751e'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0007_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_73cff90e-4e42-41b5-b09f-05bef46bc0ff'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0008",
      "requirement": {
        "requirement_id": "ATOM_096",
        "requirement_text": "ASPSPs MUST validate TPP role semantics for payment initiation requests",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0008_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_2",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_3",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_4",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0008_5",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0009",
      "requirement": {
        "requirement_id": "ATOM_224",
        "requirement_text": "client_id parameter SHALL contain organizationIdentifier as provided in the eIDAS certificate with specific structure format",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "13.1",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0009_1",
          "text": "### getKeyId method\n\nThe method contains the KeyID calculation logic. You can customize it according to your requirements. Given below is \nthe method signature:\n\n``` java\npublic String getKeyId(Certificate certificate, JWSAlgorithm signatureAlgorithm, String tenantDomain) throws IdentityOAuth2Exception;\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0009_2",
          "text": "## Client Creation\n\nThe OpenAPI extension for dynamic client creation  provides the extendibility to validate the incoming dynamic client registration request attributes and store custom client data according to Open Banking\nspecificatio requirements. The data setting from this extension point will be stored as client metadata",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0009_3",
          "text": "## Writing a custom ID Token Builder\n\nThe default ID Token Builder in WSO2 Open Banking provides the pairwise subject calculation for authorization and token \nflow.\n\nIf the API consumer application supports the sector identifier URI parameter, the pairwise subject calculation is \nperformed using the **sector identifier URI**. Otherwise, the calculation is performed using the **callback URI**.\n\nGiven below is the Fully Qualified Name (FQN) of the default ID Token Builder: \n\n``` java\ncom.wso2.openbanking.accelerator.identity.idtoken.OBIDTokenBuilder\n```\n\nYou can implement a custom ID Token Builder for the **Authorization flow** by overriding the following method of this class:",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0009_4",
          "text": "## Validate Authorize Request\n\nThe OpenAPI extension for validate client sending authorize API requests to ensure request parameters are according to  the way\nallowed in the Open Banking  specificatio requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0009_5",
          "text": "## Configuring a custom ID Token Builder\n\nTo configure the custom ID Token Builder, follow the steps below:\n\n1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n\n2. Add the following tags and configure your custom ID Token Builder using its FQN:\n\n   ``` toml\n   [oauth.oidc.extensions]\n   id_token_builder = \"com.wso2.openbanking.accelerator.identity.idtoken.OBIDTokenBuilder\"\n   ```\n   \n!!! note\n    If `id_token_builder` is not configured, the default ID Token Builder `DefaultIDTokenBuilder` is used for the \n    `subject` claim calculation.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0009_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase context, there is no direct evidence or implementation details indicating support for a `client_id` parameter that *SHALL* contain an `organizationIdentifier` with the specific eIDAS certificate structure format: `PSD + 2-char country code + hyphen + 2-8 char NCA identifier + hyphen + PSP identifier`. The codebase primarily deals with standard OAuth 2.0 and OpenID Connect `client_id` handling, which typically involves a string identifier without a mandated specific format related to eIDAS certificates.\\n\\n### Implementation Details and Configuration Options\\nThe codebase shows various instances of `client_id` being used and configured, but none of them enforce the specific eIDAS format you described. For example, in the `add-oidc-idp.json` file, a `ClientId` property is defined with a generic alphanumeric value like `\"abcd1234wxyz5678ijklmnopqrst9012\"` . Similarly, `create-oauth-app-with-additional-oidc-attributes.json` defines a `clientId` as `\"custom_client_id\"` .\\n\\nThe `OAuth2PushedAuthRequestTestCase.java` test case demonstrates handling of `client_id` parameters, including scenarios with an \"invalid client id\" and \"without client id\" . However, the validation logic in these tests only checks for the presence and basic validity of the `client_id` (e.g., not null or empty), not for a specific structured format like the eIDAS one.\\n\\nThe `DCRTestCase.java` file, which handles Dynamic Client Registration, validates the `client_id` received in the response against the one provided in the request, or simply asserts that a `client_id` is not null if it wasn\\'t explicitly set in the request . This also does not indicate any specific format enforcement.\\n\\n### API Endpoints or Features\\nThe codebase mentions standard OAuth 2.0 and OpenID Connect endpoints such as `/oauth2/token`, `/oauth2/authorize`, and `/oauth2/dcr/v1.1/register`  . While these endpoints handle `client_id` as a parameter, there is no indication within the provided snippets that they enforce the eIDAS-specific format for the `client_id`. The `Features and Capabilities` wiki page also lists various OAuth 2.0 and OpenID Connect features, but none of them explicitly mention support for eIDAS-specific `client_id` formats .\\n\\n### Documentation References\\nThe provided wiki pages, including \"Features and Capabilities\"  and \"OAuth2 and OpenID Connect\" , describe the general OAuth2 and OIDC support within WSO2 Identity Server. They detail various grant types, token management, and conformance with standards. However, neither of these documents, nor any other provided context, refers to eIDAS certificates or a specific structured format for the `client_id` parameter as a requirement.\\n\\n## Notes\\nThe query specifically asks about the `client_id` parameter containing an `organizationIdentifier` from an eIDAS certificate with a very precise structure. While the codebase extensively uses and validates `client_id` in the context of OAuth 2.0 and OpenID Connect, there is no explicit mention or implementation of the eIDAS-specific format. It is possible that such a feature might exist as a custom extension or a plugin not visible in the provided snippets, or it might be a requirement that is not yet implemented in this version of the codebase. Without further context or code related to eIDAS integration or custom `client_id` validation logic, it cannot be confirmed that this repository supports the specified requirement.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-c_4f5c1401-810e-4227-98c7-d6215093d79e\\n', 'id': 'lc_301c606a-98a8-4073-8c33-3196ca03994b'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0009_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_4c1dcfb9-12c1-4a6c-880e-9489b20fbba2'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0010",
      "requirement": {
        "requirement_id": "ATOM_134",
        "requirement_text": "The ASPSP shall deny access for one-off consent if AISP requests data more than once or validity has timed out",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0010_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports denying access for one-off consents if the AISP requests data more than once or if the validity has timed out. This functionality is primarily handled through OAuth 2.0 token validity periods and consent management configurations.  \\n\\n## Implementation Details\\n\\nThe system enforces timeout restrictions on authorization codes and access tokens.  For instance, the `AuthorizationCodeDefaultValidityPeriod` is set to 300 seconds (5 minutes), and `AccessTokenDefaultValidityPeriod` and `UserAccessTokenDefaultValidityPeriod` are set to 3600 seconds (1 hour). \\n\\nA test case, `testSendAuthorizeWithExpiredRequestURI`, explicitly verifies that an authorization request with an expired request URI is denied.  This test simulates a scenario where a request URI times out after 60 seconds and then attempts to use it, expecting an `oauthErrorMsg=par.request.uri.expired` error. \\n\\nConsent management is also a core feature, allowing for the explicit collection and revocation of user consent. <cite repo=\"wso2/product-is\" path=\"wso2/product-is/wiki/Features-and-Capabilities#consent-management\" /> While the provided snippets don\\'t detail \"one-off consent\" specifically, the general consent management framework, including the ability to approve once or always, suggests that fine-grained control over consent validity is possible. \\n\\n## Configuration Options\\n\\nThe validity periods for various tokens can be configured in the `identity.xml` file. \\n\\n*   `AuthorizationCodeDefaultValidityPeriod`: Default validity period for Authorization Code in seconds. \\n*   `AccessTokenDefaultValidityPeriod`: Default validity period for application access tokens in seconds. \\n*   `UserAccessTokenDefaultValidityPeriod`: Default validity period for user access tokens in seconds. \\n*   `RefreshTokenValidityPeriod`: Validity period for refresh token. \\n\\nConsent management can be enabled or disabled using the `<EnableSSOConsentManagement>` tag within the `<Consent>` section of the `identity.xml` configuration. \\n\\n## API Endpoints or Features\\n\\nThe system utilizes standard OAuth 2.0 endpoints for authorization and token issuance.  The `OAuth2AuthzEPUrl` and `OAuth2TokenEPUrl` are configured for authorization and token endpoints respectively. \\n\\nThe `OAuth2ConsentPage` and `OIDCConsentPage` are used for handling user consent during the OAuth2 and OIDC flows.  The `OAuth2CommonClient.sendOAuthConsentApprovePost` method demonstrates how consent submission is handled, allowing for \"Approve Once\" or \"Approve Always\" options. \\n\\n## Documentation References\\n\\nThe \"Features and Capabilities\" wiki page provides an overview of the system\\'s support for OAuth 2.0, including advanced features like Token Revocation. <cite repo=\"wso2/product-is\" path=\"wso2/product-is/wiki/Features-and-Capabilities#oauth-20-and-openid-connect\" /> It also mentions \"Consent Management\" as an advanced security feature. <cite repo=\"wso2/product-is\" path=\"wso2/product-is/wiki/Features-and-Capabilities#consent-management\" />\\n\\n## Notes\\n\\nThe term \"one-off consent\" is not explicitly used in the provided code snippets or wiki pages. However, the concept of time-limited access and the ability to approve consent \"once\" (as opposed to \"always\") through the `sendOAuthConsentApprovePost` method  aligns with the spirit of a one-off consent. The system\\'s robust token validity periods and the explicit test case for expired request URIs demonstrate its capability to enforce timeout restrictions and deny subsequent access attempts.  \\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4502e7f3-f4ca-4370-aeed-9ba5054d2f36\\n', 'id': 'lc_64623b8f-0ebf-49a8-917b-56bec2048cfd'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0010_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports denying access based on request counts and time periods, which can be configured to enforce one-off consent and timeout restrictions. The core functionality for this is provided by the `throttle` mediator.  \\n\\n### Implementation Details\\nThe throttling mechanism is implemented using a `throttle` mediator within the API gateway.  This mediator can be configured to define policies that restrict access based on various criteria, including the maximum number of requests within a `UnitTime` and a `ProhibitTimePeriod` after the request count is exceeded.   When a request is rejected by the throttle mediator, a \"Access Denied\" fault is generated. \\n\\n### Configuration Options\\nThrottling policies are defined within the `<policy>` tag of the `throttle` mediator. \\nKey configuration parameters include:\\n*   `MaximumCount`: Specifies the maximum number of requests allowed. \\n*   `UnitTime`: Defines the time period in milliseconds during which the `MaximumCount` applies. \\n*   `ProhibitTimePeriod`: Specifies the duration in milliseconds to prohibit further requests after the `MaximumCount` is exceeded within the `UnitTime`. \\n\\nAn example configuration shows how to restrict requests based on IP addresses, allowing a certain number of requests within a `UnitTime` and then prohibiting further access for a `ProhibitTimePeriod`. \\n\\n### API Endpoints or Features\\nThe throttling functionality is exposed through the API Gateway, where these mediation policies are applied to API requests. The `admin-api.yaml` file indicates the presence of \"Deny Policy\" management, suggesting API endpoints for configuring and managing these policies.  Specifically, there are API endpoints for retrieving, deleting, and updating deny policies. \\n\\n### Documentation References\\nThe documentation in `all-in-one-apim/docs/xdoc/mediators/throttle.xml`  and `api-control-plane/docs/xdoc/samples/advanced_mediation_samples.xml`  provides detailed examples and explanations of how to configure the `throttle` mediator for concurrency and request rate-based throttling. These documents illustrate how to set `MaximumConcurrentAccess`, `MaximumCount`, `UnitTime`, and `ProhibitTimePeriod` to control access.  \\n\\n## Notes\\nThe provided snippets primarily focus on the WSO2 API Manager\\'s throttling capabilities, which can be adapted to meet the requirement of denying access for one-off consents if data is requested more than once or validity has timed out. The `ProhibitTimePeriod` setting is particularly relevant for enforcing timeout restrictions. While the examples show throttling based on IP addresses, the underlying mechanism is flexible enough to be applied to other identifiers if they can be extracted and used within the mediation policies. The term \"ASPSP\" and \"AISP\" are not explicitly mentioned in the codebase, but the throttling features can be used to implement the described behavior for such entities.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_97dbe509-bc3e-45e6-9dcd-330501114c83\\n', 'id': 'lc_c2f8f13a-fc10-4717-abf0-427f661cf86e'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0011",
      "requirement": {
        "requirement_id": "ATOM_023",
        "requirement_text": "Payment cancellation SHALL be divided into two steps: DELETE the corresponding resource, and start an authorisation process for the cancellation by the PSU where needed.",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0011_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0011_2",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports payment cancellation through a two-step process involving a `DELETE` request on the payment resource and, when necessary, an authorization process by the PSU. This is primarily handled through the consent management endpoints and related services.  \\n\\n## Implementation Details\\n\\nThe payment cancellation process involves the following components:\\n\\n*   **API Endpoints**: The system exposes `DELETE` endpoints for consent revocation. For instance, the `DELETE /funds-confirmation-consents/{consentId}` endpoint is used to delete a funds confirmation consent.  Similarly, a `DELETE /manage` endpoint is available for general consent management.  The `ConsentManageEndpoint.java` class handles these `DELETE` requests. \\n*   **Consent Revocation Logic**: The `DefaultConsentAdminHandler` class coordinates administrative consent operations, including revocation.  The `handleRevoke()` method within this handler is responsible for processing revocation requests. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n*   **External Service Integration**: The system supports external validation and custom revocation logic through the `PRE_PROCESS_CONSENT_REVOKE` extension point. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" /> This allows for an external service to be called before the actual revocation, which can be used to implement the authorization process by the PSU.  The `ExternalAPIConsentAdminUtils` class facilitates this integration. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n*   **Consent Core Service**: The `ConsentCoreService` interface defines methods for managing consents, including `createAuthorizableConsent` which can be used for authorization processes. \\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, manages the system\\'s configuration.  While specific configuration options for a \"cancellation-authorisations endpoint\" are not explicitly detailed, the framework\\'s extensibility allows for such a feature to be configured. The `PRE_PROCESS_CONSENT_REVOKE` extension point can be configured to invoke an external service for authorization. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n\\n## API Endpoints and Features\\n\\n*   **DELETE Payment Resource**: The `payment-initiation-openapi.yaml` defines API endpoints for payments, including a `DELETE` operation for payment consents.  Similarly, `funds-confirmation-openapi.yaml` includes a `DELETE` operation for funds confirmation consents. \\n*   **Cancellation Authorizations Endpoint**: The `accelerator-extensions-v1.0.0.yaml` defines a `/pre-process-consent-revoke` endpoint that can be used to handle pre-revocation validations when a TPP calls consent `DELETE`.  This endpoint can serve as the \"cancellation-authorisations endpoint\" by integrating with an external authorization service. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n*   **Consent Authorization**: The `doConsentAuthorisation` method in `FSAPIMConnectorTest.groovy` demonstrates how consent authorization is initiated, which could be adapted for cancellation authorization. \\n\\n## Documentation References\\n\\nThe \"Admin Operations\" wiki page provides detailed information on consent revocation operations, including the process flow and external service integration. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" /> The `README.md` for `org.wso2.financial.services.accelerator.consent.mgt.endpoint` also lists the `DELETE /admin/revoke` endpoint for revoking consents. \\n\\n## Notes\\n\\nThe provided snippets indicate strong support for the two-step payment cancellation process. The `DELETE` operation on payment resources is explicitly defined in the OpenAPI specifications, and the consent revocation mechanism, particularly with its external service integration capabilities, can facilitate the authorization step. The `PRE_PROCESS_CONSENT_REVOKE` endpoint is a key feature for implementing the authorization process by the PSU.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Admin Operations (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_e67ff897-59c8-4268-ae1b-49327a1a9849\\n', 'id': 'lc_815aa0f2-e8b8-483d-82c3-49cf46efd85b'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0012",
      "requirement": {
        "requirement_id": "ATOM_137",
        "requirement_text": "The ASPSP shall check access frequency per account and per PSU for consents covering multiple accounts",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0012_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support consent management, which is a prerequisite for tracking access frequency per account and per PSU for consents covering multiple accounts. However, based on the provided code snippets and wiki pages, there is no direct evidence of implementation details, configuration options, or API endpoints specifically designed to track and enforce access frequency limits per account and per PSU for multi-account consents   . The existing consent management features primarily focus on collecting, storing, and enforcing user consent for data sharing .\\n\\n### Implementation Details\\nThe codebase includes integration tests for consent management, such as `ConsentMgtTestCase`  and `SelfSignUpConsentTest` . These tests demonstrate the ability to add PII categories, purpose categories, purposes, and consent receipts . The `SelfSignUpConsentTest` also shows how consent is collected during self-registration  and how consents can be retrieved . However, none of these directly address access frequency limits.\\n\\n### Configuration Options\\nThe `default-identity.xml` file contains a configuration for enabling consent management during SSO: `<EnableSSOConsentManagement>true</EnableSSOConsentManagement>` . Additionally, an event listener for consent management, `ConsentMgtPostAuthnHandler`, is enabled . These configurations enable the consent management framework but do not provide specific options for frequency limiting.\\n\\n### API Endpoints or Features\\nThe `ConsentMgtTestCase` defines a `CONSENT_ENDPOINT_SUFFIX` as `/api/identity/consent-mgt/v1.0/consents` . This endpoint is used for managing consents, including adding PII categories, purpose categories, purposes, and receipts . The `default-identity.xml` also lists various secured resources related to consent management, such as `/api/identity/consent-mgt/v1.0/consents` and `/api/identity/consent-mgt/v1.0/consents/receipts/(.*)` . While these APIs handle consent, there are no explicit features or parameters mentioned for tracking or enforcing access frequency.\\n\\n### Documentation References\\nThe \"Advanced Features\" wiki page discusses Consent Management, outlining its purpose to collect, store, and manage user consent for processing personal data <wiki_page repo_name=\"wso2/product-is\" id=\"7.3\" page_name=\"Advanced Features\" />. It describes key components like PII Categories, Purposes, Purpose Categories, and Consent Receipts <wiki_page repo_name=\"wso2/product-is\" id=\"7.3\" page_name=\"Advanced Features\" />. The wiki also mentions consent collection during self-registration and authentication, and enforcement during token issuance and API responses <wiki_page repo_name=\"wso2/product-is\" id=\"7.3\" page_name=\"Advanced Features\" />. However, the wiki does not mention any functionality related to access frequency limits per account or per PSU.\\n\\n## Notes\\nThe provided context focuses heavily on the general consent management framework within WSO2 Identity Server. While the system supports managing consents, which is a foundational element for any fine-grained access control, there is no direct evidence in the provided snippets or wiki pages that `wso2/product-is` currently implements or provides features for tracking and enforcing access frequency per account and per PSU for consents covering multiple accounts. This functionality would likely require additional components for rate limiting, auditing, and policy enforcement that are not visible in the given context.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f5d3c21c-a0b4-4772-823d-678e267f6c16\\n', 'id': 'lc_6c5333de-d026-4fe4-b9df-7ec12beab431'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0012_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, WSO2 API Manager, supports rate limiting and throttling policies that can be configured to control API usage. While the provided snippets do not explicitly detail \"access frequency per account and per PSU for consents covering multiple accounts\" in the context of ASPSP (Account Servicing Payment Service Provider) and PSD2 (Revised Payment Services Directive) requirements, the system\\'s throttling capabilities can be leveraged to implement such controls.  \\n\\n## Implementation Details\\n\\nWSO2 API Manager utilizes a Traffic Manager component to enforce rate limits and throttling policies.  These policies can be defined at various levels, including API, application, and subscription.   The system allows for the definition of custom advanced throttling policies. \\n\\nThe core mechanism for throttling involves defining a `RequestCountLimit` within a specific `timeUnit` and `unitTime`.  When the number of requests exceeds the defined limit within the specified time period, access is denied. \\n\\n## Configuration Options\\n\\nThrottling policies can be configured through the API Manager.  An example of defining a subscription policy named \"PlatinumTier\" with a limit of 20 requests per minute is shown in the test data. \\n\\nThe `api-manager.xml` configuration file includes a `<ThrottlingConfigurations>` section where `EnableAdvanceThrottling` can be set to `true`.  This section also defines the `TrafficManager` type and its communication endpoints. \\n\\n## API Endpoints or Features\\n\\nThe API Manager provides REST API endpoints for managing throttling policies. For instance, a `POST` request to `/api/am/admin/v0.17/throttling/policies/subscription` is used to create subscription throttling policies. \\n\\nThe system also supports different subscription tiers, such as \"Unlimited\", \"Large\", \"Medium\", \"Small\", and \"10PerMin\", which correspond to different request limits.  These tiers can be associated with APIs to enforce usage levels. \\n\\n## Documentation References\\n\\nThe `gateway/docs/xdoc/samples/advanced_mediation_samples.xml` and `traffic-manager/docs/xdoc/samples/advanced_mediation_samples.xml` files provide examples of how throttling works, demonstrating scenarios where access is denied after a certain number of requests within a time period.   The `README.md` files also mention \"Rate Limiting\" and \"Throttling Policy Management\" as key functionalities of the Gateway and Traffic Manager components.  \\n\\n## Notes\\n\\nThe provided codebase snippets demonstrate the general throttling and rate-limiting capabilities of WSO2 API Manager. While the system supports defining policies based on request counts and time units, there is no explicit mention or example of \"access frequency per account and per PSU for consents covering multiple accounts\" as a specific feature tailored for ASPSP or PSD2 compliance. <cite /> However, the existing throttling mechanisms could likely be adapted or extended to meet such requirements by defining custom policies and potentially integrating with an external consent management system.  The `APIMGetAllSubscriptionThrottlingPolicies.java` test file shows how subscription policies are retrieved and verified, indicating that these policies are a core part of the system\\'s functionality. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-apim)](/wiki/wso2/product-apim#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_11a07204-af93-4ca0-85f1-a58d270c81ba\\n', 'id': 'lc_6d09892d-16ab-4d5f-987d-d9e9c56d1af3'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0013",
      "requirement": {
        "requirement_id": "ATOM_102",
        "requirement_text": "ASPSPs MUST return ASPSP-SCA-Approach header with value DECOUPLED when branching to Decoupled SCA Approach",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0013_1",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_2",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_3",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_4",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_5",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the specific requirement of returning an `ASPSP-SCA-Approach` header with the value `DECOUPLED` when switching to a Decoupled SCA Approach. The provided codebase context does not contain any explicit references to \"ASPSP-SCA-Approach\", \"DECOUPLED\", or \"Decoupled SCA Approach\" <cite/>.\\n\\nThe codebase primarily focuses on the core architecture of WSO2 Identity Server, including its identity services, protocol support (like OAuth2/OIDC, SAML, FAPI), authentication framework, API layer, and configuration system . While it supports Financial-grade API (FAPI) , which is relevant to ASPSPs, there\\'s no indication of the specific header manipulation for SCA approaches as described in your query <cite/>.\\n\\nTherefore, I cannot provide implementation details, configuration options, API endpoints, or documentation references related to the `ASPSP-SCA-Approach` header within this repository <cite/>.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_97901976-9138-4ae7-87f9-459f3824b61a\\n', 'id': 'lc_322ef530-8a22-4019-8998-371c92c4c113'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0013_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_17796166-6119-4241-a32a-9126a793f07f'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0014",
      "requirement": {
        "requirement_id": "ATOM_225",
        "requirement_text": "scope parameter SHALL reference the payment or consent resource in the format \"PIS:<paymentId>\", \"AIS:<consentId>\", or \"PIIS:<consentId>\"",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "13.1",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0014_1",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n```\ncurl --location --request POST 'https://localhost:8243/open-banking/v3.1/aisp/account-access-consents' \\\n--header 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n--header 'x-fapi-financial-id: open-bank' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n    \"Data\": {\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\"\n    },\n    \"Risk\": {\n        \n    }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"StatusUpdateDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\",\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"a34c8608-dbd2-4997-aad7-398a5b31cbe6\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_2",
          "text": "## Consent Authorization\n\n- Once you enter a properly constructed authorization request in your web browser, based on the `bank_code` in the \n  request object, you will be redirected to ABC bank or DCB Bank. \n\n- A bank customer needs to enter their credentials and sign in. \n    ![sign_in](../../assets/img/toolkit/regulatory-aggregator/sign-in.png)\n- Then redirected to the Aggregator's Account selection page.\n    ![account_selection](../../assets/img/toolkit/regulatory-aggregator/account-selection.png)\n- Once the bank customer selects the accounts they want to share, the whole consent agreement is displayed.\n    ![consent_agreement](../../assets/img/toolkit/regulatory-aggregator/consent-agreement.png)\n- Once the bank customer approves this consent, the aggregator will redirect you to the registered callback URL with an \n  authorization code in the query parameters.\n   ```\n   https://wso2.com/#code=1390032d-622f-3977-a976-923505035571&id_token=eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJhdWQiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwiY19oYXNoIjoiNXFNeEhhY0d2d2IxX2ZDT29GWmlNZyIsInN1YiI6ImFiY3VzZXJAY2FyYm9uLnN1cGVyIiwic19oYXNoIjoiOU9WMVpnRXVfWWExanFxU3hWelg1ZyIsImF6cCI6IngwVWkyR2k3YTVCNGp1cTdXcHdkcFdyTjlsRWEiLCJhbXIiOlsiQ3VzdG9tRmVkZXJhdGVkQXV0aGVudGljYXRvciJdLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0Ojk0NDZcL29hdXRoMlwvdG9rZW4iLCJleHAiOjE2NTM0ODI2ODAsImlhdCI6MTY1MzQ3OTA4MCwibm9uY2UiOiJqQlhoT21PS0NCIiwic2lkIjoiZmRlODZlMzMtNjljYi00ZTIwLTgxZTMtOTFiMDJhYjlmMjM3In0.OQmAuO3yH-Ap3bPzb1NpbbFN628BdIuKYZ6kZqeDRJwLK2Z5GqtO5P2VZpEoMlRSPi15Z0eg_8Uxv1ns1Na8djpIs1UyK2zK20HzHCZh4flpXlW0AMbvoxUUbAsfDzaH8r0xpzweA471vD0HX9rja2Xio0AhsP6VPJasBxC3jnAt9H9wjqB_qXYw8-TQwVPjkFONNgEZHQ44eJFRxK7Um5TOv1fHb6Ivz4URc0R91vL1LEyaIRy8w7afGePNDQn5BHObbfzwX6O4hI_jsUVeOybG0M3-ofhEwYcvkMuiMPsLeF2Oqa849bNNr11P75TajKV7ozUBo1UJquTs7VfSnA&state=0pN0NBTHcv&session_state=13831b535eebb5527056f57766e0b5a1d66caea43afbe041f75d27adcdb954f1.PNSwGdfigyA_dxaCi45fPA \n   ```\n   - The authorization code from the above URL is in the code parameter `1390032d-622f-3977-a976-923505035571`. \n   - Extract this code for the next step.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_3",
          "text": "During the consent authorization process, the banks redirect customers to provide consent for API consumers to access their banking information. The process is as follows: 1. API consumer requests to access the banking information of a customer. 2. Bank validates the API consumer\u2019s request. 3. The bank redirects the requested information (containing the information the API consumer application wants to access) to the customer. 4. The bank authenticates the customer. See below for the default login page of the consent page: ![login-consent-page](../assets/img/develop/customizing-consent-page/login-of-consent-page.png) 5. A list of bank accounts and the information that the API consumer wishes to access are displayed. ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png) 6. The customer can view the information before consenting or denying it. For example, ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) ##Consent Authorization in WSO2 Open Banking Accelerator Following components perform the consent authorization: ###Authorization endpoint Before the API consumer application accesses the customer's banking information, the API consumer sends an authorization request to get the customer's consent for it. The authorization request contains a request object. This request object is a self-contained JWT, which helps banks to validate the API consumer. The method of sending the authorization request can vary as follows: - **Send the authorization details in the authorization URL** The API consumers share the request object containing the authorization details to the authorization server and obtain the authorization URL. - **Send the authorization details as a reference in the authorization URL** The API consumers push authorization details directly to the authorization server and obtain a reference. This method is also known as **Pushed Authorization**. The reference is notated by the claim; `request_uri`. Thereby, it prevents: - Intruders from intercepting the authorization information sent in the request_object - Authorization request calls becoming bulky with the authorization details signed in the JWT and protects the confidentiality and integrity of the authorization details when passing through an API consumer application. ###Pushed Authorization web application The API consumers obtain `request_uri` which is a reference to the authentication and authorization details sent in the pushed authorization request. - **Pushed Authorization - /par endpoint** Upon successful invocation of the `/par` endpoint, API consumers will receive a `request_uri` value with an expiration time. Therefore, the reference is only valid until the expiration time for the subsequent authorization invocation. Given below is a successful response: ``` { \"request_uri\": \"urn:ietf:params:oauth:request_uri:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` This same `request_uri` value is used in the subsequent authorization request as well. WSO2 Open Banking Accelerator allows you to perform custom validations for the pushed authorization request. For more information, see [writing a Custom Pushed Auth Request Validator](../develop/custom-pushed-auth-request-validator.md). ??? tip \"Click here to see configurations related to the Pushed Authorization web application...\" 1. Open the `<IS_HOME>/repository/conf/deployment.toml` file. 2. Add the following configurations that allow you to change the format and the expiration time of the `request_uri` reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_4",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_5",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n!!!note\n      Replace the <AUTH_HEADER_VALUE> with Base64 encoded \"admin_username:admin_password\" value.\n               `Eg: Base64(admin_username:admin_password)`\n\n```\ncurl --location --request POST 'https://localhost:9446/api/fs/consent/manage/account-access-consents' \\\n--header 'Authorization: Basic <AUTH_HEADER_VALUE>' \\\n--header 'x-wso2-client-id: <CLIENT_ID>' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n   \"Data\":{\n      \"Permissions\":[\n         \"ReadAccountsBasic\",\n         \"ReadAccountsDetail\",\n         \"ReadBalances\",\n         \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\",\n      \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\"\n   },\n   \"Risk\":{\n   }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"ConsentId\": \"12a4ebc8-b98c-4f80-9a37-44679363b97b\",\n        \"StatusUpdateDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n        \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\",\n        \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the use of specific scope parameter formats like \"PIS:<paymentId>\", \"AIS:<consentId>\", or \"PIIS:<consentId>\" through its OAuth 2.0 and OpenID Connect implementation, particularly in the context of Financial-grade API (FAPI) support and custom scope validation. The system allows for defining and validating custom scopes, which can include these structured resource references.\\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server, within the `wso2/product-is` repository, provides mechanisms for defining and managing OAuth 2.0 scopes. The `OAuth2ServiceClientCredentialTestCase.java` file demonstrates how scopes are used in client credential grant type requests, including custom scopes like `VALID_RANDOM_SCOPE` and `INTERNAL_BULK_RESOURCE_CREATE` . This indicates the flexibility to define and process custom scope values.\\n\\nThe `OIDCCustomScopesLoginTest.java` further illustrates the use of custom OIDC scopes. It shows how a `customScopeName` is defined and included in `requestedScopes` . The test then verifies that the access token returned contains all requested scopes, including the custom ones . The `containAllRequestedOIDCScopes` method explicitly checks if the returned scopes match the requested ones .\\n\\nThe `OAuth2ScopesTestCase.java` file demonstrates the API for adding, retrieving, updating, and deleting scopes, which would be the underlying mechanism to manage these structured scopes . The `SCOPE_ENDPOINT_SUFFIX` constant points to `/api/identity/oauth2/v1.0/scopes`, which is the API endpoint for managing scopes .\\n\\nThe `default-identity.xml` configuration file includes a `ScopeHandlers` section, which specifies `org.wso2.carbon.identity.oauth2.validators.OIDCScopeHandler` as a handler executed during the scope validation phase . This indicates that custom logic can be implemented to validate the format of scopes, such as \"PIS:<paymentId>\".\\n\\n## Configuration Options\\n\\nThe configuration of custom scopes and their validation would involve:\\n*   **Defining Custom Scopes**: Using the scope management API (exposed via `SCOPE_ENDPOINT_SUFFIX` ) to add scopes with names like \"PIS:paymentId\", \"AIS:consentId\", or \"PIIS:consentId\".\\n*   **Custom Scope Handlers**: Implementing custom logic within a `ScopeHandler` (e.g., extending `OIDCScopeHandler` or a similar class) to parse and validate the format of these specific scopes . This handler would be responsible for verifying that the scope parameter contains a properly formatted resource reference with the correct service prefix.\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint for managing scopes is `/api/identity/oauth2/v1.0/scopes` . This endpoint allows for programmatic creation, retrieval, update, and deletion of scopes.\\n\\nThe system also supports \"Rich Authorization Requests\" as indicated by `OAuth2RichAuthorizationRequestsTestCase.java`  and the `AuthorizationDetailsType` model . This feature allows for more granular authorization requests beyond simple scopes, which could be leveraged to handle the structured resource references in the scope parameter.\\n\\n## Documentation References\\n\\nThe \"Features and Capabilities\" wiki page for `wso2/product-is` mentions \"Scope-based Authorization\" under API Security . The \"OAuth2 and OpenID Connect\" wiki page also details the various grant types and token management, which are foundational to how scopes are handled .\\n\\n## Test Criteria\\n\\nThe test criteria would involve:\\n1.  **Creating a scope** with the specified format, e.g., \"PIS:12345\" using the `/api/identity/oauth2/v1.0/scopes` endpoint .\\n2.  **Requesting an access token** with this custom scope. The `OAuth2ServiceClientCredentialTestCase.java` and `OIDCCustomScopesLoginTest.java` provide examples of requesting tokens with custom scopes .\\n3.  **Verifying the scope parameter** in the access token response or during token introspection to ensure it contains the properly formatted resource reference with the correct service prefix. The `OIDCCustomScopesLoginTest.java` includes assertions to check if all requested scopes are present in the access token .\\n\\n## Notes\\n\\nThe provided context primarily consists of integration tests and wiki documentation. While these demonstrate the capability to define and use custom scopes, the specific implementation details for parsing and validating the \"PIS:<paymentId>\", \"AIS:<consentId>\", or \"PIIS:<consentId>\" formats would likely reside within a custom `ScopeHandler` implementation, which is not directly visible in the provided snippets. The `OIDCScopeHandler` is mentioned as a default, but custom logic would be needed for the specific validation requested .\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-s_618eea60-719b-4d23-81bb-906b9a5a4ce6\\n', 'id': 'lc_7de65a71-6e66-492f-bd87-30d24ca78712'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0014_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_fb576f0d-9888-465e-8991-e4df0d792be1'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0015",
      "requirement": {
        "requirement_id": "ATOM_194",
        "requirement_text": "The PSU-IP-Address header SHALL be contained if and only if the request was actively initiated by the PSU.",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0015_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, does not appear to have explicit support for handling a `PSU-IP-Address` header with the specific condition \"if and only if the request was actively initiated by the PSU\" based on the provided code snippets. There are no direct references to `PSU-IP-Address` or similar logic to differentiate between PSU-initiated and TPP-initiated requests for this header.\\n\\nHowever, the system does include a `RemoteIpValve` in its Tomcat configuration, which is designed to extract client IP addresses from request headers, and a `RequestCorrelationIdValve` for correlation IDs.  \\n\\n### Implementation Details\\n\\nThe `catalina-server.xml.j2` template, which configures Tomcat, includes a `RemoteIpValve` that can be enabled and configured.  This valve is responsible for identifying the client\\'s IP address when requests pass through proxies. It uses properties like `remoteIpHeader`, `internalProxies`, `proxiesHeader`, and `trustedProxies` to determine the real client IP.  While this valve handles IP address extraction, there\\'s no explicit logic within the provided snippets to conditionally include or exclude a `PSU-IP-Address` header based on whether the request originated from a PSU or TPP.\\n\\nAdditionally, there is a `RequestCorrelationIdValve` that can extract correlation IDs from headers or query parameters.  This valve is used for logging and tracing requests, but it does not directly address the `PSU-IP-Address` requirement.\\n\\n### Configuration Options\\n\\nThe `RemoteIpValve` can be configured through the `catalinaValves.remoteIpValve` properties. \\nSpecifically, the following properties are available:\\n*   `catalinaValves.remoteIpValve.enable`: A boolean to enable or disable the valve. \\n*   `catalinaValves.remoteIpValve.internalProxies`: A regular expression that matches the IP addresses of internal proxies. \\n*   `catalinaValves.remoteIpValve.remoteIpHeader`: The name of the request header that holds the remote IP address. \\n*   `catalinaValves.remoteIpValve.protocolHeader`: The name of the request header that holds the protocol (e.g., `X-Forwarded-Proto`). \\n*   `catalinaValves.remoteIpValve.proxiesHeader`: The name of the request header that holds the list of proxies. \\n*   `catalinaValves.remoteIpValve.trustedProxies`: A regular expression that matches the IP addresses of trusted proxies. \\n\\nWhile you can configure which header contains the remote IP, there is no configuration option to enforce the \"if and only if initiated by PSU\" condition for a specific header like `PSU-IP-Address`. \\n\\n### API Endpoints or Features\\n\\nThe provided context does not reveal any specific API endpoints or features directly related to the `PSU-IP-Address` header or the distinction between PSU-initiated and TPP-initiated requests for this header. <cite/> The \"API Layer\" described in the architecture wiki page focuses on RESTful APIs for administration and user management, but does not mention specific header handling logic for client IP addresses based on initiation source. \\n\\n### Documentation References\\n\\nThe \"Architecture\" wiki page provides a high-level overview of WSO2 Identity Server\\'s architecture, including its configuration system.  It mentions that `catalina-server.xml.j2` is part of the configuration templates.  However, it does not contain specific documentation regarding the `PSU-IP-Address` header or the conditional inclusion based on PSU/TPP initiation. <cite/>\\n\\n## Notes\\n\\nThe prompt specifically asks about the `PSU-IP-Address` header and its conditional presence. While the `RemoteIpValve` in Tomcat configuration handles client IP addresses, it\\'s a generic mechanism for proxy environments and doesn\\'t inherently differentiate between PSU and TPP initiated requests for a specific header like `PSU-IP-Address`.  To implement the requested functionality, custom development or an extension to the existing valve logic would likely be required to inspect the request context and determine if it\\'s PSU-initiated before adding or validating the `PSU-IP-Address` header. <cite/> The `OAuth2DPopTestCase.java` file and `axis2-default.xml` were reviewed but found to be irrelevant to the specific query about the `PSU-IP-Address` header.  \\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_90f6250a-c08d-4ad0-8081-3dcc0393e9bd\\n', 'id': 'lc_d998936d-ee76-4cd1-8207-7f0ea58cf223'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0015_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided codebase snippets, there is no direct evidence or implementation details regarding a \"PSU-IP-Address\" header or its conditional inclusion based on whether a request was actively initiated by a PSU (Payment Service User) or a TPP (Third-Party Provider). The snippets primarily discuss general privacy policies, API management components, and self-registration processes.\\n\\nThe codebase does mention the collection and use of IP addresses for purposes like detecting suspicious login attempts and deriving geographic information for analytical purposes   . However, this is distinct from a specific \"PSU-IP-Address\" header being conditionally present based on the initiator of the request.\\n\\nTherefore, I cannot confirm if this repository supports the requirement for a `PSU-IP-Address` header to be contained if and only if the request was actively initiated by the PSU.\\n\\n## Notes\\n\\nThe provided snippets discuss the WSO2 API Manager (API-M) and its components, including the API Designer and Publisher, Developer Portal, API Gateway, Key Manager, Traffic Manager, and API Analytics . While IP addresses are mentioned in the context of privacy and security  , there is no specific mention of a `PSU-IP-Address` header or logic to differentiate between PSU-initiated and TPP-initiated requests for this header. The `privacy-policy-content.jsp` files   detail how API-M collects and uses personal information, including IP addresses, but not in the context of the specific header mentioned in the query.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_66c0c894-9094-43d2-8041-e9cc9486c663\\n', 'id': 'lc_3c553625-2cd2-47fb-9c29-ab1971993e02'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0016",
      "requirement": {
        "requirement_id": "ATOM_195",
        "requirement_text": "The POST /v1/{payment-service}/{payment-product}/{paymentId}/authorisations endpoint SHALL create an authorisation sub-resource and return HTTP response code 201.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0016_1",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0016_2",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0016_3",
          "text": "reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank. In this web application, the customer: - Logs in using the login credentials. - Views information that the API consumer requested to access. - Selects the accounts that the API consumer can access. - Provides consent to the API consumer to access the information. ###Identifier-first authenticator Banks use Identifier-first authentication to authenticate the user with a second-factor authenticator instead of a password. The user who logs into the authorization web application, can provide the username, and authenticate using a second-factor authentication mechanism such as SMS-OTP/TOTP.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0016_4",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0016_5",
          "text": "### Step 3: Authorizing a consent\n\nThe API consumer application redirects the bank customer to authenticate and approve/deny application-provided consents.\n\n1. Generate a request object by signing your JSON payload using the supported algorithms. \n    \n    ???tip \"Click here to see a sample request object...\"\n        - Given below is a sample request object in the JWT format:\n        \n        ``` jwt tab='Sample'\n        eyJraWQiOiJoM1pDRjBWcnpnWGduSENxYkhiS1h6emZqVGciLCJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IlM2dTJIZTRqeXd2eXlwVDdmR1lFeExTeXBRWWEiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE3NTcyMzM1ODgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiUzZ1MkhlNGp5d3Z5eXBUN2ZHWUV4TFN5cFFZYSJ9.mClPy-6g0Kn3JIF8P7odd-PiWYCSDhVyQJqn9SkHAXo07saGYD-YxQcqfghRnUbYc41SyAwtkw4bfbNLpqLFnmJsBiP3XjjDE0YwKwD4UXFMAac4zW9ooQtzr_5qXkGS5nNpua7KtpvNezNBgS5-c4MjuI6nUxL63rgmZyRoDlrK_Uxgx4CSxmJQkcHP8YzNvCVxe9ftpuKUlanCCgNvGg2ocmwpRP1G1-ZBr2e3nIfGsFxSaX-4vkur4chEyjk5YogfoxjnG1UjvP_al9M07W0J-eysviGMNqzJ7LDIVCDp5ZKrOnf1p_zPLE4No3xV8cN1ZTJJ_ufUABhJTYQKEw\n        ```\n        \n        ``` tab='Format'\n        {\n          \"kid\": \"<The KID value of the signing jwk set>\",\n          \"alg\": \"<SUPPORTED_ALGORITHM>\",\n          \"typ\": \"JWT\"\n        }\n        {\n          \"max_age\": 86400,\n          \"aud\": \"<This is the audience that the ID token is intended for. Example, https://<IS_HOST>:9446/oauth2/token>\",\n          \"scope\": \"accounts openid\",\n          \"iss\": \"<CLIENT_ID>\",\n          \"claims\": {\n            \"id_token\": {\n              \"acr\": {\n                \"values\": [\n                  \"urn:openbanking:psd2:sca\",\n                  \"urn:openbanking:psd2:ca\"\n                ],\n                \"essential\": true\n              },\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            },\n            \"userinfo\": {\n              \"openbanking_intent_id\": {\n                \"value\": \"<CONSENTID>\",\n                \"essential\": true\n              }\n            }\n          },\n          \"response_type\": \"code id_token\",  \n          \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n          \"state\": \"YWlzcDozMTQ2\",\n          \"exp\": <The expiration time of the request object in Epoch format>,\n          \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n          \"client_id\": \"<CLIENT_ID>\"\n        }\n        ```\n\n2. The bank sends the request to the customer stating the accounts and information that the API \nconsumer wishes to access. This request is in the format of a URL as follows: \n\n    ``` url tab=\"Sample\"\n        https://localhost:9446/oauth2/authorize/?request=eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL29iLWlhbTo5NDQ2L29hdXRoMi90b2tlbiIsIm5iZiI6MTc0OTAyMDQ5MCwiY3JpdCI6e30sInNjb3BlIjoib3BlbmlkIGFjY291bnRzIG9wZW5pZCIsImNsYWltcyI6eyJpZF90b2tlbiI6eyJhY3IiOnsidmFsdWVzIjpbInVybjpvcGVuYmFua2luZzpwc2QyOmNhIiwidXJuOm9wZW5iYW5raW5nOnBzZDI6c2NhIl0sImVzc2VudGlhbCI6dHJ1ZX0sIm9wZW5iYW5raW5nX2ludGVudF9pZCI6eyJ2YWx1ZSI6IjE5NmFkZjAzLTQ2ZDAtNDA4Yy1hNzdiLWFhZWY0MDFlZWM2MiIsImVzc2VudGlhbCI6dHJ1ZX19LCJ1c2VyaW5mbyI6eyJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiIxOTZhZGYwMy00NmQwLTQwOGMtYTc3Yi1hYWVmNDAxZWVjNjIiLCJlc3NlbnRpYWwiOnRydWV9fX0sImlzcyI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVkaXJlY3RzL3JlZGlyZWN0MSIsInN0YXRlIjoiZTkwNzY0YWYtOWIyZS00N2IyLWI3MzUtNzExNjE5ZTA2MmMzIiwiZXhwIjoxNzQ5MDIzOTcwLCJub25jZSI6IjIzNTJiMjZjLTE2YzUtNDdmNy04OTg4LWNhNDA1ZTdhZDIxZCIsImNsaWVudF9pZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EifQ.rmM1Muwbm6qqtm_f3rcZOYMpbiaRQfFsQSs2SVxPCUIncaSHMcBp2vVeEoKkdo-kwysteNEdQw1uhceAU86muAqho7zFVvmTRdMGBi5Ad0zCtvu2QS00c-3Ur2GYKZM-EvfUhxYbwNx15Yu79rPWpgs9dT1qLTLTHtzkXQ_0Ib8U8u42jM3hiOnJontrRJn7WU3pAmcXRH886GJBBhPhgVPr9cpfsFvTcHIiPaxROuyteRh1_x2-_-4pz_1XZq-YkirsbN-p29CohEOzAdHhV80rIqCU_Wknp5Rkt4NT0hMSNeonxTOwfocQkXraZ5kDLb60Y_4vR5N8UUcmkIXQSw&scope=accounts%20openid&response_type=code%20id_token&redirect_uri=https%3A%2F%2Fwww.google.com%2Fredirects%2Fredirect1&state=ace6befc-90a4-4627-ae17-9aa4f75594e8&nonce=nonce&client_id=jXuHPxPhitMUevd4d31GSs25uWca\n    ```\n   \n    ``` url tab=\"Format\"\n        https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20openid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n   \n3. Run the URL in a browser to prompt the invocation of the authorize API.\n\n   ![login-screen-in-tryout-flow.png](../assets/img/get-started/quick-start-guide/login-screen-in-tryout-flow.png)\n\n4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login credentials of a user that has a `consumer` role. \n\n5. The page displays a list of bank accounts and the information that the API consumer wishes to access.\n   ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png)   \n    \n6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. Click \n **Confirm** to grant these permissions.\n    \n7. Upon providing consent, an authorization code is generated on the web page of the `redirect_uri`. See the sample \ngiven below:\n\n    The authorization code from the below URL is in the code parameter (`code=07e213e5-9971-3f0e-9acc-2fd99fd0304b`).\n\n    ```\n    https://www.google.com/redirects/redirect1#id_token=eyJ4NXQiOiJ5SFl1RDhrVHZWYzhGdjNUd3pmRUd1dHBudUEiLCJraWQiOiJOemRpTkRBd05ETmpaRE5rWlROak5UQm1NVE5rTVRObE1qRTNNakJqTnpobE1USmtaalk0TUdabU5ERmlZMll3TUdRM01qZzBNakpqT0RnM1lUWmtOUV9QUzI1NiIsImFsZyI6IlBTMjU2In0.eyJpc2siOiJmMGFkZTFkMDVmNjg4MTRlNzhjZTY2MTU5OTI1YzZhMDcyZTMwNWE0ZDI5NmRlOWJkODU2ZjdiOWMwMjQ0MTliIiwic3ViIjoiOTljMzEzMjAtNzA4ZC00NjYxLWEwYTgtZGVhYjZhMDQwYTJlQGNhcmJvbi5zdXBlciIsImFtciI6WyJCYXNpY0F1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL29iLWlhbTo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJlODAzMTNlNC04ZTZlLTRkYjctOTg2Yi0yNjYwNDQ3OThlOTciLCJzaWQiOiI0NjQ5MDlhYi1jYjZjLTRjZDktYTU5OC0wYWU1MjExYzQzOTciLCJhdWQiOiJqWHVIUHhQaGl0TVVldmQ0ZDMxR1NzMjV1V2NhIiwiY19oYXNoIjoiVTZDWFVqc1h4VGdEMWxrM3JRRnpFdyIsInVzZXJfb3JnIjoiMTAwODRhOGQtMTEzZi00MjExLWEwZDUtZWZlMzZiMDgyMjExIiwic19oYXNoIjoiOHlLSmpOcE5RMlVVQXFuN2FFU3lvdyIsImF6cCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJvcmdfaWQiOiIxMDA4NGE4ZC0xMTNmLTQyMTEtYTBkNS1lZmUzNmIwODIyMTEiLCJleHAiOjE3NDkwMjgyODIsIm9yZ19uYW1lIjoiU3VwZXIiLCJpYXQiOjE3NDkwMjQ2ODIsImp0aSI6IjZmNWFhZGI1LTdkYTEtNDhiMS04NjVjLTBjOWY5YzRkMzc2NSIsImNvbnNlbnRfaWQiOiI3NDk5ZmYzMy1mNGRlLTRkZjQtYWI0MS1hMDEzMzQ0MGI3OGMifQ.Pe18gebXzDciawD_HwXnezPfP-hgB7QrAjxl1pyWYREuVEhWJ8s-S1hnp5KzOhPbeR8nyws7Qqg7gHurFFGfCFCyLJsH34889LAWSZhcLuPl1ia9wAtHCKztCd9ga6vohhyDoQXqLaIN8E4ZARuQ75xRkLKPektf3fXQiK5Tklr0g4Le-Ht53d39soPNzoF0cSl8csLrpPPSiSie5bNpL8OEZlsJWLv88Mv3RcxC8BhBeGVGMwImmmBD4oJc-wCetUgldoG4txAA_JtckOw0TWKSvuEF_Vx036Z_n6bY8YenILzgbb3MeHrAY7tHPE3JEKe9I4KhRyv6XkZ7gSA5Lg\n    &code=07e213e5-9971-3f0e-9acc-2fd99fd0304b\n    &session_state=0d1e5b4ce6cbc2a338f25baa18efab4929129127f058c6812e9ee0130a4715ea.L25p4RAFA8WfK3UH10OddQ\n    &state=64f525ed-af4a-42f7-a671-78636bf6dd09\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0016_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support a `POST /v1/{payment-service}/{payment-product}/{paymentId}/authorisations` endpoint for creating payment authorization sub-resources. The provided context primarily focuses on \"Organization Management\" and \"API Layer\" within the WSO2 Identity Server, which are related to identity and access management, not payment processing.\\n\\nThe codebase does contain references to API resources and authorization details, but these are within the context of managing API resources for applications and defining authorization types, not for processing payments. For example, `AuthorizationDetailsType.java`  defines a model for authorization details, which includes a `type` field that could be \"payment_initiation\" . However, this is a definition of a *type* of authorization detail, not an implementation of a payment authorization endpoint.\\n\\nThe `OrganizationManagementSuccessTest.java`  and `OrganizationManagementFailureTest.java`  files show tests for creating organizations and returning `HTTP 201 Created`, but this is for organization resources, not payment authorizations. Similarly, `scim2.yaml`  defines a `POST` endpoint for creating users that returns `HTTP 201`, but again, this is for user management, not payment processing.\\n\\n## Notes\\n\\nThe prompt describes a payment-related API endpoint, which is not directly addressed by the provided codebase context. The `wso2/product-is` repository appears to be an Identity Server, focusing on authentication, authorization, user management, and organization management. While there are concepts of \"authorization\" and \"API resources\" within the codebase, they are used in the context of identity and access management, not financial transactions.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3a811591-7b5f-44dc-8b1c-60f00bac5977\\n', 'id': 'lc_4954a5e4-ffbd-46d3-a8da-39d47ef3f207'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0016_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_3778eacf-21d2-414b-81f8-067042c4e739'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0017",
      "requirement": {
        "requirement_id": "ATOM_104",
        "requirement_text": "ASPSPs MUST return transaction status ACTC for multilevel SCA when first authorization is completed",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0017_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_3",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_4",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0017_5",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, the WSO2 Financial Services Accelerator, appears to support the concept of transaction statuses for payments, including \"AcceptedSettlementInProcess\" and \"Pending\" which could be relevant to multilevel SCA, but it does not explicitly define or return a transaction status of \"ACTC\" for multilevel SCA after the first authorization is completed.  The `payment-initiation-openapi.yaml` defines the API for payment initiation and includes a `Status` enum within the `obWritePaymentResponse5` schema that lists possible payment statuses. \\n\\n### Implementation Details\\n\\nThe `payment-initiation-openapi.yaml` file defines the API specification for payment initiation.  Within this specification, the `obWritePaymentResponse5` schema includes a `Status` field.  This `Status` field is an enum that can take values such as \"AcceptedCreditSettlementCompleted\", \"AcceptedSettlementCompleted\", \"AcceptedSettlementInProcess\", \"AcceptedWithoutPosting\", \"Pending\", and \"Rejected\". \\n\\nFor multilevel SCA, the `obWritePaymentConsentResponse5` schema also includes a `MultiAuthorisation` object, which has a `Status` field with enum values like \"Authorised\", \"AwaitingFurtherAuthorisation\", and \"Rejected\".  The `EndToEndPaymentsFlowTest.groovy` integration test demonstrates a payment flow where a consent is initially in \"AwaitingAuthorisation\" status and then transitions to \"Authorised\" after authorization.  This suggests that the system handles different authorization states. However, the specific status \"ACTC\" is not present in the defined enums. \\n\\n### Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, is used for centralized configuration.  While the overview mentions consent management and identity server extensions, there is no explicit configuration option for defining or mapping transaction statuses like \"ACTC\" in the provided snippets.  The `wso2is-7.0.0-deployment.toml` and `wso2is-7.1.0-deployment.toml` files contain various deployment configurations, including authentication endpoints and resource access control, but do not specify transaction status mappings.  \\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoints for payment initiation are defined in `payment-initiation-openapi.yaml`. \\nThe key endpoints are:\\n*   `/payment-consents`: Used for creating payment consents (`CreatePaymentConsents` operation). \\n*   `/payments`: Used for creating payments (`CreatePayments` operation). \\n\\nThe `obWritePaymentResponse5` schema, returned by these APIs, includes the `Status` field which indicates the current state of the payment.  The `MultiAuthorisation` object within `obWritePaymentConsentResponse5` indicates support for multi-level authorization flows, with statuses like \"Authorised\" and \"AwaitingFurtherAuthorisation\". \\n\\n### Documentation References\\n\\nThe \"Overview\" wiki page provides a high-level understanding of the WSO2 Financial Services Accelerator, its architecture, and core components.  It mentions that the solution supports payment initiation and consent management.  The API specifications section refers to `payment-initiation-openapi.yaml` for payment-related APIs.  However, there is no specific documentation reference within the provided context that explicitly states the return of \"ACTC\" status for multilevel SCA. \\n\\n## Notes\\n\\nThe term \"ACTC\" (AcceptedTechnicalValidationCompleted) is a specific transaction status often found in Open Banking specifications. While the repository supports various payment statuses and multi-authorization flows, the exact \"ACTC\" status is not explicitly defined in the provided OpenAPI specification for payments. The closest statuses are \"AcceptedSettlementInProcess\" or \"AcceptedWithoutPosting\", which might be used in a similar context, but a direct match for \"ACTC\" is not found.  Further investigation into the actual implementation logic that maps internal statuses to the OpenAPI `Status` enum would be required to definitively confirm if \"ACTC\" is supported or can be configured.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_f378cee1-20a3-4984-addb-e97d45e82c4d\\n', 'id': 'lc_46e3cc97-32f1-4eb2-b6b4-2790b0e49e95'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0018",
      "requirement": {
        "requirement_id": "ATOM_039",
        "requirement_text": "HTTP response code 201 Created MUST be returned for successful POST requests where Payment Initiation or Consent Request was correctly performed",
        "strength": "MUST",
        "capability": "Error Handling",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0018_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Yes, this repository supports returning an HTTP `201 Created` response code for successful POST requests related to certain creation operations, including those that could be analogous to \"Payment Initiation\" or \"Consent Request\" in a broader context. Specifically, the codebase demonstrates this behavior for creating OAuth2 applications, SCIM2 users and groups, and organization-related entities.\\n\\n### Implementation Details\\n\\nThe codebase includes several integration tests that assert a `201 Created` status code for successful POST operations.\\n\\nFor instance, when creating an OAuth2 application using the Dynamic Client Registration Management (DCRM) API, the `testCreateServiceProviderRequest` method in `OAuthDCRMTestCase.java` asserts that the HTTP response status code is `201` upon successful creation of a service provider . This is further reinforced by another test, `testRollbackOnInvalidRequest`, which also expects a `201` status code for a valid DCR application creation request . The `DCRTestCase.java` in `product-scenarios` also confirms this behavior for registering OAuth2 applications .\\n\\nSimilarly, for SCIM2 user and group creation, the `SCIM2RestClient.java` includes methods like `createGroup` and `createSubOrgGroup` that explicitly assert an `HttpServletResponse.SC_CREATED` (which is `201`) status code for successful group creation  . The `SCIM2GroupTestCase.java` also verifies this for group creation with charset encoding headers . The `OrganizationManagementSuccessTest.java` also asserts a `201` status code when creating a user within an organization via SCIM2 .\\n\\nFor organization management, the `createOrganizations` method in `OrganizationManagementSuccessTest.java` checks for `HttpStatus.SC_CREATED` (201) after a POST request to create a new organization . Enabling email domain discovery also returns a `201` status code .\\n\\nOther examples include:\\n*   Creating custom OIDC scopes .\\n*   Adding local claims .\\n*   Creating Identity Providers (IdPs) .\\n*   Creating actions for pre-update password events  .\\n*   Self-registration of users  .\\n\\n### API Endpoints or Features\\n\\nThe concept of \"Payment Initiation\" or \"Consent Request\" is not explicitly named as a top-level API in the provided context. However, the `AuthorizationDetailsType` class contains an example for `payment_initiation` as a type for authorization details, suggesting that such a concept is recognized within the system\\'s data models  . The schema for this type also includes actions like \"initiate\" and \"cancel\" for `payment_initiation` .\\n\\nThe \"Consent Management\" feature, as described in the wiki, involves collecting, storing, and managing user consent for processing personal data <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"7.3\" end=\"7.3\" />. While the wiki doesn\\'t explicitly state that a `201 Created` is returned for a consent *request* POST, it details the process of consent collection during self-registration and authentication, and consent enforcement during token issuance <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"7.3\" end=\"7.3\" />. Given the consistent use of `201 Created` for other successful POST operations that create resources, it is highly probable that a similar pattern would be followed for successful consent creation.\\n\\n### Documentation References\\n\\nThe \"Organization Management\" wiki page lists `/api/server/v1/organizations` as an endpoint for creating a new organization via POST <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"3.4\" end=\"3.4\" />. The \"User APIs\" wiki page indicates that the SCIM 2.0 `/Me` endpoint supports POST for user registration, with a `201` response for successful creation <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" start=\"4.2\" end=\"4.2\" />. This is corroborated by the `scim2.yaml` Swagger definition, which explicitly states a `201` response for the `createUserMe` operation .\\n\\n## Notes\\n\\nThe provided context primarily consists of integration tests and wiki documentation. While these strongly indicate the expected behavior of returning `201 Created` for successful resource creation via POST requests, they do not provide direct access to the server-side implementation logic that generates these HTTP responses. The term \"Payment Initiation\" is found in a model definition, suggesting its conceptual presence, but not as an exposed API endpoint in the provided snippets.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [User APIs (wso2/product-is)](/wiki/wso2/product-is#4.2)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-h_16d5cab2-bfab-46ee-94f3-4991c00c6e01\\n', 'id': 'lc_d61976bd-b5b3-4303-aef6-1c03cccdf12a'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0018_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports returning an HTTP 201 Created status code for successful POST requests related to various resource creations, including APIs, subscriptions, API categories, advanced throttling policies, custom rules, deny policies, environments, and key managers. While the provided snippets do not explicitly mention \"Payment Initiation\" or \"Consent Request,\" the general pattern for successful resource creation via POST requests is to return a 201 status code.\\n\\n### Implementation Details and API Endpoints\\n\\nThe codebase includes several API definitions and test cases that assert a 201 HTTP status code for successful POST operations.\\n\\nFor example, when creating an API, the `APIsApi` in the publisher client defines a POST operation to `/apis` that returns a 201 status code upon successful creation . This is further confirmed by integration tests such as `APITestCase.txt` , `APILifecycleTestCase.txt` , `ApplicationScopeTestCase.txt` , `TagTestCase.txt` , and `EnvironmentTestCase.txt` , which explicitly check for a \"status-code\": \"201\" in their header asserts for POST requests to `/api/am/publisher/v0.16//apis`.\\n\\nSimilarly, for subscriptions, the `SubscriptionsApi` in the store client specifies that a POST request to `/subscriptions` will return a 201 status code for successful creation . This is also reflected in `ApplicationScopeTestCase.txt` for POST requests to `/api/am/store/v0.16//subscriptions` .\\n\\nOther API endpoints that return a 201 status code for successful POST operations include:\\n*   Adding an Advanced Throttling Policy via `throttlingPoliciesAdvancedPost` .\\n*   Adding an API Category via `apiCategoriesPost` .\\n*   Adding a Custom Rule via `throttlingPoliciesCustomPost` .\\n*   Adding a Deny Policy via `throttlingDenyPoliciesPost` .\\n*   Adding an Environment via `environmentsPost` .\\n*   Adding a Key Manager via `keyManagersPost` .\\n*   Creating a new application via `applicationsPost` .\\n*   Adding an API Comment via `addCommentToAPI`  and .\\n\\n### Configuration Options\\n\\nThe configuration of HTTP response codes is typically handled within the API definitions (e.g., OpenAPI/Swagger specifications) and the underlying API implementation. The provided `openapi.yaml` files explicitly define `201` as the success status code for POST operations  .\\n\\n### Documentation References\\n\\nThe OpenAPI specification files and generated client documentation clearly indicate the expected 201 HTTP status code for successful POST requests. For instance, `publisher-api.yaml`  and `admin-api.yaml`  show this for various resource creations. The `ApIsApi.md` documentation also confirms this behavior for API creation and WSDL imports .\\n\\n## Notes\\n\\nThe provided code snippets demonstrate that the `wso2/product-apim` repository consistently uses HTTP 201 Created for successful POST requests that result in the creation of a new resource. While \"Payment Initiation\" or \"Consent Request\" are not explicitly mentioned, the pattern for resource creation is well-established across various API domains within the repository. The test cases explicitly assert this behavior, confirming that the system is designed to return a 201 status code for successful creation operations.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-h_364fbf4b-df50-40b7-aa3a-4c9ca7a2bd67\\n', 'id': 'lc_e559c7f4-7970-4fa0-98bb-cdac554a44b3'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0019",
      "requirement": {
        "requirement_id": "ATOM_119",
        "requirement_text": "The Authorization header SHALL be included only if OAuth2 based authentication was performed in a pre-step or SCA was performed",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0019_1",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0019_2",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0019_3",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0019_4",
          "text": "### setOauthAppProperties method\nThis method lets you enable OAuth 2.0 properties related to the application. For example, ID token encryption.\n\n``` java\npublic void setOauthAppProperties(boolean isRegulatoryApp, OAuthConsumerAppDTO oauthApplication, Map<String, Object> spMetaData)\nthrows OpenBankingException {\n\n  oauthApplication.setIdTokenEncryptionEnabled(true);\n  oauthApplication.setIdTokenEncryptionAlgorithm(\"RSA-OAEP\");\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0019_5",
          "text": "A pushed authorization request contains authentication and authorization request parameters, which will be used in the Pushed Authorization endpoint of WSO2 Open Banking Accelerator. The Pushed Authorization endpoint returns a `request_uri` with an expiration time as a reference to the details sent in the pushed authorization request. ##Default Pushed Authorization Request validations The Pushed Auth Request Validator uses the existing validation layer of WSO2 Open Banking Accelerator to enforce validations. By default, the following validations are available in the validation layer: - Repeated parameter validation for all parameters: checks the pushed authorization request body for any repeated parameters When the `request` parameter is available: !!! note The `request` parameter value which will be referred to as `request object` from here onwards should be a Signed JWT(JWS) or an Encrypted JWT(JWE). It can be signed and encrypted as well. In this scenario, it must be signed before being encrypted. - Validation of form body parameters - verifies that only client authentication parameters (such as `client_id`, `client_assertion`, `client_assertion_type`) are present in the request form body. Other parameters must be included in the request object. - Validation of client id - validates the `client id` claim of the request object. - Validation of redirect URI - validates the redirect URI to check whether it matches with the registered redirect URIs. - Validation of request object signature algorithm - checks if the correct signing algorithm is used. - Validation of request object signature - verifies the signature of the request object. - Validation of the nonce claim - checks whether the nonce claim is available for response types requesting `id_token`. - Validation of the scope claim - checks whether the scope claim contains scopes that are registered with the client application. - Validation of the audience claim - checks if the audience claim matches the token endpoint URL. - Validation of the issuer claim - checks whether the issuer claim matches the client_id. - Validation of invalid claims in request object - check whether the `request` and `request_uri` claims are present in the request object. ##Writing a Custom Pushed Auth Request Validator You can extend the default validations in WSO2 Open Banking Accelerator and add more validations according to your open banking requirements: - To implement a custom Pushed Auth Request validator, extend the following class: ``` java com.wso2.openbanking.accelerator.identity.push.auth.extension.request.validator.PushAuthRequestValidator ``` Given below is a brief explanation of the methods you need to implement. ###validateAdditionalParams method This method performs the additional validations you add. Given below is the method signature: ``` java public void validateAdditionalParams(Map<String, Object> parameters) throws PushAuthRequestValidatorException ``` Input parameters - `Map<String, Object> parameters` - contains pushed authorization request parameters obtained from the HTTP servlet request Output parameter - `void` !!! note When a valid request object is present as a request parameter, the default implementation of the accelerator decodes the request object JWT and adds the following parameters to the Map<String, Object> parameters map. 1. Key - `\"decodedJWTBody\"`, Value - `<decoded request object JWT body>` 2. Key - `\"decodedJWTHeader\"`, Value - `<decoded request object JWT header>` For example: - Extend the `PushAuthRequestValidator` class and",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0019_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of the `Authorization` header in requests, particularly in the context of OAuth2-based authentication. The presence and content of this header are directly tied to the OAuth2 flow, specifically when obtaining access tokens.\\n\\n### Implementation Details\\nThe `Authorization` header is primarily used in OAuth2 token requests to send client credentials. For instance, in the OAuth2 Authorization Code Grant flow, the `Authorization` header is constructed with a `Basic` scheme, encoding the `consumerKey` and `consumerSecret` of the OAuth2 application . This is evident in the `testGetAccessToken` method of `OAuth2ServiceAuthCodeGrantTestCase.java`  and `sendTokenRequestForCodeGrant` method in `PreIssueAccessTokenActionSuccessRefreshTokenExpiryTestCase.java` . Similarly, for the Resource Owner Password Credentials Grant, the `Authorization` header is also set with `Basic` authentication using the `consumerKey` and `consumerSecret` .\\n\\nThe `OAuth2Constant.java` file defines the constant `AUTHORIZATION_HEADER`  and `BASIC_HEADER` , which are used to construct this header.\\n\\n### Configuration Options\\nThe `Authorization` header\\'s presence and validation are implicitly configured through the OAuth2 client registration and the grant types enabled for an application. The `ClientAuthHandlers` configuration in `saml-assertion-query-enabled-identity.xml`  indicates that `BasicAuthClientAuthHandler` is a supported client authentication method, which directly relates to how the `Authorization: Basic` header is processed.\\n\\n### API Endpoints or Features\\nThe primary API endpoint where the `Authorization` header is crucial for OAuth2 authentication is the token endpoint, typically `/oauth2/token` . This is where clients exchange authorization codes or refresh tokens for access tokens, and the `Authorization` header carries the client\\'s credentials. Examples include:\\n*   `ACCESS_TOKEN_ENDPOINT`  used in `OAuth2ServiceAuthCodeGrantTestCase` .\\n*   The `OAuth2RestClient` also uses `AUTHORIZATION_ATTRIBUTE` with a `BEARER_TOKEN_AUTHORIZATION_ATTRIBUTE` for API authorization, indicating that once an access token is obtained, it is used in a `Bearer` scheme in subsequent API calls .\\n\\n### Documentation References\\nThe \"Features and Capabilities\" wiki page for `wso2/product-is` explicitly lists \"OAuth 2.0\" as a core authentication and authorization protocol, supporting various grant types like Authorization Code and Client Credentials  . This implies that the mechanisms for client authentication, including the use of the `Authorization` header, are fundamental to these supported flows.\\n\\n## Notes\\nThe provided snippets primarily focus on the `Authorization` header in the context of OAuth2 client authentication (using `Basic` scheme with client ID and secret) and subsequent API calls (using `Bearer` scheme with an access token). There is no explicit mention or implementation detail regarding \"SCA\" (Strong Customer Authentication) in relation to the `Authorization` header within the provided context. Therefore, while OAuth2-based authentication strongly correlates with the `Authorization` header, the connection to SCA cannot be confirmed from the given information.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3ab28615-cc45-4b50-81aa-80f2ed9ad13e\\n', 'id': 'lc_27ba749d-6ce8-46bc-bc23-7e91d65e1990'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0019_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_a375146c-10d8-4bbf-8a87-c56ab1908f0f'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0020",
      "requirement": {
        "requirement_id": "ATOM_088",
        "requirement_text": "ASPSP must validate Client ID, Redirect URI, and TPP Role when using OAuth2 SCA approach",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0020_1",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_2",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_3",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_4",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0020_5",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0021",
      "requirement": {
        "requirement_id": "ATOM_226",
        "requirement_text": "PKCE code_challenge parameter SHALL be included in authorization request according to RFC 7636 to prevent code injection attacks",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "13.1",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0021_1",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0021_2",
          "text": "### Authorization Request\n\nWSO2 Open Banking Accelerator supports the following security features and fulfil FAPI requirements \nduring Authorization flows:\n\n  - OIDC Hybrid Flow\n    - Request object verification\n    - Pushed Authorization Request validation\n    - Pairwise Identifier support for ID tokens\n  - Authorization Code Flow\n    - When a request object is not available, support authentication mechanisms such as PKCE\n\nYou can use the provided extension points and customize the authorization flows. For more information, refer to the\n[Authorization Flow Customization](../develop/keyid-provider.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0021_3",
          "text": "### Validate method\n\nThis method lets you perform validations at the filter level. Given below is the method signature.\n\n``` java\nvoid validate(ServletRequest request, String clientId) throws TokenFilterException, ServletException;\n```\n\nThe following validators are implemented by extending `OBIdentityFilterValidator`. You can customize them by extending \nthe respective class and overriding the `validate` method, which is explained above.\n\n!!! note \n    In addition to extending the below validators, you can directly extend the `OBIdentityFilterValidator` class and \n    develop your own validators.\n\n - MTLSEnforcementValidator validator\n      \n    This enforces that a certificate needs to be passed during token creation. This certificate is then bound to the \n    access token.\n     \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.MTLSEnforcementValidator \n    ```\n   \n - ClientAuthenticatorValidator validator\n\n    This validates whether the token request follows the client authentication method format that was registered through \n    Dynamic Client Registration. \n    \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.ClientAuthenticatorValidator  \n    ```\n\n - SignatureAlgorithmEnforcementValidator method\n\n    This validates whether the client assertion is signed with the algorithm that was registered through Dynamic Client Registration. \n    \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.SignatureAlgorithmEnforcementValidator \n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0021_4",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0021_5",
          "text": "### Create an application using [DCR](dynamic-client-registration-try-out.md)\n\nInclude the CIBA grant type in the DCR request object as follows:\n\n   ``` json\n     \"grant_types\": [\n        \"client_credentials\",\n        \"authorization_code\",\n        \"refresh_token\",\n        \"urn:ietf:params:oauth:grant-type:jwt-bearer\",\n        \"urn:openid:params:grant-type:ciba\"\n      ],\n   ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0021_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Yes, the WSO2 Identity Server repository supports the inclusion of the PKCE `code_challenge` parameter in authorization requests according to RFC 7636. This is implemented to prevent code injection attacks.  \\n\\n## Implementation Details\\n\\nThe implementation of PKCE is demonstrated in the `OAuth2PKCETestCase.java` integration test file.  This test case covers various scenarios, including valid and invalid PKCE flows.  \\n\\n### Code Challenge Generation and Usage\\n\\nThe `getPKCECodeVerifier()` method generates a random string to be used as the `code_verifier`.  The `getPKCECodeChallenge(String codeVerifier)` method then takes this verifier and generates the `code_challenge` by applying SHA-256 hashing and Base64 URL-safe encoding, as specified in RFC 7636. \\n\\nDuring the authorization request, the `code_challenge` and `code_challenge_method` parameters are included.  The `authCodeGrantSendAuthRequestPost` method is responsible for sending these parameters in the authorization request. \\n\\n### Token Request with Code Verifier\\n\\nWhen requesting an access token, the `code_verifier` is sent along with the authorization code.  The `authCodeGrantSendGetTokensPost` method handles this part of the flow.  The system then validates the `code_verifier` against the previously sent `code_challenge`. \\n\\n## Configuration Options\\n\\nPKCE support can be configured for OAuth2 applications. The `OpenIDConnectConfiguration` model includes a `pkce` object, which has properties for `mandatory` and `supportPlainTransformAlgorithm`. \\n\\n*   `pkce.mandatory`: A boolean flag to indicate if PKCE is mandatory for the application. \\n*   `pkce.supportPlainTransformAlgorithm`: A boolean flag to indicate if the \"plain\" `code_challenge_method` is supported. \\n\\nThese configurations can be updated via the application management API.  For example, the `testUpdateApplication` method in `OAuth2PKCETestCase` demonstrates setting `pkce.mandatory` to `true` and `pkce.supportPlainTransformAlgorithm` to `false`. \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoints are those involved in the OAuth2 authorization code flow:\\n\\n*   **Authorization Endpoint**: This endpoint receives the initial authorization request, including the `code_challenge` and `code_challenge_method`. \\n*   **Token Endpoint**: This endpoint receives the token request, which includes the `code_verifier` for validation. \\n\\nThe `OAuth2PKCETestCase` extensively uses these endpoints to test PKCE functionality. \\n\\n## Test Criteria\\n\\nThe test criteria for verifying PKCE implementation are demonstrated through various assertions in `OAuth2PKCETestCase`. \\n\\n*   **Presence and Formatting**: The `getPKCECodeChallenge` method ensures the `code_challenge` is generated using SHA-256 and Base64 URL-safe encoding, adhering to RFC 7636. \\n*   **Validation of `code_challenge_method`**: The system explicitly checks for supported `code_challenge_method` values. An invalid method results in an `Unsupported PKCE Challenge Method` error. \\n*   **Validation of `code_verifier`**: If an invalid `code_verifier` is provided, the token request fails with an `invalid_grant` error and the description `PKCE validation failed`. \\n*   **Mandatory PKCE Enforcement**: When PKCE is configured as mandatory, requests without a `code_verifier` or with an invalid `code_challenge` will be rejected with specific error messages indicating that PKCE is mandatory.  \\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests (`modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/oauth2/OAuth2PKCETestCase.java` ) and model definitions (`modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/rest/api/server/application/management/v1/model/OpenIDConnectConfiguration.java` ). While these clearly demonstrate the support and configuration options for PKCE, they do not show the exact server-side implementation logic that processes and validates the `code_challenge` and `code_verifier`. However, the comprehensive nature of the tests strongly indicates that the underlying server-side implementation adheres to RFC 7636.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_a789c059-58ef-4249-b7f9-933212228b9c\\n', 'id': 'lc_d8c605a8-0160-4c95-888d-0778ddca8ca3'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0021_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"Yes, the `wso2/product-apim` repository supports the inclusion of the PKCE `code_challenge` parameter in authorization requests according to RFC 7636. This is primarily demonstrated through integration tests that configure and verify PKCE-enabled applications. \\n\\n## Implementation Details\\n\\nThe core implementation details related to PKCE support are found within the integration tests, specifically in `PkceEnabledApplicationTestCase.java` . This test class sets up applications with PKCE enabled and verifies their behavior.\\n\\n### Grant Types\\nThe system supports the `authorization_code` grant type, which is a prerequisite for PKCE. This is evident from the `grantTypes` ArrayList being populated with `APIMIntegrationConstants.GRANT_TYPE.AUTHORIZATION_CODE` . The `identity.xml` configuration also lists `authorization_code` as a supported grant type with `org.wso2.carbon.apimgt.keymgt.handlers.ExtendedAuthorizationCodeGrantHandler` as its handler .\\n\\n### Application Key Generation with PKCE\\nThe `PkceEnabledApplicationTestCase` demonstrates how to generate application keys with PKCE enabled.\\nThe `testApplicationCreationKeyGenerationWithPkce` method shows how to set `pkceMandatory` to `true` when generating application keys . This ensures that the `code_challenge` parameter will be required in subsequent authorization requests.\\n\\nThe `generateKeysWithAdditionalProperties` method of `restAPIStore` is used to pass these additional properties . The response from this operation confirms that `pkceMandatory` is set to `true` .\\n\\n### PKCE Plain Text Support\\nThe repository also supports PKCE with plain text `code_challenge` values, although RFC 7636 recommends S256. The `testApplicationCreationKeyGenerationWithPkcePlainText` method sets `pkceSupportPlain` to `true` in the additional properties during key generation . This allows for the use of plain text `code_challenge` values.\\n\\n## Configuration Options\\n\\nPKCE-related configurations are managed through additional properties when generating application keys.\\n*   `pkceMandatory`: A boolean flag that, when set to `true`, enforces the inclusion of the `code_challenge` parameter in authorization requests .\\n*   `pkceSupportPlain`: A boolean flag that, when set to `true`, allows the use of plain text `code_challenge` values .\\n\\nThese properties are passed as a `Map<String, Object>` to the `generateKeysWithAdditionalProperties` method .\\n\\n## API Endpoints or Features\\n\\nThe `restAPIStore` client, used in the integration tests, exposes the `generateKeysWithAdditionalProperties` method, which is the feature that allows configuring PKCE for applications . This method is part of the store API for managing applications and their keys.\\n\\n## Documentation References\\n\\nThe provided snippets are primarily integration tests, which serve as executable documentation for the feature. The `PkceEnabledApplicationTestCase.java` file explicitly demonstrates the usage and expected behavior of PKCE-enabled applications .\\n\\n## Test Criteria Verification\\n\\nThe integration tests verify the presence and proper formatting of the PKCE `code_challenge` parameter by asserting the values of `pkceMandatory` and `pkceSupportPlain` in the `additionalPropertyResponse` after key generation . While the tests don't directly show an authorization request with a `code_challenge` parameter, the successful generation of keys with `pkceMandatory` set to `true` implies that the system will enforce this requirement during the authorization flow.\\n\\n## Notes\\n\\nThe provided context primarily consists of integration tests. While these tests confirm the support for PKCE and its configuration options, they do not expose the exact low-level code that validates the `code_challenge` parameter according to RFC 7636. However, the presence of `ExtendedAuthorizationCodeGrantHandler`  suggests that the logic for handling authorization codes, and thus PKCE, resides within this handler or related components.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_f6d26fbe-1ad7-41bc-a4f8-4c00daeef85c\\n\", 'id': 'lc_e504795c-0e9c-4ea7-a09d-cc69b32a1f87'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0022",
      "requirement": {
        "requirement_id": "ATOM_196",
        "requirement_text": "The authorisationId field SHALL be mandatory in the response and contain a unique resource identification of the created authorisation sub-resource.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0022_1",
          "text": "| MsgInfoDTO | resource | String | An API resource | | ResponseContextDTO | MsgInfoDTO | electedResource | String | An elected resource | | ResponseContextDTO | MsgInfoDTO | httpMethod | String | The HTTP method of the request | | ResponseContextDTO | MsgInfoDTO | messageId | String | A unique ID given to a particular request | | ResponseContextDTO | APIRequestInfoDTO |context | String | The API context given when publishing the API | | ResponseContextDTO | APIRequestInfoDTO |version | String | The published version of the API | | ResponseContextDTO | APIRequestInfoDTO |username |String | The owner of the access token | | ResponseContextDTO | APIRequestInfoDTO |consumerKey | String | The client ID/Consumer Key of the API consumer application | | ResponseContextDTO | APIRequestInfoDTO |apiId | String | A unique ID given for the API | | ResponseContextDTO | Status Code | | String | The HTTP response status code | | contextProps | | | Map | A map of context properties. You can access and modify these in any executor| |modifiedPayload| | | String | The modified payload as a string| | responsePayload | | | String | The response payload as a string | | addedHeaders | | | Map | The headers that need to be added to the response (if available)| | isError | | | Boolean | A boolean value to indicate the error state | | errors | | | List<Error> | A list of errors found in the response | | analyticsData | | | Map | A map of analytics data that needs to be published to Open Banking Business Intelligence |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_2",
          "text": "##Writing a Custom Request Object Validator\nA Request Object contains authentication and authorization request parameters in a self-contained JWT. It is used in the \nauthorization endpoint of WSO2 Identity Server. Banks can use this authorization endpoint \nto redirect the bank customer to authenticate and approve/deny consents before an API consumer accesses financial \ninformation. \n\nIn WSO2 Open Banking Accelerator, the Request Object validator uses its existing validation layer to enforce validations. By \ndefault, it consists of 3 validations:\n\n   - `@RequiredParameter` checks if the Request Object is signed.\n   - `@ValidScopeFormat` checks if the scope claim contains an OpenID Connect(OIDC) scope.\n   - `@ValidAudience` checks if the audience claim matches the token endpoint URL.\n   - `@ValidSigningAlgorithm` checks if the correct signing algorithm is used.\n\nFor more information on the validation layer in WSO2 Open Banking Accelerator, see [Validation Layer](../develop/validation-layer.md).\n\nYou can extend the default validations in WSO2 Open Banking Accelerator and add more validations according to your open \nbanking requirement:\n\n1. To implement a custom Request Object validator, extend the following class:\n``` java\ncom.wso2.openbanking.accelerator.identity.auth.extensions.request.validator.OBRequestObjectValidator\n``` \n\n2. Add the required validations as annotations to the model. \n\n    !!!note\n        For annotations, you can use:\n    \n        - Hibernate Validator Library\n        - WSO2 Open Banking Accelerator\n        - Custom annotations\n    \n3. Extend `OBRequestObjectValidator` and create your own class.\n\n###validateOBConstraints method\nThis method performs the custom validations you add. Given below is the method signature:\n``` java\npublic ValidationResponse validateOBConstraints(OBRequestObject obRequestObject, Map<String, Object> dataMap) \n```\n\n!!!note\n    The `dataMap` parameter contains data related to scope validation at the moment. This `dataMap` parameter provides \n    the scope registered for the service provider application. Therefore, this can be used to validate the scopes given \n    in the Request Object according to your requirement.      \n \n- Type cast `OBRequestObject` to your own model using the following sample:\n  ```\n    UKRequestObject ukRequestObject = new UKRequestObject(obRequestObject);\n  ```\n   \n4. To make sure the default validations of the Request Object executes, validate your new model, which is inherited \nfrom `obRequestObject` as follows:\n``` java\nString error = OpenBankingValidator.getInstance().getFirstViolation(yourInheritedNewModel);\n```\n\n##Configuring a custom Request Object Validator \n1. Make sure the following configuration exists in `<IS_HOME>/repository/conf/deployment.toml`:\n``` java\n[oauth.oidc.extensions]\nrequest_object_validator = \"com.wso2.openbanking.accelerator.identity.auth.extensions.request.validator.OBRequestObjectValidationExtension\"\n```\n\n2. Update the following configuration in `<IS_HOME>/repository/conf/deployment.toml` with your extended class: \n``` java \n[open_banking.identity.extensions]\nrequest_object_validator = \"your.extended.class\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_3",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_4",
          "text": "## What is new in this release\n\n####WSO2 Open Banking Accelerator for Identity Server \n\n- Accelerator-level support for both pre-initiated and scope-based consent flows\n- OpenAPI based accelerator extension points to implement specification compliance addition to supported java based extension points. Fore more information, see [OpenAPI for Accelerator extensions](../references/accelerator-extensions-api.md)\n- JDK21 runtime support\n- Idempotency feature support from accelerator layer\n- Generalized consent management support for common open banking use cases. For more information, see [Consent Management](../learn/consent-management.md).\n- New features support from WSO2 Identity Server\n\n    - Native support for Financial grade API (FAPI) Security. For more info,[refer](https://is.docs.wso2.com/en/7.0.0/references/financial-grade-api/)  \n    - OAuth2 Rich Authorization Request (RAR) support.For more info ,[refer](https://is.docs.wso2.com/en/latest/guides/authorization/rich-authorization-requests/) \n    \n\n\n\n##What has changed in this release\n\nWSO2 Open Banking Accelerator 4.0 is an improved version of WSO2 Open Banking Accelerator 3.0 to expand covering\ndomain from Open Banking to Open Finance and improve developer experience of implementing accelerator extension points\nto cater regulatory and other open banking/ open finance requirements. Some significant changes in this release are,\n\n- OpenAPI based extensions support for IAM Accelerators.  Fore more information, see [OpenAPI for Accelerator extensions](../references/accelerator-extensions-api.md)\n- Out of the box support for both of the consent flows of pre-initiated and scopes based",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_5",
          "text": "## Writing a custom ID Token Builder\n\nThe default ID Token Builder in WSO2 Open Banking provides the pairwise subject calculation for authorization and token \nflow.\n\nIf the API consumer application supports the sector identifier URI parameter, the pairwise subject calculation is \nperformed using the **sector identifier URI**. Otherwise, the calculation is performed using the **callback URI**.\n\nGiven below is the Fully Qualified Name (FQN) of the default ID Token Builder: \n\n``` java\ncom.wso2.openbanking.accelerator.identity.idtoken.OBIDTokenBuilder\n```\n\nYou can implement a custom ID Token Builder for the **Authorization flow** by overriding the following method of this class:",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, supports the concept of an `authorizationId` field in responses, particularly within the context of managing API resources and their associated authorization details. The `authorizationId` is represented by the `id` field within `AuthorizationDetailsType` objects and `AuthorizedAPIResponse` objects, which are used to uniquely identify created authorization sub-resources.  \\n\\n## Implementation Details\\n\\nThe `id` field, which serves as the `authorizationId`, is a mandatory string field in the `AuthorizationDetailsType` model.  This model is used to define the structure of authorization details types associated with API resources. When authorization details types are added, updated, or retrieved, this `id` field is present in the response.   \\n\\nSpecifically, the `OAuth2RestClient` class contains methods for managing API resources and their authorization details. \\n*   The `addAuthorizationDetailsTypes` method creates new authorization details types for a given API resource and returns a list of `AuthorizationDetailsType` objects, each containing a unique `id`.  The `id` is asserted to be non-null in the integration tests. \\n*   The `getAuthorizationDetailsType` method retrieves a specific `AuthorizationDetailsType` by its `apiId` and `typeId` (which is the `id` of the authorization details type). \\n*   The `updateAuthorizationDetailsType` method updates an existing authorization details type identified by its `apiId` and `typeId`. \\n\\nThe `AuthorizedAPIResponse` model also includes an `id` field, which represents the unique identification of an authorized API resource.  This `id` is populated when an API authorization is added to an application. \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoints are exposed through the `OAuth2RestClient` and are used for managing API resources and their authorization details. \\n*   `apiResourceManagementApiBasePath + PATH_SEPARATOR + apiId + AUTHORIZATION_DETAILS_TYPES_PATH`: This endpoint is used for adding, retrieving, and updating authorization details types for a specific API resource.   \\n*   `applicationManagementApiBasePath + PATH_SEPARATOR + appId + AUTHORIZED_API_BASE_PATH`: This endpoint is used for managing authorized APIs for a given application, including their authorization details. \\n\\n## Test Criteria\\n\\nThe integration tests in `OAuth2RichAuthorizationRequestsTestCase` verify that the `id` field (representing `authorizationId`) is mandatory and unique. \\n*   When adding authorization details types, the test asserts that the returned `AuthorizationDetailsType` objects have non-null `id` values. \\n*   When retrieving an `AuthorizationDetailsType` by its `typeId` (which is the `id`), the test confirms that the correct object is returned, implying uniqueness. \\n*   Similarly, when authorizing API resources to an application, the `AuthorizedAPIResponse` objects returned are checked to ensure their `id` fields are populated and unique. \\n\\n## Documentation References\\n\\nThe API Layer wiki page provides an overview of the RESTful APIs in WSO2 Identity Server, including API organization, versioning, and authentication.  While it doesn't specifically mention `authorizationId`, it describes the general structure and functionality of the APIs that would include such fields.  The `AuthorizationDetailsType` model itself contains `ApiModelProperty` annotations that serve as documentation for the `id` field, indicating it is required. \\n\\n## Notes\\n\\nThe term `authorisationId` in the prompt directly maps to the `id` field found in the `AuthorizationDetailsType` and `AuthorizedAPIResponse` models within the `wso2/product-is` repository. The codebase demonstrates that this `id` field is indeed mandatory and is used as a unique identifier for authorization-related sub-resources. The provided snippets are primarily from integration tests, which serve as concrete examples of how these API features are used and validated.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_bc5ea279-fb96-4f58-a6e9-05e4af67d4d1\\n\", 'id': 'lc_41f1e9e4-97f0-4e88-b0b9-153c23a80d0f'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0022_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_c1fca758-c981-4acb-8da7-7f5b4d065968'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0023",
      "requirement": {
        "requirement_id": "ATOM_135",
        "requirement_text": "The ASPSP shall deny data access if requested service type does not comply with consented service",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0023_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Yes, the WSO2 Identity Server repository supports denying data access if the requested service type does not comply with consented services through its Consent Management framework.   This is primarily handled during token issuance and API responses, where only attributes with explicit user consent are shared. \\n\\n## Implementation Details\\n\\nThe Consent Management framework in WSO2 Identity Server allows for the collection, storage, and enforcement of user consent for personal data processing.  The core components include:\\n\\n*   **PII Categories**: Defines types of personal data. \\n*   **Purposes**: Specifies reasons for data collection. \\n*   **Purpose Categories**: Groups related purposes. \\n*   **Consent Receipts**: Records user consent decisions. \\n\\nConsent enforcement occurs at several points:\\n\\n1.  **Token Issuance**: Only attributes for which consent has been granted are included in access tokens.  The `OAuth2ServiceAuthCodeGrantJWTAccessTokenWithConsentedTokenColumnTestCase` demonstrates this by testing JWT access tokens with a consented token column enabled. \\n2.  **API Responses**: User information APIs filter attributes based on consent. \\n3.  **Application Access**: Applications can only access attributes that users have consented to share. \\n\\nThe `sendApprovalPostWithConsent` method in `OAuth2ServiceAbstractIntegrationTest` is used to send consent approval requests, which include parameters like `consent` and `scope-approval`.  This method is called during the consent approval flow, as seen in `OIDCSSOConsentTestCase`. \\n\\n## Configuration Options\\n\\nThe `default-identity.xml` configuration file contains settings related to consent management. \\n\\n*   **`UserConsentEnabledGrantTypes`**: This section defines the OAuth 2.0 grant types for which user claims will be filtered based on user consent in responses like `id_token` or user info.  By default, `authorization_code` and `implicit` grant types are configured to filter user claims based on consent. \\n*   **`EnableSSOConsentManagement`**: This property, found under the `<Consent>` tag, specifies whether consent management should be enabled during Single Sign-On (SSO).  Setting this to `true` ensures that consent is managed during SSO flows. \\n*   **`SkipConsent`**: In application configurations, the `SkipConsent` flag can be set to `false` to ensure that consent flows are not skipped.  This is demonstrated in the `configure_is_fapi.py` script, which explicitly disables skipping consent for applications. \\n\\n## API Endpoints or Features\\n\\nThe Consent Management APIs are exposed through the `/api/identity/consent-mgt/v1.0/consents` endpoint.  This endpoint is used for managing user consents, including adding PII categories, purpose categories, purposes, and consent receipts. \\n\\nSpecific API endpoints related to consent management include:\\n\\n*   `/identity/consent-mgt/v1.0/consents`: For managing user consents.  \\n*   `/identity/consent-mgt/v1.0/consents/receipts/(.*)`: For managing consent receipts. \\n*   `/identity/consent-mgt/v1.0/consents/purposes(.*)`: For managing purposes. \\n*   `/identity/consent-mgt/v1.0/consents/pii-categories(.*)`: For managing PII categories. \\n*   `/identity/consent-mgt/v1.0/consents/purpose-categories(.*)`: For managing purpose categories. \\n\\nThese endpoints are secured and require appropriate permissions for access. \\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, including its purpose, key components, collection process, and enforcement mechanisms.  It also highlights how consent decisions affect token issuance and API responses. \\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which demonstrate the functionality of the Consent Management feature. While these tests confirm that the system can deny data access based on consent, they do not expose the exact internal logic for how this denial is implemented at a granular level within the core product code. However, the presence of these tests and configuration options strongly indicates support for the stated requirement.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f89685ca-d46f-4ec0-843f-f683f94fef7a\\n', 'id': 'lc_6bccc3e2-db51-4d8a-b0f5-e018d7490d45'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0023_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports denying data access based on service type not complying with consented service through its deny policy features. The core functionality for managing these deny policies is exposed via an Admin API and is tested within the integration test suite.\\n\\n### Implementation Details\\nThe system utilizes \"deny policies\" to restrict access. These policies can be configured with a `conditionType` and `conditionValue` to specify the criteria for denial. For instance, a `conditionType` of \"API\" combined with a `conditionValue` like \"test/1.0.0\" would deny access to that specific API .\\n\\nThe deny policies are managed through the `BlockingConditionDTO` object . This DTO includes fields such as `conditionStatus` (boolean), `conditionValue` (Object), and `conditionType` (an enum, e.g., `BlockingConditionDTO.ConditionTypeEnum.API`) .\\n\\n### Configuration Options\\nDeny policies are configured through the Admin API. You can add a new deny policy by providing a `BlockingConditionDTO` in the request body . The `conditionType` can be set to \"API\" to specifically target API access based on its context .\\n\\n### API Endpoints or Features\\nThe Admin API provides endpoints for managing deny policies:\\n*   **GET /throttling/policies/deny-policies**: Retrieves all existing deny policies . This endpoint supports querying by `conditionType` and `conditionValue` .\\n*   **POST /throttling/policies/deny-policies**: Adds a new deny policy .\\n*   **DELETE /throttling/deny-policy/{conditionId}**: Deletes a specific deny policy using its `conditionId` .\\n\\nThe `DenyPoliciesCollectionApi` and `DenyPolicyIndividualApi` classes in the `org.wso2.am.integration.clients.admin.api` package provide the client-side implementation for interacting with these endpoints  .\\n\\n### Documentation References\\nThe OpenAPI Specification for the Admin API, which includes details on deny policies, can be found at `https://raw.githubusercontent.com/wso2/carbon-apimgt/v6.7.206/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/resources/admin-api.yaml` .\\n\\n### Test Criteria\\nThe `APIDenyPolicyTestCase.java`  integration test class verifies the functionality of deny policies. Specifically, `testAddDenyPolicyWithNonExistingContext()`  tests that adding a deny policy for a non-existent API context results in an `HttpStatus.SC_INTERNAL_SERVER_ERROR` and an error message indicating an invalid API context . This demonstrates the system\\'s ability to reject data requests for service types (represented by API contexts) not included in the original consent scope (implicitly, valid API contexts).\\n\\n## Notes\\nThe provided context primarily focuses on API-level deny policies. While the prompt mentions \"service type\" and \"consented service,\" the available code snippets and documentation refer to \"API\" and \"API context\" as the granular units for denial. It is assumed that \"service type\" in the prompt maps to \"API context\" in this codebase. The `carbon.consent.mgt.server.feature` and `carbon.identity.consent.mgt.server.feature` are present in the build system   , suggesting a broader consent management framework, but the direct mechanism for denying data access based on service type not complying with consented service is demonstrated through the deny policies on API contexts.\\n\\nWiki pages you might want to explore:\\n- [Build System (wso2/product-apim)](/wiki/wso2/product-apim#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c60ac0bf-d22b-484e-b906-f5748d3ed00f\\n', 'id': 'lc_ce114aa9-6969-403b-8885-180879d35492'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0024",
      "requirement": {
        "requirement_id": "ATOM_228",
        "requirement_text": "TPP SHALL be authenticated during token request using OAuth 2.0 Mutual TLS Client Authentication and Certificate Bound Access Tokens in conjunction with the TPP's eIDAS certificate",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "13.3",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0024_1",
          "text": "### Grant Handler\n\nA Grant Handler validates the grant, scopes, and access delegation. By default, the following Grant Handler types are \nengaged when issuing tokens:\n\n   - Authorization Code Grant Handler  \n   - Client Credentials Grant Handler   \n   - Refresh Grant Handler  \n   \nMutual TLS authentication is enabled by default in WSO2 Open Banking Accelerator. When MTLS authentication is enabled, \nthe **Signature algorithm enforcement validator**, **Client authentication enforcement validator**, and the \n**MTLS enforcement validator** are engaged. Regardless of the client authentication method, you need to ensure that the \nTLS certificate is passed with every token request. \n\nYou can customize the above Grant Handlers to modify the token response and for other open banking requirements. \nFor more information, see [customizing Grant Handlers](../develop/grant-handlers.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0024_2",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0024_3",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0024_4",
          "text": "## Certificate-bound access tokens \n\nCertificate-bound access tokens are access tokens that have a certificate attached to them. When using certificate-bound \naccess tokens, you need to pass the certificate, which is bound to the token to gain access to protected resources. This \nprevents attacks to the access tokens from unauthorized parties. The validation for such tokens take place as \nfollows:\n\n   - Step 1: During the token API invocation, ensure that the transport certificate is passed as a header or in the context. \n   This is performed by a **Token Filter** before the API hits the authorization server.\n\n   - Step 2: Bind the transport certificate to the access token via the confirmation (`cnf`) claim. All **Grant Handler** \n   types (`authorization_code`, `client_credentials`, and `refresh_token`) bind the transport certificate hash to the \n   token using the `cnf` claim.\n\n   - Step 3: Return the `cnf` claim via an access token, the `cnf` claim ensures that the certificate is bound to the access \n   token.\n \n   - Step 4: Validate the certificate during the API invocation. The API Manager server needs to ensure that the \n   certificate being passed during the API call is the same certificate that is bound to the token.\n\nThe diagram below explains the flow and how the Grant Handler and Token Filters engage:\n![token_flow](../assets/img/learn/access-tokens/token-flow.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0024_5",
          "text": "The TPPs can create OAuth 2.0 client applications to facilitate banking services exposed via Bank APIs. WSO2 Open Banking provides the Client Registration feature to register the applications in the bank's back end. The TPP applications go through an in-depth verification during this process to make sure the application is authorized and secured before sharing customers\u2019 financial data.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0025",
      "requirement": {
        "requirement_id": "ATOM_165",
        "requirement_text": "Transaction responses MUST support both booked and pending transaction categories",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f30dd2c91d5e",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0025_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_2",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_3",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0025_4",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports transaction responses that include both \"Booked\" and \"Pending\" transaction categories. This is defined within the OpenAPI specification for the Accounts API and demonstrated in a demo backend service.\\n\\n## Implementation Details\\n\\nThe `account-info-swagger.yaml` file, which defines the OpenAPI specification for the Accounts API, explicitly lists \"Booked\" and \"Pending\" as possible statuses for a transaction entry . Specifically, the `OBEntryStatus1Code` definition enumerates these statuses .\\n\\nThe `OBReadTransaction5` schema, which represents the structure of a transaction response, includes a `Status` field that references `OBEntryStatus1Code` . This indicates that individual transactions within the response will carry one of these statuses.\\n\\nA demo backend service, `AccountService.java`, provides an example implementation of the `/accounts/{AccountId}/transactions` endpoint . In this demo, a sample transaction is returned with the `Status` explicitly set to \"Booked\" . While this specific example only shows \"Booked\", the underlying OpenAPI definition supports both.\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `GET /accounts/{AccountId}/transactions` . This endpoint is designed to retrieve transaction information for a specific account . The response for this endpoint is defined by the `200AccountsAccountIdTransactionsRead` schema, which in turn references `OBReadTransaction5` .\\n\\n## Documentation References\\n\\nThe primary documentation reference for this functionality is the `account-info-swagger.yaml` file itself, which serves as the OpenAPI specification for the Accounts API . The `OBEntryStatus1Code` definition within this file explicitly outlines the supported transaction statuses .\\n\\n## Test Criteria\\n\\nTo verify this, you would need to make a `GET` request to the `/accounts/{AccountId}/transactions` endpoint. The response body should contain a `Data` object, which in turn contains a `Transaction` array . Each object within this `Transaction` array should have a `Status` field, and the value of this field should be either \"Booked\" or \"Pending\" .\\n\\nAn integration test, `EndToEndAccountFlowTest.groovy`, includes a test case \"Verify Accounts transaction Retrieval Request for a Authorised Consent\" . This test confirms that the transaction retrieval request returns a `200` status code, indicating a successful response . While this test doesn\\'t explicitly check for both \"Booked\" and \"Pending\" statuses in the response structure, it validates the successful retrieval of transactions.\\n\\n## Notes\\n\\nThe provided codebase context does not explicitly show separate \"booked\" and \"pending\" arrays within the `transactions` object. Instead, the `OBReadTransaction5` schema indicates that each individual transaction object will have a `Status` field that can be either \"Booked\" or \"Pending\" . Therefore, the verification criteria should focus on checking the `Status` field of individual transaction objects rather than looking for separate arrays.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d8e5dc9c-b627-4ef5-9435-82209395e31b\\n', 'id': 'lc_d7b1b46a-5fb8-4465-8640-653d20dae810'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0026",
      "requirement": {
        "requirement_id": "ATOM_066",
        "requirement_text": "The system shall set transaction status to CANC (Cancelled) after successful payment cancellation and maintain this status while the resource remains addressable",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0026_1",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, the WSO2 Financial Services Accelerator, supports setting a transaction status to `CANC` (Cancelled) after a successful payment cancellation and maintaining this status.  This functionality is primarily handled through the consent management services, which include APIs for revoking consents and updating their statuses. \\n\\n## Implementation Details\\n\\nThe core logic for revoking consents and updating their status resides within the `ConsentCoreService` interface and its implementation, `ConsentCoreServiceImpl`.  Specifically, the `revokeConsent` methods in `ConsentCoreService` are responsible for updating the consent status to a `revokedConsentStatus` (which would be `CANC` in this scenario). \\n\\nWhen a consent is revoked, the `ConsentCoreServiceImpl` performs several actions:\\n1.  It retrieves the existing consent for status validation. \\n2.  It updates the consent status using `consentCoreDAO.updateConsentStatus()`. \\n3.  It creates an audit record for the consent status update. \\n4.  It updates associated account mappings to an inactive status. \\n5.  Optionally, it revokes tokens related to the consent if `shouldRevokeTokens` is true. \\n\\nThe `ConsentCoreDAO` interface, implemented by `ConsentCoreDAOImpl`, provides the data access methods to interact with the database, including `updateConsentStatus` to change the status of a consent.  The `FS_CONSENT` table in the database schema includes a `CURRENT_STATUS` column to store the consent\\'s status.  The `FS_CONSENT_STATUS_AUDIT` table records all status changes, including the `CURRENT_STATUS` and `PREVIOUS_STATUS`, ensuring an audit trail. \\n\\n## Configuration Options\\n\\nThe system allows for external service integration during the consent revocation process.  The `PRE_PROCESS_CONSENT_REVOKE` extension point can be used to validate and process consent revocation requests with an external service.  This external service can return a `revocationStatusName` which would be used to set the status after revocation, allowing for flexible status management. \\n\\n## API Endpoints or Features\\n\\nThe `AdminApi` provides a `DELETE /admin/revoke` endpoint for revoking consents.  This endpoint would be used to initiate the cancellation process, leading to the transaction status being set to `CANC`. \\n\\nThe `obWritePaymentResponse5` schema in `payment-initiation-openapi.yaml` defines a `Status` field for payment information, which is an enum that includes various statuses such as `Rejected` and `Pending`.  While `CANC` is not explicitly listed as an enum value in this snippet, the underlying consent management system allows for flexible status updates. \\n\\n## Documentation References\\n\\nThe \"Admin Operations\" wiki page provides an overview of the administrative consent operations, including search, revocation, and audit trail tracking.  It details the `DefaultConsentAdminHandler` class as the central coordinator for these operations and explains the consent revocation flow, including external service integration. \\n\\n## Notes\\n\\nThe provided snippets indicate strong support for managing consent statuses, including revocation and auditing. The `CANC` status would be a specific value passed to the `revokedConsentStatus` parameter in the `revokeConsent` methods. The system\\'s ability to maintain this status is supported by the `updateConsentStatus` method in `ConsentCoreDAO` and the audit trail in `FS_CONSENT_STATUS_AUDIT`. The `payment-initiation-openapi.yaml` defines payment statuses, but the consent management system is more generic and allows for custom status values.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Admin Operations (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4731fb58-7b3d-41ee-9b30-0f6d9b5dea3d\\n', 'id': 'lc_94e74c07-dc67-434a-83ab-0444fc321d9d'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0027",
      "requirement": {
        "requirement_id": "ATOM_140",
        "requirement_text": "The ASPSP shall support Global Consent model where TPP submits only PSU identification for global consent authorization",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0027_1",
          "text": "### Data\nThe following table explains the data available in `ConsentValidateData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| headers   | JSONObject            | The request headers sent in the request. |\n| body   | JSONObject            | The payload sent in the request. |\n| electedResource   | String            | The path invoked in the request. For example: `/accounts/{AccountId}`|\n| consentId | String                | The consent ID related to the current resource request. This consent ID is bound to the user access token used. |\n| userId | String                | The user ID related to the current resource request. This user ID is retrieved from the user access token. |\n| clientId | String                | The ID of the TPP application related to the current resource request. This client ID is retrieved from the user access token.|\n| comprehensiveConsent  | DetailedConsentResource   | The comprehensive consent object related to the consent that is being validated. This object contains all the details related to the consent. |\n| resourceParams | Map<String, String>                | A map containing the full resource path with query parameters (ex: `aisp/accounts/{AccountId}?queryParam=urlEncodedQueryParamValue`), HTTP method, and context (ex: `/open-banking/v3.1/aisp`) of the request. |\n\nThe following table explains the data available in `ConsentValidationResult`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| isValid | boolean | An attribute to identify whether the consent is in a valid state or not. |\n| modifiedPayload | JSONObject | Optionally used to set a modified error payload to be sent with the consent validation response. If a modified payload is set, it is given priority over creating a generic error response using the message and code information. |\n| consentInformation | JSONObject | Used to set the consent data to the consent validation result. This data will be sent to the bank backend. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0027_2",
          "text": "## Setting up Consent manager app",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0027_3",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0027_4",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0027_5",
          "text": "components:\n  schemas:\n    ConsentValidateDetail:\n      type: object\n      properties:\n        headers:\n          description: Object containing keys and values of request headers received to the gateway\n          type: object\n        payload:\n          description: Object containing the request payload received to the gateway\n          type: object\n        electedResource:\n          description: String value of the request path received in the request\n          type: string\n          example: \"/accounts/1234\"\n        consentId:\n          description: The consent ID of the consent being valdiated\n          type: string\n          example: \"cc0961f9-6b38-4c78-a522-b3210a7f2330\"\n        userId:\n          description: The user ID of the user invoking the API\n          type: string\n          example: \"admin@carbon.super\"\n        clientId:\n          description: The client ID of the TPP Application invoking the API\n          type: string\n          example: \"W4QaMjYv9rn49O7dpeBQD5DLGFQa\"\n        resourceParams:\n          description: The details of the API context and resource\n          type: object\n          properties:\n            resource:\n              description: The context including query parameters of the request\n              type: string\n              example: \"/aisp/accounts/{AccountId}?queryParam=queryParamValue\"\n            httpMethod:\n              description: The http method of the request\n              type: string\n              example: \"POST\"\n            context:\n              description: The base path of the context\n              type: string\n              example: \"/open-banking/v3.1/aisp\"\n    ConsentManageCreatePayload:\n      type: object\n    ConsentManageUpdatePayload:\n      type: object\n    ConsentManagePatchPayload:\n      type: object\n    ConsentAuthorizePatchPayload:\n      type: object\n      properties:\n        cookies:\n          type: object\n          properties:\n            commonAuthId:\n              type: string\n              example: \"060711ab-ab8e-44fe-ba3f-9d57fa0c4155\"\n            JSESSIONID:\n              type: string\n              example: \"A62B65FAA2F16E0172BD9D8825F96E49D1CADD9B55C58CD00C664380F13F8AE95138939A053851856C344A1ADECC0125FF716EE00DD32140BF8574ECECF9A5EDDFAAB641280C5220AC18B1C2F75D62E574C27B8E603A666C4DFF87F0347B460BE3A3B1A370E67559C5936FE2A7700764C9041B5E87118F763731DF9F77B0DDB8\"\n        type:\n          type: string\n          example: \"accounts\"\n        approval:\n          type: string\n          example: \"true\"\n        cofAccount:\n          type: string\n          example: \"12345\"\n        paymentAccount:\n          type: string\n          example: \"12345\"\n        accountIds:\n          type: array\n          items:\n            type: string\n            example: \"12345\"\n        metadata:\n          type: object\n    ConsentErrorCommon:\n      type: object\n      properties:\n        status:\n          description: Error status code\n          type: string\n        title:\n          description: Error title\n          type: string\n        description:\n          description: Error description\n          type: string\n    ConsentValidateOKResponse:\n      type: object\n      properties:\n        isValid:\n          description: Consent validation result\n          type: string\n          example: false\n        modifiedPayload:\n          description: Modified payload for in flow\n          type: string\n          example:\n        errorCode:\n          description: Error code to be sent\n          type: string\n          example: Unauthorized\n        errorMessage:\n          description: Error message to be sent\n          type: string\n          example: \"Path requested is invalid\"\n        httpCode:\n          description: HTTP error code\n          type: string\n          example: \"401\"\n        consentInformation:\n          description: Consent information that needs to be passed to the backend\n          type: string\n          example: \"eyJhbGciOiJSUzI1NiJ9.eyJjbGllbnRJZCI6Ilc0UWFNall2OXJuNDlPN2RwZUJRRDVETEdGUWEiLCJjdXJyZW50U3RhdHVzIjoiUmVqZWN0ZWQiLCJjcmVhdGVkVGltZXN0YW1wIjoxNzE5ODA4NTAzLCJyZWN1cnJpbmdJbmRpY2F0b3IiOmZhbHNlLCJhdXRob3JpemF0aW9uUmVzb3VyY2VzIjpbeyJ1cGRhdGVkVGltZSI6MTcxOTgwODUxNywiY29uc2VudElkIjoiYTc4MTViMmQtMGViMS00MWMwLTg5OWQtYzQwYzk3MThkMTUzIiwiYXV0aG9yaXphdGlvbklkIjoiYmNiZjUwOTgtZTkyZS00ODUxLThmYTktMWUyNjc5YTY1MjI3IiwiYXV0aG9yaXphdGlvblR5cGUiOiJhdXRob3Jpc2F0aW9uIiwidXNlcklkIjoiZTYwY2FkMWItYzhmMS00NjczLWJjMWQtZjIyZTY1ZWRlNTc2IiwiYXV0aG9yaXphdGlvblN0YXR1cyI6IlJlamVjdGVkIn1dLCJ1cGRhdGVkVGltZXN0YW1wIjoxNzE5ODA4NTE3LCJjb25zZW50X3R5cGUiOiJhY2NvdW50cyIsInZhbGlkaXR5UGVyaW9kIjowLCJjb25zZW50QXR0cmlidXRlcyI6e30sImNvbnNlbnRJZCI6ImE3ODE1YjJkLTBlYjEtNDFjMC04OTlkLWM0MGM5NzE4ZDE1MyIsImNvbnNlbnRNYXBwaW5nUmVzb3VyY2VzIjpbeyJtYXBwaW5nSWQiOiIwZmJlN2Q1NS02MDQzLTQ2MTctYmNiOS0xNDg3NWI0Y2M0YzciLCJtYXBwaW5nU3RhdHVzIjoiYWN0aXZlIiwiYWNjb3VudF9pZCI6IjEyMzQ1IiwiYXV0aG9yaXphdGlvbklkIjoiYmNiZjUwOTgtZTkyZS00ODUxLThmYTktMWUyNjc5YTY1MjI3IiwicGVybWlzc2lvbiI6InByaW1hcnkifV0sImFkZGl0aW9uYWxDb25zZW50SW5mbyI6e30sInJlY2VpcHQiOnsiUmlzayI6e30sIkRhdGEiOnsiVHJhbnNhY3Rpb25Ub0RhdGVUaW1lIjoiMjAyNC0wNy0wNFQxMDowNTowMS42OTI5OTArMDU6MzAiLCJFeHBpcmF0aW9uRGF0ZVRpbWUiOiIyMDI0LTA3LTA2VDEwOjA1OjAxLjY4NTMzMCswNTozMCIsIlBlcm1pc3Npb25zIjpbIlJlYWRBY2NvdW50c0RldGFpbCIsIlJlYWRCYWxhbmNlcyIsIlJlYWRUcmFuc2FjdGlvbnNEZXRhaWwiXSwiVHJhbnNhY3Rpb25Gcm9tRGF0ZVRpbWUiOiIyMDI0LTA3LTAxVDEwOjA1OjAxLjY5Mjg0MCswNTozMCJ9fSwiY29uc2VudEZyZXF1ZW5jeSI6MH0.OiJOGfou1n86hzS7PBkRUczDxmmIVswqidxFf9-B8wuIaTLDdAxZnDMFYVs3NCYJvnJXg_ht9m3EEhnX1YgM4BPioBRNcygs1Ns8LMQunB2Y4wOtT71sYvFuDveAPPrwsZy-Z8OV9zrM27aTyLyj-mfHckehGpsDq4pNB9jaOpxaFsBEuxpF9GZxY1Bzy1XmYNxSZ5en2itoStYjKbBwQ3jIlzIvy9DcKkPrnTlukx0ik6RrYyVJ04kctiIbzGaOBQ1x71VvJin9ezriIi8lqHjP2BPxm6zV4GepFY8scxUcut9tRJNQNrQObGDMT0Ib843yf4dDaJ2huJpEEDTNFg\"\n    ConsentSearchOKResponse:\n      type: object\n      properties:\n        data:\n          description: Detailed consent objects. Search results\n          type: array\n          items:\n            $ref: \"#/components/schemas/ConsentDetail\"\n        meatadata:\n          $ref: \"#/components/schemas/ConsentSearchMetadata\"\n    ConsentManageOKResponse:\n      type: object\n    ConsentManageCreatedResponse:\n      type: object\n    ConsentAuthorizeRetrievalResponse:\n      type: object\n      properties:\n        consentData:\n          description: Consent data to be shown to the end user\n          type: array\n          items:\n            type: object\n            properties:\n              title:\n                type: string\n                example: \"Permissions\"\n              data:\n                type: array\n                items:\n                  type: string\n                  example: \"ReadAccountsDetail\"\n        application:\n          description: Name of the application requesting access\n          type: string\n          example: \"Test App\"\n        accounts:\n          description: Accounts retrieved from the bank\n          type: array\n          items:\n            type: object\n            properties:\n              account_id:\n                type: string\n                example: \"12345\"\n              display_name:\n                type: string\n                example: \"Salary Saver Account\"\n        type:\n          description: Consent Type\n          type: string\n          example: \"accounts\"\n    ConsentDetail:\n      type: object\n      properties:\n        clientId:\n          description: Client ID associated with the consent\n          type: string\n          example: \"W4QaMjYv9rn49O7dpeBQD5DLGFQa\"\n        currentStatus:\n          description: Current status of the consent\n          type: string\n          example: \"AwaitingAuthorisation\"\n        createdTimestamp:\n          description: Consent created timestamp\n          type: string\n          example: \"1719810512\"\n        recurringIndicator:\n          description: Recurring indicator of the consent\n          type: string\n          example: \"false\"\n        authorizationResources:\n          description: Authorization resources associated with the consent\n          type: array\n          items:\n            $ref: \"#/components/schemas/ConsentAuthorizationResource\"\n        updatedTimestamp:\n          description: Last updated timestamp\n          type: string\n          example: \"1719810602\"\n        validityPeriod:\n          description: Consent validity period\n          type: string\n          example: \"0\"\n        consentAttributes:\n          description: Key value pairs of consent attributes\n          type: object\n        consentId:\n          description: Consent ID\n          type: string\n          example: \"514556fe-57b6-4565-98d1-0b53ff53d62b\"\n        consentMappingResources:\n          description: Account mapping resources associated with the consent\n          type: array\n          items:\n            $ref: \"#/components/schemas/ConsentMappingResource\"\n        consentType:\n          description: Consent type\n          type: string\n          example: \"accounts\"\n        receipt:\n          description: Consent receipt\n          type: object\n        consentFrequency:\n          description: Consent Frequency\n          type: string\n          example: \"0\"\n    ConsentSearchMetadata:\n      type: object\n      properties:\n        total:\n          description: Total number of results available despite pagination\n          type: integer\n        offset:\n          description: Pagination offset of result\n          type: integer\n        count:\n          description: Count sent in current response\n          type: integer\n        limit:\n          description: Limit applied for current result\n          type: integer\n    ConsentAuthorizationResource:\n      type: object\n      properties:\n        updatedTime:\n          description: Authorization updated time\n          type: integer\n          example: 1719809834569\n        consentID:\n          description: Consent ID of the authorization\n          type: string\n          example: \"514556fe-57b6-4565-98d1-0b53ff53d62b\"\n        authorizationID:\n          description: Authorization ID\n          type: string\n          example: \"96e4033b-6063-4bc8-ba5b-00559c1a9b31\"\n        authorizationType:\n          description: Type of authorization\n          type: string\n          example: \"authorisation\"\n        userID:\n          description: User ID\n          type: string\n          example: \"admin@carbon.super\"\n        authorizationStatus:\n          description: Current status of the authorization\n          type: string\n          example: \"created\"\n    ConsentMappingResource:\n      type: object\n      properties:\n        mappingId:\n          description: Mapping ID\n          type: string\n          example: \"ddf5db03-14b2-49f9-a596-0e0cf14e9b03\"\n        mappingStatus:\n          description: Status of the mapping\n          type: string\n          example: \"active\"\n        accountId:\n          description: Accoung ID of the mapping resource\n          type: string\n          example: \"12345\"\n        authorizationID:\n          description: Authorization ID associated with the mapping\n          type: string\n          example: \"96e4033b-6063-4bc8-ba5b-00559c1a9b31\"\n        permission:\n          description: Mapping permission\n          type: string\n          example: \"primary\"\n  securitySchemes:\n    basicAuth:\n      type: http\n      scheme: basic",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0027_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support consent management, including the collection and enforcement of user consent for personal data processing. However, based on the provided code snippets and wiki pages, there is no direct evidence or explicit mention of a \"Global Consent model where TPP submits only PSU identification for global consent authorization\" as described in your query. The existing consent management features focus on managing PII categories, purposes, and consent receipts, primarily during self-registration and authentication flows.\\n\\n### Implementation Details\\n\\nThe consent management functionality is implemented through a set of REST APIs and integrated into various authentication flows. The core consent management APIs are exposed under the `/api/identity/consent-mgt/v1.0/consents` endpoint .\\n\\nThe `ConsentMgtTestCase.java`  demonstrates how to interact with these APIs to:\\n*   Add PII Categories .\\n*   Add Purpose Categories .\\n*   Add Purposes .\\n*   Add Consent Receipts .\\n\\nThe `addReceipt` method in `ConsentMgtTestCase.java`  shows the structure of a consent receipt, which includes `piiPrincipalId` (PSU identification), `service`, `purposes`, and `piiCategory` details. This indicates that consent is typically tied to specific services and purposes, rather than a global, TPP-initiated consent with only PSU identification.\\n\\nThe `SelfSignUpConsentTest.java`  demonstrates how consent is collected during user self-registration, where the user explicitly provides consent for their PII. The `selfRegister` method constructs a request body that includes consent information along with user details .\\n\\n### Configuration Options\\n\\nThe `default-identity.xml`  file contains a `<Consent>` section with an `<EnableSSOConsentManagement>` flag, which can be set to `true` or `false` to enable or disable consent management during SSO.\\n\\nThe `AdvancedApplicationConfiguration.java` model includes a `useExternalConsentPage` boolean property , suggesting that an external consent page can be used. Additionally, the `disable_skipping_consent` function in `configure_is_fapi.py`  indicates that skipping login consent can be disabled, which would force consent flows.\\n\\nThe `default-identity.xml` also defines `UserConsentEnabledGrantTypes` , which specifies grant types (e.g., `authorization_code`, `implicit`) that will filter user claims based on user consent.\\n\\n### API Endpoints or Features\\n\\nThe primary API endpoint for consent management is `/api/identity/consent-mgt/v1.0/consents` . This endpoint is used for managing PII categories, purposes, and consent receipts.\\n\\nSpecific sub-endpoints include:\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes` for managing purposes .\\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories` for managing PII categories .\\n*   `/api/identity/consent-mgt/v1.0/consents/purpose-categories` for managing purpose categories .\\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/{receiptId}` for retrieving specific consent receipts .\\n\\nThe `web.xml`  file confirms the servlet mapping for `IdentityConsentMgtV1ApiServlet` to the `/identity/consent-mgt/v1.0/*` URL pattern.\\n\\nThe `sendPOSTConsentMessage` utility function in `Utils.java`  is used to send consent approval messages, indicating that the system handles user consent decisions during authentication flows.\\n\\n### Documentation References\\n\\nThe \"Advanced Features\" wiki page  provides an overview of Consent Management, describing it as a framework to collect, store, and manage user consent for personal data processing. It outlines key components like PII Categories, Purposes, Purpose Categories, and Consent Receipts, and explains the consent collection process during self-registration and authentication.\\n\\n## Notes\\n\\nWhile the repository extensively supports consent management, the specific \"Global Consent model where TPP submits only PSU identification for global consent authorization\" is not explicitly detailed in the provided context. The existing consent mechanisms appear to be more granular, focusing on user-driven consent for specific data attributes and services. To fully address your requirement, further investigation into how TPPs interact with the consent management system and whether a global consent mechanism with only PSU identification is supported or can be configured would be necessary. The current implementation seems to require more detailed consent information than just PSU identification for authorization.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_220eea10-f083-471c-8aaa-c4a0d1dfdba4\\n', 'id': 'lc_f7e892d6-2837-464d-8f14-83ae8c3b1a43'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0027_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_695a8f4a-2310-4034-8a36-351d41790a18'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0028",
      "requirement": {
        "requirement_id": "ATOM_197",
        "requirement_text": "The scaStatus field SHALL be mandatory in the authorisation response to indicate the current status of the SCA process.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0028_1",
          "text": "## Validate Authorize Request\n\nThe OpenAPI extension for validate client sending authorize API requests to ensure request parameters are according to  the way\nallowed in the Open Banking  specificatio requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0028_2",
          "text": "A pushed authorization request contains authentication and authorization request parameters, which will be used in the Pushed Authorization endpoint of WSO2 Open Banking Accelerator. The Pushed Authorization endpoint returns a `request_uri` with an expiration time as a reference to the details sent in the pushed authorization request. ##Default Pushed Authorization Request validations The Pushed Auth Request Validator uses the existing validation layer of WSO2 Open Banking Accelerator to enforce validations. By default, the following validations are available in the validation layer: - Repeated parameter validation for all parameters: checks the pushed authorization request body for any repeated parameters When the `request` parameter is available: !!! note The `request` parameter value which will be referred to as `request object` from here onwards should be a Signed JWT(JWS) or an Encrypted JWT(JWE). It can be signed and encrypted as well. In this scenario, it must be signed before being encrypted. - Validation of form body parameters - verifies that only client authentication parameters (such as `client_id`, `client_assertion`, `client_assertion_type`) are present in the request form body. Other parameters must be included in the request object. - Validation of client id - validates the `client id` claim of the request object. - Validation of redirect URI - validates the redirect URI to check whether it matches with the registered redirect URIs. - Validation of request object signature algorithm - checks if the correct signing algorithm is used. - Validation of request object signature - verifies the signature of the request object. - Validation of the nonce claim - checks whether the nonce claim is available for response types requesting `id_token`. - Validation of the scope claim - checks whether the scope claim contains scopes that are registered with the client application. - Validation of the audience claim - checks if the audience claim matches the token endpoint URL. - Validation of the issuer claim - checks whether the issuer claim matches the client_id. - Validation of invalid claims in request object - check whether the `request` and `request_uri` claims are present in the request object. ##Writing a Custom Pushed Auth Request Validator You can extend the default validations in WSO2 Open Banking Accelerator and add more validations according to your open banking requirements: - To implement a custom Pushed Auth Request validator, extend the following class: ``` java com.wso2.openbanking.accelerator.identity.push.auth.extension.request.validator.PushAuthRequestValidator ``` Given below is a brief explanation of the methods you need to implement. ###validateAdditionalParams method This method performs the additional validations you add. Given below is the method signature: ``` java public void validateAdditionalParams(Map<String, Object> parameters) throws PushAuthRequestValidatorException ``` Input parameters - `Map<String, Object> parameters` - contains pushed authorization request parameters obtained from the HTTP servlet request Output parameter - `void` !!! note When a valid request object is present as a request parameter, the default implementation of the accelerator decodes the request object JWT and adds the following parameters to the Map<String, Object> parameters map. 1. Key - `\"decodedJWTBody\"`, Value - `<decoded request object JWT body>` 2. Key - `\"decodedJWTHeader\"`, Value - `<decoded request object JWT header>` For example: - Extend the `PushAuthRequestValidator` class and",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0028_3",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0028_4",
          "text": "## Persist\n\nThe second extension point of the Consent Authorize component is the Persist Flow. The Persistent functionality is engaged once the \nuser approves/denies the consent via an API invocation made from the consent page. When the `/persist` endpoint is \ninvoked, the OpenAPI extension implementation to persist are also invoked and the data required for persistence will be provided from the extension point.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0028_5",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to explicitly support a mandatory `scaStatus` field in authorization responses to indicate the current status of the SCA (Strong Customer Authentication) process. The provided codebase context, including the \"OAuth2 and OpenID Connect\" wiki page and various test cases, does not contain any direct references to `scaStatus` or related SCA process fields in authorization responses    .\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nBased on the provided context, there are no implementation details, configuration options, or API endpoints that directly address a mandatory `scaStatus` field in authorization responses    . The codebase primarily focuses on standard OAuth2 and OpenID Connect flows, token management, and conformance testing .\\n\\nThe `OAuth2PushedAuthRequestTestCase.java` file, for instance, demonstrates the creation of an application and sending POST requests, but it does not include any `scaStatus` related parameters or response assertions . Similarly, `configure_is.py` deals with registering and retrieving service provider details, without mention of SCA status .\\n\\nThe `OAuth2RestClient.java` file contains methods for managing authorization details types, but these are generic and do not specifically refer to SCA or `scaStatus` .\\n\\n## Documentation References\\n\\nThe \"OAuth2 and OpenID Connect\" wiki page provides a comprehensive overview of the implementation of these protocols in WSO2 Identity Server . However, it does not mention any `scaStatus` field or the requirement for it to be mandatory in authorization responses . The documentation covers supported grant types, token management, and conformance with standards like OIDC and FAPI, but SCA-specific fields are not detailed .\\n\\n## Notes\\n\\nThe term \"SCA\" (Strong Customer Authentication) is often associated with regulatory requirements like PSD2 in the financial sector. While WSO2 Identity Server supports FAPI conformance , which is relevant to financial-grade APIs, the provided codebase snippets do not explicitly show the implementation or configuration of a mandatory `scaStatus` field in authorization responses. It is possible that SCA-related functionalities are handled at a different layer or through extensions not visible in the provided context.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_142e5100-67b0-49db-ba2e-f8473e069d56\\n', 'id': 'lc_ff99a191-c8ab-4b46-9c6b-82f61bb39fae'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0028_6",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_1d8c0df3-be05-4b7c-bdf5-5c3915dc3cbe'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0029",
      "requirement": {
        "requirement_id": "ATOM_054",
        "requirement_text": "Final payment transaction status shall be either RJCT (Rejected) or ACSC (AcceptedSettlementCompleted) at the end of the payment process",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0029_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_4",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_5",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0029_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports payment transaction statuses, including `Rejected` and `AcceptedSettlementCompleted` . This is defined within the OpenAPI specification for payment initiation and is reflected in the demo backend service for payments .\\n\\n## Implementation Details\\n\\nThe `payment-initiation-openapi.yaml` file defines the `Status` field within the `obWritePaymentResponse5` schema, which enumerates possible payment statuses . These include `AcceptedSettlementCompleted` and `Rejected` .\\n\\nThe `PaymentService.java` in the demo backend demonstrates how a payment response is constructed, explicitly setting the status to `AcceptedSettlementCompleted` . This service is responsible for caching and returning payment responses .\\n\\nThe `ConsentExtensionConstants.java` file also defines `REJECTED_STATUS` as a constant, indicating its use within the consent management extensions .\\n\\n## API Endpoints or Features\\n\\nThe payment initiation API, as defined in `payment-initiation-openapi.yaml`, exposes the `/payments` endpoint for payment execution . The response from this endpoint includes the `Status` field, which will contain either `AcceptedSettlementCompleted` or `Rejected` at the end of the payment process .\\n\\nThe `PaymentService` in the demo backend handles requests to `/payments` and constructs the response with the appropriate status .\\n\\n## Documentation References\\n\\nThe `Overview` wiki page for the `wso2/financial-services-accelerator` repository mentions \"Payment Initiation APIs\" and specifically refers to `payment-initiation-openapi.yaml` as the source for payment API specifications .\\n\\n## Test Criteria\\n\\nIntegration tests within the `fs-integration-test-suite` verify payment consent authorization flows. For example, `AuthorizationFlowValidationTest.groovy` includes a test case to \"Deny consent in consent authorisation\", which asserts that the consent status becomes \"Rejected\" . Another test, `EndToEndPaymentsFlowTest.groovy`, verifies the payment submission and retrieval, implicitly confirming the handling of payment statuses .\\n\\n## Notes\\n\\nThe provided context primarily focuses on the OpenAPI definition and a demo backend implementation. While the OpenAPI specification clearly defines the `AcceptedSettlementCompleted` and `Rejected` statuses, the actual business logic for determining these statuses in a production environment would reside in the bank\\'s backend systems, which are external to this repository . The `PaymentService.java` is a demo implementation and directly sets the status to `AcceptedSettlementCompleted` . The `financial-services-accelerator/accelerators/fs-is/repository/resources/wso2is-7.0.0-deployment.toml` and `financial-services-accelerator/accelerators/fs-is/repository/resources/wso2is-7.1.0-deployment.toml` files contain configuration details for the Identity Server, but do not directly specify payment transaction statuses  . Similarly, `FundsConfirmationService.java` deals with funds confirmation, not the final payment transaction status .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-f_7f9ae66d-a6d9-4b2f-ae8d-447d9abd4fe5\\n', 'id': 'lc_23cc4659-cba0-4fdd-bd24-8c10705421b3'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0030",
      "requirement": {
        "requirement_id": "ATOM_106",
        "requirement_text": "The system SHALL support GET request to retrieve transaction status at endpoint /v1/{payment-service}/{payment-product}/{paymentId}/status",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0030_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0030_2",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0030_3",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts |[account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments |[payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds |[funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/) as an Operational Policy.\n\n    Use aut as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n\n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n\n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0030_4",
          "text": "## Publish Open Banking APIs\n\n!!! note\n    WSO2 Open Banking Accelerator supports Accounts flow, Payments flow and Confirmation of Funds flow. Publish all three APIs before trying out the flows.\n\n1. Sign in to the API Publisher Portal at `https://<APIM_HOSTNAME>:9443/publisher`. \n\n2. In the homepage, go to REST API and select Import Open API. \n    ![select-rest-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-rest-api.png)\n\n3. Select OpenAPI File/Archive. \n    ![upload-swagger.png](../../assets/img/get-started/quick-start-guide/deploy-apis/upload-swagger.png)\n\n4. Click Browse File to Upload and select the required yaml file. \n        \n    | API | Swagger File |\n    | --- | ------------ |\n    | Accounts | [account-info-swagger.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml) | \n    | Payments | [payment-initiation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Payments/payment-initiation-openapi.yaml) | \n    | Confimation of Funds | [funds-confirmation-openapi.yaml](https://github.com/wso2/financial-services-accelerator/blob/4.0.0/financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/ConfirmationOfFunds/funds-confirmation-openapi.yaml) | \n\n5. Click Next.\n\n6. Set the Context value as follows:\n\n    | API | Context Value |\n    | --- | ------------- |\n    | Accounts | `/open-banking/{version}/aisp` | \n    | Payments | `/open-banking/{version}/pisp` | \n    | Confimation of Funds | `/open-banking/{version}/cbpii` | \n\n7. Leave the Endpoint field empty as it is, Select the Gateway Type and click Create.\n    ![configure-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/configure-api.png)\n\n8. Select Subscriptions from the left menu pane and uncheck all subscription plans.\n    ![api-subscription.png](../../assets/img/get-started/quick-start-guide/deploy-apis/api-subscription.png)\n\n9. Click Save.\n\n10. Go to Runtime using the left menu pane. <br/>\n    ![select-runtime.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-runtime.png)\n\n11. Toggle the Schema Validation button to enable Schema Validation for all APIs except for the Dynamic Client Registration API.\n    ![schema-validation.png](../../assets/img/get-started/quick-start-guide/deploy-apis/schema-validation.png)\n\n12. Go to Endpoints using the left menu pane. <br/>\n    ![select-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-endpoints.png)\n\n13. Select the endpoint types; **Dynamic Endpoints** and click Save.  \n    ![dynamic-endpoint.png](../../assets/img/get-started/quick-start-guide/deploy-apis/dynamic-endpoint.png)\n\n14. Add [JWT claim based access validation](https://apim.docs.wso2.com/en/latest/design/api-policies/regular-gateway-policies/jwt-claim-based-access-validator/).\n\n    Use **aut** as the Access verification claim name and value from below.\n\n    | Token Type               | Claim Value      |\n    | ------------------------ | ---------------  |\n    | Client Credentials Grant | APPLICATION      |\n    |Authorization Code Grant  | APPLICATION_USER |\n\n15. Create and engage the required [Inbuilt Gateway Enforcements](../../learn/inbuilt-policies.md)\n    - Refer the [Introduction to Policies](../../learn/policies.md) for more details on Policies.\n    - Refer the [Create Policies](../../learn/create-policies.md) for create new Policies.\n    - Refer the [Engage Policies](../../learn/engage-policies.md) to learn how to engage policies to an API.\n    \n    Refer to the below table and engage the required policies for each API.\n\n    | API | API Level Policies | Operational Level Policies |\n    | --- | ------------------ | -------------------------- |\n    | Accounts | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Payments | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    | Confirmation of Funds | `MTLS Enforcement Policy` | `Consent Enforcement Policy` </br> `Dynamic Endpoint Policy` |\n    \n16. Select the **API Gateway** type, in this scenario, it is **Default**.\n\n17. Click Deploy.\n\n18. Go to Overview using the left menu pane. <br/>\n    ![select-overview.png](../../assets/img/get-started/quick-start-guide/deploy-apis/select-overview.png)\n\n19. click Publish. \n    ![publish-api.png](../../assets/img/get-started/quick-start-guide/deploy-apis/publish-api.png)\n\nOnce you deploy the APIs an API resource will be created along with the role mentioned in the swagger on the Identity Server side.\n\n!!! note\n    If you have created the users, assign the roles created while publishing the APIs to the users.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0030_5",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0030_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator supports GET requests to retrieve payment transaction status. The relevant API endpoint is `/payments/{paymentId}` . This functionality is defined within the `payment-initiation-openapi.yaml` OpenAPI specification  and is implemented in the demo backend by the `PaymentService.java` .\\n\\n## Implementation Details\\n\\nThe system defines a GET endpoint for retrieving payment status:\\n*   **Endpoint**: `/payments/{paymentId}` \\n*   **HTTP Method**: `GET` \\n*   **Parameters**: It requires a `paymentId` as a path parameter . Other parameters include `x-fapi-auth-date`, `x-fapi-customer-ip-address`, `x-fapi-interaction-id`, and `authorization` headers .\\n*   **Responses**: A successful response (HTTP 200) returns an `obWritePaymentResponse5` schema . This schema includes `PaymentId`, `ConsentId`, `CreationDateTime`, `Status`, and `StatusUpdateDateTime` . The `Status` field can have values such as \"AcceptedCreditSettlementCompleted\", \"AcceptedSettlementCompleted\", \"AcceptedSettlementInProcess\", \"AcceptedWithoutPosting\", \"Pending\", or \"Rejected\" . Error responses (400, 401, 403, 405, 406, 429, 500) are also defined .\\n*   **Security**: The endpoint is secured using `TPPOAuth2Security` and `default` security schemes with the `payments` scope .\\n\\nThe `PaymentService.java` in the demo backend provides a concrete implementation for this endpoint . The `getPaymentTypePayment` method retrieves payment information based on the `paymentId` and returns a JSON object containing the payment details . The `cacheAndGetPaymentResponse` method is responsible for constructing the response object, including setting the `PaymentId`, `Status`, `CreationDateTime`, and `StatusUpdateDateTime` .\\n\\n## API Endpoints and Features\\n\\nThe `payment-initiation-openapi.yaml` file defines several payment-related endpoints :\\n*   `/payment-consents`: Used for creating payment consents (POST request) .\\n*   `/payment-consents/{consentId}`: Used for retrieving payment consents (GET request) .\\n*   `/payment-consents/{consentId}/funds-confirmation`: Used for getting funds confirmation for a payment consent (GET request) .\\n*   `/payments`: Used for creating payments (POST request) .\\n*   `/payments/{paymentId}`: Used for retrieving the status of a specific payment (GET request) .\\n\\nThe `fs-integration-test-suite` also includes tests that verify the retrieval of payment status, specifically in `EndToEndPaymentsFlowTest.groovy` . The `doDefaultPaymentIdRetrieval()` method is called to perform the GET request to the `/payments/{paymentId}` endpoint .\\n\\n## Configuration Options\\n\\nThe WSO2 Financial Services Accelerator uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class . While the provided snippets do not directly show configuration options for the `/payments/{paymentId}` endpoint, the overall system configuration supports various aspects like consent management, identity server extensions, and event notifications .\\n\\n## Documentation References\\n\\nThe OpenAPI specification for payment initiation, `payment-initiation-openapi.yaml`, serves as the primary documentation for the `/payments/{paymentId}` endpoint . This file details the request and response structures, parameters, and security requirements.\\n\\n## Notes\\n\\nThe provided snippets confirm that the system supports the requested GET request for transaction status. The `payment-initiation-openapi.yaml` file clearly defines the endpoint and its expected behavior, and the `PaymentService.java` provides a demo implementation. The integration tests further validate this functionality.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c2f70300-0c17-41e8-b386-a055295f5b90\\n', 'id': 'lc_348acf03-2751-41a9-9d46-6fb67ba6ed1c'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0031",
      "requirement": {
        "requirement_id": "ATOM_057",
        "requirement_text": "The system shall support transaction status ACCP (AcceptedCustomerProfile) to indicate positive financial risk profile and PSU funds availability checks",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0031_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0031_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0031_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0031_4",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0031_5",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0031_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports payment initiation with various statuses, including `AcceptedSettlementCompleted` . While the specific status `ACCP` (AcceptedCustomerProfile) is not explicitly defined, the system provides a `Status` field in the payment initiation response that can indicate the outcome of financial risk and funds availability checks . The `FundsConfirmationService` and `PaymentService` within the demo backend demonstrate how funds availability checks are handled and how payment statuses are set  .\\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` repository includes an OpenAPI specification for Payment Initiation, which defines the structure of payment requests and responses . The `obWritePaymentResponse5` schema includes a `Status` field that specifies the status of the payment information group . The possible values for this status include `AcceptedCreditSettlementCompleted`, `AcceptedSettlementCompleted`, `AcceptedSettlementInProcess`, `AcceptedWithoutPosting`, `Pending`, and `Rejected` .\\n\\nThe demo backend\\'s `PaymentService` is responsible for processing payment submissions . In the `cacheAndGetPaymentResponse` method, the `status` is explicitly set to `\"AcceptedSettlementCompleted\"` for successful payments . This method also adds a `PaymentId`, `CreationDateTime`, and `StatusUpdateDateTime` to the response .\\n\\nFor funds availability checks, the `FundsConfirmationService` provides an endpoint `/funds-confirmations` that returns a `FundsAvailable` boolean in its response  . This service is a demo endpoint and sets `FundsAvailable` to `true` by default . Similarly, the `PaymentService` also has a `/payment-consents/{ConsentId}/funds-confirmation` endpoint that returns `FundsAvailable: true`  .\\n\\nThe `DefaultConsentManageValidator` class contains logic to validate payment initiation payloads, including checks for debtor and creditor accounts, local instruments, and instructed amounts . This validation contributes to the overall risk assessment before a payment is accepted.\\n\\n## Configuration Options\\n\\nThe system uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class . This configuration supports consent management with customizable handlers and validation rules . While there isn\\'t a direct configuration option for the `ACCP` status, the `financial-services.xml` file and related components allow for customization of consent processing and validation, which can influence the final payment status .\\n\\nThe `FSKeyManagerImpl` class can extract and update additional properties defined in the configuration, which could potentially be used to influence payment processing logic or status reporting .\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoints for payment initiation and funds confirmation are defined in the OpenAPI specifications:\\n\\n*   **Payment Initiation**: The `/payments` endpoint (POST request) is used to create payments . The response to this endpoint includes the `Status` of the payment .\\n*   **Funds Confirmation**:\\n    *   The `/payment-consents/{consentId}/funds-confirmation` endpoint (GET request) is used to get funds confirmation for a payment consent .\\n    *   The `/funds-confirmations` endpoint (POST request) is used to create a funds confirmation request . The response includes a `FundsAvailable` boolean .\\n\\nThese endpoints, particularly the `/payments` POST endpoint, are where the payment status, including `AcceptedSettlementCompleted`, would be returned after successful customer profile and funds availability checks  .\\n\\n## Documentation References\\n\\nThe \"Overview\" wiki page provides a high-level understanding of the WSO2 Financial Services Accelerator, mentioning its support for payment initiation and confirmation of funds . It also details the API specifications for Payments and Funds Confirmations . The \"Core Components\" wiki page further elaborates on the modular architecture and the responsibilities of components like Consent Management, which are crucial for handling financial risk and customer profile validations .\\n\\n## Notes\\n\\nThe prompt specifically asks for the transaction status `ACCP` (AcceptedCustomerProfile). While this exact status code is not found in the provided OpenAPI specifications or demo backend code, the system does support a `Status` field in the payment response with values like `AcceptedSettlementCompleted` . This `AcceptedSettlementCompleted` status, as implemented in the `PaymentService` demo, implies that the payment has been accepted and settled, which would typically follow successful customer profile and funds availability checks .\\n\\nThe `obWriteFundsConfirmationResponse1` schema in `payment-initiation-openapi.yaml` also includes a `FundsAvailableResult` object with a `FundsAvailable` boolean, which directly addresses the \"PSU funds availability checks\" aspect of the requirement .\\n\\nThe `obRisk1` schema is present in both `obWriteConsent4` and `obWritePayment2`  . This indicates that the system considers risk assessment as part of the payment process, which aligns with the \"positive financial risk profile\" aspect of the requirement. The actual logic for evaluating this risk profile would likely be implemented in the backend services, potentially leveraging the \"External Service Integration Framework\" mentioned in the \"Overview\" wiki page .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_74ebdce8-4fdc-4a22-95a4-4be3409f40ea\\n', 'id': 'lc_b236c64c-ca4a-4a7c-bde5-6bbe1d16fa80'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0032",
      "requirement": {
        "requirement_id": "ATOM_166",
        "requirement_text": "Standing orders MUST include standingOrderDetails with startDate, endDate, executionRule, and frequency",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f30dd2c91d5e",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0032_1",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, appears to support standing orders with `startDate`, `endDate`, `executionRule`, and `frequency` through its payment initiation payloads. The `fs-integration-test-suite` module contains Groovy scripts that define and utilize these fields for domestic standing order payments.  \\n\\n## Implementation Details\\n\\nThe implementation details are primarily found within the test framework, specifically in the `PaymentRequestPayloads.groovy`  and `RequestPayloads.groovy`  files. These files define Groovy methods that construct JSON payloads for payment initiation.\\n\\nThe `initiationPayloadDomesticStandingOrderPayment` method in `PaymentRequestPayloads.groovy`  and `initiationPaymentPayloadWithCustomValues` in `RequestPayloads.groovy`  are responsible for creating the standing order initiation payload. These methods include fields such as `Frequency`, `FirstPaymentDateTime`, and `FinalPaymentDateTime` within the `Initiation` object.  \\n\\nThe `getParameterValue` method  is used to retrieve values for these fields from a `parameterMap` or provide default values. For instance, `FirstPaymentDateTime` and `FinalPaymentDateTime` are populated using `TestUtil.getDateAndTime()`  , and `Frequency` has a default value of \"EvryDay\"  in the `defaultValueMap` .\\n\\n## Configuration Options\\n\\nThe configuration options for standing orders are managed through the `parameterMap` passed to the payload building methods.   This allows for dynamic setting of values like `Frequency`, `FirstPaymentDateTime`, and `FinalPaymentDateTime`.   Default values are defined in `defaultValueMap`  within `PaymentRequestPayloads.groovy`  and `RequestPayloads.groovy` .\\n\\n## API Endpoints or Features\\n\\nThe API endpoint for domestic standing order consents is defined as `/open-banking/v3.1/pisp/domestic-standing-order-consents`  in `ConnectorTestConstants.groovy`.  The submission path for domestic standing orders is `/open-banking/v3.1/pisp/domestic-standing-orders` . These constants indicate that the system supports specific API endpoints for managing standing order consents and submissions.\\n\\n## Documentation References\\n\\nThe provided snippets are primarily from integration test suites, which serve as a form of executable documentation for how these features are expected to behave. The `PaymentRequestPayloads.groovy`  and `RequestPayloads.groovy`  files demonstrate the structure of the JSON payloads for standing orders, including the `Frequency`, `FirstPaymentDateTime`, and `FinalPaymentDateTime` fields.  \\n\\nThe `TestConstants.java` file  also contains a `PAYMENT_SUBMISSION` string that includes `Frequency`, `FirstPaymentDateTime`, and `FinalPaymentDateTime`, further illustrating the expected structure for standing order transactions. \\n\\n## Notes\\n\\nThe provided code snippets are primarily from test frameworks and constant definitions. While they clearly indicate support for standing orders with `Frequency`, `FirstPaymentDateTime` (acting as `startDate`), and `FinalPaymentDateTime` (acting as `endDate`), the specific field `executionRule` is not explicitly present in the provided snippets. It\\'s possible that `executionRule` is implicitly handled by the `Frequency` field or is part of a broader schema not fully visible in these snippets. The test criteria mention `additionalInformationStructured.standingOrderDetails` which is not directly mapped to the `Data.Initiation` structure seen in the payloads, but the fields requested (`startDate`, `endDate`, `executionRule`, `frequency`) are largely covered by `FirstPaymentDateTime`, `FinalPaymentDateTime`, and `Frequency` within the `Initiation` object.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-s_ce943fb2-dbc8-49b0-b171-2bd656746143\\n', 'id': 'lc_b78f2d82-962a-4b0b-b18a-831a730d4e64'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0033",
      "requirement": {
        "requirement_id": "ATOM_062",
        "requirement_text": "The system shall support transaction status PART (PartiallyAccepted) for bulk payments when not all payments are processed successfully despite completed authorizations",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0033_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_2",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_4",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0033_5",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not appear to explicitly support the transaction status `PART` (PartiallyAccepted) for bulk payments. The OpenAPI specification for payment initiation defines several payment statuses, but `PART` is not among them . The `PaymentService` in the demo backend also sets the payment status to \"AcceptedSettlementCompleted\" without any logic for partial acceptance .\\n\\n### Implementation Details\\n\\nThe `financial-services-accelerator` repository provides an OpenAPI specification for payment initiation, which includes a `Status` field within the `obWritePaymentResponse5` schema . The allowed enumeration values for this `Status` field are: \"AcceptedCreditSettlementCompleted\", \"AcceptedSettlementCompleted\", \"AcceptedSettlementInProcess\", \"AcceptedWithoutPosting\", \"Pending\", and \"Rejected\" . The status `PART` (PartiallyAccepted) is not listed as a supported value.\\n\\nThe `PaymentService.java` in the demo backend, which handles payment submissions, explicitly sets the payment status to \"AcceptedSettlementCompleted\" . This service does not contain any logic to determine or set a \"PartiallyAccepted\" status based on individual payments within a bulk transaction .\\n\\n### Configuration Options\\n\\nThere are no explicit configuration options within the provided snippets, such as in `wso2is-7.0.0-deployment.toml`  or `wso2is-7.1.0-deployment.toml` , that would enable or configure a `PART` status for bulk payments. The `financial-services.xml` file, mentioned in the wiki as a central configuration, is not provided, so it\\'s not possible to definitively state if such a configuration exists there .\\n\\n### API Endpoints or Features\\n\\nThe `/payments` POST endpoint is used for creating payments . The response schema for this endpoint, `obWritePaymentResponse5`, only includes the aforementioned payment statuses and does not indicate support for a `PART` status . There are no other API endpoints or features explicitly identified in the provided context that would handle or return a `PART` status for bulk payments.\\n\\n### Documentation References\\n\\nThe provided wiki page \"Overview\" describes the WSO2 Financial Services Accelerator and its components, including API specifications for payment initiation . However, it does not contain any specific documentation references regarding the `PART` status for bulk payments. The OpenAPI specification for payment initiation is the primary documentation for the API features, and it does not include `PART` as a valid payment status .\\n\\n## Notes\\n\\nThe provided codebase snippets primarily focus on single payment initiation and consent management. While the term \"bulk payments\" is used in the prompt, the `payment-initiation-openapi.yaml` and `PaymentService.java` do not explicitly define or handle bulk payment scenarios with partial acceptance logic  . The `DefaultConsentManageValidator.java` validates payment initiation requests but does not include any specific validation for bulk payments or partial acceptance statuses .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d54fff38-bc8b-4174-9e1d-df5bf1654e48\\n', 'id': 'lc_a8d8c857-4f50-44f9-9bf6-d18fdc07e097'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0034",
      "requirement": {
        "requirement_id": "ATOM_198",
        "requirement_text": "The TPP-Redirect-URI header SHALL be mandatory for the Redirect SCA Approach when TPP-Redirect-Preferred equals true.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0034_1",
          "text": "### Step 2: Sign in to the Developer Portal as the TPP\n\n1. Now, sign in to the [Developer portal](https://<APIM_HOST>:9443/devportal) as the TPP.\n\n2. Enter the username and the password you entered when signing up as a TPP.\n\n3. Click Continue. Now, you are on the home page of the Developer Portal.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0034_2",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0034_3",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0034_4",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0034_5",
          "text": "## How WSO2 Open Banking supports App-to-App redirection [ ![](../assets/img/learn/app-to-app-redirection/app-to-app-redirection-sequence-flow.png) ](../assets/img/learn/app-to-app-redirection/app-to-app-redirection-sequence-flow.png) WSO2 Open Banking supports the App-to-App redirection flow as follows: The API consumer mobile application invokes the `authorize` endpoint, similar to a basic browser-based auth-code/hybrid redirect flow. When the bank\u2019s mobile application is installed in the customer\u2019s device with a deep link connected to this authorize request, the request is handled by the bank\u2019s mobile application instead of the browser. !!! note If the bank\u2019s mobile application is not available in the customer\u2019s device, the customer is taken through a typical browser-based flow. Once the mobile application handles the customer authentication and consent, it obtains a callback URI. This is the URL to the API consumer application. Using deep links, the bank application redirects the customer to the API consumer\u2019s mobile application. Here, similar to the initial scenario, the callback URI is deep linked to the API consumer\u2019s mobile application. Using this, the flow continues from the bank\u2019s mobile application to the API consumer\u2019s mobile application again. In the App-to-App redirection method, the flow should be handled in the bank\u2019s mobile application as follows: 1. The bank\u2019s mobile application is opened using the deep link. 2. The application invokes the `/authorize` endpoint to initiate the authorization flow. The response redirect is sent by an authenticator that is customized to the app-based flow. !!! note You need to configure custom authenticators that address the requirements of both browser-based and app-based redirection flows. For more information, see [Adding Custom Authenticators](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-local-authenticator/#writing-a-custom-local-authenticator). If this is not an error page or application callback redirect, the application can gain the authentication of the bank customer. For example, using biometrics. !!! info Based on the user agent of the auth request in the adaptive authentication script, a mobile app-based flow can be detected. This states which authenticators need to be invoked in each scenario. 3. Once the authentication is provided, a `/commonauth` request has to be made. This is processed by the authenticator mentioned above. In a biometric scenario, since the verification happens in the mobile application, this request should guarantee non-repudiation and client identification. Given below is a sample request, modify the payload according to your requirements: ``` cURL curl -X POST \\ https://<IS_HOST>:9446/commonauth \\ -H 'Content-Type: application/x-www-form-urlencoded' \\ -d 'sessionDataKey=value&username=value&password=value' ``` - It is recommended to have a key pair for the mobile application. So that the response can be included with a signed JWT, which helps to identify the client with guaranteed non-repudiation. 4. Successful authentication prompts a redirection response to the consent page that contains `sessionDataKeyConsent`. This value is extracted and will be used in the next step. 5. The `authorize/retrieve` request has to be sent with the `SessionDataKeyConsent`. This is to retrieve the data that is required to display on the consent page. 6. After the user approves/denies the consent and selects the accounts, a `PATCH authorize/persist` request is made to persist the consent information. 7. Finally, if the persistence is successful, to complete the flow the `/authorize` endpoint is invoked. This results in a redirection to the callback URL of the API",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0034_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the concept of a `redirect_uri` in the context of OAuth2 and OpenID Connect flows, which is analogous to the \"TPP-Redirect-URI\" in your query. The `redirect_uri` is a mandatory parameter in several OAuth2 flows, particularly the Authorization Code Grant type.   While the specific terms \"TPP-Redirect-URI\" and \"TPP-Redirect-Preferred\" are not explicitly found in the provided snippets, the functionality of requiring a redirect URI for authorization flows is present.\\n\\n### Implementation Details\\n\\nThe `redirect_uri` is a fundamental parameter in OAuth2 authorization requests. It is used to specify where the user agent should be redirected after the authorization process is complete. \\n\\nIn the `wso2/product-is` repository, the `redirect_uri` is handled in various test cases and client implementations:\\n\\n*   **`OAuth2Constant.java`**: This file defines constants for OAuth2 parameters, including `REDIRECT_URI_NAME` and `OAUTH2_REDIRECT_URI`.  \\n*   **`OAuth2RestClient.java`**: The `getAccessToken` method in `OAuth2RestClient` explicitly takes `redirectUrl` as a parameter and includes it in the token request.   This method is used to obtain an access token using the authorization code grant type. \\n*   **`OAuth2CommonClient.java`**: The `sendAuthorizeGet` method constructs an authorization request and includes the `redirectUri` as a parameter. \\n*   **`OAuthDCRMTestCase.java`**: This test case demonstrates that registering an OAuth application with the `authorization_code` grant type without any `redirect_uris` will result in a `400 Bad Request` error, indicating that redirect URIs are mandatory for this grant type.  It also shows that a valid redirect URI is required for successful application registration. \\n*   **`OAuth2PushedAuthRequestTestCase.java`**: This test case includes scenarios where an invalid `redirect_uri` in a Pushed Authorization Request (PAR) results in a `BAD_REQUEST` error.  It also tests for repeated `redirect_uri` parameters, which also lead to a `BAD_REQUEST`. \\n\\n### Configuration Options\\n\\nThe `redirect_uri` is typically configured during the registration of an OAuth2 client application. The `OAuthDCRMTestCase.java` shows how `REDIRECT_URIS` are provided as a `JSONArray` during the application registration process.  \\n\\n### API Endpoints or Features\\n\\nThe primary API endpoints involved in handling `redirect_uri` are:\\n\\n*   **Authorization Endpoint**: This is where the initial authorization request is sent, including the `redirect_uri`.  The constant `OAuth2Constant.AUTHORIZE_ENDPOINT_URL` is used in test cases related to this. \\n*   **Token Endpoint**: After receiving an authorization code, the client sends a request to the token endpoint to exchange the code for an access token, and this request also includes the `redirect_uri`. \\n\\n### Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" provides a high-level overview of the OAuth2 and OIDC implementation in WSO2 Identity Server.  It mentions the \"Authorization Code Grant\" as the most commonly used flow, which inherently requires a `redirect_uri`. \\n\\n## Notes\\n\\nThe user\\'s query specifically mentions \"TPP-Redirect-URI\" and \"TPP-Redirect-Preferred\". While the codebase extensively uses `redirect_uri` and enforces its presence in relevant flows, there is no explicit mention of \"TPP\" prefixes in the provided snippets. It is possible that \"TPP\" refers to a specific profile or extension of OAuth2/OIDC (e.g., related to Open Banking or PSD2) that builds upon the standard `redirect_uri` functionality. The core requirement of a mandatory redirect URI for a redirect-based SCA approach is supported by the existing OAuth2 implementation.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f3ef0bd2-a0c0-42d2-87df-f805f20b5787\\n', 'id': 'lc_38a39aab-6815-4978-9d02-157d918c1dc2'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0034_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_c2342302-9463-4991-b5df-b3f8e2eac801'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0035",
      "requirement": {
        "requirement_id": "ATOM_141",
        "requirement_text": "The ASPSP shall display general account access information to PSU during SCA for Global Consent model",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0035_1",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_2",
          "text": "### Data\nThe following table explains the data available in `ConsentValidateData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| headers   | JSONObject            | The request headers sent in the request. |\n| body   | JSONObject            | The payload sent in the request. |\n| electedResource   | String            | The path invoked in the request. For example: `/accounts/{AccountId}`|\n| consentId | String                | The consent ID related to the current resource request. This consent ID is bound to the user access token used. |\n| userId | String                | The user ID related to the current resource request. This user ID is retrieved from the user access token. |\n| clientId | String                | The ID of the TPP application related to the current resource request. This client ID is retrieved from the user access token.|\n| comprehensiveConsent  | DetailedConsentResource   | The comprehensive consent object related to the consent that is being validated. This object contains all the details related to the consent. |\n| resourceParams | Map<String, String>                | A map containing the full resource path with query parameters (ex: `aisp/accounts/{AccountId}?queryParam=urlEncodedQueryParamValue`), HTTP method, and context (ex: `/open-banking/v3.1/aisp`) of the request. |\n\nThe following table explains the data available in `ConsentValidationResult`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| isValid | boolean | An attribute to identify whether the consent is in a valid state or not. |\n| modifiedPayload | JSONObject | Optionally used to set a modified error payload to be sent with the consent validation response. If a modified payload is set, it is given priority over creating a generic error response using the message and code information. |\n| consentInformation | JSONObject | Used to set the consent data to the consent validation result. This data will be sent to the bank backend. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_3",
          "text": "### getConsentAmendmentHistoryData method\n\n!!! info\n    This is only available as a WSO2 Update from **WSO2 Open Banking Identity Server Accelerator Level\n    3.0.0.33** onwards. For more information on updating,\n    see [Getting WSO2 Updates](../install-and-setup/setting-up-servers.md#getting-wso2-updates).\n\nThis method retrieves the consent amendment history for a given consent. Given below is the method signature:\n\n``` java\nMap < String, ConsentHistoryResource > getConsentAmendmentHistoryData(\n    String consentID)\nthrows ConsentManagementException\n```\nInput parameter:\n\n- `consentID`: consent ID of the consent. This is a mandatory parameter.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_4",
          "text": "### Viewing consent details\n\n- To view consent details, click the respective `Action` button. \n\n    ![view consent](../assets/img/learn/consent-manager/view-consent.png)\n\n- You can view the details such as the associated API consumer application, consent granted date, consent expiry date, \naccount numbers, and permissions that you have granted.\n\n    ![consent details](../assets/img/learn/consent-manager/consent-details.png)",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_5",
          "text": "#### Add CustomerCareOfficerRole Role\n\nCustomerCareOfficerRole is required for bank users to log into the Consent Manager Portal and search for the consents granted by any user.\n\n1. Go to **Roles** under the **User Management** tab in the left pane.\n\n2. Click on **+ New Role**.<br/> \n![roles](../assets/img/learn/consent-manager/roles.png)\n\n3. Enter following details and click on Next button.\n    - Role Name: CustomerCareOfficerRole\n    - Role audience: Organization<br/> \n![create-cc-role](../assets/img/learn/consent-manager/create-cc-role.png)\n\n4. Select the created **API Resource** under the **Permission Selection** section.\n\n5. Add the **consents:read_all** permission from the API resource separately.<br/> \n![create-role-step2](../assets/img/learn/consent-manager/create-role-step2.png)\n\n6. Click on the **Finish** button.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports displaying general account access information during Strong Customer Authentication (SCA) for a Global Consent model. This is primarily handled through its Consent Management framework, which allows for the configuration and enforcement of user consent for data sharing.\\n\\n## Implementation Details\\nThe WSO2 Identity Server (WSO2 IS) includes a Consent Management framework that enables the collection, storage, and management of user consent for processing personal data . This framework is designed to help comply with privacy regulations like GDPR .\\n\\nThe core components of the Consent Management framework include:\\n*   **PII Categories**: These define types of personal data, such as email or address .\\n*   **Purposes**: These specify the reasons for data collection, such as account management or marketing .\\n*   **Purpose Categories**: These are groupings of related purposes .\\n*   **Consent Receipts**: These are records of user consent decisions .\\n\\nDuring authentication, consent is collected for sharing attributes with applications . The system ensures that only attributes for which consent has been granted are included in tokens or API responses .\\n\\nThe `SelfSignUpConsentTest.java` file demonstrates how purposes are shown during self-registration and how consent requests are constructed . Specifically, the `getConsentReqBody` method constructs a JSON request body for consent, including `purposeId`, `piiCategoryId`, and `username` . This indicates that the system can present general descriptions of data usage (purposes) rather than specific PII details during the consent process.\\n\\n## Configuration Options\\nThe WSO2 Identity Server allows for configuration of consent management.\\n*   **Enabling Consent Management**: The `EnableSSOConsentManagement` property in `default-identity.xml` can be set to `true` to enable consent management during Single Sign-On (SSO) .\\n*   **Skipping User Consent**: The `SkipUserConsent` property within the `<OpenIDConnect>` section of `default-identity.xml` can be set to `false` to ensure that user consent is not skipped . This forces the display of consent information to the user.\\n*   **Disabling Skip Login Consent**: The `oidc-fapi-conformance-tests/configure_is_fapi.py` script includes a function `disable_skipping_consent` that sets `skipLoginConsent` to `false` within the application\\'s advanced configurations . This ensures that the consent flow is triggered. The payload for this configuration is defined in `constants_fapi.py` as `DISABLE_SKIP_CONSENT_BODY_PAYLOAD` .\\n\\n## API Endpoints or Features\\nThe Consent Management APIs are exposed through the `/api/identity/consent-mgt/v1.0/consents` endpoint . This API allows for managing consents, including:\\n*   Retrieving consent receipts .\\n*   Managing purposes .\\n*   Managing PII categories .\\n*   Managing purpose categories .\\n\\nThe `SelfSignUpConsentTest.java` file also shows interaction with a `consentEndpoint` to retrieve consents for a given user .\\n\\n## Documentation References\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management within WSO2 Identity Server, detailing its purpose, key components, collection process, and enforcement mechanisms <cite repo=\"wso2/product-is\" path=\"7.3\" />. It also highlights the integration with OAuth2/OIDC for custom scopes and claims <cite repo=\"wso2/product-is\" path=\"7.3\" />.\\n\\n## Notes\\nThe prompt specifically mentions \"ASPSP\" (Account Servicing Payment Service Provider) and \"PSU\" (Payment Services User), which are terms commonly associated with Open Banking and PSD2 regulations. While the provided codebase and wiki pages discuss general consent management and GDPR compliance, they do not explicitly use these Open Banking specific terms. However, the underlying consent management framework in WSO2 Identity Server is designed to be flexible enough to support such requirements by defining appropriate PII categories and purposes. The ability to display general access descriptions rather than specific details during global consent authentication is supported through the configuration of purposes and PII categories, and by ensuring that `SkipUserConsent` is disabled.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_696a7e42-2e97-426d-9bba-53116e0e7657\\n', 'id': 'lc_aa7471a5-c6a1-4c8a-86be-3fc6bcacd5c5'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0035_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_07be3458-7188-4f74-9253-3661f6372cbf'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0036",
      "requirement": {
        "requirement_id": "ATOM_126",
        "requirement_text": "The ASPSP shall support Account Information Service consent with specified type of service to grant access to",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0036_1",
          "text": "#### Add CustomerCareOfficerRole Role\n\nCustomerCareOfficerRole is required for bank users to log into the Consent Manager Portal and search for the consents granted by any user.\n\n1. Go to **Roles** under the **User Management** tab in the left pane.\n\n2. Click on **+ New Role**.<br/> \n![roles](../assets/img/learn/consent-manager/roles.png)\n\n3. Enter following details and click on Next button.\n    - Role Name: CustomerCareOfficerRole\n    - Role audience: Organization<br/> \n![create-cc-role](../assets/img/learn/consent-manager/create-cc-role.png)\n\n4. Select the created **API Resource** under the **Permission Selection** section.\n\n5. Add the **consents:read_all** permission from the API resource separately.<br/> \n![create-role-step2](../assets/img/learn/consent-manager/create-role-step2.png)\n\n6. Click on the **Finish** button.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_2",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_3",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_4",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_5",
          "text": "#### Add ConsentPortalRole Role\n\nConsentPortalRole is required for users to log into the Consent Manager Portal and search for the consents granted by them.\n\nSimilarly create another role named as **ConsentPortalRole** and assign **consents:read_self** scope to the role.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports Account Information Service (AIS) consent with specified service types, which is a crucial aspect for an Account Servicing Payment Service Provider (ASPSP)  . The implementation details involve a Consent Management framework that allows for the definition of PII Categories, Purposes, and Consent Receipts . Configuration options are available through the `default-identity.xml` file, which enables consent management during SSO and defines user consent enabled grant types  . The system exposes REST API endpoints for managing consents, purposes, and PII categories .\\n\\n## Implementation Details\\n\\nThe core of the consent management functionality is provided by the `org.wso2.carbon.consent.mgt` and `org.wso2.carbon.identity.consent.mgt` features . These features are integrated into the WSO2 Identity Server\\'s architecture, which includes a dedicated API layer for user and server APIs .\\n\\nThe `ConsentMgtTestCase.java` demonstrates how PII Categories, Purpose Categories, Purposes, and Consent Receipts are added and managed programmatically . For instance, the `testAddPIICategory()` method adds a PII category with a specified name and description . Similarly, `testAddPurposeCategory()` and `testAddPurpose()` handle the creation of purpose categories and purposes, respectively . The `testAddReceipt()` method illustrates the creation of a consent receipt, which includes details like `piiPrincipalId`, `service`, `consentType`, and `policyURL` .\\n\\nThe `SelfSignUpConsentTest.java` further illustrates consent collection during self-registration, where a `consent` property is included in the self-registration request body . The `getConsentReqBody()` method constructs the JSON payload for consent, specifying `purposeId`, `piiCategoryId`, `consentType`, and other relevant details .\\n\\n## Configuration Options\\n\\nConsent management can be configured through the `default-identity.xml` file .\\n\\n*   **`EnableSSOConsentManagement`**: This setting, found under the `<Consent>` tag, can be set to `true` to enable consent management during Single Sign-On (SSO) .\\n*   **`UserConsentEnabledGrantTypes`**: This section defines the OAuth 2.0 grant types for which user claims will be filtered based on user consent in responses like `id_token` or user info . By default, `authorization_code` and `implicit` grant types are configured .\\n\\n## API Endpoints and Features\\n\\nThe system provides REST API endpoints for managing consent-related entities . These endpoints are secured and require specific permissions for access .\\n\\n*   **`/api/identity/consent-mgt/v1.0/consents`**: This endpoint is used for managing consents and consent receipts . The `ConsentMgtTestCase` uses `CONSENT_ENDPOINT_SUFFIX` which resolves to this endpoint .\\n*   **`/api/identity/consent-mgt/v1.0/consents/purposes`**: This endpoint allows for POST (add) and GET (retrieve) operations on purposes . DELETE operations are also supported .\\n*   **`/api/identity/consent-mgt/v1.0/consents/pii-categories`**: This endpoint supports POST (add) and GET (retrieve) operations for PII categories . DELETE operations are available as well .\\n*   **`/api/identity/consent-mgt/v1.0/consents/purpose-categories`**: This endpoint enables POST (add) and GET (retrieve) operations for purpose categories . DELETE operations are also supported .\\n\\nThe `OAuth2ServiceAbstractIntegrationTest` class contains methods like `sendApprovalPostWithConsent()` which are used to send approval post requests with consent information, including session data keys and consent claims . This indicates that consent is integrated into the OAuth2 authorization flow.\\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management within WSO2 Identity Server . It describes the Consent Framework, including Purpose Management, PII Category Management, and Consent Receipts . The wiki also details the Consent Collection Process during self-registration and authentication, and Consent Enforcement during token issuance and API responses .\\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests, which demonstrate the functionality and configuration of consent management. While these tests confirm the existence and behavior of the features, they do not constitute end-user documentation. The term \"ASPSP\" (Account Servicing Payment Service Provider) is not explicitly found in the provided code or wiki pages, but the consent management features described are directly applicable to the requirements of an ASPSP for handling AIS consent. The \"type of service\" mentioned in the prompt can be mapped to the \"Purposes\" and \"Purpose Categories\" within the consent management framework .\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_370eb60c-c006-4d16-af2c-8e95c1a87795\\n', 'id': 'lc_41c974da-ae85-4abd-9841-540dba5be1a3'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0036_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_80d39b9a-3a05-4442-80ef-8b447fdea5ee'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0037",
      "requirement": {
        "requirement_id": "ATOM_095",
        "requirement_text": "ASPSPs MUST validate eIDAS certificate request syntax for payment initiation requests",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0037_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to have some capabilities related to certificate validation and authorization details that could be relevant to validating eIDAS certificate request syntax for payment initiation requests. However, based on the provided snippets, there is no direct, explicit support for \"eIDAS certificate request syntax validation\" or \"ASPSPs\" (Account Servicing Payment Service Providers) in the context of payment initiation.  \\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository includes a dependency for `org.wso2.carbon.identity.api.server.certificate.validation.management.v1`  and `org.wso2.carbon.identity.api.server.certificate.validation.management.common` . This suggests that there is an API for managing certificate validation. The exact implementation details for eIDAS-specific validation are not visible in the provided snippets.\\n\\nAdditionally, the `oidc-fapi-conformance-tests/resource-server/resource-server.py` file contains logic for computing SHA256 thumbprints from client certificates and comparing them with thumbprints from access tokens  . This is part of FAPI (Financial-grade API) conformance tests, which often involve strong authentication and certificate-based security. While this demonstrates certificate handling and validation, it\\'s within a test context and not directly tied to eIDAS.\\n\\nThe `AdvancedApplicationConfiguration.java` model includes a `certificate` property . This indicates that applications can be configured with certificates, which might be used for various security purposes, including potentially for eIDAS-related validations if integrated.\\n\\n### Configuration Options\\n\\nThe `oidc-metadata.json` file, which provides metadata for OAuth2/OIDC configurations, lists \"certificate\" as an option for `accessTokenBindingType` . This implies that access tokens can be bound to client certificates, which is a mechanism that could be leveraged for strong authentication and potentially for eIDAS certificate validation.\\n\\n### API Endpoints or Features\\n\\nThe `AuthorizationDetailsType.java` file defines a model for authorization details, including a `type` field that can be set to \"payment_initiation\" . This suggests that the system is designed to handle authorization requests specifically for payment initiation. The `schema` property within `AuthorizationDetailsType` can define the structure of these authorization details, including properties like `type`, `actions`, `locations`, and `instructedAmount` . This schema could potentially be extended to include eIDAS certificate syntax requirements.\\n\\nThe `OAuth2RichAuthorizationRequestsGrantTypesTestCase.java` test case demonstrates an authorization code grant flow with \"authorization details\" . This test validates the processing of authorization requests that include these details, which aligns with the concept of payment initiation requests.\\n\\n### Documentation References\\n\\nThe provided context does not include specific documentation references for eIDAS certificate validation. The wiki page \"API Layer\"  and \"Application Management\"  provide general information about the API structure and application configuration, but do not delve into eIDAS specifics.\\n\\n## Notes\\n\\nThe term \"eIDAS\" is not explicitly mentioned in the provided code snippets or wiki pages. While there are mechanisms for certificate validation and handling authorization details for payment initiation, direct support for eIDAS certificate request syntax validation would require further investigation into the `org.wso2.carbon.identity.api.server.certificate.validation.management` module and how it can be extended or configured for eIDAS-specific requirements. The FAPI conformance tests indicate a strong focus on secure, certificate-based authentication, which is a prerequisite for eIDAS compliance, but not a direct implementation of it.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_ab8989dc-e7b4-4e95-ba13-96279885c413\\n', 'id': 'lc_bcc46d7c-4764-47b2-9b28-aa43fd821705'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0037_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support certificate validation, including mutual SSL, which could be relevant to validating eIDAS certificates. However, there is no explicit mention of \"eIDAS\" or \"payment initiation requests\" in the provided code snippets. The validation mechanisms primarily focus on general certificate handling and schema validation.\\n\\n### Implementation Details\\nThe codebase includes functionality for uploading, retrieving, and updating client and endpoint certificates. For instance, the `APISecurityMutualSSLCertificateChainValidationTestCase.java` file demonstrates how root and intermediate certificates are uploaded and associated with APIs for mutual SSL validation  . This suggests that the system can be configured to use specific certificates for secure communication.\\n\\nAdditionally, there\\'s a `Validate Mediator` described in the documentation, which is used for schema validation of messages . This mediator can validate a portion of a message against a specified schema and execute a sequence of actions if validation fails . While this is for message schema validation rather than certificate syntax, it indicates a general capability for enforcing structural correctness.\\n\\n### Configuration Options\\nFor certificate management, the system allows uploading certificates with an alias and associating them with APIs . The `ClientCertificatesApi.java` and `EndpointCertificatesApi.java` files define API calls for managing these certificates, including retrieving, updating, and downloading them    .\\n\\nFor message validation, the `Validate Mediator` can be configured with a schema key and an `on-fail` sequence to handle validation failures .\\n\\n### API Endpoints or Features\\nThe `ClientCertificatesApi` and `EndpointCertificatesApi` classes provide several API endpoints for certificate management:\\n*   `getAPIClientCertificateByAlias(String alias, String apiId)`: Retrieves information about a client certificate .\\n*   `getAPIClientCertificateByKeyTypeAndAlias(String keyType, String alias, String apiId)`: Retrieves information about a client certificate of a given key type .\\n*   `getAPIClientCertificateContentByAlias(String apiId, String alias)`: Downloads a client certificate .\\n*   `updateAPIClientCertificateByAlias(String alias, String apiId, File certificate, String tier)`: Updates an uploaded client certificate .\\n*   `updateAPIClientCertificateByKeyTypeAndAlias(String keyType, String alias, String apiId, File certificate, String tier)`: Updates an uploaded client certificate of a given key type .\\n*   `getEndpointCertificateByAlias(String alias)`: Retrieves information about an endpoint certificate .\\n*   `updateEndpointCertificateByAlias(String alias, File certificate)`: Updates an uploaded endpoint certificate .\\n\\nThe `APISecurityMutualSSLCertificateChainValidationTestCase` also shows that APIs can be configured with `mutualssl` and `mutualssl_mandatory` security schemes . This implies that the system can enforce mutual SSL for API invocations.\\n\\n### Documentation References\\nThe `Validate Mediator` is documented in `all-in-one-apim/docs/xdoc/mediators/validate.xml` . This documentation explains its syntax, UI configuration, and provides an example of its usage for schema validation   .\\n\\n## Notes\\nWhile the codebase demonstrates strong capabilities for mutual SSL and general message schema validation, there is no direct evidence within the provided snippets that explicitly addresses \"eIDAS certificate request syntax\" or \"payment initiation requests.\" The existing certificate validation mechanisms are generic and would need to be specifically configured or extended to meet eIDAS requirements for payment initiation. The `Validate Mediator` could potentially be used to validate the syntax of payment initiation requests if a corresponding schema is provided, but it does not inherently perform eIDAS certificate syntax validation.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_2583eeef-8593-4e16-be21-5d7d31d01acc\\n', 'id': 'lc_d16c77de-a2a0-4f5c-b7d2-bdb6c712c317'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0038",
      "requirement": {
        "requirement_id": "ATOM_230",
        "requirement_text": "TPP message category SHALL only permit \"ERROR\" or \"WARNING\" values",
        "strength": "SHALL",
        "capability": "Error Handling",
        "section_id": "14.2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0038_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase context, there is no direct support or explicit configuration for a \"TPP message category\" that is restricted to \"ERROR\" or \"WARNING\" values. The term \"TPP\" and \"message category\" in this specific context do not appear in the provided code snippets.\\n\\nThe codebase does contain references to error handling and logging levels, which use terms like \"ERROR\" and \"WARN\" (or \"WARNING\"). However, these are related to internal system logging and API error responses, not a \"TPP message category\" as described in your query.\\n\\nSpecifically, the `log4j2.properties` file configures logging levels for various components, where `ERROR` and `WARN` are standard logging levels . Similarly, API error responses, as seen in `RESTTestBase.java`, include an `errorCode` and `message`, but there\\'s no \"category\" field that is explicitly constrained to \"ERROR\" or \"WARNING\" values .\\n\\nTherefore, based on the provided context, I cannot confirm support for a \"TPP message category\" with the specified constraints.\\n\\n## Notes\\nThe provided snippets primarily focus on API layer architecture, testing of REST APIs, and logging configurations. While error handling and logging levels are present, they do not directly address a \"TPP message category\" as a distinct feature or configuration option. The `get-user-store_by_type_id_response.json` file shows a \"category\" attribute within a property definition, but its values are \"user\" and not \"ERROR\" or \"WARNING\" .\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_7354b2e1-6a47-4a59-909b-add2544f68a2\\n', 'id': 'lc_ac188952-fd36-4be1-99b7-08691eb845db'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0038_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports logging with various categories, including \"ERROR\" and \"WARN\"    . However, the documentation indicates that the \"Log Category\" can also be set to \"TRACE\", \"DEBUG\", \"INFO\", and \"FATAL\"    . Therefore, the system does not strictly enforce that a TPP message category SHALL only permit \"ERROR\" or \"WARNING\" values.\\n\\n### Implementation Details and Configuration Options\\n\\nThe logging functionality is primarily handled by the `Log mediator` . This mediator allows you to configure the log level and category .\\n\\nThe available log categories are:\\n*   `TRACE` \\n*   `DEBUG` \\n*   `INFO` \\n*   `WARN` \\n*   `ERROR` \\n*   `FATAL` \\n\\nThe `Log mediator` can be configured using XML syntax, where the `level` attribute can be set . Although the documentation refers to \"Log Category\" and \"Log Level\" separately, the provided syntax for the `log` mediator only shows a `level` attribute . It is possible that \"Log Category\" refers to the same concept as \"Log Level\" in this context, or that the `level` attribute implicitly controls the category.\\n\\nThe `simple-spectral-ruleset.yaml` file  shows an example of defining rules with `severity` set to `error` or `warn`    . This suggests that \"error\" and \"warn\" are recognized severity levels within the system for certain rules, but it does not restrict the general \"TPP message category\" to only these two values.\\n\\n### API Endpoints or Features\\n\\nThe `openapi.yaml` file  defines API endpoints for governance policies. These endpoints return `Error` schemas for various HTTP error codes (e.g., 400, 401, 403, 500) . While this indicates the system handles and reports errors, it doesn\\'t directly relate to a \"TPP message category\" or restrict its values.\\n\\n### Documentation References\\n\\nThe documentation for the `Log mediator` explicitly lists the available \"Log Category\" values :\\n*   `TRACE`\\n*   `DEBUG`\\n*   `INFO`\\n*   `WARN`\\n*   `ERROR`\\n*   `FATAL`\\n\\nThis documentation is consistent across multiple modules, including `all-in-one-apim` , `gateway` , `api-control-plane` , and `traffic-manager` .\\n\\nAdditionally, the `configuration_language.xml` and `properties_guide.xml` files mention `ERROR_CODE`, `ERROR_MESSAGE`, `ERROR_DETAIL`, and `ERROR_EXCEPTION` as well-defined properties that can be set on the Synapse message context scope during a fault  . These properties are used to capture error-related information, but they do not define a \"TPP message category\" with restricted values.\\n\\n## Notes\\n\\nThe term \"TPP message category\" is not explicitly found in the provided codebase snippets. The closest related concept is \"Log Category\" within the `Log mediator` documentation. Based on the available documentation, the \"Log Category\" supports more values than just \"ERROR\" or \"WARNING\". The `simple-spectral-ruleset.yaml` file shows \"error\" and \"warn\" as severity levels for specific rules, but this is a different context than a general \"TPP message category\".\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4e210497-d169-40aa-8f14-54ff33841241\\n', 'id': 'lc_80e05e12-9bf3-4142-acf6-ae754218479a'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0039",
      "requirement": {
        "requirement_id": "ATOM_199",
        "requirement_text": "The _links field SHALL be mandatory and contain hyperlinks for the transaction flow including scaStatus link.",
        "strength": "SHALL",
        "capability": "General",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0039_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the inclusion of a `_links` field containing hyperlinks within API responses, particularly for pagination and navigation within the Organization Management and Client Native Authentication flows.   However, there is no explicit mention or implementation of an `scaStatus` link within the provided context. <cite />\\n\\n## Implementation Details\\n\\nThe `_links` field is implemented as a list of maps, where each map represents a link with a `rel` (relation) and `href` (hyperlink reference) attribute. \\n\\n### Pagination Links\\nIn the Organization Management API, the `_links` field is used for pagination, providing `next` and `previous` links to navigate through collections of organizations.  The `getLink` method extracts the `href` for a given `rel` from the list of links.  For example, in `OrganizationManagementSuccessTest.java`, the `testGetPaginatedOrganizations` method retrieves `next` and `previous` links from the response to validate pagination.  \\n\\n### Client Native Authentication Links\\nIn Client Native Authentication flows, the `_links` field is present in the JSON response and contains a hyperlink (`href`) for the next step in the authentication process.  The `validInitClientNativeAuthnResponse` method in various test cases asserts the presence of the `_links` field and extracts the `href`.  \\n\\n## Configuration Options\\n\\nThe provided context does not explicitly detail configuration options for the `_links` field itself. However, the presence and content of these links are dynamically generated based on the API\\'s functionality, such as pagination parameters (`limit`, `offset`, `after`, `before`) for organization listings.  \\n\\n## API Endpoints or Features\\n\\nThe `_links` field is a feature of the API responses, not an endpoint itself. It is returned by endpoints that support pagination or multi-step flows.\\n\\n*   **Organization Management API**: Endpoints like `/api/server/v1/organizations` return `_links` for pagination. \\n*   **Client Native Authentication API**: The initial response for authentication flows includes `_links` to guide the client to the next authentication step. \\n\\n## Documentation References\\n\\nThe wiki page \"API Layer\" mentions that APIs supporting collections of resources include pagination links in the response.  This aligns with the observed usage of the `_links` field for pagination in the `OrganizationManagementSuccessTest.java`. \\n\\n## Test Criteria Verification\\n\\nThe provided test criteria states: \"Verify that _links field contains required hyperlinks including scaStatus for authorisation flow\". <cite />\\n\\n*   **Presence of `_links` field**: The test cases confirm the mandatory presence of the `_links` field in relevant API responses.  \\n*   **Required hyperlinks**: For pagination, `next` and `previous` links are validated.  For authentication flows, a general `href` for the next step is validated. \\n*   **`scaStatus` link**: The provided codebase context does **not** contain any explicit references to an `scaStatus` link within the `_links` field for authorization flows or any other purpose. <cite /> Therefore, based on the provided information, this specific requirement for an `scaStatus` link cannot be confirmed as supported. <cite />\\n\\n## Notes\\n\\nThe `_links` field is consistently used for navigation and flow control in various APIs within `wso2/product-is`.   However, the specific `scaStatus` link mentioned in the prompt is not found in the provided code snippets or wiki pages. <cite /> It is possible that `scaStatus` is part of a different API or a more specific implementation not covered by the given context. <cite />\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2487ee1d-94c4-4fa0-ad18-898b76d551c8\\n', 'id': 'lc_1ba38f32-0da2-427f-b25a-0c285dad0cbe'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0039_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to have mechanisms for handling and processing various types of links, but there is no direct evidence within the provided snippets to confirm explicit support for a mandatory `_links` field containing an `scaStatus` link for transaction flows or authorization flows.    \\n\\n## Implementation Details\\n\\nThe codebase includes several \"handler\" classes configured in `registry.xml` files across different modules, which are responsible for processing various types of links and media types.    \\n\\n*   **`SmartLifecycleLinkHandler`**: This handler processes links related to lifecycles, with states such as \"Created\", \"Tested\", and \"Deployed\".  It is configured to match the media type `application/vnd.wso2-smart-link`.  This handler is present in `all-in-one-apim/modules/distribution/product/src/main/conf/registry.xml` (committed by rswijesena on 2015-01-26, commit [6897f0f3](https://github.com/wso2/product-apim/commit/6897f0f3)),  `api-control-plane/modules/distribution/product/src/main/conf/registry.xml` (committed by Tharika Madurapperuma on 2025-02-08, commit [cf0398ec](https://github.com/wso2/product-apim/commit/cf0398ec)),  `api-control-plane/modules/distribution/product/src/main/resources/conf/templates/repository/conf/registry.xml.j2` (committed by Tharika Madurapperuma on 2025-02-08, commit [cf0398ec](https://github.com/wso2/product-apim/commit/cf0398ec)),  and `gateway/modules/distribution/product/src/main/conf/registry.xml` (committed by Tharika Madurapperuma on 2025-02-08, commit [cf0398ec](https://github.com/wso2/product-apim/commit/cf0398ec)). \\n*   **`ExternalLinkHandler`**: This handler is designed to process external links to resources.  It matches the media type `application/vnd.wso2-hyperlink`.  This handler is also present in the same `registry.xml` files as `SmartLifecycleLinkHandler`.    \\n*   **`ServiceMediaTypeHandler`**: This handler, found in `gateway/modules/distribution/product/src/main/resources/conf/templates/repository/conf/registry.xml.j2`, processes services added to the registry and has a property `smartLifecycleLinks` which takes keys like \"dev\", \"qa\", and \"live\".  This handler is committed by Tharika Madurapperuma on 2025-02-08, commit [cf0398ec](https://github.com/wso2/product-apim/commit/cf0398ec). \\n\\nThe `registry.xml` files define how different media types are handled within the WSO2 Carbon Registry, which is a component for storing and managing configuration and governance artifacts.    \\n\\n## Configuration Options\\n\\nThe `registry.xml` files show configuration for various handlers that process links.   These configurations specify the handler class and the media types they are designed to process.  For example, `SmartLifecycleLinkHandler` is configured with specific lifecycle states. \\n\\nThere is no explicit configuration for a mandatory `_links` field or an `scaStatus` link within the provided `registry.xml` snippets. <cite/> The existing link handling appears to be for internal registry lifecycle management and external hyperlinks, not specifically for transaction or authorization flow status.  \\n\\n## API Endpoints or Features\\n\\nThe provided code snippets do not directly expose API endpoints related to a mandatory `_links` field with `scaStatus`. <cite/> The `registry.xml` files configure internal handlers for the WSO2 Carbon Registry, which might be used by APIs, but the API definitions themselves are not present here. \\n\\n## Documentation References\\n\\nNo direct documentation references for a mandatory `_links` field with `scaStatus` are available in the provided snippets. <cite/> The comments in the `registry.xml` files describe the purpose of each handler, such as \"This handler processes the links for the lifecycle\"  and \"This handler processes making an external link to a given resource\" .\\n\\n## Notes\\n\\nThe prompt specifically asks about a mandatory `_links` field including an `scaStatus` link for transaction and authorization flows. While the codebase shows a general capability to handle various types of links through `SmartLifecycleLinkHandler` and `ExternalLinkHandler`, there is no explicit mention or configuration for `_links` as a mandatory field or for an `scaStatus` link.   The `registry.xml` files primarily deal with internal registry mechanisms for managing resources and their lifecycles.  The `claim-config.xml` and `tenant-axis2.xml` files are not relevant to the `_links` field or `scaStatus` as they deal with user claims and Axis2 message processing respectively.  \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_697c38ed-1d90-4122-b1a2-453a893fe4c1\\n', 'id': 'lc_4fdade56-b764-483f-8978-87076fc80f51'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0040",
      "requirement": {
        "requirement_id": "ATOM_058",
        "requirement_text": "The system shall support transaction status ACFC (AcceptedFundsChecked) to indicate positive customer profile and funds availability verification",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0040_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0040_2",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0040_3",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0040_4",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0040_5",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0040_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support the transaction status `ACFC` (AcceptedFundsChecked) as defined in your query. The `payment-initiation-openapi.yaml`  defines a set of payment statuses, but `ACFC` is not among them. However, the system does include functionality for funds availability checks, which is a component of the `ACFC` requirement.\\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` provides an API for checking funds availability. The `PaymentService` in the `demo.backend` module includes a `/payment-consents/{ConsentId}/funds-confirmation` endpoint . This endpoint, when called, returns a `FundsAvailable` status, which is a boolean indicating whether funds are available . This is a demo endpoint and not intended for production use .\\n\\nThe `FundsConfirmationService` also provides a `/funds-confirmations` endpoint that returns a `FundsAvailable` boolean in its response . This service is also part of the demo backend .\\n\\nThe OpenAPI specification for Payments defines a `Status` field within the `obWritePaymentResponse5` schema, which enumerates possible payment statuses such as `AcceptedCreditSettlementCompleted`, `AcceptedSettlementCompleted`, `AcceptedSettlementInProcess`, `AcceptedWithoutPosting`, `Pending`, and `Rejected` . The `ACFC` status is not present in this enumeration.\\n\\n## API Endpoints and Features\\n\\nThe relevant API endpoints for funds confirmation are:\\n*   `GET /payment-consents/{consentId}/funds-confirmation`: This endpoint is defined in the `payment-initiation-openapi.yaml`  and is handled by the `getPaymentTypeFundsConfirmation` method in `PaymentService` . It returns a `FundsAvailable` boolean.\\n*   `POST /funds-confirmations`: This endpoint is defined in `funds-confirmation-openapi.yaml`  and is handled by the `getAccountBalance` method in `FundsConfirmationService` . It also returns a `FundsAvailable` boolean.\\n\\nThe `obWriteFundsConfirmationResponse1` schema, used for responses from funds confirmation requests, includes a `FundsAvailable` boolean field to indicate the result of a funds availability check .\\n\\n## Configuration Options\\n\\nThe system uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class . While the provided context does not explicitly show configuration options for defining custom payment statuses like `ACFC`, the `FinancialServicesConfigParser` handles various configuration sections including `Consent` and `Identity` . It is possible that custom extensions could be developed to introduce and manage such a status, leveraging the existing extension framework .\\n\\n## Documentation References\\n\\nThe OpenAPI specifications for payment initiation and funds confirmation provide details on the expected request and response structures, including the `FundsAvailable` field  and the enumerated payment `Status` values . The `Overview` wiki page also mentions the API specifications for Payment Initiation APIs and Confirmation of Funds APIs .\\n\\n## Notes\\n\\nThe current codebase does not define `ACFC` as a payment status. The existing payment statuses are enumerated in `payment-initiation-openapi.yaml` . While the system supports checking for funds availability, the integration of this check with a specific `ACFC` status for payment initiation would require custom development or an extension to the existing payment status definitions. The `PaymentService` and `FundsConfirmationService` are part of a demo backend  , suggesting that their direct use in a production environment might not be suitable without further customization.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ae704849-f302-48bb-9e97-0551373aacd6\\n', 'id': 'lc_6f62c4a1-2657-41dd-8a18-f8a997cb82e7'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0041",
      "requirement": {
        "requirement_id": "ATOM_110",
        "requirement_text": "The Authorization header SHALL be included only if OAuth2 based authentication was performed in a pre-step or OAuth2 based SCA was performed in current PIS transaction or preceding AIS service in same session",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0041_1",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0041_2",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n```\ncurl --location --request POST 'https://localhost:8243/open-banking/v3.1/aisp/account-access-consents' \\\n--header 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n--header 'x-fapi-financial-id: open-bank' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n    \"Data\": {\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\"\n    },\n    \"Risk\": {\n        \n    }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"StatusUpdateDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\",\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"a34c8608-dbd2-4997-aad7-398a5b31cbe6\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0041_3",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0041_4",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0041_5",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0041_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, supports the inclusion of the `Authorization` header in API requests when OAuth2-based authentication is performed. The presence of this header is directly tied to the OAuth2 flow, specifically when obtaining and using access tokens. The system\\'s integration tests demonstrate this behavior, ensuring that the `Authorization` header, typically in the format `Bearer <access_token>` or `Basic <base64_encoded_client_credentials>`, is used for authenticated requests.\\n\\n## Implementation Details\\n\\nThe `Authorization` header is primarily used in requests to OAuth2 endpoints such as the token endpoint and user info endpoint, as well as for accessing protected resources.\\n\\n### OAuth2 Token Requests\\nWhen requesting an access token using grant types like Authorization Code or Client Credentials, the `Authorization` header is constructed with `Basic` authentication, encoding the client ID and client secret. For example, in the `testInvalidAuthzCode()` method within `OAuth2ServiceAuthCodeGrantTestCase.java`, an `HttpPost` request to the `ACCESS_TOKEN_ENDPOINT` explicitly sets the `Authorization` header using `OAuth2Constant.BASIC_HEADER` and Base64 encoded client credentials . Similarly, `OAuth2RoleClaimTestCase.java` demonstrates this for the Resource Owner Password Credentials grant type .\\n\\n### UserInfo Endpoint Requests\\nAfter obtaining an access token, requests to the UserInfo endpoint include the `Authorization` header with a `Bearer` token. The `sendRequestToUserInfoEndpoint()` method in `OAuth2ServiceWithConsentedTokenColumnAbstractIntegrationTest.java` illustrates this by setting the `Authorization` header as `\"Bearer \" + accessToken` .\\n\\n### General API Requests with OAuth2\\nThe `RESTTestBase.java` class provides utility methods for making GET requests to API endpoints with OAuth2 authentication. The `getResponseOfGetWithOAuth2()` methods use `given().auth().preemptive().oauth2(accessToken)` to include the `Authorization: Bearer <accessToken>` header automatically . This confirms that the `Authorization` header is a standard part of OAuth2 authenticated API calls within the system.\\n\\n## Configuration Options\\n\\nThe WSO2 Identity Server\\'s OAuth configuration, typically found in `identity.xml` files, defines various aspects of OAuth2, including supported grant types and client authentication methods.\\n\\n### Client Authentication Handlers\\nThe `ClientAuthHandlers` section in configuration files like `identity-identitymgtlistener-enabled.xml`  and `backupIdentity.xml`  specifies how clients authenticate. The `BasicAuthClientAuthHandler` is a common handler, which processes the `Authorization: Basic` header for client authentication during token requests.\\n\\n## API Endpoints or Features\\n\\nThe following API endpoints and features are directly related to the use of the `Authorization` header in OAuth2 flows:\\n\\n*   **`/oauth2/token`**: This endpoint is used to obtain access tokens. It requires the `Authorization` header for client authentication when using confidential clients .\\n*   **`/oauth2/userinfo`**: This endpoint provides user claims and requires an `Authorization: Bearer <access_token>` header to authenticate the request .\\n*   **`/oauth2/revoke`**: The token revocation endpoint also uses the `Authorization` header for client authentication .\\n\\n## Documentation References\\n\\nThe WSO2 Identity Server testing framework wiki page on \"OAuth2 and OpenID Connect\" provides an overview of the supported grant types, token management, and system architecture, all of which inherently involve the use of the `Authorization` header for secure communication <cite repo=\"wso2/product-is\" path=\"null\" start=\"3.1\" end=\"3.1\" />. The various test cases, such as `OAuth2ServiceAuthCodeGrantTestCase` , `OAuth2ServiceWithConsentedTokenColumnAbstractIntegrationTest` , and `OAuth2RoleClaimTestCase` , serve as practical examples and test criteria for verifying the presence and correct usage of the `Authorization` header in OAuth2 flows.\\n\\n## Test Criteria\\n\\nThe integration tests within the `wso2/product-is` repository explicitly verify the presence and correctness of the `Authorization` header. For instance, in `OAuth2ServiceAuthCodeGrantTestCase.java`, the `testInvalidAuthzCode()` method constructs a request with the `Authorization` header and asserts the expected error response, indirectly verifying the header\\'s processing . Similarly, `OAuth2ServiceAuthCodeGrantCacheDisabledTestCase.java` includes a `testAuthzCodeResend()` method that also sets the `Authorization` header for a token request . These tests confirm that the `Authorization` header is included when OAuth2 authentication is performed and that its absence or incorrect format would lead to authentication failures.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which are designed to validate the functionality of the WSO2 Identity Server. While these tests clearly demonstrate the usage and expectation of the `Authorization` header in OAuth2 flows, they do not expose the internal server-side implementation logic that processes this header. However, the consistent use of `request.setHeader(\"Authorization\", ...)` across various OAuth2-related test cases strongly indicates that the server-side components are designed to expect and process this header for authentication.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Testing Framework (wso2/product-is)](/wiki/wso2/product-is#6)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ad6680af-7cb6-4f2f-a340-7b247d4a8c3b\\n', 'id': 'lc_156cf030-aca6-45cb-a2cb-3147908ac8fe'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0041_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_88cd463c-aed8-486f-8c05-acac0a22c649'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0042",
      "requirement": {
        "requirement_id": "ATOM_200",
        "requirement_text": "TPP SHALL create a one-time use XSRF token to be conveyed to the ASPSP in the state parameter when preparing an authorization request in Redirect SCA approach.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0042_1",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0042_2",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0042_3",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0042_4",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0042_5",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0042_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the inclusion of a `state` parameter in authorization requests, which can be used to convey a one-time use XSRF token. The `state` parameter is explicitly handled in the `MockOIDCIdentityProvider` for testing OIDC flows . While the codebase demonstrates the capability to pass a `state` parameter, it does not explicitly show the generation or validation of a one-time use XSRF token by the TPP (Third Party Provider) within the provided snippets.\\n\\n### Implementation Details\\n\\nThe `state` parameter is part of the authorization request in OpenID Connect (OIDC) flows. In the `MockOIDCIdentityProvider` class, which is used for testing OIDC flows, the `/authorize` endpoint is configured to accept and return a `state` parameter . Specifically, the `stubFor` method for the `/authorize` endpoint includes `withQueryParam(\"state\", matching(\".*\"))` , indicating that the mock IDP expects a `state` parameter. The response then includes `state={{request.query.state}}` , echoing the received `state` parameter back.\\n\\nThe `OAuth2RestClient.java` class, used for making OAuth2 related REST calls in integration tests, has methods like `initiateAuthRequest`  that build authorization requests. While this method constructs query parameters for the authorization request, it does not explicitly include a `state` parameter in the provided snippet . However, the `OpenIDConnectConfiguration` model includes a `state` field , suggesting that the system is designed to handle it.\\n\\n### Configuration Options\\n\\nThe `state` parameter itself is typically generated by the client (TPP) and is not a server-side configuration in terms of its value. However, the system\\'s ability to process this parameter is inherent in its OAuth2/OIDC implementation. The `OpenIDConnectConfiguration` class contains a `state` property , which is part of the application\\'s OpenID Connect configuration. This indicates that the system is designed to recognize and potentially utilize a `state` parameter associated with an OIDC application.\\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoint for authorization requests is typically `/oauth2/authorize` . The `MockOIDCIdentityProvider` explicitly mocks this endpoint to handle the `state` parameter . The `OAuth2Constant` class defines `AUTHORIZE_ENDPOINT_URL`  which points to this endpoint.\\n\\n### Documentation References\\n\\nThe provided wiki page on \"API Layer\"  describes the overall API architecture and versioning, but it does not delve into specific OAuth2/OIDC parameter handling like the `state` parameter for XSRF protection. The test cases, such as `OIDCAuthCodeGrantSSOTestCase` , demonstrate the use of the authorization endpoint and its parameters, including `client_id`, `scope`, `response_type`, `prompt`, and `redirect_uri` . While `state` is not explicitly added in this particular `URIBuilder` example, its presence in the `MockOIDCIdentityProvider` and `OpenIDConnectConfiguration` indicates support for it.\\n\\n## Notes\\n\\nThe provided code snippets confirm that the WSO2 Identity Server\\'s OAuth2/OIDC implementation is capable of receiving and echoing the `state` parameter in authorization requests. However, the responsibility of generating a unique XSRF token and including it in the `state` parameter for each authorization request, as well as its subsequent validation, falls on the TPP (Third Party Provider) and is not explicitly demonstrated within the provided server-side codebase. The server provides the mechanism to pass this parameter, but the client-side logic for XSRF token generation and validation would need to be implemented by the TPP.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3e343377-3d2b-4e2a-bc39-df345098b181\\n', 'id': 'lc_3fd5970e-f968-4cb2-975c-dca1f5c0ee8f'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0042_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_2f930979-5434-4bec-82f8-ddb11e13e906'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0043",
      "requirement": {
        "requirement_id": "ATOM_231",
        "requirement_text": "Amount values SHALL be represented with fractional digits compliant to currency definition, up to 14 significant figures, with dot as decimal separator",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "14.3",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0043_1",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, specifically within the WSO2 Financial Services Accelerator, supports amount values with fractional digits and a dot as a decimal separator, with a defined pattern for up to 13 digits before the decimal and up to 5 fractional digits. This is primarily enforced through OpenAPI specifications for various financial APIs.   \\n\\n## Implementation Details\\n\\nThe amount format is defined using regular expressions within the OpenAPI (Swagger) specifications for the APIs.  \\n\\n### API Specifications\\nThe `Amount` field in various API schemas uses a `pattern` to enforce the format. \\n\\n*   **Confirmation of Funds API**: In `funds-confirmation-openapi.yaml`, the `InstructedAmount` object, which is part of `obFundsConfirmation1` and `obFundsConfirmationResponse1`, defines the `Amount` property with the pattern `^\\\\\\\\d{1,13}$|^\\\\\\\\d{1,13}\\\\\\\\.\\\\\\\\d{1,5}$`.   This pattern allows for:\\n    *   1 to 13 digits before the decimal point. \\n    *   An optional decimal point followed by 1 to 5 fractional digits. \\n    *   The decimal separator is a dot (`.`). \\n\\n*   **Payment Initiation API**: Similarly, in `payment-initiation-openapi.yaml`, the `obActiveCurrencyAndAmount_SimpleType` schema, referenced by `InstructedAmount` in various payment initiation objects, uses the same pattern `^\\\\\\\\d{1,13}$|^\\\\\\\\d{1,13}\\\\\\\\.\\\\\\\\d{1,5}$`.      This also enforces 1 to 13 digits before the decimal and 1 to 5 fractional digits, with a dot as the decimal separator. \\n\\n*   **Account Information API**: The `account-info-swagger.yaml` defines `OBActiveCurrencyAndAmount_SimpleType` with a pattern `^\\\\\\\\d{1,13}\\\\\\\\.\\\\\\\\d{1,5}$`.  This pattern specifically requires a decimal point and 1 to 5 fractional digits, along with 1 to 13 digits before the decimal. \\n\\nThe `Currency` field in these schemas is defined with the pattern `^[A-Z]{3,3}$`, ensuring compliance with ISO 4217 for currency codes.  \\n\\n### Example Usage\\nAn example of an amount value adhering to this format can be seen in the `RequestPayloads.groovy` file, where an `Amount` is set to `\"165.88\"` with `Currency` as `\"GBP\"`.  \\n\\n## Configuration Options\\n\\nThe amount format is hardcoded within the OpenAPI specification files using regular expressions.  There are no explicit configuration options mentioned in the provided context to modify this pattern dynamically. <cite />\\n\\n## API Endpoints or Features\\n\\nThe amount format is applied to the `InstructedAmount` field in the following API contexts:\\n\\n*   **Funds Confirmation**: When creating or retrieving funds confirmation consents and responses, the `InstructedAmount` field is subject to this validation.  \\n*   **Payment Initiation**: For payment initiation requests and responses, the `InstructedAmount` within the `Initiation` object adheres to this format.    \\n*   **Account Information**: The `OBActiveCurrencyAndAmount_SimpleType` is used for amounts in account-related information, such as transaction entries.   \\n\\n## Documentation References\\n\\nThe OpenAPI specification files themselves serve as documentation for the expected format of amount values.    The descriptions within these files explicitly state that the amount is \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"   \\n\\n## Notes\\n\\nThe provided context indicates that the amount format is strictly enforced at the API level through OpenAPI schema validation.  The pattern `^\\\\\\\\d{1,13}$|^\\\\\\\\d{1,13}\\\\\\\\.\\\\\\\\d{1,5}$` allows for a maximum of 13 significant figures before the decimal point and up to 5 fractional digits.  The use of a dot as a decimal separator is inherent in this regular expression.  The currency definition compliance is handled by requiring a 3-letter uppercase ISO 4217 currency code.  While the pattern allows for up to 13 digits before the decimal and up to 5 after, the total number of significant figures is not explicitly capped at 14, but rather implicitly limited by the sum of these maximums (13 + 5 = 18).  However, the prompt asks for \"up to 14 significant figures\", which is a broader requirement than the current implementation\\'s explicit digit limits. <cite /> The current implementation ensures a dot decimal separator and currency-specific fractional digit rules (up to 5 fractional digits). \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_0bd5fd3a-69b4-464c-b0a1-95cae66bb1e4\\n', 'id': 'lc_48fddd82-a4eb-45f5-a656-062ec65f6e31'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0044",
      "requirement": {
        "requirement_id": "ATOM_100",
        "requirement_text": "ASPSPs MUST provide available SCA methods to PSU when multiple authentication methods are supported",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0044_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_2",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_3",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_4",
          "text": "## Configuring a custom Push Authenticator  \n\n1. Once implemented, build a JAR file for your project.\n2. Place the above-created JAR file in the `<IS_HOME>/repository/components/dropins` directory.\n3. Open the `<IS_HOME>/repository/conf/deployment.toml` file and configure your custom authenticator using the Fully \nQualified Name (FQN):\n\n      ``` toml\n      [open_banking.sca.idp]\n      name = \"CIBA-Push-Auth\"\n      ```\n    \n4. Save the configurations and restart the Identity Server.\n5. Follow the [Set up CIBA flow](../learn/ciba-set-up-flow.md#configuring-authenticator) documentation and try out the \nflow.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_5",
          "text": "### setAuthenticators method\nThis method lets you configure authenticators to be invoked during the authorization flow.\n\n``` java\npublic void setAuthenticators (boolean isRegulatoryApp, String tenantDomain, ServiceProvider serviceProvider,\n                               LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\n        throws OpenBankingException {\n\n    if (isRegulatoryApp) {\n\n        List<AuthenticationStep> authSteps = new ArrayList<>();\n\n        //Step 1 - Default basic authentication\n        LocalAuthenticatorConfig localAuthenticatorConfig = new LocalAuthenticatorConfig();\n        LocalAuthenticatorConfig[] localAuthenticatorConfigs = new LocalAuthenticatorConfig[1];\n        AuthenticationStep basicAuthenticationStep = new AuthenticationStep();\n\n        String authenticatorDisplayName = \"<PRIMARY_AUTHENTICATOR_DISPLAY_NAME>\";\n        String authenticatorName = \"<PRIMARY_AUTHENTICATOR_NAME>\";\n\n        localAuthenticatorConfig.setDisplayName(authenticatorDisplayName);\n        localAuthenticatorConfig.setEnabled(true);\n        localAuthenticatorConfig.setName(authenticatorName);\n        localAuthenticatorConfigs[0] = localAuthenticatorConfig;\n\n        basicAuthenticationStep.setStepOrder(1);\n        basicAuthenticationStep.setLocalAuthenticatorConfigs(localAuthenticatorConfigs);\n        basicAuthenticationStep.setAttributeStep(true);\n        basicAuthenticationStep.setSubjectStep(true);\n        //set step 1\n        authSteps.add(basicAuthenticationStep);\n\n         if (logger.isDebugEnabled()) {\n            logger.debug(String.format(\"Authentication step 1 added: %s\", authenticatorName));\n        }\n\n        localAndOutboundAuthenticationConfig.setAuthenticationSteps(authSteps.toArray(\n                    new AuthenticationStep[0]));\n    }\n}\n```\n\n!!! tip\n    You can change the name of the Identity Provider by configuring the following tag in the \n    `<IS_HOME>/repository/conf/deployment.toml` file. For example:\n    ``` xml\n    [open_banking.sca.idp]\n    name = \"SMSAuthentication\"\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, supports various multi-factor authentication (MFA) methods, which can be considered Strong Customer Authentication (SCA) methods. The system\\'s architecture includes an \"Authentication Framework\" that handles different authentication mechanisms, including multi-factor authenticators like TOTP, SMS OTP, and Email OTP <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.1\" end=\"1.1\" />. The platform also features \"Adaptive Authentication\" which allows for risk-based, step-based, and conditional authentication flows, enabling the dynamic selection of SCA methods based on context <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.2\" end=\"1.2\" />.\\n\\n### Implementation Details\\nWSO2 Identity Server\\'s authentication framework is designed to be modular and extensible, allowing for the integration of various authentication mechanisms <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.1\" end=\"1.1\" />. The system supports \"Multi-factor Authenticators\" such as SMS OTP, Email OTP, and TOTP <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.2\" end=\"1.2\" />. These authenticators are defined within the system\\'s build process, as seen in the `pom.xml` which lists dependencies for `org.wso2.carbon.identity.local.auth.smsotp.feature`, `org.wso2.carbon.identity.local.auth.emailotp.server.feature`, and `org.wso2.carbon.extension.identity.authenticator.outbound.totp` .\\n\\nThe system also provides \"Adaptive Authentication\" capabilities, which allow for the configuration of complex authentication flows using JavaScript scripts <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.2\" end=\"1.2\" />. These scripts can dynamically determine which authentication steps, including SCA methods, are required based on various factors like user attributes, device information, and network context <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.2\" end=\"1.2\" />.\\n\\n### Configuration Options\\nConfiguration for multi-factor authentication is managed through the system\\'s configuration files. For instance, the `identity-mgt-listener-enabled.xml` and `encrypt-decrypt-persistence-enabled-identity.xml` files contain a `<MultifactorAuthentication>` section, although it is commented out by default, indicating that MFA can be enabled and configured  . Similarly, `identity-default.xml` and `backupIdentity.xml` also show a `<UseMultifactorAuthentication>` flag that can be set to `true`  .\\n\\nThe \"Configuration System\" of WSO2 Identity Server supports dynamic configuration through templates and deployment files like `deployment.toml` <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.1\" end=\"1.1\" />. This allows administrators to define and manage authentication policies, including the use of multiple SCA methods, through these configuration mechanisms <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.1\" end=\"1.1\" />.\\n\\n### API Endpoints or Features\\nWSO2 Identity Server provides an \"API Layer\" for administration and user management <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.1\" end=\"1.1\" />. While the provided context does not explicitly detail an API endpoint that returns a list of available SCA methods in a \"Start Authorisation Response,\" the presence of a comprehensive API layer suggests that such functionality could be exposed or configured. The \"Authentication Framework\" and \"Adaptive Authentication\" features imply that the system can determine and apply appropriate authentication methods dynamically <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.1\" end=\"1.1\" />.\\n\\nThe `OAuth2ServiceAbstractIntegrationTest.java` file contains methods like `sendLoginPostForCustomUsers` and `sendApprovalPost` which interact with authentication and authorization flows, indicating how a client might interact with the system during these processes . The `Oauth2ImpersonationTestCase.java` also demonstrates interactions with authorization endpoints and token requests .\\n\\n### Documentation References\\nThe WSO2 Identity Server documentation, specifically the \"Features and Capabilities\" wiki page, details the support for \"Multi-factor Authentication\" and \"Adaptive Authentication\" <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.2\" end=\"1.2\" />. These sections describe how various MFA methods are supported and how authentication flows can be customized based on conditions <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.2\" end=\"1.2\" />. The \"Architecture\" wiki page also provides an overview of the \"Authentication Framework\" which is central to handling different authentication mechanisms <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"1.1\" end=\"1.1\" />. For more detailed installation and deployment information, the `README.md` refers to `https://is.docs.wso2.com/en/latest/deploy/get-started/install` .\\n\\n## Notes\\nThe prompt specifically asks about ASPSPs (Account Servicing Payment Service Providers) and PSUs (Payment Services Users) in the context of SCA (Strong Customer Authentication) methods. While the provided codebase does not explicitly use these terms, the functionality described under \"Multi-factor Authentication\" and \"Adaptive Authentication\" in WSO2 Identity Server aligns with the technical requirements for SCA. The system\\'s ability to support multiple authentication methods and dynamically apply them based on context directly addresses the core of the user\\'s query. The test criteria regarding the ASPSP returning a list of available SCA methods in a Start Authorisation Response would likely be implemented through the API Layer and the Adaptive Authentication framework, which can orchestrate and present these options to the PSU.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_fa604b68-4b68-4d79-b414-c4818c69fb12\\n', 'id': 'lc_2982f5aa-1612-4d4b-9337-285138c27cca'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0044_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_46251970-6956-46d5-9211-31e143d3143f'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0045",
      "requirement": {
        "requirement_id": "ATOM_169",
        "requirement_text": "Standing order information requests MUST use bookingStatus parameter with value 'information'",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f30dd2c91d5e",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0045_1",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, appears to support standing order information requests, but the provided context does not explicitly confirm the enforcement of a `bookingStatus=information` parameter for these requests. The `OBBalanceType1Code` definition in `account-info-swagger.yaml` includes an \"Information\" enum value, which suggests that \"information\" is a recognized balance type . However, there is no direct evidence in the provided snippets that this specific parameter and value are *required* for standing order information requests.\\n\\n### API Endpoints and Features\\n\\nThe `wso2/financial-services-accelerator` repository defines API specifications for various financial services, including \"Account Information APIs\" and \"Payment Initiation APIs\" . Within the \"Payment Initiation APIs\", there are references to standing orders. For instance, the `ConnectorTestConstants.groovy` file defines constants for standing order consent paths, such as `CONSENT_PATH_STANDING_ORDERS` and `CONSENT_PATH_INTERNATIONAL_STANDING_ORDER` . Similarly, submission paths for standing orders are also defined .\\n\\nThe `account-info-swagger.yaml` file, which defines the Account Information APIs, includes a definition for `OBBalanceType1Code` . This enum contains a value `Information` . This suggests that \"information\" is a recognized type of balance or status within the system.\\n\\n### Implementation Details\\n\\nThe `PaymentRequestPayloads.groovy` file contains a method `initiationPayloadDomesticStandingOrderPayment` which constructs a payload for domestic standing order payments . This payload includes fields like `FirstPaymentDateTime`, `RecurringPaymentDateTime`, and `FinalPaymentDateTime`, which are relevant to standing order details . However, there is no explicit `bookingStatus` parameter with a value of `information` in this payload construction.\\n\\nThe `TestConstants.java` file also shows permissions related to standing orders, such as `ReadStandingOrdersBasic` and `ReadStandingOrdersDetail` . These permissions indicate that the system supports reading standing order information.\\n\\n### Configuration Options\\n\\nThe provided context does not contain specific configuration options directly related to enforcing the `bookingStatus=information` parameter for standing order requests. The `Overview` wiki page mentions a centralized configuration approach through the `financial-services.xml` file parsed by `FinancialServicesConfigParser` . However, the details of this configuration do not specify parameters for standing order requests.\\n\\n### Documentation References\\n\\nThe `Overview` wiki page provides a high-level overview of the WSO2 Financial Services Accelerator and mentions API specifications for \"Account Information APIs\" and \"Payment Initiation APIs\" . These API specifications are defined in OpenAPI/Swagger files like `account-info-swagger.yaml`  and `payment-initiation-openapi.yaml` . While `account-info-swagger.yaml` defines `OBBalanceType1Code` with an \"Information\" value , there is no explicit documentation in the provided context that mandates `bookingStatus=information` for standing order information requests.\\n\\n## Notes\\n\\nThe provided code snippets indicate that the system handles standing orders and has a concept of \"information\" as a balance type. However, there is no direct evidence in the provided context that GET requests for standing orders *must* include a `bookingStatus=information` query parameter. The `OBBalanceType1Code` enum in `account-info-swagger.yaml` is related to account balances, not directly to standing order request parameters. To confirm the requirement, further investigation into the API gateway\\'s request validation logic or specific standing order API definitions would be necessary.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-s_c99b59ca-780f-46b8-a175-c8738af2a4a9\\n', 'id': 'lc_0450538e-d524-4f2a-a0e3-d163e5aadc79'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0046",
      "requirement": {
        "requirement_id": "ATOM_129",
        "requirement_text": "The ASPSP shall perform Strong Customer Authentication (SCA) as mandated by EBA-RTS for consent authorization",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0046_1",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_2",
          "text": "## How to manage consents\n\nThe API consumer applications seek consent from their customers who wish to expose their financial data through the \napplication. When granting consent the customers must know the following:\n\n- Who they are granting access to: The identity of the API consumer application\n- For what purpose: The details that this application will have access to. For example, account details, payment details\n- For what period: Number of days the consent is valid for\n- Expiration process: How the user can revoke a granted consent\n\nOnce the customer successfully agrees to the above the bank backends take over the process. The bank backend engages \nwith the customer and authenticates them according to the available security mechanisms, for example, multi-factor \nauthentication/Strong Customer Authentication via SMS OTP. \n\nAfter successful authentication, the customer is presented with the details of the consent where they can allow or \ndeny this request from the API consumer application to access data. Depending on the customer\u2019s response the API \nconsumer application may or may not have access to the data. \n\nWith the [Consent Manager](consent-manager.md) application in WSO2 Open Banking Accelerator you can use one of the \nfollowing methods to revoke these consents granted to API consumer applications.\n \n - A customer can revoke a consent using the Consent Manager portal \n - A Customer Care Representative from the bank can revoke a consent on behalf of a user\n \nWSO2 Open Banking Accelerator uses the following [API endpoints](../references/consent-rest-api.md) to manage consents \nas previously described. \n\n- **Consent Validation - `/validate` endpoint**  \n  The accelerator gathers all consent details and invokes validators via this API. Once the validations are performed, \n  the flow will proceed. You can write your own validations and customize the process.  \n  \n- **Consent Portal - `/admin` endpoint**  \n   The Consent Management portal and the Customer Care portal invoke this API to search consents and revoke consents.\n    \n- **Consent Management - `/manage` endpoint**  \n  This component processes requests based on specification requirements on consent management operations as create \n- consent,get consent, revoke consent and update consent. \n  \n- **Consent Authorize - `/authorize` endpoint**  \n  This endpoint uses to retrieve the consent and consumer data showing in consent grant UI and then persist the user \n  granted data . You can customize the populating data to the consent grant page or persist custom data \n  after user granted.\n\nFor more information on this, refer to [Consent Management OpenAPI Extensions](../develop/openapi-consent-management-manage.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_3",
          "text": "#Client-Initiated Backchannel Authentication (CIBA) Flow\n\nWSO2 Open Banking Accelerator provides support for the\n[OpenID Connect Client-Initiated Backchannel Authentication Flow](https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html). \n\nThe CIBA flow is an authentication flow like OpenID Connect. In the OpenID Connect authentication flow, the bank customers \nare redirected to the bank in order to log in by providing their credentials. The customers are authenticating themselves \nthrough the same device that is used for the rest of the flow. \n\nHowever, in CIBA, the bank sends a notification to the customer's mobile device and verifies the account owners. CIBA \nuses a decoupled direct channel to verify the customer without relying on redirects. This flow consists of 2 types of devices:\n\n- Consumption Device:  Device used to interact with the bank\n- Authentication Device: Device used for authentication and consent grant\n\nThe customer starts the flow with a relying party (a Third Party Provider/API consumer application) at the Consumption Device \nbut authenticates and grants consent on the Authentication Device. This makes the flow a form of \n**Decoupled authentication/authorization**.\n\nCIBA flow increases the security by involving a second device, which is similar to Two-Factor Authentication. Customers \nsimply receive a mobile notification to authenticate themselves and grant access to their accounts. This also\nimproves the user experience as the customers are not redirected between websites.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_4",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_5",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'WSO2 Identity Server (IS) supports Strong Customer Authentication (SCA) for consent authorization, particularly in the context of Financial-grade API (FAPI) compliance and OAuth 2.0/OpenID Connect flows. The system allows for configuration to enable or disable consent management and provides mechanisms to enforce multi-factor authentication (MFA) as part of adaptive authentication flows, which can be used to satisfy SCA requirements. \\n\\n## Implementation Details\\n\\nWSO2 Identity Server\\'s core identity services include adaptive authentication and multi-factor authentication (MFA) features that can be leveraged for SCA.  The system supports various MFA methods such as SMS OTP, Email OTP, TOTP, and FIDO.  These authentication mechanisms can be integrated into authentication flows to enforce stronger authentication during consent authorization. \\n\\nThe `SAMLSSOConsentTestCase.java`  and `SelfSignUpConsentTest.java`  integration tests demonstrate how consent approval is handled within SAML SSO and self-registration flows, respectively. The `performConsentApproval` method in `OAuthAppsWithSameClientIdTestCase.java` shows the programmatic approval of OIDC consent. \\n\\nFor FAPI compliance, which often mandates SCA, the `configure_acr` function in `configure_is_fapi.py` is used to set up advanced authentication scripts.  These scripts can define conditional authentication flows, including MFA, to meet SCA requirements. \\n\\n## Configuration Options\\n\\nThe WSO2 Identity Server provides configuration options to manage consent and authentication.\\n\\n### Consent Management Configuration\\n\\nConsent management can be enabled or disabled for SSO flows through the `EnableSSOConsentManagement` property in the `deployment.toml` file (represented by `default-identity.xml` in the test resources).  Additionally, specific OAuth 2.0 grant types can be configured to filter user claims based on user consent, such as `authorization_code` and `implicit` grants. \\n\\nThe `skipLoginConsent` property in application advanced configurations can be set to `false` to ensure that consent flows are triggered.  This is crucial for enforcing consent authorization.\\n\\n### Strong Customer Authentication (SCA) Configuration\\n\\nSCA is typically implemented through adaptive authentication policies and MFA. WSO2 Identity Server allows for the configuration of adaptive authentication scripts using JavaScript to define conditional authentication flows.  These scripts can incorporate various factors like user attributes, device information, and network context to determine the required authentication strength. \\n\\n## API Endpoints or Features\\n\\nWSO2 Identity Server exposes REST APIs for managing various aspects of identity and access management, including consent.\\n\\n### Consent Management APIs\\n\\nThe API Layer includes endpoints for consent management under `/api/identity/consent-mgt/v1.0/consents`.  These APIs allow for managing user consents, purposes, and PII categories. \\n\\n### Authentication APIs\\n\\nThe system provides an authentication API for in-app authentication, which can be used to streamline user access and integrate with custom authentication flows.  This API, combined with adaptive authentication, can facilitate the enforcement of SCA during consent authorization.\\n\\n## Documentation References\\n\\nThe WSO2 Identity Server documentation provides further details on its capabilities. The \"Features and Capabilities\" wiki page outlines the support for OAuth 2.0/OpenID Connect, adaptive authentication, and MFA.  The \"Overview\" wiki page mentions FAPI compliance as a key feature. \\n\\n## Notes\\n\\nThe term \"ASPSP\" (Account Servicing Payment Service Provider) and \"EBA-RTS\" (European Banking Authority - Regulatory Technical Standards) are not explicitly mentioned in the provided code snippets or wiki pages. However, the codebase\\'s strong support for FAPI (Financial-grade API) compliance  and its robust adaptive authentication and MFA capabilities  indicate that it provides the necessary building blocks to implement SCA as mandated by EBA-RTS for consent authorization. The integration tests for consent management and FAPI configuration further support this. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_130a50cf-cf8f-4175-875a-087c56f9b2bd\\n', 'id': 'lc_228c19bf-7f3e-4814-ba88-53950d1102c4'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0046_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_a2474c75-d8b9-4072-8865-7fb5f9e4b990'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0047",
      "requirement": {
        "requirement_id": "ATOM_130",
        "requirement_text": "The ASPSP shall create a consent resource with detailed access rights, validity status, and Consent-ID token upon successful authorization",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0047_1",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_2",
          "text": "### createConsentAuthorization method\n      \nThis method lets you create an authorization resource for a consent.\n    \n```java\nAuthorizationResource createConsentAuthorization(AuthorizationResource authorizationResource) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_3",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_4",
          "text": "### Data\nThe following table explains the data available in `ConsentValidateData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| headers   | JSONObject            | The request headers sent in the request. |\n| body   | JSONObject            | The payload sent in the request. |\n| electedResource   | String            | The path invoked in the request. For example: `/accounts/{AccountId}`|\n| consentId | String                | The consent ID related to the current resource request. This consent ID is bound to the user access token used. |\n| userId | String                | The user ID related to the current resource request. This user ID is retrieved from the user access token. |\n| clientId | String                | The ID of the TPP application related to the current resource request. This client ID is retrieved from the user access token.|\n| comprehensiveConsent  | DetailedConsentResource   | The comprehensive consent object related to the consent that is being validated. This object contains all the details related to the consent. |\n| resourceParams | Map<String, String>                | A map containing the full resource path with query parameters (ex: `aisp/accounts/{AccountId}?queryParam=urlEncodedQueryParamValue`), HTTP method, and context (ex: `/open-banking/v3.1/aisp`) of the request. |\n\nThe following table explains the data available in `ConsentValidationResult`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| isValid | boolean | An attribute to identify whether the consent is in a valid state or not. |\n| modifiedPayload | JSONObject | Optionally used to set a modified error payload to be sent with the consent validation response. If a modified payload is set, it is given priority over creating a generic error response using the message and code information. |\n| consentInformation | JSONObject | Used to set the consent data to the consent validation result. This data will be sent to the bank backend. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0047_5",
          "text": "### createConsentFile method\n\nThis method lets you create a consent file by performing the following:\n\n- Validates the status of the consent a per the \"applicableStatusToFileUpload\" parameter\n- Creates the consent file\n- Updates the status of the consent\n- Creates audit records for necessary consent updates\n\n```\nboolean createConsentFile(ConsentFile consentFileResource, String newConsentStatus, String userID, String applicableStatusToFileUpload) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0048",
      "requirement": {
        "requirement_id": "ATOM_109",
        "requirement_text": "The X-Request-ID header SHALL be mandatory and contain a UUID unique to the call as determined by the initiating party",
        "strength": "SHALL",
        "capability": "General",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0048_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to explicitly enforce the `X-Request-ID` header as mandatory with a UUID format for all API calls. While there is a feature for UUID generation and a specific instance of an `X-Fapi-Interaction-Id` header being used in a conformance test, there\\'s no general mechanism found in the provided context that mandates or validates an `X-Request-ID` header across the entire system.\\n\\n### Implementation Details\\nThe codebase includes a \"UUID Generator feature\" as seen in the `modules/p2-profile-gen/pom.xml` file . This indicates that the system has the capability to generate UUIDs. However, this feature alone does not imply that an `X-Request-ID` header is mandatory or that it\\'s used for all incoming requests.\\n\\nIn the `oidc-fapi-conformance-tests/resource-server/resource-server.py` file, there\\'s an example of handling an `X-Fapi-Interaction-Id` header . If this header is not present, a new UUID is generated and assigned to it . This specific implementation is within a conformance test for Financial-grade API (FAPI) and is not a general enforcement across all API endpoints of WSO2 Identity Server . The `resource-server.py` file is part of `oidc-fapi-conformance-tests`, which suggests it\\'s a testing utility rather than a core component enforcing API requirements .\\n\\n### Configuration Options\\nBased on the provided snippets, there are no explicit configuration options that would allow you to mandate the presence and format of an `X-Request-ID` header globally for all API endpoints. The \"Configuration System\" described in the `Architecture` wiki page mentions `default.json`, `infer.json`, and `deployment.toml` for dynamic configuration  . However, the provided context does not show any specific entries related to `X-Request-ID` header enforcement within these configuration files.\\n\\n### API Endpoints or Features\\nThe `Architecture` wiki page outlines various API layers, including \"Server APIs\" and \"User APIs\" . However, there is no indication within the provided context that these APIs inherently require or validate an `X-Request-ID` header. The `oidc-fapi-conformance-tests/resource-server/resource-server.py` file demonstrates a specific API endpoint `/resource` that handles `X-Fapi-Interaction-Id` , but this is limited to the FAPI conformance tests.\\n\\n### Documentation References\\nThe provided context does not include any documentation references that specify the `X-Request-ID` header as mandatory or describe its general implementation and configuration within the WSO2 Identity Server. The `Architecture` wiki page provides a high-level overview but does not delve into such specific API header requirements .\\n\\n## Notes\\nThe presence of a \"UUID Generator feature\"  and the handling of `X-Fapi-Interaction-Id` in a conformance test  might suggest that UUIDs are used internally or for specific protocol implementations. However, this does not translate to a general requirement for an `X-Request-ID` header across all API calls as described in the prompt. The `AbstractUUIDUMTestCase.java` file also deals with UUIDs in the context of user management , but this is unrelated to request headers.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2f2de5de-c1d7-46fb-84da-5d441468bd2b\\n', 'id': 'lc_c742d0b3-7aba-445e-bce0-a340392489de'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0048_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not explicitly support a mandatory `X-Request-ID` header that contains a UUID and causes a request to fail if missing. However, it does define and use `MessageID` and `RelatesTo` headers, which are described as containing UUIDs for unique message and request identification respectively  . These headers are not explicitly stated to be mandatory or to cause request failure if absent.\\n\\n### Implementation Details and API Endpoints/Features\\n\\nThe documentation refers to `MessageID` and `RelatesTo` as header names with `UUID` as possible values  . These are described as unique identifiers for messages and related requests, respectively  . The documentation states that it\\'s \"not recommended to make alterations to this property of a message\" for `MessageID`  and \"Not recommended to make changes\" for `RelatesTo` . These headers can be accessed using `get-property(\\'MessageID\\')` and `get-property(\\'RelatesTo\\')`  .\\n\\n### Configuration Options\\n\\nThe provided documentation snippets do not indicate any explicit configuration options to make `MessageID` or `RelatesTo` headers mandatory, nor do they describe a mechanism to enforce request failure if these headers are missing or malformed. The `properties_guide.xml` files primarily describe the purpose and usage of various properties and headers within the WSO2 ESB context .\\n\\n### Documentation References\\n\\nThe relevant documentation for these headers can be found in:\\n*   `wso2/product-apim/all-in-one-apim/docs/xdoc/properties_guide.xml` \\n*   `wso2/product-apim/api-control-plane/docs/xdoc/properties_guide.xml` \\n*   `wso2/product-apim/gateway/docs/xdoc/properties_guide.xml` \\n*   `wso2/product-apim/traffic-manager/docs/xdoc/properties_guide.xml` \\n\\nThese documents describe `MessageID` and `RelatesTo` headers, their expected UUID values, and their purpose as unique identifiers.\\n\\n## Notes\\n\\nWhile the repository defines headers that use UUIDs for identification (`MessageID` and `RelatesTo`), there is no direct mention of an `X-Request-ID` header or any built-in mechanism to enforce its mandatory presence, validate its UUID format, or cause request failure if it\\'s missing, as specified in your requirement. The `Owasp.CsrfGuard.Carbon.properties` file mentions `X-Requested-With` in the context of CSRF protection for Ajax requests, but this is distinct from a general `X-Request-ID` for tracing purposes . It is possible that custom mediation policies or extensions could be implemented to achieve the desired behavior, but this is not directly supported by the provided documentation.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_35189c73-0788-417f-a598-876038784122\\n', 'id': 'lc_6cab3c7d-5a21-4f6b-95be-e4867956abf4'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0049",
      "requirement": {
        "requirement_id": "ATOM_201",
        "requirement_text": "TPP SHALL bind the XSRF token value to the current session in the user agent when preparing authorization request.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0049_1",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0049_2",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0049_3",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0049_4",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0049_5",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0049_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports token binding, which can be configured to bind OAuth2 access tokens and refresh tokens to an external attribute during token generation. This mechanism can be used to validate the token binding during API invocation, which is relevant to the concept of binding an XSRF token to a user session.  While the term \"XSRF token\" is not explicitly mentioned in the provided context, the functionality described for \"token binding\" aligns with the requirement of binding a token value to a session for validation. \\n\\n## Implementation Details\\n\\nThe `AccessTokenConfiguration` class in `wso2/product-is` defines properties related to access token management, including `bindingType` and `validateTokenBinding`. \\n\\n*   **`bindingType`**: This property specifies the type of binding for OAuth2 access and refresh tokens.  The available options for `bindingType` include \"None\", \"cookie\", \"sso-session\", \"device-flow\", \"DPoP\", \"certificate\", and \"client-request\". \\n*   **`validateTokenBinding`**: If enabled, both the access token and the token binding must be present for a successful API invocation. \\n\\nThe `OAuth2DPopTestCase.java` demonstrates the use of DPoP (Demonstrating Proof-of-Possession) for token binding, where a `dpop_jkt` (DPoP JSON Web Key Thumbprint) is sent in the authorization request.  This `dpop_jkt` is generated from a DPoP proof. \\n\\n## Configuration Options\\n\\nToken binding can be configured through the `AccessTokenConfiguration` model, which is part of the `ApplicationModel`.  Specifically, the `bindingType` property can be set to \"cookie\" or \"sso-session\" to bind the token to the browser session.  The `validateTokenBinding` property can be enabled to enforce the validation of this binding during API calls. \\n\\n## API Endpoints or Features\\n\\nThe Application Management API, accessible via `/api/server/v1/applications`, allows for the configuration of application-specific settings, including OAuth2/OIDC configurations.  The `PUT /applications/{applicationId}/inbound-protocols/{protocol}` endpoint can be used to update the protocol configuration, which would include the `AccessTokenConfiguration` settings. \\n\\nThe `oidc-metadata.json` file indicates that `accessTokenBindingType` is a configurable option for OAuth2/OIDC applications. \\n\\n## Documentation References\\n\\nThe wiki page on \"Application Management\" provides an overview of OAuth2/OIDC configuration, including \"Token Binding\" as a security feature. <wiki_page repo_name=\"wso2/product-is\" id=\"4.3\" page_name=\"Application Management\" /> It lists \"None\", \"Cookie\", \"DPoP\", \"Certificate\", \"Device-flow\", and \"SSO-session\" as binding types. <wiki_page repo_name=\"wso2/product-is\" id=\"4.3\" page_name=\"Application Management\" />\\n\\n## Notes\\n\\nThe term \"XSRF token\" is not explicitly used in the provided codebase or documentation. However, the concept of \"token binding\" with options like \"cookie\" and \"sso-session\" for `bindingType` in the `AccessTokenConfiguration` directly addresses the requirement of binding a token value to the current session in the user agent and validating it upon callback.   The `validateTokenBinding` flag further ensures that this binding is enforced.  The DPoP implementation in `OAuth2DPopTestCase.java` serves as a concrete example of how token binding is handled and validated within the system. \\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b0aac8b0-697c-47d8-a60a-cd79c90bf155\\n', 'id': 'lc_70d2f4d2-2692-4f75-b3e3-0aee52b5238e'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0049_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_6dfa2531-fe0d-4c00-a60d-fcc02ae33c5c'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0050",
      "requirement": {
        "requirement_id": "ATOM_202",
        "requirement_text": "TPP MUST generate a nonce for the challenge parameter in addition to XSRF token when using integrated OAuth SCA Approach.",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0050_1",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_2",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_3",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_4",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0050_5",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0051",
      "requirement": {
        "requirement_id": "ATOM_010",
        "requirement_text": "ASPSPs must accept at least the specified basic character set including letters, numbers, and common punctuation",
        "strength": "MUST",
        "capability": "General",
        "section_id": "eef9ab97432c - 4.2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0051_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports character set validation for usernames, which is relevant to the requirement that ASPSPs must accept a specified basic character set. The validation is primarily configured through regular expressions defined in `infer.json`  and `default.json` .\\n\\n## Implementation Details\\n\\nThe character set validation is implemented using regular expressions applied to usernames. For `database` and `database_unique_id` user store types, the `UsernameJavaRegEx` is `^[^\\\\\\\\s*?%]{3,50}$`  . This regex allows any character except whitespace, asterisk, question mark, or percentage sign, with a length between 3 and 50 characters.\\n\\nFor `read_only_ldap`, `read_only_ldap_unique_id`, `read_write_ldap`, `read_write_ldap_unique_id`, `active_directory`, and `active_directory_unique_id` user store types, the `UsernameJavaRegEx` is `[a-zA-Z0-9._\\\\\\\\-|//]{3,50}$`      . This regex specifically allows alphanumeric characters, periods, underscores, hyphens, and forward slashes, also with a length between 3 and 50 characters.\\n\\nAdditionally, a global `UsernameJavaScriptRegEx` is defined as `^[^\\\\\\\\s*?%]{3,50}$`  in `default.json`, which is similar to the database user store regex.\\n\\n## Configuration Options\\n\\nThe character set for usernames is configured through the `UsernameJavaRegEx` and `UsernameJavaScriptRegEx` properties. These properties are found in the `infer.json`  and `default.json`  files.\\n\\nThe `infer.json` file provides specific regexes based on the `user_store.type` . For example, if the user store type is `database`, the regex `^[^\\\\\\\\s*?%]{3,50}$` is applied . If the user store type is `read_only_ldap`, a different regex `[a-zA-Z0-9._\\\\\\\\-|//]{3,50}$` is used .\\n\\n## API Endpoints or Features\\n\\nWhile the provided snippets do not directly show API endpoints for character set validation, the `AuthenticatorFailureTest.java`   and `IdPFailureTest.java`   test cases indicate that API calls to create or update authenticators and identity providers can result in `HTTP.SC_BAD_REQUEST` responses due to invalid input, including format validation. For instance, `AuthenticatorFailureTest.java` shows validation for `displayName` format  . This suggests that character set validation, like the username regexes, would be enforced during API interactions related to user and identity provider management.\\n\\n## Documentation References\\n\\nThe \"Security Configuration\" wiki page mentions \"Identity Governance Security Policies\"  and \"Password Policies\" . While these primarily focus on password complexity and account locking, the underlying mechanism for input validation, including character sets, would be part of the broader security governance framework. The `get-category-QWNjb3VudCBNYW5hZ2VtZW50-response.json`  file, which is a test resource for account management, includes properties related to OTP character sets (uppercase, lowercase, numbers)  and a regex for security question answers . This indicates that character set validation is a configurable aspect of identity governance.\\n\\n## Notes\\n\\nThe provided regexes for usernames in `infer.json`  and `default.json`  do not explicitly cover all the characters specified in the user\\'s query (e.g., `():,\\'+` and space are not universally allowed by the LDAP-specific regex). The `^[^\\\\\\\\s*?%]{3,50}$` regex allows most of the requested characters except for `*`, `?`, `%`, and whitespace. The `[a-zA-Z0-9._\\\\\\\\-|//]{3,50}$` regex is more restrictive. To fully meet the requirement of accepting \"a-z, A-Z, 0-9, /-?:().,\\'+, and space\", these regular expressions would need to be adjusted. The system provides the mechanism to configure these character sets via regexes, but the default configurations might not align perfectly with the specified basic character set.\\n\\nWiki pages you might want to explore:\\n- [Identity Provider Management (wso2/product-is)](/wiki/wso2/product-is#3.3)\\n- [Security Configuration (wso2/product-is)](/wiki/wso2/product-is#5.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_bda6d782-bfb0-4c7b-bee8-3135375ec489\\n', 'id': 'lc_231c8b5a-591e-4a22-92c2-635355ffbd6f'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0051_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, demonstrates some support for handling special characters in various contexts, including API resource names, endpoint security passwords, and URI template parameters. However, it does not explicitly define or enforce a \"basic character set\" for ASPSPs (Account Servicing Payment Service Providers) as described in your query. The provided snippets primarily focus on how the system handles special characters in its internal operations and configurations, rather than validating input against a specific character set for external entities like ASPSPs.\\n\\n## Implementation Details\\n\\nThe codebase shows several instances where special characters are handled:\\n\\n### Input Validation in Self-Registration\\nThe `self-registration-with-verification.jsp` file in both `all-in-one-apim` and `api-control-plane` repositories includes client-side JavaScript validation for unsafe characters in input fields  . The `unsafeCharPattern` regular expression `/[<>`\\\\\"]/`   explicitly restricts angle brackets, backticks, and double quotes. If these characters are found, an error message \"For.security.following.characters.restricted\" is displayed  . This indicates a security-driven approach to character restrictions for user input.\\n\\n### API Resource Names\\nThe `APIResourceWithSpecialCharactersInvocation.java` test case demonstrates that API resource names can include special characters such as comma (`,`), hyphen (`-`), period (`.`), underscore (`_`), and tilde (`~`) . The test successfully invokes an API with a resource path like `/special,-._~resource`  . This suggests that the system is designed to handle these characters in API paths without issues.\\n\\n### Endpoint Security Passwords\\nThe `ChangeEndPointSecurityOfAPITestCase.java` file includes tests for endpoint passwords containing various symbolic characters, including `!`, `@`, `#`, `$`, `%`, `^`, `&`, `*`, `(`, `)`, `_`, `-`, `+`, `=`, `{`, `[`, `}`, `]`, `|`, `:`, `;`, `\\'`, `<`, `,`, `>`, `.`, `?`, and `/` . The tests confirm that the system can handle these characters in endpoint security configurations .\\n\\n### URI Template Parameter Encoding\\nThe `UriTemplateReservedCharacterEncodingTest.java` test class verifies how URI template parameters with special characters are handled . It includes tests for space characters (` `) , trailing percentage signs (`%`) , and plus signs (`+`) . The tests assert that these characters are correctly percent-encoded and decoded during URI template expansion   .\\n\\n### Character Encoding in API Responses\\nThe `CONTENT_TYPE_TEST.xml` files demonstrate the use of `charset=UTF-8` in the `Content-Type` header for API responses  . This indicates support for UTF-8 character encoding in API communication, which would encompass the specified basic character set and beyond.\\n\\n## Configuration Options\\n\\nBased on the provided snippets, there are no explicit configuration options directly related to defining or enforcing a \"basic character set\" for ASPSPs. The character handling appears to be embedded in the system\\'s logic and tested through integration tests.\\n\\n## API Endpoints or Features\\n\\nThe codebase does not expose specific API endpoints or features designed for ASPSPs to validate character sets. The character handling is observed in:\\n*   **Self-registration forms**: The `self-registration-with-verification.jsp`   file shows client-side validation for certain unsafe characters.\\n*   **API creation and invocation**: The `APIResourceWithSpecialCharactersInvocation.java`  test demonstrates that API resource paths can contain a range of special characters.\\n*   **Endpoint security configuration**: The `ChangeEndPointSecurityOfAPITestCase.java`  test confirms that endpoint passwords can include various symbolic characters.\\n*   **URI template handling**: The `UriTemplateReservedCharacterEncodingTest.java`  test verifies the encoding and decoding of special characters in URI parameters.\\n\\n## Documentation References\\n\\nNo explicit documentation references within the provided code snippets define a \"basic character set\" for ASPSPs. The `XMLSchema.xsd` file defines XML schema types like `normalizedString` and `token` , which have `whiteSpace` processing rules, but this is a general XML schema definition and not specific to ASPSP character set requirements.\\n\\n## Notes\\n\\nThe provided code snippets indicate that the `wso2/product-apim` repository has robust handling for various special characters in different contexts, including API resource paths, endpoint credentials, and URI parameters. The system generally supports UTF-8 encoding, which would cover the specified basic character set (a-z, A-Z, 0-9, /-?:().,\\'+, and space). However, there is no direct evidence in the provided snippets of a specific \"basic character set\" being defined or enforced for ASPSPs. The character restrictions observed are primarily for security (e.g., in self-registration forms) or for proper URI encoding/decoding. To fully address the requirement, further investigation into the ASPSP-specific modules or configurations would be necessary.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_cb6961c2-7130-43b0-8482-63dc73be44de\\n', 'id': 'lc_67490fcb-4f77-4804-b854-d092a3d460b4'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0052",
      "requirement": {
        "requirement_id": "ATOM_170",
        "requirement_text": "The API MUST support a GET endpoint at /v1/accounts/{account-id}/transactions/{transactionId} to read transaction details for a specific transaction on a given account.",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0052_1",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_2",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_3",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_4",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_5",
          "text": "### Retrieve a consent \n- An API consumer can retrieve a consent resource that they have created to check its status. In order to make this request, \nthe API consumer must have an access token issued by the bank using the client credentials grant.\n\n??? tip \"Click here to find how to generate an application access token...\"\n    - Generate an application access token using the following command: \n      ```\n      curl -X POST \\\n      https://<IS_HOST>:9446/oauth2/token \\\n      --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n      -d 'grant_type=client_credentials&scope=accounts%20openid&client_assertion=eyJraWQiOiJEd01LZFdNbWo3UFdpbnZvcWZReVhWe\n      nlaNlEiLCJhbGciOiJQUzI1NiJ9.eyJzdWIiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OT\n      Q0Ni9vYXV0aDIvdG9rZW4iLCJpc3MiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiZXhwIjoxNjg0MDk5ODEyLCJpYXQiOjE2ODQwOTk4\n      MTMsImp0aSI6IjE2ODQwOTk4MTIifQ.EMZ2q3jciJ4MmrsH93kH_VGacrt2izbLaCBchGWiyUltdWwj3GwDMKfhpeMHtThd0DszwV8LUPKZaMT3wUS\n      oH3adY2IBC8aa2GKeb_vaQB5b0ZO6WpYQ45y_xIttAVj56d6oPli8wN4MlJoJsFPUlaxQohCLunN43BxSr-kFgeFMj7ynEsVbQvuYuEiTppwTSyXlt\n      Jmv70-nwpGU9UyuPCkXUsU53ShICrY0nC-3NUhY6oNpZclJP4MwG8mP4ZOvUIez_PSoP3AiaNithWhPCfLuKd68OLAReTBGdItqidsWWnn8lPVbM2F\n      LvehukHDCJhf9-ev1pdWIiwDSVDV7uQ&redirect_uri=www.wso2.com'\n      ```\n      - The request payload contains a client assertion in the following format:\n      ```\n      {\n      \"alg\": \"<<The algorithm used for signing>>\",\n      \"kid\": \"<<The KID value of the signing jwk set>>\",\n      \"typ\": \"JWT\"\n      }\n        \n      {\n      \"iss\": \"<<This is the issuer of the token. For example, client ID of your application>>\",\n      \"sub\": \"<<This is the subject identifier of the issuer. For example, client ID of your application>>\",\n      \"exp\": <<This is epoch time of the token expiration date/time>>,\n      \"iat\": <<This is epoch time of the token issuance date/time>>,\n      \"jti\": \"<<This is an incremental unique value>>\",\n      \"aud\": \"<<This is the audience that the ID token is intended for. For example, https://<APIM_HOST>:8243/token>>\"\n      }\n        \n      <signature: For DCR, the client assertion is signed by the private key of the signing certificate. Otherwise the private\n      signature of the application certificate is used.>\n      ```\n      - Upon successful token generation, you obtain a token as follows:\n      ```\n      {\n         \"access_token\":\"aa8ce78b-d81e-3385-81b1-a9fdd1e71daf\",\n         \"scope\":\"accounts payments  openid\",\n         \"id_token\":\"eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5HWXdZbU00WlRBM01XSTJOREF6WkdRek5HTTBaR1JsTmpKa09ERmtaRFJpT1RGa01XRmhNelUyWkdWbE5nX1JTMjU2IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiaHVBcS1GbzB0N2pFZmtiZ1A4TkJwdyIsImF1ZCI6WyJrYkxuSkpfdVFMMlllNjh1YUNSYlBJSk9SNFVhIiwiaHR0cDpcL1wvb3JnLndzbzIuYXBpbWd0XC9nYXRld2F5Il0sInN1YiI6ImFkbWluQHdzbzIuY29tQGNhcmJvbi5zdXBlciIsIm5iZiI6MTYwMTk5MzA5OCwiYXpwIjoia2JMbkpKX3VRTDJZZTY4dWFDUmJQSUpPUjRVYSIsImFtciI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwic2NvcGUiOlsiYW1fYXBwbGljYXRpb25fc2NvcGUiLCJvcGVuaWQiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo4MjQzXC90b2tlbiIsImV4cCI6MTYwMTk5NjY5OCwiaWF0IjoxNjAxOTkzMDk4fQ.cGdQ-9qK5JvKW32lK_PqhyJZyRb3r_86UPRFI2hlgiScnLYD8RsXDBNalmmnHiAbfb06e69QHQnmEKa6pcSSFWor0OAuzisBb6C5V51E9vH0eCr4hIa_lBtmjvLmsSue7puRUaYcyptwiuUkwjLFb-3_cpeuzWH29Knwne6zVD8gav_FPi1ub4vkrkX8ktLZH_JQG20fim1Ai5j2Q7jcnaMIHShYnC9sLBP5usp3thFLdQEyH8KCHJK79yNKzaruUntkq9yqqO_MQvY7VevLlDEDPllniRVih0r4TICdGrgJ0Ibr4wh_xFksVhYqa2_6x71ed_K9SX3hG-6T6pBUVA\",\n         \"token_type\":\"Bearer\",\n         \"expires_in\":3600\n      }\n      ```\n- A sample request to retrieve a consent looks as follows:\n```\ncurl GET \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- A sample response looks as follows:\n```\n{\n    \"Meta\": {\n        \"TotalPages\": 1\n    },\n    \"Risk\": {},\n    \"Links\": {\n        \"Self\": \"https://<IS_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID>\"\n    },\n    \"Data\": {\n        \"Status\": \"Authorised\",\n        \"StatusUpdateDateTime\": \"2020-10-07T12:46Z\",\n        \"CreationDateTime\": \"2020-10-07T09:29Z\",\n        \"TransactionToDateTime\": \"2020-10-09T10:28:49+05:30\",\n        \"ExpirationDateTime\": \"2020-10-11T10:28:49+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"41042513-fa45-4da8-93be-1513b3caffac\",\n        \"TransactionFromDateTime\": \"2020-10-06T10:28:49+05:30\"\n    }\n}\n```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0052_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports a GET endpoint for retrieving transaction details for a specific account, but not for a specific transaction ID within that account. The API specification defines an endpoint to retrieve all transactions for a given account, but it does not include a `transactionId` parameter in the path for filtering a single transaction. \\n\\n## Implementation Details\\n\\nThe `AccountService.java` in the `org.wso2.financial.services.accelerator.demo.backend` module contains a demo implementation for retrieving account transactions.  This `getAccountTransactions` method is annotated with `@GET` and `@Path(\"/accounts/{AccountId}/transactions\")`, indicating it handles GET requests to `/accounts/{AccountId}/transactions`.  It takes an `AccountId` as a path parameter and returns a hardcoded JSON response containing a list of transactions.  While the response includes a `TransactionId` field within the transaction objects,  the endpoint itself does not allow filtering by `transactionId` directly in the path. \\n\\n## API Endpoints and Features\\n\\nThe `account-info-swagger.yaml` file defines the API specification for Account and Transaction APIs.  It includes a GET endpoint for `/accounts/{AccountId}/transactions` to retrieve transactions for a specific account.  The `OBReadTransaction5` definition specifies the structure of a transaction object, which includes `AccountId` and `TransactionId`.  However, there is no defined path parameter for `transactionId` in the `/accounts/{AccountId}/transactions` endpoint. \\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, handles configuration for the accelerator.  While it supports various configurations related to consent management, identity server extensions, and event notifications,  there are no specific configuration options directly related to enabling or disabling a `/v1/accounts/{account-id}/transactions/{transactionId}` endpoint. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page mentions that the accelerator implements Open Banking APIs, including \"Account Information APIs\" which cover \"Transactions\". <cite repo=\"wso2/financial-services-accelerator\" path=\"financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml\" start=\"1-30\" end=\"1-30\" /> It also states that the \"Accounts\" category supports \"transaction history\". <cite repo=\"wso2/financial-services-accelerator\" path=\"financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml\" start=\"1-30\" end=\"1-30\" /> The `account-info-swagger.yaml` serves as the primary documentation for the API endpoints. <cite repo=\"wso2/financial-services-accelerator\" path=\"financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml\" start=\"1-60\" end=\"1-60\" />\\n\\n## Test Criteria\\n\\nIntegration tests in `EndToEndAccountFlowTest.groovy` verify the retrieval of account transactions.  The test `Verify Accounts transaction Retrieval Request for a Authorised Consent` makes a request to `ConnectorTestConstants.TRANSACTIONS_SINGLE_PATH` and asserts a 200 status code.  However, `TRANSACTIONS_SINGLE_PATH` refers to `/accounts/{AccountId}/transactions`, not `/accounts/{AccountId}/transactions/{transactionId}`.  \\n\\n## Conclusion\\n\\nThe repository supports a GET endpoint at `/v1/accounts/{account-id}/transactions` to read all transaction details for a given account.  However, it does not explicitly support a GET endpoint at `/v1/accounts/{account-id}/transactions/{transactionId}` to read details for a *specific* transaction using `transactionId` as a path parameter.  The existing implementation and API definition retrieve all transactions for an account, and then the client would need to filter by `transactionId` if needed. \\n\\n## Notes\\n\\nThe `account-info-swagger.yaml` file defines the API using Swagger 2.0.  The version of the API is `v3.1`.  The base path for the API is `/open-banking/{version}/aisp`.  Therefore, the full path for retrieving all transactions for an account would be `/open-banking/v3.1/aisp/accounts/{AccountId}/transactions`.   The prompt specifies `/v1/accounts/{account-id}/transactions/{transactionId}`, which differs in both the version and the inclusion of `transactionId` in the path. <cite/>\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_aa95acbc-9883-4846-9c88-95e50ac3e7a1\\n', 'id': 'lc_09988e85-ae28-4967-9550-07dfbdd9e327'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0053",
      "requirement": {
        "requirement_id": "ATOM_014",
        "requirement_text": "The API SHALL support multiple level SCA where a transaction needs authorisation by more than one PSU in a corporate context.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0053_1",
          "text": "ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify fraudulent activities. 7. **API Security** - API consumers invoke APIs to access customer\u2019s financial information. Therefore, API security plays a vital role in open banking to mitigate data theft. The solution has built-in support for global industry-standards such as OpenID Connect Financial Grade API (FAPI), OAuth 2.0, Electronic Identification and Trust Services (eIDAS). API security can be categorised into two main levels: - Application layer security - Validates API consumers against the certificates issued by competent authorities. For example: open banking directories, Qualified Trust Service Providers (QTSPs). Also, the solution supports OAuth2 security implementations such as Private key JWT authentication, client-credentials grant type, and authorization code grant type. - Transport layer security - Secures the communication between the API consumer, and the bank using Mutual Transport Layer Security (MTLS). 8. **User Experience** - The solution provides an enhanced user experience for the banks, API consumers, and customers with self-explanatory and simple actions. 9. **Premium APIs and Monetization** - Using the capabilities in WSO2 API Manager, WSO2 Open Banking Accelerator allows: - banks to publish highly-performant custom APIs for API consumers. - banks to expose their performance and compliance data by integrating into analytics engines. - banks to plug in any billing engines with subscription-based freemium, tiered pricing, or per-request pricing. 10. **Standards-based API Templates** - WSO2 API Manager offers standard API management capabilities, and you can customize the API templates according to your open banking and other requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_2",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_3",
          "text": "# Financial -grade API (FAPI) Security\n\nFinancial-grade API (FAPI), a specification that extends the OAuth and OIDC frameworks, \nwas introduced by the FAPI Working Group and defines additional technical requirements \nto secure APIs. Eventhough FAPI was initially defined for financial serivces, \nit is appropriate for any critical API whose security is the highest priority.\n\nFor Open Banking/ Open Finance use-cases,since robust API and data security is must,most of the immerging\ntechnical specifications for Open Banking/ Open Finance have been mandated **FAPI Security** for the \nexposing financial APIs such as ;\n - Open Banking UK\n - Consumer Data Standards (CDS), Australia\n - The Financial Data Exchange (FDX), USA\n\nThe following diagram illustrates how FAPI-compliant features combine to secure applications \n\n![fapi](../assets/img/learn/api-security/fapi.png)\n\nWSO2 Identity Server 7.0.0 onwards ,FAPI Security is supported from the base product itself and \nfor more information on configuring the FAPI features,please visit WSO2 IS Documentation on \n[FAPI](https://is.docs.wso2.com/en/latest/references/financial-grade-api/)\n\n\nWSO2 Open Banking Accelerators have been certified as a OpenID FAPI1-Advanced OpenID Provider as in https://openid.net/certification/",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_4",
          "text": "## Open banking / Open Finance regulations Open banking and Open Finance regulations provide a policy and legislative framework to help banks and API consumers deliver the benefits of open banking. - The **newest** regulation of Open Finance is the finalized **section 1033 rule from Consumer Financial Protection Bureau (CFPB) of the United States**.It requires financial institutions to make available to consumers the information they have about their financial products and services, upon request. - The first known open banking regulation is the **Payment Service Directive** in Europe. Administered by the European Commission (Directorate General Internal Market) regulates payment services and payment service providers throughout the European Union and European Economic Area (EEA). PSD1 came into force in 2007 followed by the PSD2 in 2015. - The Competition and Market Authority formed the **Open Banking Implementation Entity** in the UK. The Open Banking Implementation Entity adopted the PSD2 and issued its first version of the open banking standard in 2017. It specified how banks should allow an API consumer to access customer\u2019s information and request payments with the customer\u2019s consent. - The Berlin Group consists of almost 40 banks, associations and Payment Service Providers across the European Union. They have defined a common API standard called NextGenPSD2 for the use cases specified in PSD2. Based on the PSD2 and European Banking Authority - Regulatory Technical Standards (RTS) requirements, the Berlin Group has worked on detailed Access to Account (XS2A) Framework including implementation details for open banking named as **NextGenPSD2XS2A**.Now this has been expanded to Open Finance with the introduction of **Berlin Group openFinance API framework** - **Consumer Data Right** in Australia is a right provided by law under the Treasury Laws Amendment (Consumer Data Right) Act in 2019 to give Australians greater control over their data. It empowers consumers to choose to share their data with API consumers only for the purposes that they have authorized. - **Fintech law** in Mexico promotes data sharing as well as transparency among banks and subholding companies (example: broker-dealers, money exchangers, credit unions, popular, and community financial entities). The Fintech law defines guidelines for the regulated entities on the types of information and how to share them. Comisi\u00f3n Nacional Bancaria y de Valores, The Embassy of the United Kingdom, the FinTech Hub, C Minds, ODI and the Government of the Republic are involved in the regulation. - The Hong Kong Monetary Authority (HKMA) published the **Open API Framework** in 2018 to provide a secure, controlled, and convenient operating environment to financial institutions and third parties. It expects the banks and third parties to work together and build innovative banking services offering a better customer experience. The framework has a phased approach. - The Monetary Authority of Singapore (MAS) provided a legal framework for open banking in 2018. MAS introduced [APIX](https://www.mas.gov.sg/development/fintech/api-exchange) for the banks to open up their data and services encouraging openness among both the financial institutions and the API consumers. - Following the footsteps of the UK and Australia, New Zealand issued a government backed pilot plan in 2018 to design and develop open banking",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_5",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase, there is no direct evidence or explicit mention of support for \"multiple level SCA where a transaction needs authorisation by more than one PSU in a corporate context\" <cite/>. The codebase primarily focuses on Identity and Access Management (IAM) functionalities, including OAuth2/OpenID Connect, SAML, user management, and organization management . While there are features related to authorization and organization management, the specific requirement of multi-PSU authorization for transactions is not directly addressed in the provided snippets  .\\n\\n## Implementation Details\\nThe codebase includes modules for API resources and organization management  . For instance, `org.wso2.carbon.identity.api.server.organization.management.v1` and `org.wso2.carbon.identity.api.server.organization.role.management.v1` are present, indicating capabilities for managing organizations and their roles  . However, these do not explicitly detail multi-level SCA for transactions. The `APIResourceResponse.java` file contains `authorizationDetailsTypes`, which might be related to authorization details, but its specific use for multi-PSU authorization is not clear from the snippet .\\n\\n## Configuration Options\\nThe configuration system supports various settings, including security and identity configurations . The `identity-mgt-listener-enabled.xml` and `identity-original-530-cache-disabled.xml` files show configurations related to OAuth, multi-factor authentication, and resource access control  . While MFA is mentioned, it\\'s not directly linked to multi-PSU authorization for transactions .\\n\\n## API Endpoints or Features\\nThe WSO2 Identity Server provides REST APIs for both administrative and end-user operations . The `OrgMgtRestClient.java` includes methods for authorizing APIs for B2B applications and managing organizations . The `organization-self-service-apis.json` defines API paths and associated permissions for organization management, such as `/api/server/v1/organizations` and `/o/scim2/Users`  . However, none of these explicitly describe an API for multi-level SCA with multiple PSUs.\\n\\n## Documentation References\\nThe provided context includes an \"Overview\" wiki page that describes WSO2 Identity Server\\'s capabilities, including OAuth 2.0/OpenID Connect and role-based authorization . It also mentions \"Workflow Management\" for \"User Approval\" . This \"User Approval\" feature might be a candidate for implementing multi-PSU authorization, but the details are not available in the provided snippets .\\n\\n## Notes\\nThe prompt specifically asks about \"multiple level SCA where a transaction needs authorisation by more than one PSU in a corporate context\" <cite/>. While the codebase has strong support for OAuth2/OIDC, organization management, and general authorization, there is no explicit mention or detailed implementation of a multi-level Strong Customer Authentication (SCA) process involving multiple Payment Service Users (PSUs) for a single transaction <cite/>. The \"User Approval\" mentioned in the wiki could potentially be extended or configured to meet this requirement, but the current snippets do not provide enough information to confirm this . Further investigation into the \"Workflow Management\" and \"Adaptive Authentication\" features would be necessary to determine if such a capability exists or can be built using the existing framework .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_18411e8f-c9c0-4026-8cc6-9e1f581b82da\\n', 'id': 'lc_c7bf4680-17e6-4c9d-bcc9-aa1381d38e21'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0053_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_f9c9c26f-b3ee-45b2-abb7-23cf1b6ebf07'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0054",
      "requirement": {
        "requirement_id": "ATOM_086",
        "requirement_text": "ASPSP must provide confirmation code as query parameter when requesting transaction authorization confirmation",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0054_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_3",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_4",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_5",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0054_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, the WSO2 Financial Services Accelerator, does not explicitly support the requirement for an ASPSP (Account Servicing Payment Service Provider) to provide a `confirmationCode` as a query parameter when requesting transaction authorization confirmation. The provided OpenAPI specifications for Payments and Confirmation of Funds APIs do not include a `confirmationCode` as a query parameter in any of their defined endpoints. \\n\\n## Implementation Details and API Endpoints\\n\\nThe `financial-services-accelerator` repository provides OpenAPI specifications for various financial services, including Payment Initiation and Confirmation of Funds. \\n\\n### Payment Initiation API\\nThe Payment Initiation API defines endpoints such as `/payment-consents/{consentId}` for getting payment consents and `/payment-consents/{consentId}/funds-confirmation` for funds confirmation related to a payment consent.  The parameters for these endpoints primarily include `consentId`, `x-fapi-auth-date`, `x-fapi-customer-ip-address`, `x-fapi-interaction-id`, and `authorization`.  There is no `confirmationCode` query parameter defined in these specifications. \\n\\n### Confirmation of Funds API\\nSimilarly, the Confirmation of Funds API includes endpoints like `/funds-confirmation-consents` for creating funds confirmation consents and `/funds-confirmation-consents/{consentId}` for retrieving a specific consent.  The parameters for these operations also do not include a `confirmationCode` query parameter. \\n\\n## Configuration Options\\nThe `financial-services-accelerator` uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class.  While this configuration supports various aspects like consent management and identity server extensions, there is no explicit configuration option mentioned for enabling or requiring a `confirmationCode` as a query parameter for transaction authorization confirmation. \\n\\n## Documentation References\\nThe provided wiki page \"Overview\" describes the WSO2 Financial Services Accelerator as a solution for Open Banking capabilities, including consent management, secure API access, and TPP onboarding.  It mentions support for account information services, payment initiation, and confirmation of funds.  However, it does not contain any specific documentation or mention of a `confirmationCode` being used as a query parameter for transaction authorization confirmation. \\n\\n## Notes\\nThe prompt specifically asks about a `confirmationCode` as a *query parameter*. The OpenAPI specifications define various parameters, but none are named `confirmationCode` and none are explicitly marked as query parameters for transaction authorization confirmation.  The `consentId` parameter is a path parameter used to identify consents, which is a different concept from a `confirmationCode` for authorization. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_7fe3a186-61dc-4a14-91d2-ab2ba7cbc512\\n', 'id': 'lc_881b3b0b-4bb7-4693-90af-d8c91e239163'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0055",
      "requirement": {
        "requirement_id": "ATOM_046",
        "requirement_text": "When an OAuth2 token is invalid, the system shall return an HTTP 401 Unauthorized response with Content-Type application/problem+json",
        "strength": "SHALL",
        "capability": "Error Handling",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0055_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports returning an HTTP 401 Unauthorized response when an OAuth2 token is invalid. However, the provided context does not explicitly confirm that the `Content-Type` header will be `application/problem+json` in all such cases. The integration tests primarily assert the HTTP status code and the error description in the JSON response body.\\n\\n### Implementation Details\\n\\nThe WSO2 Identity Server\\'s OAuth2 implementation handles invalid tokens by returning an HTTP 401 Unauthorized status code. This behavior is demonstrated across various scenarios in the integration tests:\\n\\n*   **Invalid Client Credentials**: When client credentials (client ID or client secret) are invalid during a token request, the system returns an HTTP 401 status code. For example, in `OAuth2ServiceClientCredentialTestCase.java`, tests like `testGetTokenUsingCCGrantWithInvalidClientId()`  and `testGetTokenUsingCCGrantWithInvalidClientCredentials()`  explicitly assert that the `errorObject.getHTTPStatusCode()` is `HttpStatus.SC_UNAUTHORIZED` (401). The error code is typically `invalid_client` .\\n*   **Expired DPoP Proof**: If a DPoP (Demonstrating Proof of Possession) access token request includes an expired DPoP proof, the system returns an HTTP 401. The `getDPoPTokenWithExpiredDPoPProof()` test in `OAuth2DPopTestCase.java`  verifies that an error is present in the JSON response. Similarly, `accessResourceWithDPoPTokenFromClientCredentialsWithDifferentThumbprint()`  asserts a 401 status code when accessing a resource with an invalid DPoP token.\\n*   **Invalid Access Token for UserInfo Endpoint**: When an invalid access token is used to request user information, the `OpenIdUserInfoTestCase.java`  test `testUserInfoPostWithInvalidToken()` expects an `error` of `invalid_token` and an `error_description` of \"Access token validation failed\". While it doesn\\'t explicitly check the HTTP status code in the assertion, the nature of the error implies an unauthorized response.\\n*   **Invalid Client ID in Device Flow**: In the OAuth2 Device Flow, attempting a token request with an invalid client ID results in an `invalid_client` error and an HTTP 401 status code. This is tested in `OAuth2DeviceFlowTestCase.java` .\\n*   **Invalid Client ID in Pushed Authorization Requests (PAR)**: Sending a PAR with an invalid client ID also leads to an HTTP 401 Unauthorized response with an `invalid_client` error, as shown in `OAuth2PushedAuthRequestTestCase.java` .\\n*   **Invalid Client Credentials in Token Revocation**: If a token revocation request is made with invalid client authentication credentials, an HTTP 401 is returned. This is verified in `OAuth2TokenRevocationWithRevokedAccessToken.java` .\\n*   **Unauthorized Access to Management APIs**: For various management APIs, such as those for organization management, an invalid OAuth2 token (referred to as `invalidM2MToken`) consistently results in an HTTP 401 Unauthorized response. This is evident in `OrganizationManagementFailureTest.java` across multiple tests like `testAddDiscoveryConfigUnauthorized()` , `testGetDiscoveryConfigUnauthorized()` , and others      .\\n\\nThe system consistently returns a JSON object in the response body containing `error` and `error_description` fields for these unauthorized scenarios. However, the provided code snippets do not explicitly assert the `Content-Type` header to be `application/problem+json`. They primarily focus on the HTTP status code and the content of the JSON response body.\\n\\n### Configuration Options\\n\\nThe provided context does not detail specific configuration options to enable or disable the `application/problem+json` content type for error responses. The behavior of returning HTTP 401 with a JSON body containing error details appears to be a default implementation for OAuth2-related error handling.\\n\\n### API Endpoints or Features\\n\\nThe following API endpoints and features are relevant to invalid OAuth2 token handling:\\n\\n*   **Token Endpoint (`/oauth2/token`)**: Used for obtaining access tokens. Invalid client credentials or grant types will result in a 401 response.  \\n*   **User Info Endpoint (`/oauth2/userinfo`)**: Used to retrieve user claims. An invalid access token will lead to an error response. \\n*   **Revocation Endpoint (`/oauth2/revoke`)**: Used to revoke tokens. Invalid client credentials during a revocation request will result in a 401. \\n*   **Pushed Authorization Request (PAR) Endpoint (`/oauth2/par`)**: Used to push authorization request parameters. Invalid client IDs will result in a 401. \\n*   **Device Authorization Endpoint (`/oauth2/device_authorize`)**: Used in the device flow. Invalid client IDs will result in an error response. \\n*   **SCIM2 Endpoints**: Accessing SCIM2 endpoints with an invalid DPoP token also results in a 401. \\n*   **Organization Management APIs**: These APIs, such as those for discovery configuration, consistently return HTTP 401 for unauthorized access attempts using invalid OAuth2 tokens. \\n\\n### Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" /> provides a high-level overview of OAuth2 and OIDC implementation, including supported grant types, token management, and system architecture. It mentions \"Token Service\" and \"Authorization Service\" as core components responsible for handling tokens and authorization <cite repo=\"wso2/product-is\" path=\"wiki_page\" start=\"3.1\" end=\"3.1\" />. While it describes token types and revocation, it does not delve into the specific error response formats like `application/problem+json`.\\n\\nThe `scim2.yaml` file, which defines the OpenAPI specification for SCIM2 APIs, includes a `401` response definition with a schema reference to `#/definitions/ErrorUnauthorized` . This indicates that for SCIM2 APIs, an unauthorized response is expected to conform to a defined error structure, which is typically JSON. However, it does not explicitly specify `application/problem+json` as the `Content-Type`.\\n\\n## Notes\\n\\nThe provided integration tests confirm that the system returns an HTTP 401 Unauthorized status code for various invalid OAuth2 token scenarios. The response body typically contains a JSON object with `error` and `error_description` fields. However, none of the provided snippets explicitly assert the `Content-Type` header to be `application/problem+json`. To fully meet the \"SHALL\" requirement, further investigation into the actual HTTP response headers for these error scenarios would be necessary. The existing tests focus on the status code and the presence/content of error messages within the response body.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_7af52ee5-015d-4c42-88f9-b9c7c9aa7ec4\\n', 'id': 'lc_6e3b571f-0236-4045-891b-1d98add5a2ab'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0055_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support returning an HTTP 401 Unauthorized response when an OAuth2 token is invalid. However, the `Content-Type` header is specified as `application/json` in the OpenAPI definitions and not `application/problem+json` as requested.\\n\\n### Implementation Details\\nThe OpenAPI specification files, such as `all-in-one-apim/modules/integration/tests-common/clients/service-catalog/api/openapi.yaml`  and `all-in-one-apim/modules/integration/tests-common/clients/store/api/openapi.yaml` , define a `401` HTTP status code response with a `content` type of `application/json`. This response includes an `Error` schema with `code`, `message`, `description`, `moreInfo`, and `error` fields. For example, the `service-catalog` OpenAPI definition shows:\\n```yaml\\n        \"401\":\\n          content:\\n            application/json:\\n              example:\\n                code: 401\\n                message: Unauthorized\\n                description: The user is not authorized\\n                moreInfo: \"\"\\n                error: []\\n              schema:\\n                $ref: \\'#/components/schemas/Error\\'\\n          description: Unauthorized. The user is not authorized.\\n``` \\nThis indicates that the system is designed to return a 401 status with a JSON body, but not specifically `application/problem+json`.\\n\\nThe `api_product_template.xml` file also shows a scenario where a `401` status code is set for certain authorization failures, specifically when an incorrect key type is provided for a gateway environment . In this case, the `ContentType` is set to `application/xml` .\\n\\n### Configuration Options\\nThe `ApiClient.mustache` file contains a `getTokenEndPoint()` method within a `{{#hasOAuthMethods}}` block, suggesting that OAuth methods and token endpoints are configurable . This method iterates through `authentications` to find an instance of `RetryingOAuth` and returns its `TokenRequestBuilder`. This implies that the OAuth token handling mechanism can be configured.\\n\\n### API Endpoints or Features\\nSeveral API client documentation files, such as `CommentsApi.md`  and `ServicesApi.md` , demonstrate how to configure OAuth2 access tokens for authorization using `OAuth2Security.setAccessToken(\"YOUR ACCESS TOKEN\")`. These documents also list `401 Unauthorized` as a possible HTTP response detail for various API operations .\\n\\n### Documentation References\\nThe `README.md` for the `service-catalog` client provides instructions on obtaining an access token via a `curl` command to the `/oauth2/token` endpoint . It also shows a sample successful response with an `access_token` .\\n\\n### Test Criteria\\nThe `APISecurityTestCase.java` file contains integration tests that verify the system\\'s behavior with invalid OAuth2 tokens. For instance, `testAPIInvocationWithMutualSSLWithOauthMandatoryNegative3()`  sends a request with a randomly generated UUID as an OAuth2 token and asserts that the response code is `HttpStatus.SC_UNAUTHORIZED` (401) . Similarly, `testInvokeBearerTokenForBasicNegative()`  tests invoking a BasicAuth API with a Bearer token and expects a 401 response . These tests confirm that the system returns a 401 status for invalid OAuth2 tokens. However, these tests do not explicitly verify the `Content-Type` header of the 401 response.\\n\\n## Notes\\nWhile the repository clearly supports returning an HTTP 401 Unauthorized response for invalid OAuth2 tokens, the OpenAPI definitions consistently specify `application/json` as the `Content-Type` for these error responses, not `application/problem+json`. The integration tests confirm the 401 status code but do not assert the `Content-Type` header. Therefore, based on the provided snippets, the system does not appear to explicitly support `application/problem+json` for 401 responses.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_30f67b60-557e-45c4-9f8d-6238953e5b4e\\n', 'id': 'lc_992bb6b6-6010-4140-862a-fb2548da86d3'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0056",
      "requirement": {
        "requirement_id": "ATOM_065",
        "requirement_text": "The system shall provide SCA process status information through scaStatus data element in GET SCA Status Response Message for payment initiation",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0056_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0056_2",
          "text": "backendTime)`|`142`| In addition to the above-mentioned data elements, you can publish data that are specific to your open banking standard. For information on the additional data elements that you can publish, see [Data Publishing Extensions](../develop/authentication-flow-for-data-publishing.md). WSO2 Open Banking Accelerator has by default enabled data publishing in API gateway and authentication components. Additionally, you can publish any streams using a custom component. For more information, see [Custom Data Publishing](../develop/custom-data-publishing.md). ###Data Summarization You can write a summarization script for the data stored using Siddhi Applications. For more information, see the WSO2 Streaming Integrator documentation on [Summarizing Data](https://ei.docs.wso2.com/en/latest/streaming-integrator/guides/summarizing-data/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0056_3",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0056_4",
          "text": "## Open banking / Open Finance regulations Open banking and Open Finance regulations provide a policy and legislative framework to help banks and API consumers deliver the benefits of open banking. - The **newest** regulation of Open Finance is the finalized **section 1033 rule from Consumer Financial Protection Bureau (CFPB) of the United States**.It requires financial institutions to make available to consumers the information they have about their financial products and services, upon request. - The first known open banking regulation is the **Payment Service Directive** in Europe. Administered by the European Commission (Directorate General Internal Market) regulates payment services and payment service providers throughout the European Union and European Economic Area (EEA). PSD1 came into force in 2007 followed by the PSD2 in 2015. - The Competition and Market Authority formed the **Open Banking Implementation Entity** in the UK. The Open Banking Implementation Entity adopted the PSD2 and issued its first version of the open banking standard in 2017. It specified how banks should allow an API consumer to access customer\u2019s information and request payments with the customer\u2019s consent. - The Berlin Group consists of almost 40 banks, associations and Payment Service Providers across the European Union. They have defined a common API standard called NextGenPSD2 for the use cases specified in PSD2. Based on the PSD2 and European Banking Authority - Regulatory Technical Standards (RTS) requirements, the Berlin Group has worked on detailed Access to Account (XS2A) Framework including implementation details for open banking named as **NextGenPSD2XS2A**.Now this has been expanded to Open Finance with the introduction of **Berlin Group openFinance API framework** - **Consumer Data Right** in Australia is a right provided by law under the Treasury Laws Amendment (Consumer Data Right) Act in 2019 to give Australians greater control over their data. It empowers consumers to choose to share their data with API consumers only for the purposes that they have authorized. - **Fintech law** in Mexico promotes data sharing as well as transparency among banks and subholding companies (example: broker-dealers, money exchangers, credit unions, popular, and community financial entities). The Fintech law defines guidelines for the regulated entities on the types of information and how to share them. Comisi\u00f3n Nacional Bancaria y de Valores, The Embassy of the United Kingdom, the FinTech Hub, C Minds, ODI and the Government of the Republic are involved in the regulation. - The Hong Kong Monetary Authority (HKMA) published the **Open API Framework** in 2018 to provide a secure, controlled, and convenient operating environment to financial institutions and third parties. It expects the banks and third parties to work together and build innovative banking services offering a better customer experience. The framework has a phased approach. - The Monetary Authority of Singapore (MAS) provided a legal framework for open banking in 2018. MAS introduced [APIX](https://www.mas.gov.sg/development/fintech/api-exchange) for the banks to open up their data and services encouraging openness among both the financial institutions and the API consumers. - Following the footsteps of the UK and Australia, New Zealand issued a government backed pilot plan in 2018 to design and develop open banking",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0056_5",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n```\ncurl --location --request POST 'https://localhost:8243/open-banking/v3.1/aisp/account-access-consents' \\\n--header 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n--header 'x-fapi-financial-id: open-bank' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n    \"Data\": {\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\"\n    },\n    \"Risk\": {\n        \n    }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"StatusUpdateDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\",\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"a34c8608-dbd2-4997-aad7-398a5b31cbe6\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0056_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the provision of SCA process status information through an `scaStatus` data element in a GET SCA Status Response Message for payment initiation. The provided code snippets do not contain any explicit references to \"SCA\", \"Strong Customer Authentication\", \"payment initiation\", or an `scaStatus` field in API responses related to such a process. <cite/>\\n\\nThe snippets primarily deal with:\\n*   Configuration of OIDC FAPI conformance tests, including hybrid flow settings and advanced authentication configurations .\\n*   Integration tests for OAuth2 federated token sharing .\\n*   Configuration tests for SCIM and impersonation settings .\\n*   SCIM2 pagination and schema validation tests  .\\n\\nNone of these directly relate to the specific requirement of providing `scaStatus` for payment initiation. <cite/>\\n\\n## Notes\\nThe term \"SCA\" (Strong Customer Authentication) is a specific regulatory requirement, particularly in the European Union under PSD2, related to payment services. <cite/> While the `wso2/product-is` repository is an Identity Server and might be involved in authentication flows, the provided snippets do not indicate direct support for the `scaStatus` data element in the context of payment initiation as described. <cite/> It\\'s possible that such functionality exists elsewhere in the codebase or is handled by an external service that integrates with this product, but it is not visible in the provided context. <cite/>\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_a36dcf43-31aa-4719-b110-1527b8cd5397\\n', 'id': 'lc_a6a3efb7-8d44-4eae-b389-7fa0ab526c02'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0056_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_5359f834-ffad-4c89-885d-292cd1da3232'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0057",
      "requirement": {
        "requirement_id": "ATOM_113",
        "requirement_text": "The fundsAvailable field SHALL be included when ASPSP supports funds check, funds check has been performed, and transactionStatus is ACTC, ACWC or ACCP",
        "strength": "SHALL",
        "capability": "Funds Confirmation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0057_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the `fundsAvailable` field or the specific conditions related to ASPSP funds checks and transaction statuses (ACTC, ACWC, ACCP) as described in your query. The provided code snippets and wiki page primarily concern the API Layer, application management, organization management, and general configuration within the WSO2 Identity Server. There is no explicit mention or implementation of financial transaction processing, funds checks, or related fields like `fundsAvailable` within the context provided.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nBased on the provided context, there are no implementation details, configuration options, or API endpoints that directly relate to a `fundsAvailable` field or the specified financial transaction statuses       . The `wso2/product-is` repository focuses on identity and access management functionalities, such as application management, user management, and API infrastructure .\\n\\n## Documentation References\\n\\nThe provided wiki page \"API Layer\" describes the architecture and functionality of the REST APIs within WSO2 Identity Server . However, it does not contain any documentation references for financial transaction-related fields or processes like `fundsAvailable` .\\n\\n## Notes\\n\\nThe user\\'s query seems to be related to financial services or open banking APIs, which are not covered by the provided codebase context for `wso2/product-is`. The snippets primarily deal with identity and access management, application configuration, and API infrastructure. Therefore, I cannot confirm support for the `fundsAvailable` field or the specified conditions within this repository.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e70c6dcb-4de4-4340-b35e-e6bf6f0fc12c\\n', 'id': 'lc_c90360fa-44c9-401f-86cd-57ba06fa76cf'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0057_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, WSO2 API Manager, does not appear to directly support the `fundsAvailable` field or the specific conditions related to ASPSP funds checks and transaction statuses like ACTC, ACWC, or ACCP. The codebase primarily focuses on API management functionalities such as request/response processing, security enforcement, and rate limiting .\\n\\n### Implementation Details, Configuration Options, and API Endpoints\\n\\nThe provided snippets do not contain any direct implementation details, configuration options, or API endpoints related to a `fundsAvailable` field, ASPSP (Account Servicing Payment Service Provider) funds checks, or the transaction statuses ACTC, ACWC, or ACCP  .\\n\\nThe `StarbucksOutletServiceImpl.java` file contains a `doPayment` method that checks for \"Insufficient Funds\" . However, this appears to be a simplified example within an integration test backend service for a coffee sample application . It does not reflect a general `fundsAvailable` field tied to ASPSP checks or specific transaction statuses as described in your query . The `PaymentStatus` object in this example can return \"Insufficient Funds\" , but this is a local check within the sample service and not an external ASPSP integration .\\n\\n### Documentation References\\n\\nThe provided documentation references, such as `README.txt`  and `admin_guide.xml` , discuss general product information, installation, and administration of WSO2 API Manager  . They do not contain any specific information about a `fundsAvailable` field, ASPSP funds checks, or the mentioned transaction statuses  . The `Overview` wiki page also describes the high-level architecture and components of WSO2 API Manager, none of which directly relate to the specific financial transaction details you are asking about .\\n\\n## Notes\\n\\nThe query seems to be related to Open Banking or PSD2 compliance, which often involves specific fields like `fundsAvailable` and transaction statuses (ACTC, ACWC, ACCP) for ASPSP interactions. While WSO2 API Manager is an API management platform that could potentially be used to expose such APIs, the provided codebase snippets do not indicate that these specific functionalities are implemented within this repository itself. The `StarbucksOutletServiceImpl.java` file is part of an integration test and serves as a basic example of a backend service, not a core financial transaction processing component .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-apim)](/wiki/wso2/product-apim#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6abefeb1-41d0-47b7-bcf1-28125368168e\\n', 'id': 'lc_579d3ab0-dd29-46d0-9fa6-133ae24e22f9'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0058",
      "requirement": {
        "requirement_id": "ATOM_203",
        "requirement_text": "TPP MUST check whether the state parameter is linked to the current session when retrieving GET command from PSU browser.",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0058_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_2",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_3",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_4",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_5",
          "text": "### Step 2: Sign in to the Developer Portal as the TPP\n\n1. Now, sign in to the [Developer portal](https://<APIM_HOST>:9443/devportal) as the TPP.\n\n2. Enter the username and the password you entered when signing up as a TPP.\n\n3. Click Continue. Now, you are on the home page of the Developer Portal.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, appears to support the validation of the OAuth 2.0 `state` parameter to ensure it's linked to the current session during authorization code grant flows. This is primarily demonstrated through integration tests that extract and assert the presence of a `sessionDataKey` or `state` parameter in authorization responses, which is then used in subsequent requests to maintain session integrity.\\n\\n### Implementation Details\\nThe WSO2 Identity Server's OAuth2 and OpenID Connect implementation, as described in the wiki , includes mechanisms for handling the `state` parameter. The `state` parameter is used to maintain the state between the authorization request and the callback, preventing cross-site request forgery (CSRF) attacks.\\n\\nIn the integration tests, after sending an authorization request, the system extracts a `sessionDataKey` from the `location` header of the HTTP response . This `sessionDataKey` is then asserted to be non-null, indicating that a session-bound value is being tracked . Similarly, in federated authentication scenarios, the `state` parameter is included in the authorization request and subsequently extracted and asserted from the response  .\\n\\nThe `sessionDataKey` is extracted from the `location` header of the HTTP response using the `DataExtractUtil.getParamFromURIString` method . This key is crucial for maintaining the session state across redirects during the OAuth 2.0 authorization flow.\\n\\n### API Endpoints or Features\\nThe primary API endpoint involved in this process is the OAuth2 `AUTHORIZE_ENDPOINT_URL` . When a TPP (Third-Party Provider) initiates an authorization request, it sends a GET command to this endpoint, including the `state` parameter. The WSO2 Identity Server then processes this request and, upon successful authentication and consent, redirects the user back to the TPP's `redirect_uri` with an authorization code and the original `state` parameter.\\n\\nThe `OAuth2Constant.OAUTH2_RESPONSE_TYPE` and `OAuth2Constant.OAUTH2_GRANT_TYPE_CODE` are used to specify the authorization code grant type . The `OAuth2Constant.OAUTH2_CLIENT_ID` and `OAuth2Constant.OAUTH2_REDIRECT_URI` are also essential parameters in the authorization request .\\n\\n### Test Criteria\\nThe integration tests explicitly verify that the `sessionDataKey` is present in the authorization response, which serves as a session-bound value. For example, in `OIDCAuthzCodeIdTokenValidationTestCase.java`, after sending an authorization request, the test asserts that the `locationValue` contains `OAuth2Constant.SESSION_DATA_KEY` . This `sessionDataKey` is then extracted and checked for nullability . This process ensures that the `state` parameter (or its equivalent `sessionDataKey` in this context) is validated against a session-bound value before further processing.\\n\\nSimilar validation logic is observed in other test cases, such as `OAuth2DPopTestCase.java`  and `OIDCAuthCodeGrantSSOTestCase.java` , where `sessionDataKey` is extracted and validated from the authorization response. In federated scenarios, the `state` parameter itself is extracted and validated .\\n\\n### Configuration Options\\nWhile specific configuration options for explicitly enabling or disabling `state` parameter validation are not directly visible in the provided snippets, the presence of extensive integration tests implies that this validation is a core, non-configurable security feature of the WSO2 Identity Server's OAuth2/OIDC implementation. The system is designed to handle and validate the `state` parameter as part of its standard OAuth2 authorization code flow.\\n\\n## Notes\\nThe provided code snippets are primarily integration tests, which demonstrate the expected behavior of the system rather than the direct implementation of the `state` parameter validation logic. However, the consistent extraction and assertion of `sessionDataKey` and `state` parameters in these tests strongly indicate that the underlying WSO2 Identity Server implementation performs the necessary validation to link the `state` parameter to the current session. The `sessionDataKey` acts as an internal representation of the session state, which is then implicitly linked to the `state` parameter provided by the TPP.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3f04e205-c64f-4cdf-b6ee-3eb7c5bdfd88\\n\", 'id': 'lc_e2587112-3eae-40f6-8769-c1e9554d18eb'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0058_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_9e334b2b-5b79-4595-8bb3-334a6295ac64'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0059",
      "requirement": {
        "requirement_id": "ATOM_093",
        "requirement_text": "PSU must authenticate with first factor before account or SCA method details are available to PISP in embedded SCA approach",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0059_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_2",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_3",
          "text": "## Configuring a custom Push Authenticator  \n\n1. Once implemented, build a JAR file for your project.\n2. Place the above-created JAR file in the `<IS_HOME>/repository/components/dropins` directory.\n3. Open the `<IS_HOME>/repository/conf/deployment.toml` file and configure your custom authenticator using the Fully \nQualified Name (FQN):\n\n      ``` toml\n      [open_banking.sca.idp]\n      name = \"CIBA-Push-Auth\"\n      ```\n    \n4. Save the configurations and restart the Identity Server.\n5. Follow the [Set up CIBA flow](../learn/ciba-set-up-flow.md#configuring-authenticator) documentation and try out the \nflow.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_4",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_5",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, supports multi-factor authentication (MFA) and conditional authentication, which can be configured to enforce a first-factor authentication before revealing sensitive information. The system allows for flexible authentication flows, including the use of local authenticators like `BasicAuthenticator` for username/password authentication.  This capability can be leveraged to meet the requirement of a PSU authenticating with a first factor before account or SCA method details are available to a PISP in an embedded SCA approach. \\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server uses an adaptive authentication engine that allows defining authentication steps and conditions through JavaScript-based scripts.  This enables the system to enforce a first-factor authentication step (e.g., username and password) before proceeding to subsequent steps that might involve revealing sensitive information or initiating a Strong Customer Authentication (SCA) method. \\n\\nFor instance, the `onLoginRequest` function within an authentication script can define the sequence of authentication steps.  A common first step is `BasicAuthenticator`, which handles username and password authentication.  After successful completion of the first step, the script can then conditionally trigger further authentication steps or actions. \\n\\nThe `ChallengeQuestionPostAuthnHandlerTestCase.java` demonstrates how post-authentication handlers can be used to enforce additional steps, such as challenge questions, based on configuration.  While this specific test case focuses on challenge questions, the underlying mechanism of conditional execution after initial authentication is relevant. \\n\\n## Configuration Options\\n\\nTo implement the described requirement, you would configure the service provider\\'s local and outbound authentication configuration. \\n\\n1.  **Authentication Steps**: Define at least two authentication steps. The first step would typically involve a local authenticator like `BasicAuthenticator` for username/password. \\n2.  **Authentication Script**: Utilize an `AuthenticationScript` to control the flow.  This script can check if the first factor is complete and then decide whether to proceed or to prompt for additional SCA methods. \\n3.  **Conditional Authentication**: The wiki page on \"SAML and Identity Federation\" explicitly mentions support for conditional authentication, allowing dynamic authentication flows based on various factors.  This feature is crucial for implementing the \"first factor before SCA details\" requirement. \\n\\n## API Endpoints or Features\\n\\nThe core functionality for authentication and adaptive flows is exposed through the WSO2 Identity Server\\'s authentication framework. While specific API endpoints for directly controlling the \"embedded SCA\" flow are not explicitly detailed in the provided snippets, the system\\'s architecture suggests that authentication requests would be directed to a common authentication endpoint.  The `COMMON_AUTH_URL` is used in test cases for sending authentication requests and consent messages. \\n\\nThe `OAuth2DPopTestCase.java` and `Oauth2ImpersonationTestCase.java` demonstrate interactions with OAuth2 endpoints like `AUTHORIZE_ENDPOINT_URL` and `ACCESS_TOKEN_ENDPOINT` for various grant types.   These endpoints would be part of the overall flow where the first-factor authentication is performed. \\n\\n## Documentation References\\n\\nThe \"SAML and Identity Federation\" wiki page provides a comprehensive overview of SAML and identity federation capabilities, including SAML SSO configuration and flows.  It also mentions conditional authentication as an advanced SAML feature.  For more detailed documentation on adaptive authentication and configuring authentication steps, you would typically refer to the official WSO2 Identity Server documentation, which is linked in the `README.md` file. \\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests and configuration files. While they demonstrate the capabilities of WSO2 Identity Server, they do not constitute end-user documentation. The `README.md` file points to the official WSO2 Identity Server website and documentation for more information.  The concept of \"embedded SCA approach\" is not explicitly mentioned in the provided context, but the adaptive authentication features of WSO2 Identity Server are flexible enough to implement such a requirement.  The `pom.xml` lists various local authenticators, including `basicauth`, `fido`, and `fido2`, indicating a wide range of first and second factor authentication methods available. \\n\\nWiki pages you might want to explore:\\n- [SAML and Identity Federation (wso2/product-is)](/wiki/wso2/product-is#3.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_3ea15e21-ae6f-403e-97e9-e6ee2cd66517\\n', 'id': 'lc_9802b5e3-1ea1-4bc2-859a-3ae988ef137e'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0059_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_e8054f55-adc8-4404-8d64-3535e49710a1'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0060",
      "requirement": {
        "requirement_id": "ATOM_172",
        "requirement_text": "The transactionId path parameter MUST be a string that corresponds to the transactionId attribute from a transaction list entry.",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0060_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_3",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_4",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_5",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0060_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports the requirement that the `transactionId` path parameter must be a string corresponding to a `transactionId` attribute from a transaction list entry.  This is primarily defined within the OpenAPI/Swagger specifications for the Accounts API and demonstrated in the demo backend service.  \\n\\n## Implementation Details\\n\\nThe `transactionId` is defined as a string type with a minimum length of 1 and a maximum length of 210 characters in the `account-info-swagger.yaml` file.  This definition is part of the `OBTransaction5` schema, which describes the structure of a transaction entry. \\n\\nThe `/accounts/{AccountId}/transactions` endpoint in the Accounts API is responsible for retrieving transaction information.  While the provided `account-info-swagger.yaml` snippet does not explicitly show a `transactionId` path parameter for a single transaction retrieval, it defines the `TransactionId` as a property within the `OBTransaction5` object, which is part of the response for listing transactions. \\n\\nA demo backend service, `AccountService.java`, provides a concrete example of a transaction list response where `TransactionId` is a string with the value \"123\".  This service handles GET requests to `/accounts/{AccountId}/transactions` and returns a JSON response containing transaction details, including the `TransactionId`.  \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `/accounts/{AccountId}/transactions` which is used to retrieve a list of transactions for a given account.  The `transactionId` is an attribute within the `Transaction` objects returned by this endpoint.  \\n\\n## Documentation References\\n\\nThe `account-info-swagger.yaml` file serves as the primary documentation for the Accounts API, defining the structure and types of parameters and responses, including the `TransactionId`. \\n\\n## Test Criteria\\n\\nThe integration test framework includes methods like `buildValidationTransactionPayload` in `RequestPayloads.groovy` and `AccountsRequestPayloads.groovy` that construct request payloads for validating transactions.   These payloads include a `resource` field that specifies `/aisp/accounts/30080012343456/transactions` and an `electedResource` field that uses `/accounts/{AccountId}/transactions`, indicating that the system expects to handle transaction-related requests.  While these snippets don\\'t directly show validation of a `transactionId` *path parameter*, they confirm the existence of transaction-related API interactions and the expectation of string values for identifiers. \\n\\n## Notes\\n\\nThe provided `account-info-swagger.yaml` defines `TransactionId` as a property within the `OBTransaction5` schema, which is part of the response for listing transactions.  It does not explicitly show a path parameter named `transactionId` for retrieving a *single* transaction. However, the prompt specifically asks about a `transactionId` path parameter corresponding to a `transactionId` attribute from a transaction list entry. The definition of `TransactionId` as a string in the OpenAPI specification and its presence in the demo backend\\'s transaction list response confirms that the system handles `transactionId` as a string.  \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_97921e36-28ad-4fed-b1ab-e0d0c4617d04\\n', 'id': 'lc_934e4531-0231-48a4-8edf-40b745b4ed6e'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0061",
      "requirement": {
        "requirement_id": "ATOM_067",
        "requirement_text": "The system shall set transaction status to PATC (PartiallyAcceptedTechnicalCorrect) for payments authorized by at least one PSU but not yet fully authorized in multilevel SCA processes",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0061_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_2",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_3",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_4",
          "text": "## Open banking / Open Finance regulations Open banking and Open Finance regulations provide a policy and legislative framework to help banks and API consumers deliver the benefits of open banking. - The **newest** regulation of Open Finance is the finalized **section 1033 rule from Consumer Financial Protection Bureau (CFPB) of the United States**.It requires financial institutions to make available to consumers the information they have about their financial products and services, upon request. - The first known open banking regulation is the **Payment Service Directive** in Europe. Administered by the European Commission (Directorate General Internal Market) regulates payment services and payment service providers throughout the European Union and European Economic Area (EEA). PSD1 came into force in 2007 followed by the PSD2 in 2015. - The Competition and Market Authority formed the **Open Banking Implementation Entity** in the UK. The Open Banking Implementation Entity adopted the PSD2 and issued its first version of the open banking standard in 2017. It specified how banks should allow an API consumer to access customer\u2019s information and request payments with the customer\u2019s consent. - The Berlin Group consists of almost 40 banks, associations and Payment Service Providers across the European Union. They have defined a common API standard called NextGenPSD2 for the use cases specified in PSD2. Based on the PSD2 and European Banking Authority - Regulatory Technical Standards (RTS) requirements, the Berlin Group has worked on detailed Access to Account (XS2A) Framework including implementation details for open banking named as **NextGenPSD2XS2A**.Now this has been expanded to Open Finance with the introduction of **Berlin Group openFinance API framework** - **Consumer Data Right** in Australia is a right provided by law under the Treasury Laws Amendment (Consumer Data Right) Act in 2019 to give Australians greater control over their data. It empowers consumers to choose to share their data with API consumers only for the purposes that they have authorized. - **Fintech law** in Mexico promotes data sharing as well as transparency among banks and subholding companies (example: broker-dealers, money exchangers, credit unions, popular, and community financial entities). The Fintech law defines guidelines for the regulated entities on the types of information and how to share them. Comisi\u00f3n Nacional Bancaria y de Valores, The Embassy of the United Kingdom, the FinTech Hub, C Minds, ODI and the Government of the Republic are involved in the regulation. - The Hong Kong Monetary Authority (HKMA) published the **Open API Framework** in 2018 to provide a secure, controlled, and convenient operating environment to financial institutions and third parties. It expects the banks and third parties to work together and build innovative banking services offering a better customer experience. The framework has a phased approach. - The Monetary Authority of Singapore (MAS) provided a legal framework for open banking in 2018. MAS introduced [APIX](https://www.mas.gov.sg/development/fintech/api-exchange) for the banks to open up their data and services encouraging openness among both the financial institutions and the API consumers. - Following the footsteps of the UK and Australia, New Zealand issued a government backed pilot plan in 2018 to design and develop open banking",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_5",
          "text": "as a Java Map in the Worker Java implementation. You can use these properties to implement the logic you want. 3. Worker Name - This is the name of the Worker. !!! note Provide the same name you configured in the `deployment.toml` file as the Worker name in the third step. !!! info You can implement multiple workers, give them different names, and use them in the adaptive authentication script. Below is a sample adaptive authentication script that uses this Worker extension: ``` java var psuChannel = \"Online Banking\"; var onLoginRequest = function (context) { publishAuthData(context, \"AuthenticationAttempted\", { psuChannel: psuChannel, }); executeStep(1, { onSuccess: function (context) { Log.info(\"Authentication Successful\"); publishAuthData(context, \"AuthenticationSuccessful\", { psuChannel: psuChannel, }); OBAuthenticationWorker(context, {}, \"psuAuthenticated\"); }, onFail: function (context) { Log.info(\"Authentication Failed\"); publishAuthData(context, \"AuthenticationFailed\", { psuChannel: psuChannel, }); OBAuthenticationWorker(context, {}, \"psuAuthenticated\"); }, }); OBAuthenticationWorker(context, {}, \"finalised\"); }; ``` !!! note To add these to one or more existing applications, log into the Carbon console as the super admin and update the script. Follow the steps in the [Adaptive Authentication - Overview](https://is.docs.wso2.com/en/latest/guides/adaptive-auth/configure-adaptive-auth/) documentation.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, does not appear to directly support setting a transaction status to PATC (PartiallyAcceptedTechnicalCorrect) for payments in multilevel SCA processes. The provided code snippets primarily relate to OAuth, SAML, and multifactor authentication configurations within an Identity Server context, rather than payment processing or transaction status management.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThe provided code snippets do not contain any implementation details, configuration options, or API endpoints related to payment processing, transaction statuses like PATC, or multilevel SCA specifically for payments. The files `saml-assertion-query-enabled-identity.xml`  and `encrypt-decrypt-persistence-enabled-identity.xml`  show configurations for:\\n\\n*   **OAuth Grant Types**: Such as `saml2-bearer` and `iwa:ntlm` .\\n*   **OpenID Connect**: Including `IDTokenBuilder`, `SignatureAlgorithm`, and `IDTokenExpiration` .\\n*   **Multifactor Authentication**: With settings for XMPP .\\n*   **SAML SSO**: Configurations for `EntityId`, `IdentityProviderURL`, and various builders/signers .\\n\\nThese configurations are related to identity and access management, not payment transaction processing or specific payment statuses like PATC.\\n\\n## Documentation References\\n\\nNo documentation references within the provided snippets are relevant to payment transaction statuses or multilevel SCA in the context of payments.\\n\\n## Notes\\n\\nThe user's query is highly specific to payment transaction statuses and Strong Customer Authentication (SCA) in a payment context. The provided codebase snippets from `wso2/product-is` are related to an Identity Server, which handles authentication and authorization, including multifactor authentication (MFA) and SAML/OAuth protocols. While MFA is a component of SCA, the Identity Server itself does not appear to manage payment-specific transaction statuses like PATC. It's possible that a separate payment gateway or financial services component, which might integrate with this Identity Server for authentication, would handle such payment-specific statuses. However, based solely on the provided code, there is no direct support for the requested functionality.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4ec0bff8-b72d-44c7-9e99-8d7b7929f30a\\n\", 'id': 'lc_92067574-9a52-4e3e-a721-f04df0244b5c'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0061_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_4c12cbf3-da04-408d-b3ff-8ff846e6e438'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0062",
      "requirement": {
        "requirement_id": "ATOM_204",
        "requirement_text": "TPP MUST stop the transaction if the state parameter validation check fails.",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0062_1",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_2",
          "text": "A pushed authorization request contains authentication and authorization request parameters, which will be used in the Pushed Authorization endpoint of WSO2 Open Banking Accelerator. The Pushed Authorization endpoint returns a `request_uri` with an expiration time as a reference to the details sent in the pushed authorization request. ##Default Pushed Authorization Request validations The Pushed Auth Request Validator uses the existing validation layer of WSO2 Open Banking Accelerator to enforce validations. By default, the following validations are available in the validation layer: - Repeated parameter validation for all parameters: checks the pushed authorization request body for any repeated parameters When the `request` parameter is available: !!! note The `request` parameter value which will be referred to as `request object` from here onwards should be a Signed JWT(JWS) or an Encrypted JWT(JWE). It can be signed and encrypted as well. In this scenario, it must be signed before being encrypted. - Validation of form body parameters - verifies that only client authentication parameters (such as `client_id`, `client_assertion`, `client_assertion_type`) are present in the request form body. Other parameters must be included in the request object. - Validation of client id - validates the `client id` claim of the request object. - Validation of redirect URI - validates the redirect URI to check whether it matches with the registered redirect URIs. - Validation of request object signature algorithm - checks if the correct signing algorithm is used. - Validation of request object signature - verifies the signature of the request object. - Validation of the nonce claim - checks whether the nonce claim is available for response types requesting `id_token`. - Validation of the scope claim - checks whether the scope claim contains scopes that are registered with the client application. - Validation of the audience claim - checks if the audience claim matches the token endpoint URL. - Validation of the issuer claim - checks whether the issuer claim matches the client_id. - Validation of invalid claims in request object - check whether the `request` and `request_uri` claims are present in the request object. ##Writing a Custom Pushed Auth Request Validator You can extend the default validations in WSO2 Open Banking Accelerator and add more validations according to your open banking requirements: - To implement a custom Pushed Auth Request validator, extend the following class: ``` java com.wso2.openbanking.accelerator.identity.push.auth.extension.request.validator.PushAuthRequestValidator ``` Given below is a brief explanation of the methods you need to implement. ###validateAdditionalParams method This method performs the additional validations you add. Given below is the method signature: ``` java public void validateAdditionalParams(Map<String, Object> parameters) throws PushAuthRequestValidatorException ``` Input parameters - `Map<String, Object> parameters` - contains pushed authorization request parameters obtained from the HTTP servlet request Output parameter - `void` !!! note When a valid request object is present as a request parameter, the default implementation of the accelerator decodes the request object JWT and adds the following parameters to the Map<String, Object> parameters map. 1. Key - `\"decodedJWTBody\"`, Value - `<decoded request object JWT body>` 2. Key - `\"decodedJWTHeader\"`, Value - `<decoded request object JWT header>` For example: - Extend the `PushAuthRequestValidator` class and",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_3",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_4",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_5",
          "text": "## Validate Authorize Request\n\nThe OpenAPI extension for validate client sending authorize API requests to ensure request parameters are according to  the way\nallowed in the Open Banking  specificatio requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the validation of the `state` parameter in OpenID Connect (OIDC) authentication flows, and it appears to terminate the transaction if the validation fails. The `MockOIDCIdentityProvider` class, used for testing, demonstrates how the `state` parameter is handled during authorization and logout requests.  \\n\\n### Implementation Details\\n\\nThe `MockOIDCIdentityProvider` class simulates an OIDC Identity Provider for testing purposes.  It configures mock endpoints for authorization and logout. \\n\\nFor the authorization flow, the mock IDP expects a `state` query parameter in the authorization request.  Upon successful processing, it redirects back to the `redirect_uri` and includes the received `state` parameter in the response.  This implies that the client (TPP) is expected to validate this returned `state` against the one it initially sent.\\n\\nSimilarly, for the logout flow, the `MockOIDCIdentityProvider` also expects and returns a `state` parameter.  \\n\\nThe `testFederatedTokenSharing` method in `FederatedTokenSharingTestCase` demonstrates an OIDC flow where an authorization request is sent to a primary IDP, which then redirects to a federated IDP.  While this test case doesn\\'t explicitly show a `state` parameter mismatch, it outlines the overall OIDC authorization code flow where such a validation would occur. \\n\\n### Configuration Options\\n\\nThe provided context does not explicitly detail configuration options for enabling or disabling `state` parameter validation. However, the presence of `state` parameter handling in the `MockOIDCIdentityProvider` suggests that it\\'s an inherent part of the OIDC protocol implementation within WSO2 Identity Server. \\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoints for `state` parameter validation are the OIDC authorization endpoint (`/authorize`) and potentially the logout endpoint (`/oidc/logout`).  The `state` parameter is a standard part of the OpenID Connect specification, used to maintain state between the authorization request and the callback, and to mitigate CSRF attacks.\\n\\n### Documentation References\\n\\nThe wiki page \"SAML and Identity Federation\" provides an overview of SAML and Identity Federation, and mentions OAuth2 and OpenID Connect as related topics.  While it doesn\\'t specifically detail `state` parameter validation, it indicates that WSO2 Identity Server supports these protocols. \\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests. The `MockOIDCIdentityProvider` is a test utility to simulate an OIDC provider, and its behavior regarding the `state` parameter reflects the expected behavior of a compliant OIDC implementation.  The `FederatedTokenSharingTestCase` further illustrates the OIDC flow.  The actual server-side implementation of the `state` parameter validation would reside within the core OIDC components of WSO2 Identity Server, which are not directly visible in these test snippets. However, the tests imply that such validation is a fundamental part of the system\\'s design.\\n\\nWiki pages you might want to explore:\\n- [SAML and Identity Federation (wso2/product-is)](/wiki/wso2/product-is#3.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c5a05340-a1f4-4584-b521-268286dc410a\\n', 'id': 'lc_bf503d87-0e94-47fd-9de8-a37278a5c517'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0062_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_9c8a940d-0b42-4f87-8d0f-1677a96061e7'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0063",
      "requirement": {
        "requirement_id": "ATOM_099",
        "requirement_text": "ASPSPs MUST support one-time password (OTP) authentication method in Embedded SCA Approach",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0063_1",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0063_2",
          "text": "**Consumer Authentication** is a mechanism used to authenticate a user that initiates a payment or accesses banking \ninformation via an API consumer application. Authentication can be configured using two or more of the following factors \nto  minimise fraudulent activities by preventing identity theft. It authenticates the user using the following factors \none at a time:\n\n- Knowledge: Things only the user knows, such as passwords.\n- Possession: Things only the user has, such as ATM cards.\n- Inherence: Things only the user is, such as a fingerprint.\n\n![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png)\n\n!!!note\n    **Strong Customer Authentication** is the term used in PSD2 for **Consumer Authentication**. In Strong Customer Authentication,\n    it is mandatory to use at least two of the authentication factors mentioned above.\n    \nYou can enforce Consumer Authentication for the WSO2 Open Banking solution with the use of authentication mechanisms supported in\nWSO2 Identity Server. For more information:\n\n- By default, WSO2 Identity Server supports basic authentication and SMS OTP authentication. See [The Default Authenticator](https://is.docs.wso2.com/en/5.11.0/learn/writing-a-new-oauth-client-authenticator/#the-default-authenticator).\n- WSO2 Identity Server provides you with the flexibility of implementing any type of authentication such as biometric, FIDO, Duo etc. See [Identity Federation for Developers](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-federated-authenticator/).\n    - By default, identifier-first authentication is supported. To configure identifier-first authentication, see [Identifier-first Authentication]()\n- WSO2 Identity Server allows you to strengthen the existing authentication by adding an additional authentication step \nto authenticate with basic authentication, such as FIDO, TOTP. See [Multi-factor Authentication](https://is.docs.wso2.com/en/5.11.0/learn/multi-factor-authentication/).\n- Once you implement multi-factor authentication, you can configure and deploy those multiple factors in a way that the \nIdentity Service Provider can select the right factors depending on a user\u2019s risk profile and behavior. See [Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/adaptive-authentication/).\n    - Try out adaptive authentication using the instructions given in [Configuring a Service Provider for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/learn/configuring-a-service-provider-for-adaptive-authentication/).\n    - According to your open banking standard, you can write a custom function for adaptive authentication. See [Writing a custom function for Adaptive Authentication](https://is.docs.wso2.com/en/5.11.0/develop/writing-custom-functions-for-adaptive-authentication/).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0063_3",
          "text": "### setAuthenticators method\nThis method lets you configure authenticators to be invoked during the authorization flow.\n\n``` java\npublic void setAuthenticators (boolean isRegulatoryApp, String tenantDomain, ServiceProvider serviceProvider,\n                               LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\n        throws OpenBankingException {\n\n    if (isRegulatoryApp) {\n\n        List<AuthenticationStep> authSteps = new ArrayList<>();\n\n        //Step 1 - Default basic authentication\n        LocalAuthenticatorConfig localAuthenticatorConfig = new LocalAuthenticatorConfig();\n        LocalAuthenticatorConfig[] localAuthenticatorConfigs = new LocalAuthenticatorConfig[1];\n        AuthenticationStep basicAuthenticationStep = new AuthenticationStep();\n\n        String authenticatorDisplayName = \"<PRIMARY_AUTHENTICATOR_DISPLAY_NAME>\";\n        String authenticatorName = \"<PRIMARY_AUTHENTICATOR_NAME>\";\n\n        localAuthenticatorConfig.setDisplayName(authenticatorDisplayName);\n        localAuthenticatorConfig.setEnabled(true);\n        localAuthenticatorConfig.setName(authenticatorName);\n        localAuthenticatorConfigs[0] = localAuthenticatorConfig;\n\n        basicAuthenticationStep.setStepOrder(1);\n        basicAuthenticationStep.setLocalAuthenticatorConfigs(localAuthenticatorConfigs);\n        basicAuthenticationStep.setAttributeStep(true);\n        basicAuthenticationStep.setSubjectStep(true);\n        //set step 1\n        authSteps.add(basicAuthenticationStep);\n\n         if (logger.isDebugEnabled()) {\n            logger.debug(String.format(\"Authentication step 1 added: %s\", authenticatorName));\n        }\n\n        localAndOutboundAuthenticationConfig.setAuthenticationSteps(authSteps.toArray(\n                    new AuthenticationStep[0]));\n    }\n}\n```\n\n!!! tip\n    You can change the name of the Identity Provider by configuring the following tag in the \n    `<IS_HOME>/repository/conf/deployment.toml` file. For example:\n    ``` xml\n    [open_banking.sca.idp]\n    name = \"SMSAuthentication\"\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0063_4",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0063_5",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0063_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports One-Time Password (OTP) authentication methods, including Email OTP and SMS OTP, which can be integrated into an Embedded SCA (Strong Customer Authentication) approach. The system provides configurable options for these authenticators and includes API endpoints for managing them.\\n\\n### Implementation Details\\nThe WSO2 Identity Server architecture includes an \"Authentication Framework\" that supports various authentication mechanisms, including \"Multi-factor Authenticators\" like TOTP, SMS OTP, and Email OTP .\\n\\nSpecifically, the `pom.xml` file lists dependencies for `org.wso2.carbon.extension.identity.authenticator.outbound.emailotp` (Email OTP)  and `org.wso2.carbon.extension.identity.authenticator.outbound.smsotp` (SMS OTP) , indicating their inclusion in the product. There are also dependencies for `org.wso2.carbon.identity.local.auth.emailotp`  and `org.wso2.carbon.identity.local.auth.smsotp.feature` , which are local authenticators for Email OTP and SMS OTP respectively.\\n\\nThe `modules/p2-profile-gen/pom.xml` file further confirms the inclusion of these authenticators as features within the product\\'s P2 profile generation, specifically mentioning `org.wso2.carbon.extension.identity.authenticator.totp.connector.feature.group` , `org.wso2.carbon.identity.authenticator.emailotp.feature.group` , and `org.wso2.carbon.identity.local.auth.smsotp.feature.group` .\\n\\nAn example of how Email OTP is used in a multi-step authentication flow is demonstrated in `EmailOTPTestCase.java` . This test case sets up a service provider with basic authentication as the first step and Email OTP as the second step, simulating an SCA approach. The `getLocalAndOutBoundAuthenticator` method configures this sequence .\\n\\nFor SMS OTP, the `MockSMSProvider.java`  class is used in integration tests to simulate an SMS gateway and extract OTPs from the mock SMS content, demonstrating the system\\'s capability to handle SMS OTPs .\\n\\n### Configuration Options\\nOTP authenticators offer various configuration options. For Email OTP, the `email_otp_config.toml` file shows parameters such as `usecase`, `secondaryUserstore`, `EMAILOTPMandatory`, `sendOTPToFederatedEmailAttribute`, `federatedEmailAttributeKey`, `EmailOTPEnableByUserClaim`, `CaptureAndUpdateEmailAddress`, and `showEmailAddressInUI` .\\n\\nAdditionally, governance configurations related to OTPs are available. For account recovery, properties like `Recovery.Notification.Password.OTP.SendOTPInEmail`, `Recovery.Notification.Password.OTP.UseUppercaseCharactersInOTP`, `Recovery.Notification.Password.OTP.UseLowercaseCharactersInOTP`, `Recovery.Notification.Password.OTP.UseNumbersInOTP`, and `Recovery.Notification.Password.OTP.OTPLength` can be configured . Similar configurations exist for email verification, such as `EmailVerification.OTP.SendOTPInEmail` and `EmailVerification.OTP.OTPLength` .\\n\\n### API Endpoints or Features\\nThe system provides API endpoints for handling OTP authentication. In the `ApplicationNativeAuthentication2FATestCase.java` , an Email OTP POST request is sent to an unspecified endpoint with the `OTPCode` as a parameter . The `PasswordLessEmailOTPAuthTestCase.java` also demonstrates sending an OTP via a POST request to the `COMMON_AUTH_URL` .\\n\\nThe `EmailOTPTestCase.java` indicates that the `EMAIL_OTP_AUTHENTICATION_ENDPOINT_URL` is used for redirection during email OTP authentication .\\n\\n### Documentation References\\nThe \"Architecture\" wiki page provides a high-level overview of the WSO2 Identity Server, including its \"Authentication Framework\" and \"Multi-factor Authenticators\" . This serves as a foundational document for understanding where OTP authentication fits within the overall system design.\\n\\n## Notes\\nThe provided context primarily consists of integration tests and Maven `pom.xml` files, which confirm the existence and configurability of OTP authenticators (Email OTP, SMS OTP, TOTP) within the WSO2 Identity Server. The test cases demonstrate how these authenticators can be used in multi-step authentication flows, which aligns with the concept of an Embedded SCA Approach. The test criteria regarding processing OTP authentication data in an Authorisation-Update Request when only one SCA method is available is implicitly covered by the integration tests that simulate authentication flows with OTP as a step. However, explicit API endpoints for \"Authorisation-Update Request\" were not directly found in the provided snippets, though the general mechanism for submitting OTPs via POST requests is present.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_ec68ba2b-7a51-4f9c-b2cd-7484be3837d0\\n', 'id': 'lc_ecc9e5e3-7b52-474b-9f0d-bb66b809ad39'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0063_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_aae93130-104e-43e1-9360-9c0fc160ca9c'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0064",
      "requirement": {
        "requirement_id": "ATOM_132",
        "requirement_text": "The ASPSP shall validate Read Account Data Request against PSU consent for type of account data to be accessed",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0064_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the validation of \"Read Account Data Request\" against \"PSU consent for type of account data to be accessed\" through its Consent Management framework. This is primarily demonstrated in the integration tests related to consent and OAuth2, and configured via `default-identity.xml` .\\n\\n## Implementation Details\\n\\nThe Consent Management framework in `wso2/product-is` allows for the collection, storage, and enforcement of user consent for processing personal data . This is crucial for validating account data access requests against user consent.\\n\\n### Consent Collection and Storage\\nDuring self-registration, consent can be collected for required attributes . The `SelfSignUpConsentTest` demonstrates how to add purpose categories and PII categories, and how to self-register a user with associated consents  . The `getConsentReqBody` method constructs the JSON payload for a consent request, specifying details like `purposeId`, `piiCategoryId`, and `validity` .\\n\\n### Consent Enforcement\\nConsent decisions influence how user information is shared. For instance, during token issuance, only attributes for which consent has been granted are included in the tokens . The `OAuth2ServiceAuthCodeGrantJWTAccessTokenWithConsentedTokenColumnTestCase` shows how consent parameters are passed during the approval process for OAuth2 flows . The `sendApprovalPostWithConsent` method in `OAuth2ServiceAbstractIntegrationTest` is responsible for sending the approval post request with consent information .\\n\\n## Configuration Options\\n\\nThe `default-identity.xml` file contains configuration options related to consent management .\\nSpecifically, the `<EnableSSOConsentManagement>` tag can be set to `true` to enable consent management during Single Sign-On .\\n\\nAdditionally, the `configure_is_fapi.py` script demonstrates how to disable skipping consent for an application, which is essential for enabling consent flows .\\n\\n## API Endpoints or Features\\n\\nThe Consent Management APIs are exposed through specific endpoints:\\n*   `/api/identity/consent-mgt/v1.0/consents`: This endpoint is used for managing consents . The `SelfSignUpConsentTest` uses `CONSNT_ENDPOINT_SUFFIX` which resolves to this endpoint  .\\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/(.*)`: This endpoint is used to retrieve consent receipts . The `getConsent` method in `SelfSignUpConsentTest` interacts with this endpoint to retrieve a specific consent receipt .\\n*   `/api/identity/consent-mgt/v1.0/consents/purpose-categories(.*)`: This endpoint is used for managing purpose categories . The `addPurposeCategory` method in `SelfSignUpConsentTest` uses this endpoint to add new purpose categories .\\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories(.*)`: This endpoint is used for managing PII categories . The `addPIICategory` method in `SelfSignUpConsentTest` uses this endpoint to add new PII categories .\\n\\nThe `ConsentMgtPostAuthnHandler` is an event listener that plays a role in post-authentication consent handling .\\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, including its purpose, key components (PII Categories, Purposes, Purpose Categories, Consent Receipts), and the consent collection and enforcement processes <wiki_page repo_name=\"wso2/product-is\" id=\"7.3\" page_name=\"Advanced Features\" />. It also highlights how consent integrates with OAuth2/OIDC for custom scopes and claims <wiki_page repo=\"wso2/product-is\" path=\"modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/oauth2/OIDCCustomScopesLoginTest.java\" start=\"113\" end=\"544\" />.\\n\\n## Test Criteria\\n\\nThe integration tests verify that the ASPSP (Account Servicing Payment Service Provider) checks account data access requests against established consent scope and denies unauthorized access attempts. For example, the `selfSignUpWithConsents` test in `SelfSignUpConsentTest` ensures that a user cannot self-register with a username that is already taken, implying a check against existing user data . The `getPurposes` test further validates that consents are correctly retrieved and associated with the user .\\n\\nThe `OAuth2ServiceAuthCodeGrantJWTAccessTokenWithConsentedTokenColumnTestCase` and `OIDCCustomScopesLoginTest` demonstrate how consent is integrated into the OAuth2 authorization code grant flow, where `sendApprovalPostWithConsent` is used to approve claims based on consent  . This implies that if consent is not given for certain data, access to that data would be denied.\\n\\n## Notes\\n\\nThe provided snippets primarily focus on the WSO2 Identity Server\\'s capabilities as an Identity Provider (IdP) and its consent management features. While the prompt refers to an \"ASPSP\" (Account Servicing Payment Service Provider), the underlying mechanisms for consent validation and enforcement within WSO2 Identity Server are applicable to such a role. The integration tests demonstrate the core functionality of collecting and enforcing consent for user data, which would be leveraged by an ASPSP to validate requests against PSU (Payment Services User) consent. The term \"Read Account Data Request\" is a specific domain concept, but the general principle of validating data access against consent is directly supported.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3c19dea6-8f1e-40f7-abc7-0703dfd0e0da\\n', 'id': 'lc_0aa61816-d8d0-4bb6-8452-135bf9db1d67'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0064_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"This repository, `wso2/product-apim`, appears to support the validation of Read Account Data Requests against PSU (Payment Services User) consent for the type of account data to be accessed. This functionality is primarily handled through the integration of consent management features within the WSO2 API Manager.\\n\\n### Implementation Details\\nThe WSO2 API Manager includes features related to consent management, which are integrated during the build process. Specifically, the `traffic-manager/modules/p2-profile/product/pom.xml` file lists `org.wso2.carbon.consent.mgt:org.wso2.carbon.consent.mgt.server.feature` and `org.wso2.carbon.identity.framework:org.wso2.carbon.identity.consent.mgt.server.feature` as feature artifacts to be included in the P2 repository generation . These features indicate the presence of a consent management system within the product.\\n\\nThe consent management system is further evidenced by the `self-registration-with-verification.jsp` file, which includes logic for displaying and handling user consents during self-registration . This JSP file dynamically renders consent information based on `hasPurposes` and `consentDisplayType` variables . The `renderReceiptDetails` function, defined in the same file, is responsible for displaying these purposes, potentially in a tree structure, indicating that specific data categories (PII categories) can be associated with purposes and require user consent .\\n\\nThe `GrantTypeTokenGenerateTestCase.java` and `JWTTestCase.java` integration tests demonstrate the process of obtaining access tokens using authorization codes, which involves user login and consent approval steps  . These tests simulate a user approving an application, which is a prerequisite for token generation and subsequent API access. The `sessionDataKeyConsent` parameter is used to manage the consent flow .\\n\\n### Configuration Options\\nThe `default.json` configuration file contains settings related to authentication and consent. The `authentication.consent.prompt` property, if set to `true`, would enable prompting for consent during authentication . Additionally, `oauth.prompt_consent` is another configuration that can be set to `true` to prompt for OAuth consent . The `authentication.consent.data_source` property specifies the JDBC data source for consent management .\\n\\n### API Endpoints or Features\\nThe system supports the concept of scopes, which can be used to control access to APIs based on granted permissions. The `APIScopeTestCase.java` demonstrates how scopes are used during token generation and API invocation . If a user does not have the required scopes, access to an API method can be forbidden . This mechanism can be extended to enforce consent for specific types of account data.\\n\\nThe `opaPolicy_v1.json` defines an operation policy for validating requests with an Open Policy Agent (OPA) . This policy can be configured to send the access token to the OPA engine , allowing for externalized authorization decisions based on the token's claims, which could include consent information.\\n\\n### Documentation References\\nThe `sample3/README.md` and `sample4/README.md` files provide high-level overviews of API development and security within WSO2 API Manager. While they don't directly address PSU consent for account data, they discuss concepts like optimizing API output based on client identification and enforcing authentication and authorization using scopes  . These concepts are foundational to implementing consent-based access control.\\n\\n## Notes\\nThe provided snippets strongly suggest that WSO2 API Manager, as built from this repository, supports consent-based access control, particularly for sensitive data like account information. The presence of consent management features, configuration options for consent prompting, and the use of scopes and external policy agents (OPA) all contribute to the ability to validate Read Account Data Requests against PSU consent. The integration tests further confirm that consent approval is part of the token generation flow.\\n\\nWiki pages you might want to explore:\\n- [Build System (wso2/product-apim)](/wiki/wso2/product-apim#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9d875eaa-6f92-435f-b020-cb53525e72a7\\n\", 'id': 'lc_aef136da-cbe8-4315-94f1-b8cb482f6761'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0065",
      "requirement": {
        "requirement_id": "ATOM_021",
        "requirement_text": "ASPSPs SHALL enable direct start of Redirect SCA processing after payment or consent submission if no other data from the TPP has to be submitted.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0065_1",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0065_2",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0065_3",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0065_4",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0065_5",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0065_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, supports various authentication and authorization protocols, including OAuth 2.0 and OpenID Connect, which are relevant to the concept of Strong Customer Authentication (SCA) and consent management. The system provides features for managing user consent and handling authentication flows, which are foundational to implementing direct start of Redirect SCA processing.    \\n\\n### Implementation Details\\n\\nThe WSO2 Identity Server includes mechanisms for handling user consent, which is a critical component for SCA. The `requestMissingClaims` method in test cases like `OAuth2ServiceSAML2BearerGrantTestCase`  and `TestPassiveSTS`  checks if a redirect URL contains \"consent.do\", indicating that user consent is required. This suggests that the system can initiate a consent flow. The `OAuth2ServiceSAML2BearerGrantTestCase` also demonstrates sending SAML assertions to the token endpoint , which is part of an authentication process that could precede SCA.\\n\\n### Configuration Options\\n\\nThe system allows for configuration related to consent. For instance, the `DISABLE_SKIP_CONSENT_BODY_PAYLOAD` in `constants_fapi.py`  shows an option to explicitly set `skipLoginConsent` to `false`. This indicates that the system can be configured to always require user consent, which is essential for SCA.\\n\\n### API Endpoints or Features\\n\\nThe WSO2 Identity Server exposes various API endpoints for OAuth2 and OIDC, which are fundamental for initiating and managing authentication and authorization flows that would involve SCA. The `OAuth2CommonClient` defines endpoints such as `/oauth2/authorize` and `/oauth2/token` , which are used in the initial stages of an OAuth 2.0 flow. The `DCR_ENDPOINT` for dynamic client registration  and `TOKEN_ENDPOINT`  are also defined, which are crucial for TPPs to interact with the ASPSP. The system also supports advanced OAuth features like Pushed Authorization Requests (PAR) and Rich Authorization Requests, which can be used to convey additional data for SCA. \\n\\n### Documentation References\\n\\nThe \"Features and Capabilities\" wiki page  highlights that WSO2 Identity Server provides comprehensive support for OAuth 2.0 and OpenID Connect, including various grant types and advanced features. It also explicitly mentions \"Consent Management\" as an advanced security feature, indicating that the system is designed to handle user consent flows. \\n\\n## Notes\\n\\nThe provided snippets are primarily from integration tests and configuration files, which demonstrate the system\\'s capabilities rather than providing direct implementation code for the ASPSP\\'s SCA processing. While the presence of consent-related checks and OAuth2/OIDC endpoints strongly suggests support for the described requirement, the exact \"direct start of Redirect SCA processing\" and automatic creation of authorization sub-resources would likely be handled by internal logic within the WSO2 Identity Server that is not directly visible in these test-related snippets. The test criteria mentioned in the prompt (\"Verify that for simple cases, ASPSP automatically creates authorisation sub-resources and returns hyperlinks without requiring separate POST to authorisations endpoint\") would need to be validated through specific test cases that simulate this behavior, which are not fully detailed in the provided context.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [Testing Framework (wso2/product-is)](/wiki/wso2/product-is#6)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_6e88d23a-38fe-4e73-b002-1a8475a6150f\\n', 'id': 'lc_e2409a73-e8b9-47fd-b190-7b4db863a722'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0065_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_d6e3de9b-8ef8-425d-a1fa-faafb4adde90'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0066",
      "requirement": {
        "requirement_id": "ATOM_118",
        "requirement_text": "The X-Request-ID header SHALL be mandatory and contain a UUID that is unique to the call",
        "strength": "SHALL",
        "capability": "General",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0066_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to explicitly enforce the `X-Request-ID` header as mandatory with a UUID format for all API calls. However, there is an instance where a similar header, `X-Fapi-Interaction-Id`, is used and generated as a UUID if not present, within a conformance test suite.\\n\\n### Implementation Details\\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` file, which is part of the FAPI (Financial-grade API) conformance tests, demonstrates the use of an `X-Fapi-Interaction-Id` header. In the `resource` function, if the `X-Fapi-Interaction-Id` header is not present in the incoming request, a new UUID is generated and assigned to it before being included in the response headers . This suggests that while a request ID is used, its mandatory nature and UUID format are handled within this specific test context rather than being a general enforcement across the entire product. The generation of the UUID is done using `uuid.uuid4()` .\\n\\nThe codebase also includes a \"UUID Generator feature\" as seen in `modules/p2-profile-gen/pom.xml`  and . This feature, `org.wso2.carbon.uuid.generator.feature`, indicates that the capability to generate UUIDs exists within the product. However, there is no direct evidence in the provided snippets that this feature is specifically used to enforce an `X-Request-ID` header as mandatory for all incoming API requests.\\n\\nOther instances of UUID generation are found in test cases, such as in `modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/utils/RichAuthorizationRequestsUtils.java` where `UUID.randomUUID()` is used to create unique identifiers for API resources . Similarly, `modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/applicationNativeAuthentication/ApplicationNativeAuthenticationTestCase.java`  and `modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/applicationNativeAuthentication/ApplicationNativeAuthentication2FATestCase.java`  use `UUID.randomUUID().toString()` for generating nonces in OAuth 2.0 parameter lists. These usages are within test contexts and do not indicate a system-wide enforcement of `X-Request-ID`.\\n\\n### Configuration Options\\n\\nBased on the provided codebase context, there are no explicit configuration options visible that would allow an administrator to enforce the `X-Request-ID` header as mandatory or to configure its validation. The \"Configuration System\" described in the `Architecture` wiki page mentions `default.json`, `infer.json`, and `deployment.toml` for dynamic configuration . However, the snippets do not contain any specific entries related to `X-Request-ID` header enforcement.\\n\\n### API Endpoints or Features\\n\\nThe `API Layer` section of the `Architecture` wiki page describes various APIs such as `Server APIs` and `User APIs` . While these APIs handle requests, there is no indication in the provided snippets that they inherently require or validate an `X-Request-ID` header. The only related feature found is the `X-Fapi-Interaction-Id` header within the FAPI conformance tests, which is specific to that context .\\n\\n### Documentation References\\n\\nThe provided context does not include any documentation references that explicitly state the `X-Request-ID` header is mandatory and must contain a UUID unique to the call. The `Architecture` wiki page provides a high-level overview , but does not delve into such specific API header requirements.\\n\\n## Notes\\n\\nThe prompt specifically asks about the `X-Request-ID` header. While the codebase shows usage of `UUID` generation and a related header `X-Fapi-Interaction-Id` in a test context, there is no direct evidence to suggest that the `X-Request-ID` header is universally mandatory and validated for UUID format across all API endpoints in the `wso2/product-is` repository. The \"UUID Generator feature\"  indicates the capability to generate UUIDs exists, but not its enforcement for a specific request header.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d9d656d7-dcc6-409b-adbc-522b8a10ae4a\\n', 'id': 'lc_0ae922eb-d166-4ab6-a634-05edc7f6b88e'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0066_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not explicitly support a mandatory `X-Request-ID` header containing a UUID that is unique to the call, nor does it provide configuration options to enforce such a requirement or reject requests lacking it. However, it does utilize `MessageID` and `RelatesTo` headers, which are described as containing UUIDs for message and request correlation respectively.\\n\\n### Implementation Details and API Endpoints\\nThe documentation refers to `MessageID` and `RelatesTo` as header names that can contain UUIDs.\\nThe `MessageID` header is described as \"The unique message ID of the message\" . Similarly, the `RelatesTo` header is described as \"The unique ID of the request to which the current message is related\" . Both are documented to have \"UUID\" as possible values  . These headers are mentioned in the context of properties that are not recommended to be altered  .\\n\\nThe `get-property(\\'MessageID\\')`  and `get-property(\\'RelatesTo\\')`  examples suggest that these are internal properties accessible within the system, likely for message mediation or routing.\\n\\n### Configuration Options\\nThere are no explicit configuration options found in the provided snippets that would allow you to enforce the mandatory presence of an `X-Request-ID` header or validate its UUID format. The `Owasp.CsrfGuard.Carbon.properties` files   discuss CSRF protection and the `X-Requested-With` header, but this is distinct from a general `X-Request-ID` for call uniqueness.\\n\\n### Documentation References\\nThe primary documentation references for `MessageID` and `RelatesTo` headers are found in the `properties_guide.xml` files across different modules:\\n*   `all-in-one-apim/docs/xdoc/properties_guide.xml` \\n*   `api-control-plane/docs/xdoc/properties_guide.xml` \\n*   `gateway/docs/xdoc/properties_guide.xml` \\n*   `traffic-manager/docs/xdoc/properties_guide.xml` \\n\\nThese documents describe the existence and purpose of `MessageID` and `RelatesTo` headers, indicating they carry UUIDs for message and request identification within the system. However, they do not specify a mechanism to enforce their mandatory presence as an incoming request header named `X-Request-ID` or to reject requests that do not conform to a UUID format for such a header.\\n\\n## Notes\\nThe codebase mentions `MessageID` and `RelatesTo` headers which are UUIDs for internal message and request correlation. While these serve a similar purpose to an `X-Request-ID` in terms of unique identification, there is no direct evidence in the provided snippets of a mechanism to enforce an *incoming* `X-Request-ID` header as mandatory or to validate its format. The `Owasp.CsrfGuard.Carbon.properties` files discuss `X-Requested-With` in the context of CSRF protection, which is a different concern.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_8707c299-7602-4f76-a8bc-c4370fcc4180\\n', 'id': 'lc_af33299c-e2bc-4257-8651-226c94af8a00'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0067",
      "requirement": {
        "requirement_id": "ATOM_173",
        "requirement_text": "The X-Request-ID header MUST be included as a UUID that uniquely identifies the request as determined by the initiating party.",
        "strength": "MUST",
        "capability": "General",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0067_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to explicitly support the `X-Request-ID` header as a UUID that uniquely identifies the request as determined by the initiating party. While the codebase utilizes UUIDs for various internal purposes, there is no direct evidence or configuration option found that enforces or processes an `X-Request-ID` header with a UUID format for all incoming requests.\\n\\n### Implementation Details \\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` file, which is part of conformance tests, shows an example of handling an `X-Fapi-Interaction-Id` header. If this header is not present, a new UUID is generated and assigned to it . This suggests that while UUID generation is available and used for request correlation in specific contexts, it\\'s not directly tied to a general `X-Request-ID` header enforcement across all requests.\\n\\nThe codebase also includes a \"UUID Generator feature\"  and a corresponding feature group  within its `pom.xml` configuration, indicating the capability to generate UUIDs. However, this feature is for internal use and does not directly relate to processing an incoming `X-Request-ID` header.\\n\\nUUIDs are also used in various test cases for generating unique identifiers for OAuth2 nonces  and for creating API resources in rich authorization request utilities . These instances demonstrate the use of UUIDs within the system but do not indicate a mechanism for validating an `X-Request-ID` header from an external party.\\n\\n### Configuration Options <cite/>\\nThere are no explicit configuration options found in the provided snippets that would enable or enforce the `X-Request-ID` header with a UUID format. The `pom.xml` references a \"UUID Generator feature\"  , but this is a build-time feature for including a UUID generation capability, not a runtime configuration for request headers.\\n\\n### API Endpoints or Features <cite/>\\nThe codebase does not expose any specific API endpoints or features that are designed to consume or validate an `X-Request-ID` header as described. The `Features and Capabilities` wiki page  provides an overview of the system\\'s functionalities, including API security and management , but it does not mention support for `X-Request-ID` header validation.\\n\\n### Documentation References <cite/>\\nThe provided wiki page and code comments do not contain any documentation references related to the `X-Request-ID` header requirement.\\n\\n## Notes\\nThe presence of UUID generation capabilities  and the use of UUIDs in test cases   indicates that the system can generate and utilize UUIDs. However, this does not translate to an explicit feature for validating an `X-Request-ID` header from an external source. The `X-Fapi-Interaction-Id` handling in the conformance tests  is the closest related functionality, but it\\'s specific to FAPI and generates a UUID if one is not present, rather than strictly validating an incoming `X-Request-ID`.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_8851386e-683d-4c57-9396-19e6f3fd7e72\\n', 'id': 'lc_d0abca23-f839-4129-972b-d5191591792e'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0067_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the inclusion of a unique message ID, which is a UUID, in messages. While it doesn\\'t explicitly refer to an \"X-Request-ID\" header, the `MessageID` header serves a similar purpose of uniquely identifying a message.   \\n\\n### Implementation Details\\nThe `MessageID` is described as \"The unique message ID of the message\"    and its possible values are of type `UUID`   . It is not recommended to alter this property   .\\n\\n### Configuration Options\\nThe `MessageID` can be accessed using `get-property(\\'MessageID\\')`   . This suggests that it is a property within the message context that can be retrieved and potentially used in mediation flows.\\n\\n### API Endpoints or Features\\nThe documentation refers to `MessageID` in the context of \"SOAP Headers\" . This implies that it is a feature related to SOAP message processing within the WSO2 Enterprise Service Bus (ESB) component of the API Manager.\\n\\n### Documentation References\\nThe `MessageID` header is documented in the `properties_guide.xml` files across several modules:\\n*   `all-in-one-apim/docs/xdoc/properties_guide.xml` \\n*   `gateway/docs/xdoc/properties_guide.xml` \\n*   `traffic-manager/docs/xdoc/properties_guide.xml` \\n\\nThese documents describe various properties and headers used within the WSO2 ESB, including `MessageID` and `RelatesTo`, both of which are UUIDs  .\\n\\n## Notes\\nThe user\\'s query specifically asks about an \"X-Request-ID\" header. While the codebase does not explicitly mention a header with this exact name, it does provide a `MessageID` header that serves the purpose of uniquely identifying a message using a UUID. This `MessageID` is a core concept in SOAP messaging and is likely used internally for tracking and correlation. The documentation emphasizes that it\\'s not recommended to alter this property, suggesting it\\'s automatically managed by the system.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4fc2f715-5a79-440a-8980-925a0a826108\\n', 'id': 'lc_c37622fb-6308-46cc-bd14-22d85c32e537'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0068",
      "requirement": {
        "requirement_id": "ATOM_117",
        "requirement_text": "The payment-service path parameter SHALL accept only the values 'payments', 'bulk-payments', and 'periodic-payments'",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0068_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_2",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_3",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_4",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_5",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0068_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the restriction of the `payment-service` path parameter to specific values. The OpenAPI specification for the Payment Initiation API defines the available paths, and the `PaymentService.java` class handles payment submissions. The `financial-services.xml` configuration file and `ConnectorTestConstants.groovy` also provide insights into how payment-related services are defined and tested.\\n\\n## Implementation Details\\n\\nThe `payment-initiation-openapi.yaml` file defines the API endpoints related to payments. It includes paths like `/payment-consents` and `/payments` . While this file defines the API structure, it does not explicitly define an enum for a `payment-service` path parameter with the exact values \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\'. However, it does show that the API is structured around \"payments\" as a core concept.\\n\\nThe `PaymentService.java` class, located in the `org.wso2.financial.services.accelerator.demo.backend` package, is a demo service that handles payment-related operations . It has a `@Path(\"/paymentservice/\")` annotation, indicating its base path . Within this service, there are methods like `getPaymentTypeFundsConfirmation` at `/payment-consents/{ConsentId}/funds-confirmation` and `paymentSubmission` at `/payments`  . This suggests that \"payments\" is a recognized service type.\\n\\nThe `FSDefaultAuthServletImpl.java` class uses `ConsentExtensionConstants.PAYMENTS` to identify payment-related data when populating request attributes . This further indicates that \"payments\" is a distinct category within the system.\\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, used for configuration, includes an `AllowedValues` section for parameters, which can be used to restrict accepted values . For example, it shows `accounts` and `payments` as allowed values for a parameter . This mechanism could be used to enforce the \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\' restriction if a `payment-service` parameter were explicitly defined in this configuration.\\n\\n## API Endpoints or Features\\n\\nThe `payment-initiation-openapi.yaml` defines various payment-related API paths, such as `/payment-consents` and `/payments` . These paths directly correspond to the \"payments\" service type.\\n\\nThe `ConnectorTestConstants.groovy` file defines constants for various payment-related paths, including `CONSENT_PATH_DOMESTIC`, `CONSENT_PATH_SCHEDULE`, `CONSENT_PATH_STANDING_ORDERS`, and `SUBMISSION_PATH_DOMESTIC_PAYMENTS` . These constants suggest that the system differentiates between various types of payments, such as domestic, scheduled, and standing orders, which aligns with the \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\' requirement. The `ApiScope` enum also includes `PAYMENTS` as a defined scope .\\n\\n## Documentation References\\n\\nThe \"Overview\" wiki page for `wso2/financial-services-accelerator` mentions \"Payment Initiation APIs\" as one of the API specifications supported by the accelerator . It also states that the \"Payments\" category has endpoints for payment consent creation, payment execution, and funds confirmation . This high-level documentation confirms the existence and importance of payment-related services.\\n\\n## Test Criteria\\n\\nThe `IdempotencyValidatorTests.java` file contains tests for idempotency validation, which includes checking requests to the `/payments` endpoint  . This indicates that the system has testing in place for payment-related API calls.\\n\\nThe `ConsentDataProviders.groovy` file defines data providers for consent types, including `paymentsParameterMap` with `consentType` set to `PAYMENTS_TYPE` . This suggests that different payment types are handled and tested.\\n\\nWhile the codebase does not explicitly define a `payment-service` path parameter with an enum for \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\', the existing structure and test cases indicate that the system is designed to handle and differentiate between various payment types. The configuration mechanism in `financial-services.xml` provides a way to enforce allowed values for parameters, which could be extended to a `payment-service` parameter if needed.\\n\\n## Notes\\n\\nThe prompt specifically asks about a `payment-service` path parameter. While the provided code snippets show paths like `/payments` and `/paymentservice/`, and constants for various payment types (domestic, scheduled, standing orders), there isn\\'t a direct definition of a single `payment-service` path parameter that accepts \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\' as enum values. The system appears to use distinct paths for different payment types rather than a single parameterized path. However, the underlying logic and configuration capabilities exist to enforce such restrictions if a single parameterized path were introduced.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f30c0fc8-2bf7-48cc-9c97-0254317a6156\\n', 'id': 'lc_14f2b265-4821-4030-b1e0-d7bee2aeb610'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0069",
      "requirement": {
        "requirement_id": "ATOM_205",
        "requirement_text": "ASPSP MUST include Digest header field if and only if the Signature element is contained in the request header.",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0069_1",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_2",
          "text": "### Validate method\n\nThis method lets you perform validations at the filter level. Given below is the method signature.\n\n``` java\nvoid validate(ServletRequest request, String clientId) throws TokenFilterException, ServletException;\n```\n\nThe following validators are implemented by extending `OBIdentityFilterValidator`. You can customize them by extending \nthe respective class and overriding the `validate` method, which is explained above.\n\n!!! note \n    In addition to extending the below validators, you can directly extend the `OBIdentityFilterValidator` class and \n    develop your own validators.\n\n - MTLSEnforcementValidator validator\n      \n    This enforces that a certificate needs to be passed during token creation. This certificate is then bound to the \n    access token.\n     \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.MTLSEnforcementValidator \n    ```\n   \n - ClientAuthenticatorValidator validator\n\n    This validates whether the token request follows the client authentication method format that was registered through \n    Dynamic Client Registration. \n    \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.ClientAuthenticatorValidator  \n    ```\n\n - SignatureAlgorithmEnforcementValidator method\n\n    This validates whether the client assertion is signed with the algorithm that was registered through Dynamic Client Registration. \n    \n    ``` java\n    com.wso2.openbanking.accelerator.identity.token.validators.SignatureAlgorithmEnforcementValidator \n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_3",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the inclusion of a Digest header field in SAML requests, which is related to the presence of a Signature element. The implementation details show that the digest algorithm is configurable and is used when signing SAML requests.\\n\\n### Implementation Details\\nThe `SAML2SSOTestBase.java` file contains a method `setSignature` that is responsible for adding a digital signature to a SAML request . This method takes `digestAlgorithm` as a parameter . If the `digestAlgorithm` is not explicitly provided, it defaults to `XML_DIGEST_ALGORITHM_SHA1` . The digest algorithm is then applied to the content reference of the signature .\\n\\nThe `buildSAMLPOSTRequest` method calls `setSignature` if signing is enabled . This indicates that the Digest header field, as part of the XML Signature, is included when the Signature element is present in the SAML request.\\n\\n### Configuration Options\\nThe digest algorithm can be configured. In the `SAML2SSOTestBase.java` file, the `setSignature` method allows a `digestAlgorithm` to be passed as an argument .\\n\\nConfiguration files like `IDENTITY6777-identity.xml`  and `TestServer.xml`  show that `SAMLDefaultDigestAlgorithmURI` and `digestAlgorithmURI` are configurable properties, typically set to `http://www.w3.org/2000/09/xmldsig#sha1`. Similarly, `saml-idp.xml` shows a `DigestAlgorithm` property that can be set to `MD5` .\\n\\nJSON configuration files for SAML applications also include `digestAlgorithm` as a configurable option, with a default value of `http://www.w3.org/2000/09/xmldsig#sha1` . The available options for `responseDigestAlgorithm` are listed in `saml-metadata-super-tenant.json`  and `saml-metadata-tenant.json` , including various SHA and MD5 algorithms.\\n\\n### API Endpoints or Features\\nThe relevant feature is the SAML 2.0 Single Sign-On (SSO) functionality, specifically the signing of SAML requests and responses. The `setSignature` method is a core part of this functionality .\\n\\n### Documentation References\\nThe provided snippets are primarily code and configuration files, which serve as implementation-level documentation. There are no explicit external documentation references in the provided context.\\n\\n## Notes\\nThe provided code snippets are from test scenarios and configuration files within the `wso2/product-is` repository. While they demonstrate the capability to include and configure digest algorithms as part of SAML message signing, they do not directly show the HTTP header manipulation for a \"Digest header field\" as might be expected in some ASPSP (Account Servicing Payment Service Provider) contexts. Instead, the \"Digest\" refers to the `ds:DigestMethod` and `ds:DigestValue` elements within the XML Signature of a SAML message  . The question implies a specific HTTP header, which is not directly addressed by the provided SAML XML Signature context. However, the core concept of a digest being present when a signature is present is supported within the SAML message structure.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_4b517e38-ec58-46d6-9678-775f990b2480\\n', 'id': 'lc_3731d901-b328-4d40-be16-94dde5c69842'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0069_4",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support Digest authentication for APIs, but there is no direct evidence in the provided snippets to suggest that it enforces the specific condition: \"ASPSP MUST include Digest header field if and only if the Signature element is contained in the request header.\"    The existing implementation focuses on the presence of the `Authorization` header for Digest authentication.  \\n\\n### Implementation Details\\n\\nThe `wso2/product-apim` repository includes a `DigestAuth_API` defined in Synapse XML configurations, which handles requests with Digest authentication.   This API checks for the presence of the `Authorization` header.   If the header is present, it logs a message indicating its presence and sends a `200 OK` response.   If the `Authorization` header is not present, it logs a message and sends a `401 Unauthorized` response with a `WWW-Authenticate` header containing Digest authentication details.  \\n\\nA Java test case, `DigestAuthenticationTestCase.java`, demonstrates the creation and invocation of an API configured with Digest authentication.  This test sets the endpoint type to \"secured\" and the authentication type to \"digestAuth\" for an API.  It then invokes the API with an `Authorization` header containing a Bearer token, which is a different authentication scheme than Digest.  This suggests that while Digest authentication is supported, the test case itself doesn\\'t directly verify the Digest header\\'s presence or its correlation with a `Signature` element. \\n\\nThe `api_product_template.xml` files also reference a `org.wso2.carbon.apimgt.gateway.mediators.DigestAuthMediator` class, indicating a dedicated mediator for Digest authentication within the API Gateway.   However, the specific logic within this mediator regarding the `Digest` header and `Signature` element is not visible in the provided snippets. \\n\\n### Configuration Options\\n\\nAPIs can be configured to use Digest authentication by setting the `endpointAuthType` to \"digestAuth\" and providing `epUsername` and `epPassword` during API creation. \\n\\n### API Endpoints or Features\\n\\nThe `DigestAuth_API` is exposed at the context `/digestAuth`.   It supports various HTTP methods including POST, GET, PUT, DELETE, HEAD, and OPTIONS. \\n\\n### Documentation References\\n\\nThe provided snippets do not contain explicit documentation references that detail the specific requirement of correlating the `Digest` header with a `Signature` element. <cite /> The `WebsubSubscriptionConfigurationDTO.java` file mentions `signingAlgorithm` and `signatureHeader` but these appear to be related to WebSub subscriptions and not directly to the Digest authentication mechanism for API requests.  \\n\\n## Notes\\n\\nThe provided code snippets indicate support for Digest authentication in WSO2 API Manager, primarily through the presence of the `Authorization` header.   However, there is no explicit code or configuration shown that enforces the specific condition that the `Digest` header must be included *if and only if* a `Signature` element is present in the request header. <cite /> The `DigestAuthenticationTestCase` primarily tests the successful invocation of an API configured with Digest authentication using a Bearer token, which doesn\\'t directly address the user\\'s specific requirement.  Further investigation into the `org.wso2.carbon.apimgt.gateway.mediators.DigestAuthMediator` class would be necessary to determine if such a correlation is handled at a deeper level. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_1316418d-5595-4bfc-b4f5-60cba7f151ba\\n', 'id': 'lc_c34f625b-cee2-46ca-a5c8-a14183667779'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0070",
      "requirement": {
        "requirement_id": "ATOM_133",
        "requirement_text": "The ASPSP shall validate Read Account Data Request against PSU consent for addressed account identification where applicable",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0070_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the validation of \"Read Account Data Request\" against \"PSU consent for addressed account identification\" through its Consent Management framework . The system allows for the definition of PII Categories and Purposes, and the collection and enforcement of user consent, which can be used to control access to specific data  .\\n\\n## Implementation Details\\n\\nThe core of the consent management is handled through the `Consent Management` framework . This framework allows for the definition of:\\n*   **PII Categories**: These represent types of personal data, such as \"Organization\" . They are added via the `addPIICategory` method, which makes a POST request to the `/api/identity/consent-mgt/v1.0/consents/pii-categories` endpoint .\\n*   **Purpose Categories**: These are groupings of related purposes, for example, \"Financial\" . They are added using the `addPurposeCategory` method, which sends a POST request to the `/api/identity/consent-mgt/v1.0/consents/purpose-categories` endpoint .\\n*   **Purposes**: These define the reasons for data collection, such as \"Financial Purpose 01\" for the \"SIGNUP\" group .\\n*   **Consent Receipts**: These are records of user consent decisions . The `addReceipt` method is used to create these records .\\n\\nConsent enforcement ensures that only attributes with user consent are included in tokens and API responses . The `OAuth2ServiceAuthCodeGrantJWTAccessTokenWithConsentedTokenColumnTestCase` demonstrates how consent affects token issuance .\\n\\n## Configuration Options\\n\\nThe `default-identity.xml` configuration file contains a `<Consent>` section where `EnableSSOConsentManagement` can be set to `true` to enable consent management during SSO .\\n\\nAdditionally, the `oidc-fapi-conformance-tests/configure_is_fapi.py` script shows how to `disable_skipping_consent` for an application, which forces consent flows to be triggered . This is achieved by patching the application configuration to set \"Skip Login consent\" to `false` .\\n\\n## API Endpoints or Features\\n\\nThe primary API endpoints for consent management are:\\n*   `/api/identity/consent-mgt/v1.0/consents`: This endpoint is used for managing consents  .\\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/{receiptId}`: This endpoint is used to retrieve specific consent receipts  .\\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories`: Used for managing PII categories  .\\n*   `/api/identity/consent-mgt/v1.0/consents/purpose-categories`: Used for managing purpose categories  .\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes`: Used for managing purposes .\\n\\nThe `sendApprovalPostWithConsent` method in `OAuth2ServiceAbstractIntegrationTest` demonstrates how consent approval is sent to the system, including `sessionDataKeyConsent` and `consentClaims` . This method is crucial for the \"ASPSP verifies account identification in data requests matches consented accounts before granting access\" requirement, as it\\'s the mechanism by which the user\\'s consent is communicated and processed.\\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, including its purpose, key components, collection process, and enforcement <wiki_page repo_name=\"wso2/product-is\" id=\"7.3\" page_name=\"Advanced Features\" />. It also highlights how consent decisions affect token issuance and API responses <wiki_page repo=\"wso2/product-is\" path=\"Advanced Features\" start=\"1\" end=\"1\" />.\\n\\nThe \"Integration Tests\" wiki page also mentions \"Self-Registration and Consent Tests\" and specifically references `SelfSignUpConsentTest` as a test case for self-registration with consent management <wiki_page repo=\"wso2/product-is\" path=\"Integration Tests\" start=\"1\" end=\"1\" />.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which demonstrate the functionality of the consent management system. While these tests confirm the existence and basic operation of the features, they do not expose the internal implementation logic of how the ASPSP (Account Servicing Payment Service Provider) specifically validates account data requests against PSU (Payment Services User) consent for addressed account identification. However, the presence of `ConsentMgtTestCase`  and `OAuth2ServiceAuthCodeGrantJWTAccessTokenWithConsentedTokenColumnTestCase`  strongly suggests that the system is designed to handle and enforce consent for data access, including account-related information. The `sendApprovalPostWithConsent` method  is a key part of how consent is communicated to the system.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_20d8f9b2-7c74-4eff-a867-a78c338f0620\\n', 'id': 'lc_29e3892d-4713-4e43-bed3-93297c9f76b3'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0070_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, includes features related to consent management, which could be relevant to validating account data requests against user consent. Specifically, it includes features for consent management and identity authentication and authorization. However, the provided context does not contain direct implementation details, API endpoints, or specific configuration options for validating \"Read Account Data Request against PSU consent for addressed account identification.\"  \\n\\n## Implementation Details\\n\\nThe `wso2/product-apim` repository incorporates consent management features through the inclusion of specific P2 features during its build process. The `gateway` and `traffic-manager` components, for instance, include `org.wso2.carbon.consent.mgt.server.feature` and `org.wso2.carbon.identity.consent.mgt.server.feature`  . These features suggest the presence of a consent management system within the WSO2 API Manager product.\\n\\nThe `self-registration-with-verification.jsp` file in the `api-control-plane` and `all-in-one-apim` distributions shows how user consent is handled during self-registration  . This JSP processes user selections for purposes and PII categories, which are then used to construct a consent receipt . The `IdentityManagementEndpointUtil` class is used to retrieve and fill PII information related to claims .\\n\\n## Configuration Options\\n\\nThe `default.json` configuration files across different distributions (e.g., `api-control-plane`, `gateway`, `all-in-one-apim`) contain settings related to authentication and consent   .\\n\\n*   `authentication.consent.data_source`: This property specifies the JDBC data source used for consent management .\\n*   `authentication.consent.prompt`: This boolean property indicates whether a consent prompt should be displayed during authentication . Setting this to `true` would likely enable the system to ask for user consent.\\n*   `oauth.prompt_consent`: This property, also a boolean, controls whether consent is prompted for OAuth flows .\\n\\nThese configuration options suggest that the system can be configured to prompt for and manage user consent, which is a prerequisite for validating account data requests against PSU consent.\\n\\n## API Endpoints or Features\\n\\nWhile the provided snippets indicate the presence of consent management features, they do not directly expose specific API endpoints for \"Read Account Data Request against PSU consent for addressed account identification.\" The `self-registration-with-verification.jsp` file interacts with `selfRegistrationMgtClient` to get purposes and `usernameRecoveryApi` to get claims  . These clients likely interact with internal APIs related to identity and consent management.\\n\\nThe presence of `org.wso2.carbon.identity.auth.server.feature` and `org.wso2.carbon.identity.authz.server.feature`   suggests that the system has capabilities for authentication and authorization, which would be integral to validating access to account data based on consent.\\n\\n## Documentation References\\n\\nThe provided context does not include direct documentation references for the specific requirement of validating \"Read Account Data Request against PSU consent for addressed account identification.\" However, the wiki page \"Build System\" provides an overview of the WSO2 API Manager\\'s architecture and build process, which could serve as a starting point for understanding the overall system . Further investigation into the WSO2 Carbon Identity and Consent Management components would be necessary to find specific documentation related to the requested functionality.\\n\\n## Notes\\n\\nThe provided code snippets indicate that the `wso2/product-apim` repository includes components for consent management and identity authentication/authorization. While the system appears to have the foundational elements to support the validation of account data requests against PSU consent, the exact implementation details, specific API endpoints for this validation, and direct documentation references are not explicitly present in the provided context. The `pom.xml` files show the inclusion of consent management features, and the `default.json` files offer configuration options for consent prompting. The `.jsp` files demonstrate how user consent is captured during self-registration. To fully verify the requirement, a deeper dive into the `org.wso2.carbon.identity.consent.mgt` and related modules would be necessary.\\n\\nWiki pages you might want to explore:\\n- [Build System (wso2/product-apim)](/wiki/wso2/product-apim#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_72836eef-21eb-4584-9a32-d15c20bf3957\\n', 'id': 'lc_17d34d89-2ace-4443-9fb3-b62ef8909c36'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0071",
      "requirement": {
        "requirement_id": "ATOM_143",
        "requirement_text": "The ASPSP shall make detailed consent information retrievable by TPP via GET consent object for Bank Offered Consent",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0071_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the retrieval of detailed consent information by a TPP (Third Party Provider) via a GET consent object, which is relevant for Bank Offered Consent scenarios. The system provides a REST API endpoint for consent management, and its functionality is tested through integration tests.\\n\\n## Implementation Details\\n\\nThe core functionality for consent management is exposed through a REST API. The `ConsentMgtTestCase.java`  and `SelfSignUpConsentTest.java`  integration test classes demonstrate how consent-related operations are performed.\\n\\nSpecifically, the `ConsentMgtTestCase`  class includes methods for adding PII categories, purpose categories, purposes, and consent receipts. For instance, the `addReceipt` method  sends a POST request to the consent endpoint to create a consent receipt. The `SelfSignUpConsentTest`  class further illustrates consent management in the context of self-registration, including methods like `getConsents`  and `getConsent`  to retrieve consent details.\\n\\nThe `getConsent` method  in `SelfSignUpConsentTest.java`  is particularly relevant as it demonstrates retrieving a specific consent receipt using a `receiptId`. This method constructs a REST client and makes a GET request to the `consentEndpoint + \"/receipts/\" + receiptId` . The response is then returned as a String, which can be parsed to extract consent details. This directly addresses the requirement for TPPs to retrieve detailed consent information.\\n\\nThe `OAuth2ServiceAbstractIntegrationTest.java`  class also contains `sendApprovalPostWithConsent` methods   that are used to approve consent during OAuth2 flows, indicating that consent is an integral part of the authorization process.\\n\\n## Configuration Options\\n\\nThe `default-identity.xml`  file shows a configuration option for enabling consent management during SSO: `<EnableSSOConsentManagement>true</EnableSSOConsentManagement>` . This indicates that consent management can be enabled or disabled at a global level.\\n\\nAdditionally, the `UserConsentEnabledGrantTypes`  section in `default-identity.xml`  specifies which OAuth2 grant types will filter user claims based on user consent in responses like `id_token` or user info. By default, `authorization_code` and `implicit` grant types are configured for this.\\n\\nThe `AdvancedApplicationConfiguration.java`  model includes a `useExternalConsentPage` boolean property , suggesting that there\\'s an option to use an external consent page, which could be relevant for customizing the consent experience.\\n\\n## API Endpoints or Features\\n\\nThe primary API endpoint for consent management is `/api/identity/consent-mgt/v1.0/consents`  . This endpoint is used for various consent-related operations, including:\\n\\n*   **Adding PII Categories**: `POST /api/identity/consent-mgt/v1.0/consents/pii-categories` \\n*   **Adding Purpose Categories**: `POST /api/identity/consent-mgt/v1.0/consents/purpose-categories` \\n*   **Adding Purposes**: `POST /api/identity/consent-mgt/v1.0/consents/purposes` \\n*   **Adding Consent Receipts**: `POST /api/identity/consent-mgt/v1.0/consents` \\n*   **Retrieving Consent Receipts**: `GET /api/identity/consent-mgt/v1.0/consents/receipts/{receiptId}` . This specific endpoint allows TPPs to retrieve detailed consent information.\\n\\nThe `web.xml`  configuration for the `IdentityConsentMgtV1ApiServlet`  confirms the `/identity/consent-mgt/v1.0/*`  URL pattern for consent management APIs.\\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page   provides an overview of Consent Management, detailing its purpose, key components (PII Categories, Purposes, Purpose Categories, Consent Receipts), and the consent collection and enforcement processes. It explicitly mentions that consent decisions affect how user information is shared, including token issuance and API responses.\\n\\n## Test Criteria Verification\\n\\nThe `SelfSignUpConsentTest.java`  class includes a test method `getPurposes()`  that retrieves consents for a user and then fetches a specific consent receipt. This test asserts that the `collectionMethod`  of the retrieved receipt is \"Web Form - Self Registration\" . This demonstrates the capability to retrieve final consent details after a process (in this case, self-registration, which can be analogous to a Bank Offered Consent process with PSU interaction). The `OIDCSSOConsentTestCase.java`  also tests consent management after updating application claim configurations, verifying that requested claims are prompted for consent.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which are valuable for understanding the intended functionality and how the system is designed to be used. While these tests confirm the existence and basic operation of the consent management APIs, they do not expose the internal service layer implementation details. The term \"Bank Offered Consent\" is not explicitly found in the codebase, but the general consent management framework and the ability to retrieve consent objects are directly supported and tested. The `piiPrincipalId`  in the `addReceipt` method  could be used to identify the PSU (Payment Service User) in a banking context.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_331b046f-08a5-453b-a80a-877adc625c3b\\n', 'id': 'lc_06723872-4e85-4791-91eb-3253f473ccbe'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0071_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support consent management, which is a prerequisite for retrieving consent information. The presence of features related to consent management and configuration options for consent data sources suggests that the system is designed to handle consent-related operations. However, the provided context does not contain specific implementation details, API endpoints, or documentation references for a TPP to retrieve detailed consent information via a `GET consent object` for Bank Offered Consent.\\n\\n### Implementation Details and Configuration Options\\nThe codebase includes features for consent management, such as `org.wso2.carbon.consent.mgt.server.feature.group`     and `org.wso2.carbon.identity.consent.mgt.server.feature.group`     . These features are included in the product builds for the API Control Plane, Gateway, and All-in-One APIM distributions.\\n\\nConfiguration for consent management includes setting the data source for authentication consent, as seen in `default.json` files with the property `\"authentication.consent.data_source\": \"jdbc/WSO2AM_DB\"`   . There is also a configuration option `\"authentication.consent.prompt\": false`   , which likely controls whether a consent prompt is displayed during authentication. The `consent-mgt-config.xml` file is also referenced for datasource replacement, indicating its role in consent management configuration    .\\n\\n### API Endpoints or Features\\nWhile the codebase indicates support for consent management, there are no explicit API endpoints or features within the provided snippets that directly correspond to a \"GET consent object\" for TPPs to retrieve detailed consent information after a Bank Offered Consent process. The `GrantTypeTokenGenerateTestCase.java`  test case demonstrates an OAuth 2.0 authorization code flow where user consent is approved, but it does not show a TPP retrieving consent details via a specific API. The test case includes steps for user login and approving an application, which involves a `sessionDataKeyConsent`  and a `consent=approve`  parameter, suggesting that consent is handled during the authorization process.\\n\\n### Documentation References\\nThe provided context does not include specific documentation references for TPPs to retrieve consent details. The wiki page \"Build System\"  focuses on the build process and does not delve into API functionalities for consent management.\\n\\n## Notes\\nThe presence of \"Consent Management dependency\"  and related features in the `pom.xml` files indicates that consent management is an integrated part of the WSO2 API Manager. However, the specific mechanism for a TPP to retrieve consent details via a `GET consent object` is not explicitly detailed in the provided code snippets. The `self-registration-with-verification.jsp`   and `all-in-one-apim/modules/distribution/product/src/main/extensions/self-registration-with-verification.jsp`  files show UI elements and logic for user consent during self-registration, which is a different aspect of consent handling than TPP retrieval of consent objects.\\n\\nWiki pages you might want to explore:\\n- [Build System (wso2/product-apim)](/wiki/wso2/product-apim#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_1188078c-87cf-48e6-ab80-2566a1815aa7\\n', 'id': 'lc_c943f9a8-3308-4f63-b1a7-fa90154d3291'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0072",
      "requirement": {
        "requirement_id": "ATOM_175",
        "requirement_text": "The Consent-ID header MUST be included to identify the corresponding consent granted by the PSU.",
        "strength": "MUST",
        "capability": "Consent Management",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0072_1",
          "text": "### getDetailedConsent method\n \nThis method lets you retrieve detailed consent for a given consent ID. A detailed consent includes the following in \naddition to consent resource-specific data: \n\n - Relative consent authorization data\n - Relative consent account mapping data \n - Relative consent attributes\n \n``` java\nDetailedConsentResource getDetailedConsent(String consentID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_2",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_3",
          "text": "### Data\nThe following table explains the data available in `ConsentValidateData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| headers   | JSONObject            | The request headers sent in the request. |\n| body   | JSONObject            | The payload sent in the request. |\n| electedResource   | String            | The path invoked in the request. For example: `/accounts/{AccountId}`|\n| consentId | String                | The consent ID related to the current resource request. This consent ID is bound to the user access token used. |\n| userId | String                | The user ID related to the current resource request. This user ID is retrieved from the user access token. |\n| clientId | String                | The ID of the TPP application related to the current resource request. This client ID is retrieved from the user access token.|\n| comprehensiveConsent  | DetailedConsentResource   | The comprehensive consent object related to the consent that is being validated. This object contains all the details related to the consent. |\n| resourceParams | Map<String, String>                | A map containing the full resource path with query parameters (ex: `aisp/accounts/{AccountId}?queryParam=urlEncodedQueryParamValue`), HTTP method, and context (ex: `/open-banking/v3.1/aisp`) of the request. |\n\nThe following table explains the data available in `ConsentValidationResult`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| isValid | boolean | An attribute to identify whether the consent is in a valid state or not. |\n| modifiedPayload | JSONObject | Optionally used to set a modified error payload to be sent with the consent validation response. If a modified payload is set, it is given priority over creating a generic error response using the message and code information. |\n| consentInformation | JSONObject | Used to set the consent data to the consent validation result. This data will be sent to the bank backend. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_4",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports consent management, which is a prerequisite for handling a `Consent-ID` header. The system includes API endpoints for managing consents, purposes, and PII categories, and integration tests demonstrate how consent is collected and approved during authentication flows. However, the provided context does not explicitly show the implementation details for processing a `Consent-ID` header in account information requests.\\n\\n### Implementation Details\\nThe `wso2/product-is` repository includes features for Consent Management, which involves collecting, storing, and managing user consent for personal data processing . The `SelfSignUpConsentTest.java` file, for instance, demonstrates how consent is collected during self-registration . The `getConsentReqBody` method in `SelfSignUpConsentTest.java` constructs a JSON request body for consent, including details like `jurisdiction`, `collectionMethod`, `piiPrincipalId`, and `purposeId` .\\n\\nThe `OIDCSSOConsentTestCase.java` and `OIDCAuthCodeGrantSSOTestCase.java` files illustrate how consent approval is handled during OAuth2/OIDC authentication flows  . Specifically, the `sendApprovalPostWithConsent` method is used to send an approval post request with consent parameters, which includes a `sessionDataKeyConsent` . This `sessionDataKeyConsent` is extracted from the authentication response and is crucial for linking the user\\'s consent to the ongoing authentication session  .\\n\\nWhile the codebase extensively covers consent collection and approval, there is no explicit mention or implementation detail within the provided snippets that directly addresses the processing or validation of a `Consent-ID` header in account information requests. The existing consent mechanisms primarily revolve around `sessionDataKeyConsent` during authentication and consent management APIs.\\n\\n### Configuration Options\\nThe `wso2/product-is` repository uses a `CONSENT_DB` datasource for storing consent-related information . This is configured in `db_separation_config.toml` with the `authentication.consent.data_source` property pointing to `jdbc/CONSENT_DB` .\\n\\nThe `pom.xml` file includes a feature group for `org.wso2.carbon.identity.consent.mgt.server.feature.group`, indicating that consent management is a modular and configurable component of the WSO2 Identity Server .\\n\\n### API Endpoints or Features\\nThe repository exposes several REST API endpoints related to consent management:\\n*   `/api/identity/consent-mgt/v1.0/consents`: This endpoint is used for general consent management operations . The `SelfSignUpConsentTest.java` file defines `CONSNT_ENDPOINT_SUFFIX` as `/api/identity/consent-mgt/v1.0/consents` .\\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/(.*)`: This endpoint is used to retrieve specific consent receipts . The `getConsent` method in `SelfSignUpConsentTest.java` uses this endpoint to retrieve a consent based on a `receiptId` .\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes(.*)`: Endpoints for managing purposes, including POST for adding , GET for retrieving , and DELETE for removing purposes . The `addPurposeCategory` method in `SelfSignUpConsentTest.java` interacts with this endpoint .\\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories(.*)`: Endpoints for managing PII categories, including POST for adding , GET for retrieving , and DELETE for removing PII categories . The `addPIICategory` method in `SelfSignUpConsentTest.java` uses this endpoint .\\n\\nThese APIs allow for the programmatic management of consent-related data, which is essential for a system that would enforce a `Consent-ID` header.\\n\\n### Documentation References\\nThe \"Advanced Features\" wiki page for `wso2/product-is` provides an overview of Consent Management, describing it as a framework to collect, store, and manage user consent for processing personal data . It outlines key consent components such as PII Categories, Purposes, Purpose Categories, and Consent Receipts . The wiki also details the consent collection process during self-registration and authentication, and how consent enforcement affects token issuance and API responses .\\n\\n## Notes\\nThe provided code snippets and wiki pages confirm that WSO2 Identity Server has robust consent management capabilities, including APIs for managing consent artifacts and integration tests demonstrating consent collection during various authentication flows. However, the specific requirement of including a `Consent-ID` header in account information requests and its validation is not explicitly detailed in the provided context. The existing `sessionDataKeyConsent` is used internally during authentication to manage consent within a session, but it is not presented as a direct equivalent to a `Consent-ID` header for subsequent account information requests. To fully answer the user\\'s query, more information on how `Consent-ID` headers are expected to be processed and validated in the context of account information requests would be needed.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b01c6087-82d8-4f07-a980-cba7f757f084\\n', 'id': 'lc_0c6f9059-3a1c-4b08-b681-fb8b5f754065'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0072_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_9045c128-be4b-48ef-a84b-7842a90287d6'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0073",
      "requirement": {
        "requirement_id": "ATOM_085",
        "requirement_text": "TPP must control session fixation using the state parameter during redirect SCA approach",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0073_1",
          "text": "#Using Sample Resources\n\nFollowing configs can be used in test-config.xml to use sample SSA and keystores for DCR tests.\n\n    <DCR>\n        <SSAPath>Path.To.Directory/ssa.txt</SSAPath>\n        <!-- SSA SoftwareId -->\n        <SoftwareId>jFQuQ4eQbNCMSqdCog21nF</SoftwareId>\n        <!-- SSA Redirect Uri -->\n        <RedirectUri>https://www.google.com/redirects/redirect1</RedirectUri>\n    </DCR>\n\nUse signing.jks in 'signing-keystore' directory as the Application Keystore, and transport.jks in 'transport-keystore'\ndirectory as the Transport Keystore.\n\nSample Keystore information:\n\n- Signing Kid = 7eJ8S_ZgvlYxFAFSghV9xMJROvk\n\n- Signing keystore alias = tpp7-signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - 7x6UrhU-Yj1Aa9Ird03JJCcDurs\n\n- Transport keystore alias = tpp7-transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_2",
          "text": "### Run tests\n\n1. Use a tool and convert the private key (tpp.com.key) to a JWK. Use this JWK to update the value of the **keys** \n   array element in the JSON configuration.\n2. Log in to the test suite.\n3. Select the Open Banking test plan and client authentication type as follows:\n    - Test plan: `FAPI-CIBA-ID1: Authorization server test`\n    - Client Authentication Type `private_key_jwt` or `mtls`\n    - CIBA Mode: `poll`\n    - FAPI Profile: `plain_fapi`\n    - Client Registration Type: `static_client`\n    ![test_configuration](../assets/img/conformance/test-config.png)\n4. Copy the content in the modified JSON configuration file and paste it into the **JSON** tab. ![json_configuration](../assets/img/conformance/json-config.png)\n5. Click **Start Test Plan**.\n6. Run each given test in sequence. ![run_test](../assets/img/conformance/run-test.png)\n7. Refer to <https://openid.net/certification/instructions/> for more information.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_3",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_4",
          "text": "# redirect_endpoint config defines the user's succesfull authorisations redirect endpoint. This page displays the succesful CIBA flow completions.\nredirect_endpoint = \"https://localhost:9446/authenticationendpoint/ciba.jsp\"",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_5",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - 9ZzFFBxSLGEjPZogRAbvFd\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = BkHxeIHKyMKF6SgGwqYzLUvTQfk\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - _wYMMJDl96s6D8p93iO2ApHw1BE\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support session fixation protection using the `state` parameter during redirect flows, particularly within its OAuth2 and OpenID Connect implementations. The `state` parameter is used to maintain the state between the authorization request and the callback, which helps prevent cross-site request forgery (CSRF) attacks and session fixation.\\n\\n## Implementation Details\\nThe `state` parameter is generated and validated in several OAuth2 and OpenID Connect related flows. For instance, in the `MockOIDCIdentityProvider.java` file, a mock OIDC Identity Provider is configured to handle authorization requests and includes the `state` parameter in the redirect URL during the authorization flow . The `state` parameter is extracted from the request and then included in the `Location` header of the response, ensuring it is passed back to the client .\\n\\nSimilarly, in the `FederatedTokenSharingTestCase.java` and `JITUserAssociationTestCase.java` files, which are integration tests for OAuth2 flows, the `state` parameter is extracted from the redirect URL after an authentication step  . These test cases then use this `state` parameter in subsequent requests, implying that the system expects and validates its presence to maintain session integrity  .\\n\\nThe `OAuth2RestClient.java` also demonstrates the initiation of authentication requests where the `state` parameter would typically be involved, although its explicit handling is not shown in the provided snippet .\\n\\n## API Endpoints or Features\\nThe primary API endpoints involved in these flows are the authorization endpoint (`/authorize`) and the token endpoint (`/token`) . The `state` parameter is typically sent with the initial authorization request to the `/authorize` endpoint and is expected to be returned by the Identity Provider to the client\\'s redirect URI.\\n\\n## Test Criteria\\nThe integration tests, such as `FederatedTokenSharingTestCase.java` and `JITUserAssociationTestCase.java`, implicitly verify the handling of the `state` parameter by extracting it from redirect URLs and using it in subsequent steps  . The `MockOIDCIdentityProvider.java` explicitly includes the `state` parameter in its mock authorization response, which is then used by the client . This indicates that the system is designed to pass and potentially validate the `state` parameter to prevent session fixation.\\n\\n## Notes\\nThe provided snippets are primarily from integration tests, which demonstrate the expected behavior of the system. While these tests show the `state` parameter being passed and extracted, the explicit validation logic for matching the `state` parameter to the original request is not directly visible in these snippets. However, the consistent inclusion and extraction of the `state` parameter across various OAuth2 and OIDC flows strongly suggest its role in session fixation protection. The wiki page on \"SAML and Identity Federation\" does not directly mention the `state` parameter, as it focuses on SAML, which uses a `RelayState` parameter for similar purposes  . The user\\'s query specifically mentions the `state` parameter, which is a core component of OAuth2/OpenID Connect for CSRF protection.\\n\\nWiki pages you might want to explore:\\n- [SAML and Identity Federation (wso2/product-is)](/wiki/wso2/product-is#3.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0d56963f-fb8f-46dd-8275-f766524a6330\\n', 'id': 'lc_d795a00a-6c31-4046-8b83-b53c001ac4d1'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0073_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, primarily uses OWASP CSRFGuard for Cross-Site Request Forgery (CSRF) protection, which is a different security mechanism than session fixation protection using the `state` parameter in redirect-based Strong Customer Authentication (SCA) flows. The provided code snippets do not directly indicate support for validating the `state` parameter for session fixation protection in SCA redirects.\\n\\n## Implementation Details\\nThe codebase utilizes OWASP CSRFGuard for general CSRF protection. This is evident from the configuration files such as `Owasp.CsrfGuard.Carbon.properties` found in various modules like `api-control-plane` , `all-in-one-apim` , and `gateway` . The `CsrfGuardHttpSessionListener` is configured in `web.xml.j2` to generate per-session CSRF tokens .\\n\\nThe OWASP CSRFGuard configuration includes settings for:\\n*   **Enabling the filter**: `org.owasp.csrfguard.Enabled = true` .\\n*   **Validating when no session exists**: `org.owasp.csrfguard.ValidateWhenNoSessionExists = true` .\\n*   **Unprotected methods**: `org.owasp.csrfguard.UnprotectedMethods=GET` to disable CSRF validation for GET requests .\\n*   **Token per page**: `org.owasp.csrfguard.TokenPerPage=false` and `org.owasp.csrfguard.TokenPerPagePrecreate=false` are explicitly disabled due to overhead and unintended behavior .\\n*   **Actions on attack detection**: The system logs potential CSRF attacks  and sends a 403 error .\\n*   **Token name and session key**: The CSRF token is named `X-CSRF-Token`  and stored in the session using `OWASP_CSRFTOKEN` as the key .\\n\\nThe `login.jsp` file contains JavaScript functions like `getParameterByName` which can extract parameters from a URL . While this function could theoretically be used to retrieve a `state` parameter, there is no explicit code in the provided snippets that demonstrates its use for validating a `state` parameter to prevent session fixation during an SCA redirect.\\n\\n## Configuration Options\\nThe primary configuration for security, specifically CSRF protection, is managed through `Owasp.CsrfGuard.Carbon.properties` files. These files allow for enabling/disabling the CSRFGuard filter, defining unprotected methods, and configuring actions to take when a CSRF attack is detected .\\n\\n## API Endpoints or Features\\nThe `web.xml.j2` file defines several servlet mappings for authentication and authorization flows, including `oauth2_login.do`, `oauth2_authz.do`, and `oauth2_logout.do` . These endpoints are related to OAuth2, which commonly uses the `state` parameter for CSRF protection and session fixation prevention. However, the provided snippets do not contain the specific implementation logic within these servlets or their corresponding JSP files (e.g., `login.jsp`, `oauth2_authz.jsp`) that would validate the `state` parameter for session fixation. The `login.jsp` does include a `checkSessionKey()` function that makes an AJAX call and handles redirects based on the response status , but it does not explicitly show `state` parameter validation.\\n\\n## Documentation References\\nThe provided snippets are configuration files and JSP pages, which do not contain direct documentation references for the specific requirement of validating the `state` parameter for session fixation in SCA. The comments within the `Owasp.CsrfGuard.Carbon.properties` files explain the purpose of various OWASP CSRFGuard properties  , but these relate to general CSRF protection rather than the specific `state` parameter validation in OAuth2/SCA flows.\\n\\n## Conclusion\\nBased on the provided codebase context, the repository primarily implements CSRF protection using OWASP CSRFGuard. While there are OAuth2-related endpoints, there is no explicit evidence in the snippets to confirm that the `state` parameter is specifically validated to control session fixation during redirect-based SCA approaches. The existing CSRF protection mechanisms are distinct from the `state` parameter validation in OAuth2/OIDC flows.\\n\\n## Notes\\nThe user\\'s query specifically asks about \"session fixation using the state parameter during redirect SCA approach\". The provided code snippets heavily feature OWASP CSRFGuard configurations, which is a general CSRF prevention library. While CSRF and session fixation are related security concerns, the `state` parameter in OAuth2/OIDC flows is a specific mechanism for CSRF protection and session fixation prevention in redirect-based authentication. The snippets do not show the explicit logic for validating this `state` parameter in the context of an SCA redirect. The `login.jsp` file and `oauth2_login.do` servlet suggest the presence of OAuth2 flows, but the internal logic for `state` parameter validation is not visible in the provided context.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c6110ea9-29aa-4031-a3f6-df6b9d7e69da\\n', 'id': 'lc_ea188ae4-41fe-4e37-afb3-e1a90671d1a7'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0074",
      "requirement": {
        "requirement_id": "ATOM_029",
        "requirement_text": "TPPs SHALL keep the TPP-Redirect-URI used within all authorisation processes for a specific transaction constant during the lifecycle of that transaction.",
        "strength": "SHALL",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0074_1",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_2",
          "text": "# redirect_endpoint config defines the user's succesfull authorisations redirect endpoint. This page displays the succesful CIBA flow completions.\nredirect_endpoint = \"https://localhost:9446/authenticationendpoint/ciba.jsp\"",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_3",
          "text": "### Resource Request\n\nAfter an API consumer application obtains an access token, it is used to invoke a resource endpoint. In this request, \nthe following validations will be performed:\n\n- Token validity verification\n- Token type verification (User Access Token/Application Access Token)\n- Scopes/roles validation\n- Token-bound certificate validation\n- Consent validation\n\nThe resource requests go through token-bound certificate validations according to\n[rfc8705](https://datatracker.ietf.org/doc/html/rfc8705)\nThe MTLS token binding happens once a token is issued to a particular client. This ensures that at the resource endpoint,\nthe provided MTLS certificate can be validated against the certificate bound to the token. Self-contained tokens are\nused for this purpose and are bound to the tokens via a claim named `cnf`. For more information,\nsee [Token Authentication](token-authentication.md#certificate-bound-access-tokens).\n\nConsent validation ensures that the API consumer application's resource requests adhere to the consent provided \nby the bank customers. This is a custom implementation as the behaviour of consent is defined by an open banking \nspecification. You can use the [Consent Validate](../develop/consent-management-validate.md) endpoint and define the \nconsent validations by comparing the resource requests against the user-provided consent.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_4",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_5",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the requirement that the `TPP-Redirect-URI` remains constant during the authorization lifecycle of a transaction, particularly within the context of OAuth2 and OpenID Connect flows. The codebase includes tests that validate the handling of `redirect_uri` parameters, including scenarios where invalid or repeated redirect URIs are provided, suggesting an enforcement mechanism.  \\n\\n### Implementation Details\\n\\nThe system validates the `redirect_uri` parameter during various stages of the OAuth2 flow. For instance, in Pushed Authorization Requests (PAR), if a repeated `redirect_uri` is sent, the system returns a `BAD_REQUEST` error, indicating that it expects a single, consistent `redirect_uri`.  Similarly, an invalid `redirect_uri` in a PAR request also results in a `BAD_REQUEST` with an error message \"callback.not.match\", implying that the provided URI must match a pre-registered callback URL. \\n\\nThe `OAuth2Constant.java` file defines the constant `OAUTH2_REDIRECT_URI` which is used across various OAuth2 related operations, reinforcing the idea of a consistent redirect URI. \\n\\n### Configuration Options\\n\\nThe `redirect_uris` for an OAuth2/OIDC application are configured during application registration.  The `createApp` method in `OAuth2PushedAuthRequestTestCase.java` demonstrates how `callbackURLs` are set for an `OpenIDConnectConfiguration` object, which is part of the inbound protocol configuration for an application.  \\n\\nThe `oidc-fapi-conformance-tests/constants_fapi.py` file also shows examples of `redirect_uris` being defined for various FAPI applications, indicating that these are pre-configured values.  \\n\\n### API Endpoints or Features\\n\\nThe `redirect_uri` is a crucial parameter in the OAuth2 authorization endpoint (`/oauth2/authorize`) and the Pushed Authorization Request (PAR) endpoint (`/oauth2/par`).   The system expects the `redirect_uri` provided in these requests to be consistent with the registered callback URLs for the client application. \\n\\nThe `OAuth2DPopTestCase.java` demonstrates the flow where a `redirect_uri` is sent with a PAR request and subsequently used in the authorization request.   This implies that the `redirect_uri` is established early in the transaction and is expected to be maintained.\\n\\n### Documentation References\\n\\nThe \"OAuth2 and OpenID Connect\" wiki page provides an overview of the OAuth2 and OIDC implementation, including supported grant types and token management.  While it doesn\\'t explicitly mention \"TPP-Redirect-URI\", the general principles of OAuth2 and OIDC, which this repository implements, require the `redirect_uri` to be consistent throughout the authorization flow to prevent redirection attacks. The wiki page also highlights the platform\\'s compliance with standards through OIDC and FAPI conformance testing, which would inherently cover such security requirements. \\n\\n## Notes\\n\\nThe term \"TPP-Redirect-URI\" is specific to certain financial-grade API (FAPI) profiles or Open Banking specifications. In the context of the provided codebase, the general OAuth2 term \"redirect_uri\" is used. The tests and configurations indicate that the system enforces the use of a consistent and pre-registered `redirect_uri` throughout the authorization process, which aligns with the spirit of the \"TPP-Redirect-URI SHALL keep constant\" requirement. The codebase does not explicitly use the \"TPP-Redirect-URI\" terminology, but the underlying mechanism for `redirect_uri` validation supports the stated requirement.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_715ff40b-fc93-4888-b2d7-80f3d2a1ddb6\\n', 'id': 'lc_46da44d7-598b-4c1d-92b0-2c4647e6310a'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0074_6",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to have limited direct support for enforcing the constancy of `TPP-Redirect-URI` during the authorization lifecycle of a transaction. The provided snippets primarily focus on API management, OAuth configurations, and integration tests, with only one snippet tangentially related to redirect URIs in a workflow context.\\n\\n## Implementation Details\\nThe codebase does not contain explicit implementation details for enforcing the constancy of `TPP-Redirect-URI` as described in the prompt. The closest mention of a redirect URI is within a test case for a subscription workflow, where a `redirectUrl` is asserted to be \"http://google.lk\" . This test, `testHTTPredirectInSubscriptionWorkflow`, checks if the custom subscription workflow response returns a specific redirect URI . However, this is an integration test for a subscription workflow and does not directly address the `TPP-Redirect-URI` constancy requirement for authorization processes.\\n\\n## Configuration Options\\nThere are no explicit configuration options within the provided snippets that directly control or enforce the constancy of `TPP-Redirect-URI` during an authorization lifecycle. The `identity.xml` configuration file contains various OAuth-related settings, such as `OAuth2AuthzEPUrl` and `OAuth2TokenEPUrl` , but these define endpoint URLs rather than policies for redirect URI constancy. Similarly, `api-manager.xml` includes `OAuthConfigurations`  but lacks specific settings for `TPP-Redirect-URI` enforcement.\\n\\n## API Endpoints or Features\\nThe provided code snippets do not reveal any specific API endpoints or features designed to enforce the constancy of `TPP-Redirect-URI`. The `APIStoreRestClient` and `APIPublisherRestClient` are used in integration tests to manage APIs and subscriptions , but their functionalities do not extend to the specific requirement of maintaining a constant redirect URI throughout an authorization transaction.\\n\\n## Documentation References\\nNo documentation references related to `TPP-Redirect-URI` constancy were found within the provided code snippets.\\n\\n## Notes\\nThe prompt specifically asks about \"TPPs SHALL keep the TPP-Redirect-URI used within all authorisation processes for a specific transaction constant during the lifecycle of that transaction.\" The provided code snippets are primarily integration tests and configuration files for WSO2 API Manager. While there are mentions of \"redirect\" in `SubscriptionWFHTTPRedirectTest.java` , this context is related to subscription workflows and not directly to the `TPP-Redirect-URI` in authorization processes as defined by the prompt. The `identity.xml` and `api-manager.xml` files contain general OAuth configurations, but none specifically address the constancy of redirect URIs for TPPs. Therefore, based on the provided context, there is no direct evidence to suggest that this repository supports the specified requirement.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_48efe150-644d-4afa-853b-73ce53f5056e\\n', 'id': 'lc_212f80fc-fa9c-430e-a14b-b468cedef14d'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0075",
      "requirement": {
        "requirement_id": "ATOM_069",
        "requirement_text": "The system shall support consent status 'expired' when consent has exceeded its validity period such as after 90 days",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0075_1",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0075_2",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0075_3",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0075_4",
          "text": "## **Data retention**\n\nThis feature is used for archival purposes of the data that we purge using the consent purging scripts.\n  \n**Instructions for enabling data retention**\n\n- Configure in the consent data purging script with types of data to be archived as below,\n```\n    SET enableDataRetentionForAuthResourceAndMapping = TRUE;\n    SET enableDataRetentionForFsConsentFile = FALSE;\n    SET enableDataRetentionForFsConsentAttribute = FALSE;\n    SET enableDataRetentionForFsConsentStatusAudit = TRUE; \n```\n- Execute purging script with data retention enabled,\n\n```\nWSO2_FS_CONSENT_CLEANUP_SP(\n                consentTypes,\n                clientIds,\n                consentStatuses,\n                purgeConsentsOlderThanXNumberOfDays,\n                lastUpdatedTime,\n                backupTables,\n                enableAudit,\n                analyzeTables,\n                enableDataRetention\n);\n```\n\n- This will create temporary retention consent tables in consent DB with `RET_` prefix and store the purged data temporary to these tables.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0075_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0076",
      "requirement": {
        "requirement_id": "ATOM_087",
        "requirement_text": "TPP must validate confirmationCode semantics in transaction authorization confirmation response",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0076_1",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_2",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_3",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_4",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_5",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0076_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, the WSO2 Financial Services Accelerator, does not appear to directly support the validation of `confirmationCode` semantics by a TPP in a transaction authorization confirmation response. The provided codebase primarily focuses on the implementation of Open Banking APIs, consent management, and administrative operations, but lacks explicit mechanisms for TPPs to perform such validation.\\n\\n## Implementation Details  \\n\\nThe OpenAPI specifications for \"Confirmation of Funds\"  and \"Payment Initiation\"  define the structure of requests and responses for these APIs. These specifications include schemas for various objects like `obFundsConfirmationConsentResponse1`  and `obFundsConfirmationResponse1` . However, there is no explicit `confirmationCode` field defined within these response schemas that a TPP would validate. The schemas primarily focus on consent IDs, status, dates, and amounts.\\n\\nThe `obWriteFundsConfirmationResponse1` schema, found in the payment initiation OpenAPI specification, also does not contain a `confirmationCode` field for TPP validation . It includes `FundsAvailableResult` with `FundsAvailableDateTime` and `FundsAvailable` fields. \\n\\nThe `AuthorizationFlowValidationTest.groovy` file  demonstrates consent authorization flows and validation of scopes, but it does not include any tests related to `confirmationCode` semantics in transaction authorization responses.  \\n\\n## Configuration Options \\n\\nThe `accelerator-extensions-v1.0.0.yaml` file defines API extensions for pre-processing consent revocation . While it allows for external validation during consent revocation, there are no configuration options or extension points specifically for TPPs to validate `confirmationCode` semantics in authorization confirmation responses. \\n\\nThe \"Admin Operations\" wiki page describes an \"External Service Integration Framework\" <wiki_page repo_name=\"wso2/financial-services-accelerator\" id=\"3.3\" page_name=\"Admin Operations\" />. This framework supports various extension points like `PRE_PROCESS_CLIENT_CREATION`, `PRE_PROCESS_CONSENT_CREATION`, and `VALIDATE_AUTHORIZATION_REQUEST` <wiki_page repo_name=\"wso2/financial-services-accelerator\" id=\"3.3\" page_name=\"Admin Operations\" />. However, none of these directly address the TPP\\'s validation of `confirmationCode` semantics in the *response* of a transaction authorization. The `VALIDATE_AUTHORIZATION_REQUEST` extension point is for validating the *request* itself, not the response. <wiki_page repo_name=\"wso2/financial-services-accelerator\" id=\"3.3\" page_name=\"Admin Operations\" />\\n\\n## API Endpoints or Features  \\n\\nThe API specifications define endpoints for creating funds confirmation consents (`/funds-confirmation-consents`)  and payments (`/payments`) . The responses for these operations, such as `201FundsConfirmationConsentsCreated`  and `201FundsConfirmationsCreated` , return various data points like `ConsentId`, `CreationDateTime`, and `FundsAvailable` . However, none of these responses include a `confirmationCode` parameter for TPP validation. \\n\\nThe `consent_internal.yaml` file defines an internal API for consent validation, including details like `consentId`, `userId`, and `clientId` . This is an internal API and is not exposed for TPPs to validate `confirmationCode` semantics. \\n\\n## Documentation References \\n\\nThe OpenAPI specifications serve as documentation for the API structure . The \"Overview\" wiki page provides a high-level understanding of the accelerator\\'s capabilities, including API specifications for Accounts, Payments, and Funds Confirmations <wiki_page repo_name=\"wso2/financial-services-accelerator\" id=\"1\" page_name=\"Overview\" />. The \"Admin Operations\" wiki page details administrative consent management <wiki_page repo_name=\"wso2/financial-services-accelerator\" id=\"3.3\" page_name=\"Admin Operations\" />. However, none of these documents explicitly mention or describe a `confirmationCode` parameter that TPPs are expected to validate in transaction authorization confirmation responses. <wiki_page repo_name=\"wso2/financial-services-accelerator\" id=\"1\" page_name=\"Overview\" /> <wiki_page repo_name=\"wso2/financial-services-accelerator\" id=\"3.3\" page_name=\"Admin Operations\" />\\n\\n## Notes\\n\\nThe codebase primarily focuses on the server-side implementation of Open Banking APIs and consent management. The responsibility of validating `confirmationCode` semantics in transaction authorization confirmation responses typically lies with the TPP application itself, based on the Open Banking specifications it adheres to. The provided code does not show any explicit server-side mechanisms or API features designed for the TPP to perform this specific validation. If such a `confirmationCode` is part of a broader Open Banking standard, the TPP would be expected to implement its validation logic independently.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Admin Operations (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6bfe05ef-b6f8-49cc-8870-00046ae62a7c\\n', 'id': 'lc_10b00c0b-f881-4372-bdce-f09f56d52c44'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0077",
      "requirement": {
        "requirement_id": "ATOM_207",
        "requirement_text": "TPP SHALL provide certificate used for signing the request in base64 encoding when signature is included.",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0077_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of a base64 encoded certificate in the `TPP-Signature-Certificate` header when a signature is present, particularly in the context of OAuth2 and OpenID Connect (OIDC) flows, and specifically for Financial-grade API (FAPI) conformance.  The system can be configured to validate request object signatures and handle client certificates for token binding.  \\n\\n## Implementation Details\\n\\nThe system allows for the update of an application\\'s certificate, which can be provided in PEM format.  The `updateApplicationCertificate` method in `OAuth2ServiceAbstractIntegrationTest.java` takes an application ID and an `X509Certificate` object, converts it to PEM format using `convertToPem`, and then updates the application\\'s advanced configurations with this certificate.  The `convertToPem` method encodes the `X509Certificate` into a base64 string and wraps it with `BEGIN_CERT` and `END_CERT` headers. \\n\\nFor signature validation, the `OAuth2RequestObjectSignatureValidationTestCase.java` demonstrates how to enable request object signature validation for an application.  This involves setting the `validateRequestObjectSignature` property to `true` in the `OpenIDConnectConfiguration` for the application. \\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` script, used for FAPI conformance testing, includes logic to extract and compare certificate thumbprints.  It retrieves a thumbprint from the access token\\'s `cnf` claim (which can contain `x5t#S256` for SHA-256 thumbprint of the X.509 certificate)  and also computes a SHA256 thumbprint from a client certificate provided in the `X-Ssl-Cert` header.  These two thumbprints are then compared to ensure they match.  This indicates support for certificate-bound access tokens and validation of client certificates.\\n\\n## Configuration Options\\n\\nThe `oidc-metadata.json` file, which defines metadata for OIDC applications, includes a configuration option for `accessTokenBindingType`.  Among the available options for `accessTokenBindingType` is `certificate`, which signifies support for binding access tokens to client certificates. \\n\\nAdditionally, the `OAuth2RequestObjectSignatureValidationTestCase.java` shows that the `validateRequestObjectSignature` property can be enabled for an OIDC application.  This configuration ensures that request objects, which can be signed, are validated by the system.\\n\\n## API Endpoints or Features\\n\\nThe `OAuth2ServiceAbstractIntegrationTest.java` contains a method `updateApplicationCertificate` which interacts with an API to update application certificates.  While the exact API endpoint is not directly visible in the provided snippet, the presence of this method implies an underlying API for managing application certificates.\\n\\nThe `KeystoreMgtRestClient.java` client is used for managing certificates in the tenant keystore, with an endpoint defined as `/api/server/v1/keystores/certs`.  This client provides methods to `importCertToStore` and `checkCertInStore`, indicating API features for certificate management.  \\n\\n## Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" mentions \"Certificate\" as a token binding type, indicating that this feature is part of the OAuth2/OIDC implementation.  This wiki page serves as a high-level documentation reference for the supported features.\\n\\n## Test Criteria\\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` script directly addresses the test criteria by verifying that the thumbprint from the client certificate (which would be provided in a header like `X-Ssl-Cert`) matches the thumbprint embedded in the access token\\'s `cnf` claim.  This confirms the system\\'s ability to process and validate client certificates for token binding, which is a prerequisite for verifying a `TPP-Signature-Certificate` header. The `computeSHA256Thumbprint` function in this script specifically handles the base64 encoded client certificate from the `X-Ssl-Cert` header. \\n\\n## Notes\\n\\nThe provided snippets primarily focus on the server-side handling and validation of certificates and signatures. While the system supports certificate-bound access tokens and validation of signed request objects, the explicit handling of a `TPP-Signature-Certificate` header in the context of a TPP (Third Party Provider) is not directly detailed in the provided code. However, the underlying mechanisms for certificate management, signature validation, and token binding are present and would likely be leveraged for such a requirement. The `X-Ssl-Cert` header is used in the FAPI conformance tests as a proxy for client certificate information, which would be base64 encoded. \\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9e8176cd-ebc5-4edb-9bda-2c35bd8b18dc\\n', 'id': 'lc_8ec866bc-377a-469f-b3a4-de766761850e'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0077_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the provision of a base64 encoded certificate in a request header, specifically for mutual SSL authentication and JWT-related operations.   \\n\\n## Implementation Details\\n\\nThe system uses Base64 encoding for certificates in several contexts.  For instance, in mutual SSL authentication tests, a base64 encoded certificate is generated and included in the `X-WSO2-CLIENT-CERTIFICATE` header.   The `generateBase64EncodedCertificate()` method reads a certificate file and encodes its content into a Base64 URL-safe string.  This generated certificate is then used in API invocation tests. \\n\\nSimilarly, when adding an identity provider for JWT grant types, a public certificate is read from a keystore, encoded in Base64, and then set as part of the `IdentityProvider` object.  \\n\\nThe `APIMTestCaseUtils` class contains utility methods for decoding JWTs, including `getDecodedJWTHeader`, `getDecodedJWTSignature`, and `decode`, which handle Base64 decoding of JWT parts. \\n\\n## Configuration Options\\n\\nThe `deployment.toml` file includes a section for JWT configuration, where `encoding` can be set to `base64` or `base64url`.  This indicates that the system can be configured to handle different Base64 encoding schemes for JWTs. \\n\\n## API Endpoints or Features\\n\\nThe `ClientCertificatesApi` provides an endpoint to `addAPIClientCertificate`, which allows uploading a certificate.  While the `certificate` parameter is of type `File`, the context of other snippets suggests that the content of such a file could be base64 encoded. \\n\\nFor WebSub subscriptions, the `WebsubSubscriptionConfigurationDTO` includes fields for `signingAlgorithm` and `signatureHeader`, which are relevant for handling signatures and certificates in requests.  The `websub_api_template.xml` files show how a `signatureHeader` and `signingAlgorithm` are used to verify incoming webhook requests, including generating and comparing signatures.  \\n\\n## Documentation References\\n\\nThe provided snippets are primarily code and configuration files, and do not directly contain external documentation references. <cite /> However, the presence of integration tests like `APISecurityTestCase` and `JWTGrantTestCase` suggests that the functionality is well-tested within the codebase.  \\n\\n## Notes\\n\\nThe user\\'s query specifically mentions \"TPP-Signature-Certificate header\". <cite /> While the code shows usage of `X-WSO2-CLIENT-CERTIFICATE` for mutual SSL  and general certificate handling for JWTs , there is no direct mention of a header named \"TPP-Signature-Certificate\" in the provided snippets. <cite /> However, the capability to send and process base64 encoded certificates in headers is present.  The `WebsubSubscriptionConfigurationDTO` and `websub_api_template.xml` files indicate that the system is configurable for custom `signatureHeader` names, which could potentially be set to \"TPP-Signature-Certificate\".  \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_44e3355d-7b6d-482a-b65f-e891887fcc95\\n', 'id': 'lc_8a385d24-4b52-4d00-8a68-3e412ec453b4'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0078",
      "requirement": {
        "requirement_id": "ATOM_146",
        "requirement_text": "The ASPSP shall offer consent extension for both Detailed and Global Consent models if offered for one model",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "unknown",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0078_1",
          "text": "## Setting up Consent manager app",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0078_2",
          "text": "### Data model\n\nThe following table explains the data model associated with `ConsentHistoryResource`.\n\n??? tip \"Click here to see the data model associated with `ConsentHistoryResource`.\"\n            \n    | Parameter      | Type   | Description  | \n    | ---------|-------| -----------|\n    |consentID | String | The consent ID of the consent to which the history belongs |\n    |timestamp | long | The timestamp that the amendment occurred|\n    |reason | String | The reason caused the amendment on the consent |\n    |detailedConsentResource | DetailedConsentResource | The detailed consent data of the consent which existed prior to the amendment |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0078_3",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0078_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0078_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0079",
      "requirement": {
        "requirement_id": "ATOM_127",
        "requirement_text": "The ASPSP shall support Account Information Service consent with multiplicity specification for one-off or recurring access",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0079_1",
          "text": "#### Add CustomerCareOfficerRole Role\n\nCustomerCareOfficerRole is required for bank users to log into the Consent Manager Portal and search for the consents granted by any user.\n\n1. Go to **Roles** under the **User Management** tab in the left pane.\n\n2. Click on **+ New Role**.<br/> \n![roles](../assets/img/learn/consent-manager/roles.png)\n\n3. Enter following details and click on Next button.\n    - Role Name: CustomerCareOfficerRole\n    - Role audience: Organization<br/> \n![create-cc-role](../assets/img/learn/consent-manager/create-cc-role.png)\n\n4. Select the created **API Resource** under the **Permission Selection** section.\n\n5. Add the **consents:read_all** permission from the API resource separately.<br/> \n![create-role-step2](../assets/img/learn/consent-manager/create-role-step2.png)\n\n6. Click on the **Finish** button.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_2",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_3",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_4",
          "text": "## **Usage** **>> consent-cleanup.sql** This is a consent data cleanup script with batch wise delete, This procedure includes the cleanup of consents from the respective tables of *FS_CONSENT* , *FS_CONSENT_AUTH_RESOURCE* , *FS_CONSENT_MAPPING* , *FS_CONSENT_FILE* , *FS_CONSENT_ATTRIBUTE* , *FS_CONSENT_STATUS_AUDIT* 1. Compile the stored procedure. 2. Execute the compiled store procedure. **Data retention feature:** - If enabled, all the purged consents will be stored in temporary retention tables in the consent database. *- Logical condition and configs used for consent purging and data retention.* *CONSENT DATA PURGING PARAMETERS* - `consentTypes` - consent_types which should be eligible for purging. (ex : 'accounts,payments', leave as empty to skip) - `clientIds` - client_ids which should be eligible for purging. (leave as empty to skip) - `consentStatuses` - consent_statuses which should be eligible for purging. (ex : 'expired,revoked') - `purgeConsentsOlderThanXNumberOfDays` - time period to delete consents older than `n` days. (check below for more info.) - `lastUpdatedTime` - last_updated_time for purging, (if consent's updated time is older than this value then it's eligible for purging, check below for more info.) - Here if we wish to purge consents with last updated_time older than 31 days (1 month), we can configure `purgeConsentsOlderThanXNumberOfDays` = `31` this value is in no. of days. - If we wish to configure exact timestamp of the `lastUpdatedTime` rather than a time period, we can ignore configuring `purgeConsentsOlderThanXNumberOfDays` = `NULL`, and only configure lastUpdatedTime with exact unix timestamp. - `ex : lastupdatedtime = 1660737878;` *CONSENT DATA RETENTION PARAMETERS* - `enableDataRetention` - set true for enable data retention (archive purged data, default : false) - Note: When running backup procedure (consent-cleanup-restore.sql) to restore back the purged data with the retention feature enabled, make sure to clean retention tables to avoid duplicates when purging again. Note: below data retention parameters need to set in the scripts before compiling, Ignore if data retention is not enabled. - `enableDataRetentionForAuthResourceAndMapping` - enable storing auth resource and consent mapping tables for retention data. - `enableDataRetentionForFsConsentFile` - enable storing fs_consent_file table for retention data. - `enableDataRetentionForFsConsentAttribute` - enable storing fs_consent_attribute table for retention data. - `enableDataRetentionForFsConsentStatusAudit` - enable storing fs_consent_status_audit table for retention data. *OTHER PARAMETERS* - `backupTables` - enable the backup table to restore later at a later stage. (Please note this backup tables will be overwritten every time you run the cleanup script.). - Also, this would not capture the consents which were created in between the backup task and the cleanup iteration, hence if consents created after the backup task will not be able to restore if its get deleted from the cleanup iteration. - `enableAudit` - By setting this parameter to true, will log each of deleted consents in the auditlog_fs_consent_cleanup table for track them in a later time. Once compiled the stored procedure, We can execute the procedure with input parameters as in below example. (for mysql) ``` WSO2_FS_CONSENT_CLEANUP_SP( consentTypes, clientIds, consentStatuses, purgeConsentsOlderThanXNumberOfDays, lastUpdatedTime, backupTables, enableAudit, analyzeTables, enableDataRetention ); ``` ``` Ex: mysql> call WSO2_FS_CONSENT_CLEANUP_SP('accounts,payments', 'clientId1,clientId2', 'expired,revoked', 31, NULL, TRUE, TRUE, TRUE, FALSE); ``` Please refer the README.md file on each DB type for more information. *CONFIGURABLE",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_5",
          "text": "### Data\nThe following table explains the data available in `ConsentValidateData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| headers   | JSONObject            | The request headers sent in the request. |\n| body   | JSONObject            | The payload sent in the request. |\n| electedResource   | String            | The path invoked in the request. For example: `/accounts/{AccountId}`|\n| consentId | String                | The consent ID related to the current resource request. This consent ID is bound to the user access token used. |\n| userId | String                | The user ID related to the current resource request. This user ID is retrieved from the user access token. |\n| clientId | String                | The ID of the TPP application related to the current resource request. This client ID is retrieved from the user access token.|\n| comprehensiveConsent  | DetailedConsentResource   | The comprehensive consent object related to the consent that is being validated. This object contains all the details related to the consent. |\n| resourceParams | Map<String, String>                | A map containing the full resource path with query parameters (ex: `aisp/accounts/{AccountId}?queryParam=urlEncodedQueryParamValue`), HTTP method, and context (ex: `/open-banking/v3.1/aisp`) of the request. |\n\nThe following table explains the data available in `ConsentValidationResult`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| isValid | boolean | An attribute to identify whether the consent is in a valid state or not. |\n| modifiedPayload | JSONObject | Optionally used to set a modified error payload to be sent with the consent validation response. If a modified payload is set, it is given priority over creating a generic error response using the message and code information. |\n| consentInformation | JSONObject | Used to set the consent data to the consent validation result. This data will be sent to the bank backend. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports Account Information Service (AIS) consent with multiplicity specifications for one-off or recurring access through its Consent Management framework. The system allows for the definition of PII Categories, Purposes, and Purpose Categories, which are then used to manage user consent for data sharing. The consent receipts can specify the validity period, which can be indefinite, implying support for recurring access, or a specific duration for one-off access.\\n\\n### Implementation Details\\nThe Consent Management framework in `wso2/product-is` is designed to handle user consent for personal data processing, aligning with privacy regulations. The core of this functionality is exposed through a REST API endpoint `/api/identity/consent-mgt/v1.0/consents` .\\n\\nThe system allows for the creation and management of:\\n*   **PII Categories**: These define types of personal data, such as `http://wso2.org/claims/organization` . They can be added via a POST request to `/api/identity/consent-mgt/v1.0/consents/pii-categories` .\\n*   **Purpose Categories**: These group related purposes for data collection, such as \"Financial\" . They are managed through the `/api/identity/consent-mgt/v1.0/consents/purpose-categories` endpoint .\\n*   **Purposes**: These specify the reasons for data collection, like \"Financial Purpose 01\" . They are managed through the `/api/identity/consent-mgt/v1.0/consents/purposes` endpoint .\\n\\nWhen a user provides consent, a \"Consent Receipt\" is generated and stored . This receipt includes details such as the `piiPrincipalId`, `service`, `consentType`, `collectionMethod`, `jurisdiction`, `language`, and `policyURL` . Crucially, the `piiCategory` within a purpose can specify a `validity` period, which can be set to `\"DATE_UNTIL:INDEFINITE\"` for recurring access or a specific duration for one-off access . The `termination` field in the purpose receipt data also supports `\"DATE_UNTIL:INDEFINITE\"` .\\n\\nThe `ConsentMgtTestCase.java`  demonstrates how to add PII categories, purpose categories, purposes, and receipts programmatically, which are then verified through assertions    .\\n\\n### Configuration Options\\nThe `default-identity.xml` configuration file  contains a `<Consent>` section where `EnableSSOConsentManagement` can be set to `true` to enable consent management during Single Sign-On (SSO) .\\n\\nAdditionally, the `UserConsentEnabledGrantTypes` section in `default-identity.xml` specifies which OAuth2 grant types will filter user claims based on user consent in their responses . By default, `authorization_code` and `implicit` grant types are configured for this purpose .\\n\\n### API Endpoints or Features\\nThe primary API endpoint for consent management is `/api/identity/consent-mgt/v1.0/consents` . This endpoint is used for adding and managing consent receipts, PII categories, purposes, and purpose categories.\\n\\nSpecific API endpoints include:\\n*   `POST /api/identity/consent-mgt/v1.0/consents/pii-categories` for adding PII categories .\\n*   `POST /api/identity/consent-mgt/v1.0/consents/purpose-categories` for adding purpose categories .\\n*   `POST /api/identity/consent-mgt/v1.0/consents/purposes` for adding purposes .\\n*   `GET /api/identity/consent-mgt/v1.0/consents` to retrieve consents for a given `piiPrincipalId` .\\n\\nThe `sendApprovalPostWithConsent` method in `OAuth2ServiceAbstractIntegrationTest.java`  demonstrates how consent is approved during an OAuth flow, including the `sessionDataKeyConsent` and `consentClaims`. The `consent` parameter can be set to \"approve\" .\\n\\n### Documentation References\\nThe \"Consent Management\" section of the \"Advanced Features\" wiki page <wiki_page repo_name=\"wso2/product-is\" id=\"7.3\" page_name=\"Advanced Features\" /> provides an overview of how consent management works within WSO2 Identity Server. It describes the key components, consent collection process, and consent enforcement mechanisms. It also highlights the integration with OAuth2/OIDC for custom scopes and claims.\\n\\n## Notes\\nThe provided context primarily consists of integration tests and configuration files. While these demonstrate the functionality and configuration options, they do not constitute end-user documentation. The term \"ASPSP\" (Account Servicing Payment Service Provider) is not explicitly mentioned in the provided code snippets or wiki pages, but the consent management features are generic enough to be applicable to such a role. The \"multiplicity specification for one-off or recurring access\" is addressed through the `validity` and `termination` fields within the consent receipt structure, allowing for flexible consent durations.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b9798d54-8461-43d6-8ab5-18d771d905cf\\n', 'id': 'lc_88db7bba-9803-417e-afa5-93a600e53991'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0079_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_f095e6e8-0d36-47b5-b75d-c02b2e03460d'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0080",
      "requirement": {
        "requirement_id": "ATOM_011",
        "requirement_text": "When the underlying account is a multicurrency account, the first reference SHALL refer to the collection of all sub-accounts addressable by the IBAN, and the second reference SHALL refer to the euro sub-account only.",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0080_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0080_2",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0080_3",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0080_4",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0080_5",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Based on the provided codebase, there is no explicit support for distinguishing between a collection of all sub-accounts addressable by an IBAN and a specific euro sub-account within a multicurrency account. The API definitions and demo backend service primarily handle accounts at a single `AccountId` level and do not appear to have mechanisms for grouping sub-accounts by IBAN or filtering by currency for sub-accounts.\\n\\n### Implementation Details and API Endpoints\\n\\nThe `wso2/financial-services-accelerator` repository provides API definitions for account information services, as seen in `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml` .\\nThe relevant endpoints are:\\n*   `GET /accounts` : This endpoint is designed to retrieve a list of accounts. The response schema `OBReadAccount5`  contains an array of `OBAccount4` objects . Each `OBAccount4` object represents a single account and includes fields like `AccountId` and `Currency` . There is no explicit structure within `OBAccount4` to represent a parent multicurrency account with multiple sub-accounts or to group accounts by a common IBAN.\\n*   `GET /accounts/{AccountId}` : This endpoint retrieves details for a specific account identified by `AccountId`. The response also uses the `OBReadAccount4` schema , which again focuses on individual accounts.\\n\\nThe `AccountService.java`  in the demo backend service provides mock implementations for these endpoints. For example, the `getAccounts` method returns a hardcoded JSON response with two distinct accounts, each having its own `AccountId` and `Currency` (both GBP in the example) . Similarly, `getOneAccount` returns details for a single `AccountId` . These implementations do not demonstrate any logic for handling multicurrency accounts with sub-accounts or filtering by currency.\\n\\nThe `Identification` field within the `Account` object in the OpenAPI specification can represent an IBAN . However, there\\'s no indication that this `Identification` field is used to group multiple `AccountId` entries as sub-accounts of a single multicurrency account.\\n\\n### Configuration Options\\n\\nThe provided codebase context, including the `Overview` wiki page  and configuration management section, does not mention any specific configuration options related to multicurrency accounts, sub-accounts, or filtering by currency for account retrieval. The `financial-services.xml` file and `FinancialServicesConfigParser`  primarily deal with consent management, identity extensions, and event notifications.\\n\\n### Documentation References\\n\\nThe `Overview` wiki page  describes the accelerator\\'s capabilities in general terms, such as \"account information services\" . However, it does not provide specific documentation on how multicurrency accounts or sub-accounts are handled, nor does it detail any features that would allow for the distinction described in your query.\\n\\n## Notes\\n\\nThe current codebase focuses on providing individual account details and does not appear to have built-in functionality or API structures to manage multicurrency accounts with sub-accounts in the manner described (i.e., distinguishing between an IBAN referring to all sub-accounts versus a specific euro sub-account). The `Currency` field  is present in the `OBAccount4` definition, but it\\'s associated with a single account, not used as a filter for sub-accounts under a broader IBAN reference. The `Identification` field  can represent an IBAN, but its usage in the provided context is for identifying a single account, not a collection of sub-accounts.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_b9cddebe-3eaf-4301-bc71-b4f19039c1fb\\n', 'id': 'lc_9e7a98ef-58f6-4f40-a64a-208a054973d5'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0081",
      "requirement": {
        "requirement_id": "ATOM_020",
        "requirement_text": "The signing basket SHALL get the status of being fully authorised as soon as all grouped transactions have been successfully authorised by the applied SCA mechanism.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0081_1",
          "text": "## Consent Authorization\n\n- Once you enter a properly constructed authorization request in your web browser, based on the `bank_code` in the \n  request object, you will be redirected to ABC bank or DCB Bank. \n\n- A bank customer needs to enter their credentials and sign in. \n    ![sign_in](../../assets/img/toolkit/regulatory-aggregator/sign-in.png)\n- Then redirected to the Aggregator's Account selection page.\n    ![account_selection](../../assets/img/toolkit/regulatory-aggregator/account-selection.png)\n- Once the bank customer selects the accounts they want to share, the whole consent agreement is displayed.\n    ![consent_agreement](../../assets/img/toolkit/regulatory-aggregator/consent-agreement.png)\n- Once the bank customer approves this consent, the aggregator will redirect you to the registered callback URL with an \n  authorization code in the query parameters.\n   ```\n   https://wso2.com/#code=1390032d-622f-3977-a976-923505035571&id_token=eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJhdWQiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwiY19oYXNoIjoiNXFNeEhhY0d2d2IxX2ZDT29GWmlNZyIsInN1YiI6ImFiY3VzZXJAY2FyYm9uLnN1cGVyIiwic19oYXNoIjoiOU9WMVpnRXVfWWExanFxU3hWelg1ZyIsImF6cCI6IngwVWkyR2k3YTVCNGp1cTdXcHdkcFdyTjlsRWEiLCJhbXIiOlsiQ3VzdG9tRmVkZXJhdGVkQXV0aGVudGljYXRvciJdLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0Ojk0NDZcL29hdXRoMlwvdG9rZW4iLCJleHAiOjE2NTM0ODI2ODAsImlhdCI6MTY1MzQ3OTA4MCwibm9uY2UiOiJqQlhoT21PS0NCIiwic2lkIjoiZmRlODZlMzMtNjljYi00ZTIwLTgxZTMtOTFiMDJhYjlmMjM3In0.OQmAuO3yH-Ap3bPzb1NpbbFN628BdIuKYZ6kZqeDRJwLK2Z5GqtO5P2VZpEoMlRSPi15Z0eg_8Uxv1ns1Na8djpIs1UyK2zK20HzHCZh4flpXlW0AMbvoxUUbAsfDzaH8r0xpzweA471vD0HX9rja2Xio0AhsP6VPJasBxC3jnAt9H9wjqB_qXYw8-TQwVPjkFONNgEZHQ44eJFRxK7Um5TOv1fHb6Ivz4URc0R91vL1LEyaIRy8w7afGePNDQn5BHObbfzwX6O4hI_jsUVeOybG0M3-ofhEwYcvkMuiMPsLeF2Oqa849bNNr11P75TajKV7ozUBo1UJquTs7VfSnA&state=0pN0NBTHcv&session_state=13831b535eebb5527056f57766e0b5a1d66caea43afbe041f75d27adcdb954f1.PNSwGdfigyA_dxaCi45fPA \n   ```\n   - The authorization code from the above URL is in the code parameter `1390032d-622f-3977-a976-923505035571`. \n   - Extract this code for the next step.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_2",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_3",
          "text": "### Java based extensions (Old approach)\n\n   - [Open Banking Service Activator](service-activator.md)\n   - [Consent Management](consent-management-manage.md)\n   - [Token Flow Customization](jwt-access-tokens.md)\n   - [Authentication Flow](customize-authentication-steps.md)\n   - [Authorization Flow](keyid-provider.md)\n   - [Mobile Application for CIBA](mobile-application-for-ciba.md)\n   - [Application Property Validation](application-property-validation.md)\n   - [Dynamic Client Registration](application-management-listener.md)\n   - [Event Notification](custom-event-notification.md)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_4",
          "text": "### push-auth/authenticate endpoint\n\nThe SDK invokes the `push-auth/authenticate` endpoint within the `sendAuthRequest()` method to send the consent \nauthorization status (approved/denied) to the authorization server/WSO2 Identity Server.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_5",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n```\ncurl --location --request POST 'https://localhost:8243/open-banking/v3.1/aisp/account-access-consents' \\\n--header 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n--header 'x-fapi-financial-id: open-bank' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n    \"Data\": {\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\"\n    },\n    \"Risk\": {\n        \n    }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"StatusUpdateDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-26T12:03:51+05:30\",\n        \"TransactionToDateTime\": \"2025-06-29T12:03:49.938301+05:30\",\n        \"ExpirationDateTime\": \"2025-07-01T12:03:49.936563+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"a34c8608-dbd2-4997-aad7-398a5b31cbe6\",\n        \"TransactionFromDateTime\": \"2025-06-26T12:03:49.938178+05:30\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, `wso2/product-is`, does not appear to directly support the concept of a \"signing basket\" or the specific mechanism of authorizing grouped transactions with a status change to \"fully authorised\" based on SCA (Strong Customer Authentication) completion. The snippets primarily deal with OAuth2, OpenID Connect, SAML SSO, and multi-factor authentication configurations within an identity server context.\\n\\nThe provided code snippets do not contain any direct references to \"signing basket,\" \"grouped transactions,\" or a specific \"fully authorised\" status tied to such a concept. The configurations shown are related to grant types, token persistence, scope validators, and multi-factor authentication settings, which are general identity and access management features  .\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThere are no implementation details, configuration options, or API endpoints directly related to a \"signing basket\" or its authorization flow in the provided context  . The `MultifactorAuthentication` section   configures XMPP for MFA, but this is a general authentication mechanism and not specifically tied to transaction authorization or a signing basket concept.\\n\\nThe `ConfigSuccessTest.java` file  shows tests for updating inbound authentication configurations, specifically for Passive STS, but this is also a general configuration update and does not relate to the specific \"signing basket\" functionality described.\\n\\n## Documentation References\\n\\nNo documentation references within the provided snippets are relevant to the \"signing basket\" concept.\\n\\n## Notes\\n\\nThe terms \"signing basket\" and \"grouped transactions\" with a specific \"fully authorised\" status are not present in the provided codebase context. The snippets focus on core identity and access management functionalities like OAuth2 grant types, token handling, and SAML SSO, as well as general multi-factor authentication configurations. It is possible that the functionality you are looking for exists in a different part of the codebase not provided, or is implemented as a custom extension or a separate service that integrates with WSO2 Identity Server.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_b6710374-532a-48b7-8081-ec08e01cfdd8\\n', 'id': 'lc_3f9c84e8-bae2-44e6-a432-7e0fd873742d'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0081_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_825b77dc-d279-4372-b7b3-1912f6a61c60'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0082",
      "requirement": {
        "requirement_id": "ATOM_016",
        "requirement_text": "The API SHALL support signing of a group of transactions with multi-level SCA where the group needs authorisation by more than one PSU in a corporate context.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0082_1",
          "text": "ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify fraudulent activities. 7. **API Security** - API consumers invoke APIs to access customer\u2019s financial information. Therefore, API security plays a vital role in open banking to mitigate data theft. The solution has built-in support for global industry-standards such as OpenID Connect Financial Grade API (FAPI), OAuth 2.0, Electronic Identification and Trust Services (eIDAS). API security can be categorised into two main levels: - Application layer security - Validates API consumers against the certificates issued by competent authorities. For example: open banking directories, Qualified Trust Service Providers (QTSPs). Also, the solution supports OAuth2 security implementations such as Private key JWT authentication, client-credentials grant type, and authorization code grant type. - Transport layer security - Secures the communication between the API consumer, and the bank using Mutual Transport Layer Security (MTLS). 8. **User Experience** - The solution provides an enhanced user experience for the banks, API consumers, and customers with self-explanatory and simple actions. 9. **Premium APIs and Monetization** - Using the capabilities in WSO2 API Manager, WSO2 Open Banking Accelerator allows: - banks to publish highly-performant custom APIs for API consumers. - banks to expose their performance and compliance data by integrating into analytics engines. - banks to plug in any billing engines with subscription-based freemium, tiered pricing, or per-request pricing. 10. **Standards-based API Templates** - WSO2 API Manager offers standard API management capabilities, and you can customize the API templates according to your open banking and other requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_2",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_3",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_4",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_5",
          "text": "# Financial -grade API (FAPI) Security\n\nFinancial-grade API (FAPI), a specification that extends the OAuth and OIDC frameworks, \nwas introduced by the FAPI Working Group and defines additional technical requirements \nto secure APIs. Eventhough FAPI was initially defined for financial serivces, \nit is appropriate for any critical API whose security is the highest priority.\n\nFor Open Banking/ Open Finance use-cases,since robust API and data security is must,most of the immerging\ntechnical specifications for Open Banking/ Open Finance have been mandated **FAPI Security** for the \nexposing financial APIs such as ;\n - Open Banking UK\n - Consumer Data Standards (CDS), Australia\n - The Financial Data Exchange (FDX), USA\n\nThe following diagram illustrates how FAPI-compliant features combine to secure applications \n\n![fapi](../assets/img/learn/api-security/fapi.png)\n\nWSO2 Identity Server 7.0.0 onwards ,FAPI Security is supported from the base product itself and \nfor more information on configuring the FAPI features,please visit WSO2 IS Documentation on \n[FAPI](https://is.docs.wso2.com/en/latest/references/financial-grade-api/)\n\n\nWSO2 Open Banking Accelerators have been certified as a OpenID FAPI1-Advanced OpenID Provider as in https://openid.net/certification/",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase context, this repository, `wso2/product-is`, does not appear to directly support the specific requirement of \"signing of a group of transactions with multi-level SCA where the group needs authorisation by more than one PSU in a corporate context\" <cite/>. The available information primarily focuses on API management, user and group management (SCIM2), and general authentication/authorization mechanisms within the WSO2 Identity Server  . There are no explicit implementation details, configuration options, or API endpoints that directly address transaction grouping, multi-level Strong Customer Authentication (SCA) for transactions, or multi-PSU (Payment Services User) authorization in a corporate context <cite/>.\\n\\n## Implementation Details\\nThe codebase includes features for managing applications and users, and groups  . Specifically, the `SCIM2GroupTest.java` file demonstrates how to create and manage groups and their permissions . However, this is related to user group management within the identity server, not transaction groups requiring multi-level SCA <cite/>.\\n\\n## Configuration Options\\nThe `default-identity.xml` file shows configuration for SCIM and SCIM2 endpoints, including `UserEPUrl` and `GroupEPUrl`  . It also outlines SCIM authenticators like `BasicAuthHandler` and `OAuthHandler` . These configurations are for authentication and user/group provisioning, not for defining or managing multi-level SCA for transaction groups <cite/>.\\n\\n## API Endpoints or Features\\nThe `scim2.yaml` Swagger definition outlines API endpoints for managing groups, such as `GET /Groups` for filtering groups and `POST /Groups` for creating groups  . There are also endpoints for patching permissions of a group . While these APIs handle group-related operations, they do not provide functionality for transaction groups, multi-level SCA, or multi-PSU authorization <cite/>.\\n\\n## Documentation References\\nThe \"API Layer\" wiki page provides an overview of the REST API architecture in WSO2 Identity Server, categorizing APIs into Server APIs and User APIs . It discusses API versioning, implementation, deployment, and authentication/authorization mechanisms . However, it does not mention any specific features or documentation related to transaction signing, multi-level SCA, or multi-PSU authorization <cite/>.\\n\\n## Notes\\nThe provided codebase snippets and wiki page primarily describe the core identity and access management functionalities of WSO2 Identity Server, including user and group management, application management, and API infrastructure <cite/>. The concept of \"signing of a group of transactions with multi-level SCA where the group needs authorisation by more than one PSU in a corporate context\" is a specialized requirement often found in financial services or open banking contexts <cite/>. It is possible that such functionality would be implemented as an extension or a separate component built on top of the core WSO2 Identity Server, rather than being part of the core API layer described here <cite/>. Without further context or specific modules related to financial transactions or advanced authorization workflows, it is not possible to confirm support for this requirement within the provided codebase <cite/>.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_a0546a76-ae08-4fe0-aa75-bc778b2361e5\\n', 'id': 'lc_88efb631-8f01-4478-b48e-63efafa1ed12'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0082_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_7f44ea32-419a-4678-8c0f-441d52001497'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0083",
      "requirement": {
        "requirement_id": "ATOM_208",
        "requirement_text": "ASPSP SHALL return HTTP response code 200 for successful confirmation of funds requests.",
        "strength": "SHALL",
        "capability": "Funds Confirmation",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0083_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to be an Identity Server and does not directly support the role of an Account Servicing Payment Service Provider (ASPSP) for confirmation of funds requests. Therefore, it does not contain specific implementation details, configuration options, or API endpoints for ASPSP-related funds confirmation as described in your query.   The codebase primarily focuses on Identity and Access Management (IAM) features, including OAuth 2.0, OpenID Connect, SAML 2.0, SCIM 2.0, and related security and management capabilities. <cite repo=\"wso2/product-is\" path=\".\" start=\"1.2\" end=\"1.2\" />\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nThe provided codebase does not contain any direct implementation details, configuration options, or API endpoints specifically for \"confirmation of funds requests\" or the ASPSP role. <cite repo=\"wso2/product-is\" path=\".\" start=\"1.2\" end=\"1.2\" /> The `wso2/product-is` repository is an Identity Server, which handles authentication, authorization, and user management. <cite repo=\"wso2/product-is\" path=\".\" start=\"1.2\" end=\"1.2\" />\\n\\nWhile the repository supports OAuth 2.0 and OpenID Connect, which are foundational protocols for secure API access, it does not implement the specific business logic for financial services like funds confirmation. <cite repo=\"wso2/product-is\" path=\".\" start=\"1.2\" end=\"1.2\" /> For example, the `OAuth2TokenRevocationWithRevokedAccessToken.java` test class demonstrates OAuth token revocation, which is a general security feature, not specific to funds confirmation.  Similarly, the `scim2.yaml` file defines SCIM 2.0 endpoints for user and group management, which are standard IAM functionalities. \\n\\n## Documentation References\\n\\nThe \"Features and Capabilities\" wiki page provides an overview of the WSO2 Identity Server\\'s functionalities. <cite repo=\"wso2/product-is\" path=\".\" start=\"1.2\" end=\"1.2\" /> It lists various authentication protocols, identity management features, and API security aspects. <cite repo=\"wso2/product-is\" path=\".\" start=\"1.2\" end=\"1.2\" /> However, there are no specific mentions of ASPSP roles or funds confirmation services within this documentation. <cite repo=\"wso2/product-is\" path=\".\" start=\"1.2\" end=\"1.2\" />\\n\\n## Notes\\n\\nThe query specifically asks about an ASPSP returning an HTTP 200 for successful confirmation of funds requests. The provided codebase is for an Identity Server, which typically acts as an Identity Provider (IdP) or an Authorization Server in an Open Banking context, rather than the ASPSP itself. An ASPSP would integrate with an Identity Server for authentication and authorization, but the core business logic for funds confirmation would reside within the ASPSP\\'s own systems. Therefore, the `wso2/product-is` repository does not directly address the requirement for ASPSP funds confirmation.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_1f0018fe-82d8-4d47-bb4e-dfbd1a38d08e\\n', 'id': 'lc_1906470c-ee6c-414c-840e-aa81f6b42f88'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0083_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support returning an HTTP response code 200 for successful requests, including those that might be related to \"confirmation of funds requests\" if such requests are exposed as APIs through the WSO2 API Manager. The support is demonstrated through integration tests and configuration options that allow for explicit handling of HTTP status codes.\\n\\n### Implementation Details\\nThe `wso2/product-apim` repository includes integration tests that specifically verify the API Manager\\'s ability to handle and return HTTP 200 status codes from backend services . For instance, the `testAPIReturningStatusCode200` method in `APIMANAGER4533BackendReturningStatusCode200TestCase.java` creates an API, publishes it, subscribes an application to it, generates an access token, and then invokes the API . The test asserts that the HTTP response status code is 200 . This indicates that the system is designed to correctly pass through or generate a 200 OK status for successful API invocations.\\n\\nAnother test case, `HttpPATCHSupportTestCase.java`, also verifies that a backend returning a 200 OK response for an HTTP PATCH request is correctly handled and asserted . This further confirms the system\\'s capability to handle various HTTP methods and their corresponding 200 responses.\\n\\n### Configuration Options\\nThe WSO2 API Manager provides a configuration property `FAULTS_AS_HTTP_200` . When this property is set to `true`, the Enterprise Service Bus (ESB) component of WSO2 will forward a SOAP fault (which would typically result in an HTTP 500 message) to the client with an HTTP status code 200 instead . This configuration option allows for explicit control over the HTTP status code returned to the client, even in cases where an internal fault occurs. The default behavior for this property is `false` . This property is documented in `properties_guide.xml` across multiple modules, including `api-control-plane` , `gateway` , and `traffic-manager` .\\n\\n### API Endpoints or Features\\nWhile there isn\\'t a specific API endpoint named \"confirmation of funds requests\" directly visible in the provided snippets, the system\\'s general API management capabilities allow for the creation and exposure of any backend service as an API . If a \"confirmation of funds\" service exists as a backend, it can be exposed through WSO2 API Manager, and the manager will handle the HTTP 200 response as demonstrated by the integration tests. The `CORSApi.yaml` and `oas_import.json` files show OpenAPI definitions where various HTTP methods (GET, PUT, POST, DELETE, PATCH) are defined to return a 200 OK response  . This indicates that the platform supports defining API operations that are expected to return a 200 status code for successful operations.\\n\\n### Documentation References\\nThe `properties_guide.xml` files in `api-control-plane`, `gateway`, and `traffic-manager` modules serve as documentation for the `FAULTS_AS_HTTP_200` property   . These documents explain the purpose and usage of this configuration, which directly relates to the system\\'s ability to return HTTP 200 status codes. Additionally, the `SubscriptionsApi.md` file provides HTTP response details for API operations, explicitly mentioning a 200 status code for successful subscription unblocking .\\n\\n## Notes\\nThe provided context primarily focuses on the WSO2 API Manager\\'s general capabilities in handling HTTP status codes, particularly the 200 OK status. While the term \"ASPSP\" (Account Servicing Payment Service Provider) and \"confirmation of funds requests\" are not explicitly mentioned in the code snippets, the WSO2 API Manager is a platform that can be used to expose and manage APIs for such services. The evidence suggests that if an ASPSP service is exposed via WSO2 API Manager, the platform is capable of returning HTTP 200 for successful requests, and even has configuration options to force a 200 status code in certain fault scenarios. The integration tests confirm the expected behavior for successful API invocations resulting in a 200 status code.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_7a293ac6-8849-4d23-8ab9-438649297fbe\\n', 'id': 'lc_280e0dd9-5abf-4a5a-9e2c-b7845d5d0a88'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0084",
      "requirement": {
        "requirement_id": "ATOM_209",
        "requirement_text": "ASPSP MUST return fundsAvailable as true if sufficient funds are available at the time of the request, false otherwise.",
        "strength": "MUST",
        "capability": "Funds Confirmation",
        "section_id": "2bff2fd29855",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0084_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, does not appear to directly support the specific requirement of an ASPSP (Account Servicing Payment Service Provider) returning a `fundsAvailable` boolean based on account balance sufficiency. The provided code snippets primarily relate to authorization details, OpenID Connect configurations, and utility functions for rich authorization requests, which are more focused on identity and access management rather than direct financial transaction processing or balance checks.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nBased on the provided snippets, there are no direct implementation details, configuration options, or API endpoints that explicitly handle a `fundsAvailable` boolean or perform account balance sufficiency checks. The `AuthorizationDetailsType` class  defines a model for authorization details, which includes properties like `type`, `name`, `description`, and `schema` . The `schema` property, for instance, can define the structure of authorization details, and an example shows it can include `instructedAmount` , but this is a definition of the data structure, not an implementation of a funds check.\\n\\nThe `OpenIDConnectConfiguration` class  includes a property `isFAPIApplication`  which indicates if an application is FAPI conformant. While FAPI (Financial-grade API) is relevant to financial services, this configuration primarily deals with security and compliance aspects of the API, not the direct handling of financial transactions or fund availability checks .\\n\\nThe `RichAuthorizationRequestsUtils` class  contains a utility method `isRequestTypesMatchResponseTypes`  which compares authorization request and response types. This is a testing utility and does not implement any financial logic.\\n\\nThe `identity-mgt-listener-enabled.xml` file  contains configurations related to SAML and OpenID Connect, such as token builders and claim retrievers . These configurations are for identity management and authentication flows, not for checking fund availability.\\n\\n## Documentation References\\n\\nNo specific documentation references related to `fundsAvailable` or ASPSP fund checks were found within the provided code snippets. The `ApiModelProperty` annotations      provide descriptions for API properties, but none of them mention fund availability.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from test integration modules within the `wso2/product-is` repository. This suggests that the code is related to testing the identity server's functionalities, such as API resource management, application management, and rich authorization requests. The absence of direct financial transaction processing logic or explicit `fundsAvailable` indicators in these snippets indicates that this specific functionality might reside in a different part of the codebase or in a separate, integrated financial service. Without further context from other parts of the repository, it's not possible to confirm if the repository as a whole supports the ASPSP `fundsAvailable` requirement.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_dced8657-4ed6-437d-b679-228d0842eec1\\n\", 'id': 'lc_0aebc149-e5e1-4130-a457-fcab4aa4cf63'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0084_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, specifically within the `wso2/product-apim` project, contains a sample JAX-RS service that demonstrates a payment processing flow, including a check for \"Insufficient Funds\" . While it doesn\\'t directly implement an \"ASPSP\" (Account Servicing Payment Service Provider) or a `fundsAvailable` boolean as described, the `doPayment` method in `StarbucksOutletServiceImpl.java` provides a similar logic for checking if an `amount` is acceptable against an `Order` .\\n\\n## Implementation Details\\n\\nThe `StarbucksOutletServiceImpl.java` file contains the `doPayment` method, which is responsible for processing payments . Inside this method, there\\'s a conditional check: `if (!order.isAmountAcceptable(amount))` . If this condition is true, a `PaymentStatus` with the message \"Insufficient Funds\" is returned . This simulates a scenario where funds are not sufficient. The `Payment` object includes fields for `name`, `amount`, `cardNumber`, and `expiryDate` .\\n\\n## API Endpoints or Features\\n\\nThe `doPayment` method is exposed as a JAX-RS endpoint . While the exact path is not provided in the snippet, it would typically be part of a RESTful API for processing payments for orders. The method takes an `id` (presumably an order ID) and a `Payment` object as parameters .\\n\\n## Configuration Options\\n\\nThere are no explicit configuration options related to `fundsAvailable` or similar boolean flags visible in the provided snippets. The logic for determining \"Insufficient Funds\" is embedded within the `isAmountAcceptable` method of the `Order` object, which is not provided in the context .\\n\\n## Documentation References\\n\\nNo specific documentation references are provided within the given code snippets that directly address the `fundsAvailable` boolean or ASPSP requirements. The code itself serves as an example of a backend service within the WSO2 API Manager integration tests .\\n\\n## Notes\\n\\nThe provided code is part of a test backend service for a coffee sample application within the `wso2/product-apim` repository . It demonstrates basic payment processing logic, including a check for sufficient funds, but it is not a full-fledged ASPSP implementation. The `isAmountAcceptable` method, which would contain the actual logic for checking fund sufficiency, is not available in the provided context. Other files like `APIDTO.java`  and `SettingsDTO.java`  contain boolean fields like `isSubscriptionAvailable` and `isExternalStoresEnabled`, but these are unrelated to the concept of `fundsAvailable` for payment processing.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_9c7118de-47c1-4d30-a1a3-40bb94e940ed\\n', 'id': 'lc_c2aafc92-4990-43aa-9772-bb068ea28727'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0085",
      "requirement": {
        "requirement_id": "ATOM_001",
        "requirement_text": "TLS connections must use TLS version 1.2 or higher for communication between TPP and ASPSP",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "eef9ab97432c - 4.2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0085_1",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_2",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_3",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_4",
          "text": "which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it is required to check whether a given certificate is revoked by its issuer. That can be done through two protocols: ####Certificate Revocation List (CRL) CRL is a list of digital certificates that have been revoked by the issuing CA. ####Online Certificate Status Protocol (OCSP) OCSP is an internet protocol used for obtaining the revocation status of a digital certificate based on the certificate serial number. The OCSP validation is faster compared to the CRL validation. By default, WSO2 Open Banking Accelerator verifies the revocation status of a certificate using the OCSP validation. If the OCSP validation is unsuccessful, the revocation status is verified using the CRL information. The certificate is rejected if none of these protocols is successful or if the required revocation information is not found on the certificate. ###Validate external API consumers This validation allows banks to validate API consumers from the NCAs. This is done by validating the transport layer certificate an API consumer has obtained. ###Role validation According to the [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), API consumers have roles for the services they provide. The API consumer\u2019s role is defined in the API consumer\u2019s transport certificate (QWAC certificate that they obtain from an NCA), which WSO2 Open Banking Accelerator checks in the API and Dynamic Client Registration flows. If the role exists in the transport certificate, WSO2 Open Banking Accelerator allows the API consumer to invoke the API. Following are the roles that an API consumer can have: | Role | Description | |---------|--------- | |Account Information Service Provider|Provides an online service by sharing information on payment accounts held by a payment service user with payment service providers.| |Payment Initiation Services Provider|Provides an online service to initiate a payment order at the request of the payment service user with respect to a payment account held at another payment service provider.| |Card-Based Payment Instrument Issuer|Issues card-based payment instruments that can be used to initiate a payment transaction from a payment account held with another payment service provider.| !!!tip An API consumer can have one or more roles. For example, if an API consumer provides an application to view account information as well as to initiate payments, the roles of the API consumer are **Account Information Service Provider** and **Payment Initiation Services Provider**. ###eIDAS The **electronic IDentification, Authentication and trust Services (eIDAS)** regulation provides unique identity schemas for individuals and businesses to access the publicly available online services in Europe. Among electronic Identification (eID) solutions, PSD2 recommends Qualified Website Authentication Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_5",
          "text": "Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a secure TLS channel and protect the transport layer communication from potential attackers on the network. WSO2 Open Banking Accelerator validates the following aspects of the QWAC if it is used for an API invocation: - The certificate is qualified, technically correct, and is not expired. - The PSD2 information in the certificate such as PSD2 roles, Authorization Number matches with the API being invoked. - The certificate is not revoked using CRL or Online OCSP validations. ####Qualified e-Seal Certificate (QSealC) QSealC seals application data and sensitive information to ensure that the origin of the document is trusted. WSO2 Open Banking Accelerator allows using QSealC as the signing certificates in application layer security to ensure protecting the data or messages from potential attackers during or after the communication. <hr> Generally, open banking flows always consist of 3 different types of API requests by the client applications. The following section lists the different security measures taken at each of the request types.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Yes, the WSO2 Identity Server repository supports enforcing TLS version 1.2 or higher for communication. This is primarily configured through the Apache Tomcat connector settings within the `catalina-server.xml` file and its Jinja2 template  .\\n\\n## Implementation Details\\n\\nThe TLS/SSL configuration in WSO2 Identity Server is managed via Apache Tomcat\\'s connector configuration . The `catalina-server.xml` file, or more specifically its template `catalina-server.xml.j2`, defines the HTTPS connector . This configuration allows specifying the enabled TLS protocols. The system uses a templating mechanism where `default.json` provides default values, `infer.json` applies conditional logic, and Jinja2 templates generate the final `catalina-server.xml` used by the Tomcat Connector  .\\n\\nThe `sslEnabledProtocols` attribute within the `<Connector>` element is used to specify the allowed TLS versions . The `+` prefix indicates that the protocol should be added to the enabled list .\\n\\n## Configuration Options\\n\\nTo enforce TLS 1.2 or higher, you would configure the `transport.https.sslHostConfig.properties.protocols` property. The default value for this property is `+TLSv1,+TLSv1.1,+TLSv1.2` . To restrict connections to TLS 1.2 or higher, you would modify this property to exclude older versions. For example, setting it to `+TLSv1.2` would only allow TLS 1.2 and higher if available .\\n\\nThe `catalina-server.xml.j2` template dynamically generates the connector configuration based on these properties .\\n\\n## API Endpoints or Features\\n\\nThe core functionality for enforcing TLS versions is at the transport layer, specifically within the Tomcat connector configuration, rather than exposed through specific API endpoints . The system\\'s security governance features, such as account locking and password policies, are separate from the TLS protocol enforcement .\\n\\n## Documentation References\\n\\nThe \"Security Configuration\" wiki page provides an overview of TLS/SSL configuration, keystore management, security valves, and post-quantum cryptography support . It explicitly mentions that WSO2 Identity Server uses Apache Tomcat\\'s connector configuration for TLS/SSL settings and that the `catalina-server.xml` template file is the primary configuration point . The wiki also recommends enabling only TLSv1.2 or higher in production as a best practice .\\n\\n## Notes\\n\\nThe provided code snippets and wiki page clearly indicate that TLS protocol versions are configurable within the WSO2 Identity Server. The `sslEnabledProtocols` attribute in the Tomcat `Connector` element is the direct control for this requirement . While `catalina-server.xml` shows a hardcoded value, the `catalina-server.xml.j2` template and `default.json` demonstrate how these values are dynamically set and can be overridden  . The `openssl-tls.sh` script is related to OpenSSL integration and post-quantum cryptography, which is a separate but related security feature, not directly controlling the minimum TLS version for standard connections .\\n\\nWiki pages you might want to explore:\\n- [Security Configuration (wso2/product-is)](/wiki/wso2/product-is#5.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_7541e7cb-4c30-4511-af61-610225b8ed5e\\n', 'id': 'lc_3c5df53c-0d4b-4153-a07f-16e5994979cc'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0085_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports TLS connections using TLS version 1.2 or higher for communication. This is evident through configuration options in `default.json` files and a dedicated integration test case.     \\n\\n## Implementation Details and Configuration Options\\n\\nThe WSO2 API Manager codebase allows configuration of supported TLS protocols for various communication channels.\\n\\n### Passthru HTTPS Listener and Sender\\nThe `default.json` configuration files, found in `gateway/modules/distribution/product/src/main/resources/conf/default.json`, `all-in-one-apim/modules/distribution/product/src/main/resources/conf/default.json`, and `api-control-plane/modules/distribution/product/src/main/resources/conf/default.json`, specify the `HttpsProtocols` for both the passthru HTTPS listener and sender.  \\nSpecifically, the `transport.passthru_https.listener.parameters.HttpsProtocols` and `transport.passthru_https.sender.parameters.HttpsProtocols` properties are set to `\"TLSv1,TLSv1.1,TLSv1.2\"`.   This indicates that TLS 1.2 is supported.  \\n\\n### Binary Receiver\\nFor the binary receiver transport, the `transport.binary.receiver.sslEnabledProtocols` array includes `\"TLSv1.2\"`, among others. \\n\\n### WebSocket Secure (WSS)\\nThe `apim.wss.ssl_enabled_protocols` property is configured to allow `\"TLSv1.1,TLSv1.2\"`. \\n\\n### Catalina Server Configuration\\nThe `catalina-server.xml` files, such as in `traffic-manager/modules/distribution/product/src/main/conf/catalina-server.xml`, show that the `SSLHostConfig` for the HTTPS connector explicitly enables `TLSv1.2` using `protocols=\"+TLSv1,+TLSv1.1,+TLSv1.2\"`.  This configuration is noted as a \"poodle vulnerability fix\". \\n\\n### Broker AMQP SSL Connection\\nThe `broker.xml.j2` template files, located in `all-in-one-apim/modules/distribution/product/src/main/resources/conf/templates/repository/conf/broker.xml.j2`, `gateway/modules/distribution/product/src/main/resources/conf/templates/repository/conf/broker.xml.j2`, and `traffic-manager/modules/distribution/product/src/main/resources/conf/templates/repository/conf/broker.xml.j2`, include a placeholder `{{broker.transport.amqp.ssl_connection.ssl_enabled_protocols}}` for SSL enabled protocols.  A comment indicates that this can be configured to include `TLSv1.2`. \\n\\n## API Endpoints or Features\\nThe provided snippets do not directly expose API endpoints or features specifically for configuring TLS versions via an API. The configuration is primarily file-based.  \\n\\n## Documentation References\\nThe `APIMANAGER4568TLSTestCase.java` file serves as an integration test case that explicitly verifies TLS 1.2 usage.  The test case instructs to start the product with SSL debug enabled (`./wso2server.sh -Djavax.net.debug=ssl:handshake > /tmp/ssl_debug.log`) and then asserts that \"ClientHello, TLSv1.2\" is found in the log file.    This test confirms the capability to establish connections using TLS 1.2. \\n\\n## Notes\\nThe configuration files indicate support for TLSv1, TLSv1.1, and TLSv1.2.     To enforce TLS 1.2 or higher exclusively, you would need to modify these configurations to remove TLSv1 and TLSv1.1.     The `APIMANAGER4568TLSTestCase.java` test case specifically checks for the presence of TLSv1.2 in the SSL debug log, confirming its usage. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_817150c7-1749-4949-83a1-7b969b34459d\\n', 'id': 'lc_9e9f45bc-4617-4a09-9933-507f9cf75eeb'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0086",
      "requirement": {
        "requirement_id": "ATOM_068",
        "requirement_text": "The system shall support consent status values 'received', 'rejected', and 'valid' during the AIS consent initiation phase",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0086_1",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_2",
          "text": "### getConsent method\n\nThis method lets you retrieve a consent with or without its attributes by performing the following: \n\n- Retrieves the consent for status validation\n- Optionally retrieves consent attributes according to the value of the withConsentAttributes flag\n- Checks whether the retrieved consent involves a file\n  \n``` java\nConsentResource getConsent(String consentID, boolean withConsentAttributes) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_3",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0086_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0087",
      "requirement": {
        "requirement_id": "ATOM_012",
        "requirement_text": "The interface specification SHALL act on sub-accounts of multicurrency accounts in exactly the same way as on regular accounts for payment initiation and account information services.",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0087_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_2",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_3",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_4",
          "text": "This document provides step by step instructions to tryout the flow with Manual Client Registration. This includes\n\n- Setting up WSO2 FInancial Services Key Manager\n- Create application using Manual Client Registration\n- Tryout Accounts Information Flow using application created using Manual Client Registration",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_5",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0087_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, the WSO2 Financial Services Accelerator, appears to support the handling of multicurrency sub-accounts in a similar manner to regular accounts for payment initiation and account information services. The API specifications define currency at the account level, and the backend services are designed to process account-related requests.   \\n\\n## Implementation Details\\n\\nThe `AccountandTransactionAPI` Swagger definition, located at `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml`, defines the structure for account information.  Within this definition, the `OBAccount4` schema includes a `Currency` field, which is described as the \"Identification of the currency in which the account is held.\"  This suggests that the system is designed to handle accounts with specific currencies. The description further notes that \"Currency should only be used in case one and the same account number covers several currencies,\" which directly addresses the concept of multicurrency accounts. \\n\\nSimilarly, for payment initiation, the `payment-initiation-openapi.yaml` file defines schemas like `obWriteConsent4` and `obWritePayment2` which include `InstructedAmount` with both `Amount` and `Currency` fields.   This indicates that payment operations are currency-aware.\\n\\nThe `AccountService.java` in the demo backend provides a sample implementation for retrieving account information.  The `getAccounts` method returns a JSON response that includes `Currency` for each account, demonstrating the system\\'s ability to represent currency information for accounts.  The `getAccountTransactions` method also includes currency information for transaction amounts. \\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, is used for centralized configuration.  While the provided snippets do not explicitly show configuration options for multicurrency sub-accounts, the presence of currency fields in the API definitions suggests that the underlying system is designed to handle such data. The \"Overview\" wiki page mentions that the configuration supports \"Consent management with customizable handlers and validation rules\" and \"Identity server extensions with OAuth/OIDC customizations,\" which could potentially be extended to manage specific rules for multicurrency accounts if needed. \\n\\n## API Endpoints or Features\\n\\nThe API specifications define endpoints for both account information and payment initiation. \\n\\nFor Account Information Services:\\n*   `POST /account-access-consents`: Used to create account access consents. \\n*   `GET /accounts/{AccountId}`: Retrieves details for a specific account. \\n*   `GET /accounts/{AccountId}/balances`: Retrieves balance information for a specific account. \\n*   `GET /accounts/{AccountId}/transactions`: Retrieves transaction history for a specific account. \\n\\nThese endpoints are designed to operate on an `AccountId`, and the `OBAccount4` schema, which includes the `Currency` field, is returned by these APIs.  This implies that if a sub-account is identified by a unique `AccountId`, these operations would apply to it in the same way as a regular account, with currency information being part of the account details.\\n\\nFor Payment Initiation Services:\\n*   The `payment-initiation-openapi.yaml` defines operations for creating payment consents and initiating payments.  The `obWriteConsent4` and `obWritePayment2` schemas include `InstructedAmount` with `Currency`, indicating that payments are processed with specific currency values.   The `DebtorAccount` and `CreditorAccount` schemas also include `SchemeName` and `Identification`, which would be used to identify the specific account, whether it\\'s a main account or a sub-account.  \\n\\n## Documentation References\\n\\nThe \"Overview\" wiki page for the WSO2 Financial Services Accelerator provides a high-level overview of the solution, including its support for account information services and payment initiation.  It also references the API specifications for Accounts and Payments, which are the `account-info-swagger.yaml` and `payment-initiation-openapi.yaml` files.  These YAML files serve as the primary documentation for the API endpoints and their data models, including the handling of currency.\\n\\n## Notes\\n\\nThe provided code snippets strongly suggest that the WSO2 Financial Services Accelerator is designed to handle multicurrency accounts and their sub-accounts in a consistent manner with regular accounts. The API definitions explicitly include currency fields at the account and transaction levels, and the demo backend service demonstrates the inclusion of currency in account and transaction responses. The key to verifying identical behavior would be ensuring that the `AccountId` parameter, used across various API calls, can uniquely identify both regular accounts and sub-accounts of multicurrency accounts, and that the system correctly processes currency-specific logic for all such accounts.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_45595168-9e62-4a12-8ceb-f6370b0b2055\\n', 'id': 'lc_730a1ab3-7006-4eb3-8a49-995ea215b48a'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0088",
      "requirement": {
        "requirement_id": "ATOM_002",
        "requirement_text": "TPP must use a qualified certificate for website authentication issued by a qualified trust service provider according to eIDAS regulation",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "eef9ab97432c - 4.2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0088_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support X.509 certificate authentication, which is a foundational element for implementing eIDAS-compliant website authentication using qualified certificates. The system includes a dedicated valve for X.509 certificate authentication and provides configuration options for managing certificates within Identity Providers.   \\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server architecture includes an `X509CertificateAuthenticationValve` which is responsible for handling X.509 certificate authentication.  This valve is configured within the `catalina-server.xml.j2` template, which is part of the distribution assembly.  <cite repo=\"wso2/product-is\" path=\"wso2/product-is\" wiki_page=\"Architecture\" />\\nAdditionally, there is an X.509 certificate authenticator connector, `org.wso2.carbon.extension.identity.authenticator.x509Certificate.connector`, defined in the `pom.xml` file.  This suggests that X.509 certificates can be used as an authentication mechanism.\\n\\n## Configuration Options\\n\\nConfiguration for X.509 certificates can be managed at the Identity Provider (IdP) level. \\nYou can add or remove certificates for an Identity Provider using the Identity Provider Management API.  For instance, the `IdPSuccessTest.java` demonstrates patching an IdP to add or remove certificates. \\nThe `add-oidc-idp.json` example shows that an Identity Provider configuration can include a `certificate` object, which can specify a `jwksUri` or directly embed `certificates`. \\n\\n## API Endpoints or Features\\n\\nThe Identity Provider Management API allows for the management of Identity Providers, including their certificate configurations.  Specifically, the `PATCH` operation on the `IDP_API_BASE_PATH` endpoint can be used to update certificate properties, such as adding or removing JWKS URIs or certificates.  \\n\\n## Documentation References\\n\\nThe \"Architecture\" wiki page mentions \"Protocol Support\" and \"Authentication Framework\" as key layers of WSO2 Identity Server, which would encompass certificate-based authentication. <cite repo=\"wso2/product-is\" wiki_page=\"Architecture\" /> The \"Features and Capabilities\" wiki page also lists \"Advanced Security Features\" and \"Identity Federation\" which are relevant to certificate management and authentication. <cite repo=\"wso2/product-is\" wiki_page=\"Features and Capabilities\" />\\n\\n## Notes\\n\\nWhile the codebase provides mechanisms for X.509 certificate authentication and management, there is no explicit mention of \"eIDAS regulation\" or \"qualified trust service provider\" within the provided snippets. <cite /> To fully verify compliance with eIDAS, further investigation into how the system validates the \"qualified\" status of certificates and the trust chain to a \"qualified trust service provider\" would be necessary. <cite /> The existing `X509CertificateAuthenticationValve` and the ability to configure certificates for Identity Providers lay the groundwork, but specific eIDAS-related validation logic is not directly visible in the provided context.  \\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_283884cc-5bab-438c-9923-4cdb8ed23206\\n', 'id': 'lc_0a0dff0b-f786-4d1e-81d3-d8719d04f192'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0088_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support client certificate authentication, which is a prerequisite for using qualified certificates for website authentication as per eIDAS regulation. The system allows for uploading and managing client certificates, and APIs can be configured to enforce mutual SSL. However, there is no explicit mention or implementation detail within the provided snippets that directly addresses the \"qualified\" aspect of eIDAS certificates or integration with a \"qualified trust service provider\" for validation.\\n\\n### Implementation Details\\n\\nThe codebase demonstrates support for Mutual SSL (mTLS) for API security, which involves client certificate authentication. This is evident in the test cases and API client configurations.\\n\\n*   **Mutual SSL Configuration**: APIs can be configured to use `mutualssl` or `mutualssl_mandatory` security schemes. This is shown in the `APISecurityMutualSSLCertificateChainValidationTestCase.java` file where `securitySchemes.add(\"mutualssl\"); securitySchemes.add(\"mutualssl_mandatory\");` is used when creating an API request . Similarly, API Products can also be configured with these security schemes .\\n*   **Certificate Upload and Management**: The system provides functionality to upload client certificates. The `restAPIPublisher.uploadCertificate()` method is used in test cases to upload certificates associated with APIs and API Products  .\\n*   **Certificate Chain Validation**: There are test cases specifically for validating certificate chains in mutual SSL, indicating that the system processes and validates certificate hierarchies . For example, `cert_chain_root.cer` and `cert_chain_intermediate.cer` are uploaded and tested  .\\n*   **Truststore Configuration**: The `automation.xml` configuration file defines a system-wide truststore (`client-truststore.jks`) which is used to maintain certificates of trusted parties . This truststore is likely used for validating client certificates during mutual SSL. The `APIMTestCaseUtils.java` file also shows how a truststore is loaded to validate JWT signatures .\\n\\n### Configuration Options\\n\\n*   **SSL Profiles**: The `sslprofiles.xml.j2` template files indicate that custom SSL profiles can be configured, allowing for specification of keystores and truststores for different servers  . This provides flexibility in managing certificate trust.\\n*   **Client Certificate Security Schemes**: As mentioned, `mutualssl` and `mutualssl_mandatory` can be set as security schemes for APIs and API Products  .\\n\\n### API Endpoints or Features\\n\\n*   **Client Certificates API**: The `ClientCertificatesApi.md` documentation describes API endpoints for retrieving and searching uploaded client certificates .\\n    *   `getAPIClientCertificates`: Retrieves client certificates based on `apiId`, `limit`, `offset`, and `alias` .\\n    *   `getAPIClientCertificatesByKeyType`: Retrieves client certificates based on `keyType`, `apiId`, `limit`, `offset`, and `alias` .\\n*   **Endpoint Certificates API**: The `EndpointCertificatesApi.md` documentation outlines API endpoints for managing endpoint certificates . While these are for backend endpoints, the presence of certificate management APIs indicates a robust system for handling certificates.\\n    *   `getEndpointCertificates`: Retrieves endpoint certificates based on `limit`, `offset`, `alias`, and `endpoint` .\\n    *   `getEndpointCertificateByAlias`: Retrieves information about a specific certificate using its alias .\\n    *   `updateEndpointCertificateByAlias`: Updates an existing uploaded certificate .\\n\\n### Documentation References\\n\\nThe provided snippets include documentation for the `ClientCertificatesApi`  and `EndpointCertificatesApi` . These documents detail the available API operations, parameters, and return types for managing certificates.\\n\\n### eIDAS Compliance\\n\\nWhile the repository supports client certificate authentication and certificate chain validation, there is no explicit mention of eIDAS regulation or specific mechanisms to verify if a TPP certificate is \"qualified\" or issued by an \"eIDAS-compliant qualified trust service provider\" within the provided code snippets. The system can enforce mutual SSL and validate certificate chains against its configured truststore, but the specific logic for eIDAS-level qualification checks is not visible. This would typically involve checking specific certificate extensions (e.g., Qualified Certificate statements) or integrating with external eIDAS validation services.\\n\\n## Notes\\n\\nThe provided code snippets primarily focus on the technical aspects of mutual SSL and certificate management within the WSO2 API Manager. The `ApiClient.java` files across various modules (`publisher`, `admin`, `service-catalog`, `store`) contain `applySslSettings()` methods that configure SSL/TLS for HTTP clients, including trust manager and hostname verifier settings     . These settings are crucial for establishing secure connections and validating certificates. The `APIMTestCaseUtils.java` also includes logic for validating JWT signatures using a truststore , which is related to certificate usage but distinct from the primary client certificate authentication flow for TPPs.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_12ed4867-5715-4f35-a670-0c3d5068eafd\\n', 'id': 'lc_a6a2bf9f-5f4c-41a5-9fe0-c80d4e06bd5b'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0089",
      "requirement": {
        "requirement_id": "ATOM_210",
        "requirement_text": "When a TPP includes a digital signature, the TPP must include a Digest header containing a hash of the message body using SHA-256 or SHA-512 algorithms",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0089_1",
          "text": "Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a secure TLS channel and protect the transport layer communication from potential attackers on the network. WSO2 Open Banking Accelerator validates the following aspects of the QWAC if it is used for an API invocation: - The certificate is qualified, technically correct, and is not expired. - The PSD2 information in the certificate such as PSD2 roles, Authorization Number matches with the API being invoked. - The certificate is not revoked using CRL or Online OCSP validations. ####Qualified e-Seal Certificate (QSealC) QSealC seals application data and sensitive information to ensure that the origin of the document is trusted. WSO2 Open Banking Accelerator allows using QSealC as the signing certificates in application layer security to ensure protecting the data or messages from potential attackers during or after the communication. <hr> Generally, open banking flows always consist of 3 different types of API requests by the client applications. The following section lists the different security measures taken at each of the request types.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0089_2",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0089_3",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the use of SHA-256 and SHA-512 algorithms for hashing in various contexts, including DPoP (Demonstrating Proof of Possession) tokens and SAML responses. While there isn\\'t a direct, explicit feature for a \"Digest header\" on *all* HTTP requests with digital signatures as a general TPP requirement, the codebase demonstrates the capability to generate and configure SHA-256 and SHA-512 hashes for specific security mechanisms.   \\n\\n## Implementation Details\\n\\n### DPoP Proof Generation\\nThe `DPoPProofGenerator.java` utility class contains a method `generateAccessTokenHash` that explicitly uses `SHA-256` to hash access tokens.  This hash is then included in the DPoP proof, which is a signed JWT.  The `genarateDPoPProof` method constructs a JWT with claims including `htm` (HTTP method) and `htu` (HTTP URL), and optionally `ath` (access token hash).  The JWT is then signed using either `ES256` or `RS384` algorithms. \\n\\n### OAuth2 Token Hashing\\nThe system can be configured to use `SHA-512` for hashing OAuth tokens.  This is demonstrated in the `Oauth2HashAlgorithmTestCase.java` which applies a configuration to enable `SHA-512` hashing for OAuth. \\n\\n### SAML Digest Algorithms\\nFor SAML responses, the system supports various digest algorithms, including `SHA-256`, `SHA-384`, and `SHA-512`.  The `SAML2SSOTestBase.java` class shows how a digest algorithm can be set for SAML requests. \\n\\n## Configuration Options\\n\\n### OAuth Token Hashing Algorithm\\nThe hashing algorithm for OAuth tokens can be configured in the `deployment.toml` file using the `hash_token_algorithm` property under the `[oauth]` section.  An example configuration sets this to `SHA-512`. \\n\\n### SAML Response Digest Algorithm\\nFor SAML, the `responseDigestAlgorithm` can be configured with options including `http://www.w3.org/2001/04/xmlenc#sha256` and `http://www.w3.org/2001/04/xmlenc#sha512`.  The default value for this is `http://www.w3.org/2001/04/xmlenc#sha256`. \\n\\n## API Endpoints or Features\\n\\n### DPoP Token Binding\\nThe `oidc-metadata.json` file indicates support for `DPoP` as an `accessTokenBindingType`.  This implies that DPoP tokens, which can include SHA-256 hashes of access tokens, are a supported feature. \\n\\n## Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" provides an overview of token management, including DPoP tokens, which are relevant to the use of SHA-256 for hashing.  \\n\\n## Notes\\n\\nThe prompt specifically asks about a \"Digest header\" for TPPs (Third Party Providers) when including a digital signature. While the codebase demonstrates the use of SHA-256 and SHA-512 for hashing in various security contexts (DPoP, OAuth tokens, SAML), it does not explicitly show a generic \"Digest header\" mechanism for all HTTP requests with digital signatures. The existing implementations are tied to specific protocols like DPoP and SAML. Therefore, while the cryptographic capabilities are present, a general-purpose \"Digest header\" for arbitrary TPP digital signatures as a mandatory requirement is not directly evident.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_d306eb48-f5d3-46cc-bd86-9e5459146432\\n', 'id': 'lc_d137a278-2cf3-4bf5-933f-ecbaeeb491ca'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0089_4",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support Digest Authentication, but there is no direct evidence in the provided snippets that it explicitly enforces or generates a `Digest` header with SHA-256 or SHA-512 hashes of the message body for digitally signed requests. The existing code primarily focuses on handling the `Authorization` header for Digest Authentication.\\n\\n### Implementation Details\\n\\nThe `wso2/product-apim` repository includes a `DigestAuthMediator` class . This mediator is likely responsible for processing Digest Authentication. The `dummy_digest_api.xml` files   demonstrate how an API can be configured to expect an `Authorization` header for Digest Authentication. These configurations check for the presence of the `Authorization` header and respond with a 200 OK if present, or a 401 Unauthorized if not, including a `WWW-Authenticate` header for Digest authentication challenges  .\\n\\nThe `APIMTestCaseUtils.java` file contains methods for handling JWT signatures, specifically `isJwtSignatureValid` . This method checks the validity of a JWT signature and supports `SHA256withRSA` and `SHA512withRSA` algorithms . However, this is related to JWT validation and not directly to the `Digest` header for message body hashing.\\n\\n### Configuration Options\\n\\nThe `deployment.toml` file  and `api-manager.xml`  show a `signing_algorithm` configuration for JWTs, which can be set to `SHA256withRSA`. This indicates support for these hashing algorithms in the context of JWTs, but not explicitly for a `Digest` header on the message body.\\n\\n### API Endpoints or Features\\n\\nThe `DigestAuthenticationTestCase.java`  demonstrates the creation and invocation of an API secured with Digest Authentication. It sets `endpointAuthType` to \"digestAuth\"  and includes an `Authorization` header in the request . However, there is no mention or implementation of a `Digest` header for the message body.\\n\\n### Documentation References\\n\\nNo explicit documentation references regarding the `Digest` header for message body hashing with SHA-256 or SHA-512 were found in the provided snippets. The `services-config.xml` file mentions \"XML Digital Signatures\" as a message integrity option , but this is a general security policy setting and does not specifically address the `Digest` header requirement.\\n\\n## Notes\\n\\nThe provided code snippets indicate strong support for Digest Authentication using the `Authorization` header and JWT signature validation with SHA-256 and SHA-512. However, there is no direct evidence in these snippets to confirm that the system automatically generates or validates a `Digest` header containing a hash of the message body using SHA-256 or SHA-512 algorithms when a TPP includes a digital signature. The existing \"Digest\" related code focuses on HTTP Digest Access Authentication, which is different from the \"Digest\" header for message body integrity.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_bf976cc2-cd01-4e85-8353-457b16ef5bd5\\n', 'id': 'lc_7df0dac5-5395-44ad-affe-b4b77f756683'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0090",
      "requirement": {
        "requirement_id": "ATOM_084",
        "requirement_text": "TPP must validate eIDAS certificate, request syntax, TPP role, and semantics when receiving payment status response",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0090_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support aspects of certificate validation and API security that could be relevant to eIDAS certificate validation and TPP role verification, particularly within the context of Financial-grade API (FAPI) compliance. However, direct implementation details for \"eIDAS certificate validation,\" \"TPP role verification,\" or \"semantic validation upon payment status response receipt\" are not explicitly found in the provided snippets.\\n\\n### Implementation Details and API Endpoints\\n\\nThe codebase includes a Python script, `oidc-fapi-conformance-tests/resource-server/resource-server.py`, which demonstrates FAPI validations. This script performs several checks related to client certificates and access tokens .\\n\\nSpecifically, the `resource` endpoint in this script performs the following validations:\\n1.  **Access Token Retrieval**: It extracts the access token from the `Authorization` header .\\n2.  **Thumbprint from Access Token**: It retrieves a SHA256 thumbprint from the `cnf` claim within the access token. This `cnf` claim can be obtained either by decoding a JWT access token or by introspecting a non-JWT token via the `/oauth2/introspect` endpoint .\\n3.  **Thumbprint from Client Certificate**: It extracts the client certificate from the `X-Ssl-Cert` header and computes its SHA256 thumbprint .\\n4.  **Thumbprint Matching**: It compares the thumbprint from the access token with the thumbprint from the client certificate. If they do not match, an `Unauthorized` error is raised . This mechanism is crucial for mutual TLS (mTLS) and client certificate-bound access tokens, which are often requirements in FAPI and eIDAS contexts.\\n5.  **Access Token Introspection**: It validates the access token\\'s active state by calling the `/oauth2/introspect` endpoint .\\n\\nThe `IdPSuccessTest.java` file also shows that Identity Providers (IdPs) can be configured with certificates, including the ability to add or remove certificates and JWKS URIs via the Identity Provider management API . This suggests that the system has capabilities for managing certificates associated with external entities, which could be extended to eIDAS certificates.\\n\\nThe `pom.xml` file indicates the presence of an `x509Certificate` authenticator , which further supports the capability for X.509 certificate-based authentication.\\n\\n### Configuration Options\\n\\nThe `IdPSuccessTest.java` file demonstrates API calls to configure Identity Providers, including updating claims, roles, and Just-in-Time (JIT) provisioning settings . It also shows how to patch an IdP to add or remove JWKS URIs and certificates . These configuration options are relevant for setting up trust relationships and validating certificates from external entities like TPPs.\\n\\n### Documentation References\\n\\nThe \"Features and Capabilities\" wiki page for `wso2/product-is` mentions \"Financial-grade API (FAPI) Support\" under API Security . FAPI often involves strict security requirements, including mTLS and certificate validation, which aligns with the user\\'s query regarding eIDAS certificates. The wiki also lists \"OAuth 2.0 for API Security\" and \"JWT Access Tokens\" , which are foundational for secure API interactions and can incorporate certificate-bound tokens.\\n\\n### Test Criteria\\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` script provides a concrete example of how certificate validation is performed. The comparison of thumbprints from the client certificate and the access token directly addresses the \"eIDAS certificate validation\" aspect, assuming eIDAS certificates are used as client certificates in an mTLS setup . The script also validates the access token\\'s active state, which is a form of request syntax validation .\\n\\nWhile direct \"TPP role verification\" and \"semantic validation upon payment status response receipt\" are not explicitly detailed in the provided snippets, the platform\\'s capabilities for claim management  and role management  suggest that TPP roles could be mapped to internal roles or claims and then validated during authorization flows. The extensibility features, such as \"Authentication Scripts\"  and \"Pre/Post Actions\" , could potentially be used to implement custom semantic validation logic.\\n\\n## Notes\\n\\nThe provided code snippets and wiki page indicate strong support for general API security, FAPI compliance, and certificate management within WSO2 Identity Server. While \"eIDAS\" and \"TPP\" are not explicitly mentioned, the underlying mechanisms for certificate validation (especially client certificate-bound access tokens via mTLS) and role-based access control are present. The `oidc-fapi-conformance-tests/resource-server/resource-server.py` script is a particularly relevant example of how certificate validation is implemented in a FAPI context. The `modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/rest/api/server/action/management/v1/preupdatepassword/PreUpdatePasswordActionFailureTest.java` file, while mentioning \"certificate content is invalid\" , is less directly relevant to the TPP validation scenario as it pertains to password sharing certificates rather than client authentication certificates.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_de17e42d-b2ed-4f89-8556-1c5fcc329f0d\\n', 'id': 'lc_37621cbf-13d8-4e28-acac-bad8347beda0'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0090_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support client certificate management, which could be relevant to eIDAS certificate validation, and also includes features for role validation. However, there is no direct evidence within the provided snippets that explicitly mentions \"eIDAS\", \"TPP\" (Third Party Provider), or specific \"payment status response\" semantics. The codebase primarily deals with general API security, mutual SSL, and certificate handling.\\n\\n### Implementation Details for Certificate Management\\n\\nThe `wso2/product-apim` repository provides APIs for managing client and endpoint certificates.\\nThe `ClientCertificatesApi.java`  and `EndpointCertificatesApi.java`  classes define operations for adding, deleting, getting, and updating certificates.\\n\\nFor client certificates, the following operations are available:\\n*   `deleteAPIClientCertificateByKeyTypeAndAlias`: Deletes a client certificate by key type and alias. \\n*   `getAPIClientCertificateByAlias`: Retrieves information about a client certificate using its alias. \\n*   `getAPIClientCertificateByKeyTypeAndAlias`: Retrieves information about a client certificate by key type and alias. \\n*   `getAPIClientCertificateContentByAlias`: Downloads a client certificate by alias. \\n*   `getAPIClientCertificateContentByKeyTypeAndAlias`: Downloads a client certificate by key type and alias. \\n*   `updateAPIClientCertificateByAlias`: Updates an existing client certificate. \\n*   `updateAPIClientCertificateByKeyTypeAndAlias`: Updates an existing client certificate by key type and alias. \\n\\nSimilarly, for endpoint certificates, operations like `addEndpointCertificate`, `deleteEndpointCertificateByAlias`, `getEndpointCertificateByAlias`, `getEndpointCertificateContentByAlias`, and `updateEndpointCertificateByAlias` are available.     \\n\\nThe `APISecurityTestCase.java`  demonstrates uploading a certificate using `restAPIPublisher.uploadCertificate`. This suggests that the system can handle and store certificates for security purposes. The `testAPIInvocationWithMutualSSLHeader` test case  shows how a client certificate can be sent in the `X-WSO2-CLIENT-CERTIFICATE` header for mutual SSL authentication.\\n\\n### Configuration Options\\n\\nThe provided code snippets do not directly expose configuration options for eIDAS-specific validation. However, the presence of `keyType` parameters in `ClientCertificatesApi`  and the ability to upload certificates suggest that different types of certificates can be managed. The `tier` parameter in `updateAPIClientCertificateByAlias`  and `updateAPIClientCertificateByKeyTypeAndAlias`  might allow for categorization or policy enforcement based on certificate characteristics.\\n\\n### API Endpoints or Features\\n\\nThe `ClientCertificatesApi`  and `EndpointCertificatesApi`  classes expose API endpoints for certificate management. These APIs allow for programmatic interaction with the certificate store. The `APISecurityTestCase`  demonstrates the use of mutual SSL, which is a mechanism for client certificate validation. The `RolesApi`  provides an endpoint `validateUserRole` to check if a logged-in user has a specific role, which could be used for TPP role verification.\\n\\n### Documentation References\\n\\nThe `ClientCertificatesApi.md`  and `EndpointCertificatesApi.md`  files provide documentation for the respective APIs, including parameters, return types, authorization, and HTTP response details. The `RolesApi.md`  documents the `validateUserRole` endpoint.\\n\\n### Test Criteria\\n\\nThe `APISecurityTestCase.java`  includes tests for mutual SSL authentication, which involves client certificate validation. Specifically, `testAPIInvocationWithMutualSSLMandatoryNegative2` and `testAPIInvocationWithMutualSSLHeader` verify that API invocations fail with `HttpStatus.SC_UNAUTHORIZED` if the mutual SSL authentication is not successful or if an incorrect certificate is used. This indicates that the system performs certificate validation.\\n\\nThe `JWTGrantTestCase.java`  includes a test `testGenerateTokenWithJWTSignedWithDifferentCert` which asserts that a JWT token signed with a different certificate than the Identity Provider (IDP) results in an error \"Signature or Message Authentication invalid\". This demonstrates that the system validates the signature of JWT tokens, which is a form of certificate validation.\\n\\nWhile the codebase supports general certificate validation and role checking, there is no explicit mention of \"eIDAS certificate\", \"request syntax validation\" specific to payment status responses, or \"semantic validation upon payment status response receipt\" within the provided snippets. The existing certificate management and mutual SSL features could potentially be extended or configured to support eIDAS certificates, but this would require further implementation or configuration beyond what is directly visible.\\n\\n## Notes\\n\\nThe provided snippets focus on general API management, security, and certificate handling within the `wso2/product-apim` repository. While the concepts of certificate validation and role checking are present, there is no direct evidence of specific support for \"eIDAS certificate\", \"TPP role\", \"request syntax validation\" or \"semantic validation\" in the context of \"payment status response\" as requested in the prompt. These might be features implemented at a higher level or in other modules not included in the provided context.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3d10c8bc-9ecc-44e0-ad60-dc741239aa73\\n', 'id': 'lc_4c5863e9-1595-4f1c-b1d3-17e03bd235fd'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0091",
      "requirement": {
        "requirement_id": "ATOM_048",
        "requirement_text": "Error responses shall include a human-readable title describing the error condition",
        "strength": "SHALL",
        "capability": "Error Handling",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0091_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports error responses that include a human-readable title (referred to as \"message\" in the codebase) describing the error condition.  The error responses are typically in JSON format and contain fields such as `code`, `message`, `description`, and `traceId`. \\n\\n### Implementation Details\\n\\nThe core implementation for validating error responses, including the presence of a human-readable message, is found in the `RESTTestBase.java` file.  The `validateErrorResponse` method is responsible for asserting the structure and content of error responses. \\n\\nSpecifically, the `validateErrorMessage` method is called within `validateErrorResponse` to check the `message` field.  This method retrieves the expected error message from the `RESTAPIErrors.properties` file based on the provided `errorCode`.  The `validateElementAgainstErrorProperties` method then compares the actual `message` in the response with the expected message. \\n\\nAn example of how `validateErrorResponse` is used can be seen in `AuthenticatorFailureTest.java`, where a `statusCode`, `code`, `message`, and `description` are validated for a bad request.  Similarly, `IdPFailureTest.java` and `OrganizationManagementFailureTest.java` also utilize `validateErrorResponse` to verify error conditions.  \\n\\n### Configuration Options\\n\\nThe human-readable titles (messages) and descriptions for error conditions are configured in the `RESTAPIErrors.properties` file.  This file maps specific error codes to their corresponding messages and descriptions.  For example, `CQM-18017.message` defines the message for error code `CQM-18017`.  Dynamic values within the error descriptions can be specified using placeholders (`%s`) and are replaced during test execution. \\n\\n### API Endpoints or Features\\n\\nThe error response structure, including the `message` field, is consistently applied across various REST APIs within the WSO2 Identity Server. This is evident from the usage of `validateErrorResponse` in integration tests for different API categories, such as:\\n\\n*   **Authenticator Management API**: Errors related to authenticator configurations. \\n*   **Identity Provider Management API**: Errors concerning Identity Provider configurations. \\n*   **Organization Management API**: Errors related to organization management operations. \\n*   **Tenant Management API**: Errors during tenant-related operations. \\n*   **Claim Management API**: Errors during claim management operations. \\n\\nThe `scim2.yaml` Swagger definition also outlines error response schemas, which include `status`, `schemas`, `scimType`, and `detail` fields for various error conditions like `ErrorIvalidInput`, `ErrorUnauthorized`, `ErrorForbidden`, and `ErrorInternalServerError`.     The `detail` field in these SCIM error responses serves a similar purpose to the `description` field in the `RESTAPIErrors.properties` file, providing a human-readable explanation of the error. \\n\\n### Documentation References\\n\\nThe wiki page \"Features and Capabilities\" provides a high-level overview of the WSO2 Identity Server\\'s features, including API Security and Management, which implicitly covers error handling for REST APIs.   While it doesn\\'t explicitly detail the error response format, it confirms the existence and importance of robust API interactions. \\n\\n## Notes\\n\\nThe term \"title\" in the user\\'s query corresponds to the \"message\" field in the WSO2 Identity Server\\'s error response structure.  The `RESTAPIErrors.properties` file is central to defining these human-readable error messages and descriptions.  The integration tests consistently validate the presence and content of these fields, ensuring that error responses are informative.  The `scim2.yaml` file also defines error schemas with a `detail` field that serves a similar purpose to the `description` field in the `RESTAPIErrors.properties` file. \\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_708a366b-0afe-431e-90b0-100127122151\\n', 'id': 'lc_6357ad59-6eab-4e73-a0a8-ce612f5e37ba'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0091_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Yes, this repository supports error responses that include a human-readable title describing the error condition.    \\n\\n## Implementation Details\\n\\nThe error response structure is defined in several OpenAPI specification files across the repository.    These specifications define an `Error` object that includes a `title` field.   \\n\\nFor example, in `gateway-api.yaml`, the `Error` definition explicitly includes a `title` field described as \"Error object returned with 4XX HTTP status\".  This `Error` object is then referenced by various HTTP error responses, such as `BadRequest` and `NotFound`.  \\n\\nThe `Error` object typically contains the following properties:\\n*   `code`: An integer representing the error code. \\n*   `message`: A string providing a concise error message. \\n*   `description`: A more detailed description of the error message. \\n*   `moreInfo`: An optional URL with more details about the error. \\n*   `error`: An array of `ErrorListItem` objects for multiple errors, such as validation errors. \\n\\nThe `ErrorListItem` itself also includes `code` and `message` fields. \\n\\n## Configuration Options\\n\\nThe error response structure is defined within the OpenAPI specification files. There are no explicit runtime configuration options mentioned in the provided snippets that would alter the presence or content of the `title` field in error responses. The `title` field is part of the schema definition for error objects. \\n\\n## API Endpoints or Features\\n\\nThe `Error` object and its `title` field are used across various API definitions within the `wso2/product-apim` repository.   \\n\\nExamples include:\\n*   **Gateway API**: Defines `BadRequest` and `NotFound` responses that reference the `Error` schema.  \\n*   **Service Catalog API**: Various endpoints, such as those for deleting or getting services, return error responses (e.g., 400, 401, 404, 409, 500) that conform to the `Error` schema.  \\n*   **Store API**: Similar to the Service Catalog API, the Store API also uses the `Error` schema for its error responses. \\n*   **Admin API**: The Admin API also defines error responses that include the `Error` and `ErrorListItem` schemas. \\n\\n## Documentation References\\n\\nThe OpenAPI specification files themselves serve as documentation for the error response structure.    The `title` field within the `Error` definition explicitly states its purpose: \"Error object returned with 4XX HTTP status\".   \\n\\n## Test Criteria\\n\\nTo verify that error response JSON contains a \\'title\\' field with descriptive text, you would inspect the JSON response from an API call that results in an error. For example, if a `BadRequest` occurs, the response JSON should contain a `code`, `message`, `description`, and potentially a `moreInfo` field, as well as the overall `title` for the error object. \\n\\nAn example of a `BadRequest` error response from the `gateway-api.yaml` would look like this:\\n```json\\n{\\n  \"code\": 400,\\n  \"message\": \"Bad Request\",\\n  \"description\": \"Invalid request or validation error\",\\n  \"moreInfo\": \"\",\\n  \"error\": []\\n}\\n``` \\nWhile the `title` field is defined in the schema for the `Error` object, it is not explicitly shown in the `examples` provided within the OpenAPI specifications for individual error responses.   This suggests that the `title` might be a metadata field for the schema itself rather than a field directly included in the JSON payload of every error response. However, the `message` and `description` fields within the error response examples provide human-readable text describing the error condition. \\n\\n## Notes\\n\\nThe `title` field is consistently defined in the `Error` schema across multiple OpenAPI specification files, such as `gateway-api.yaml` , `openapi.yaml` (for service catalog) , `service-catalog-api.yaml` , `store-api.yaml` , and `admin-api.yaml` . While the `title` field is part of the schema definition, the provided examples of error responses do not explicitly include a field named `title` in the JSON payload. Instead, the `message` and `description` fields serve the purpose of providing human-readable error information.  Therefore, while the schema supports a \"title\" concept, the actual JSON responses might use `message` and `description` for the human-readable error condition.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_4a032fca-6097-4b6f-8a2a-84fa29c218ad\\n', 'id': 'lc_ce7eb3d5-96b7-4f1a-93ab-fb05804680bc'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0092",
      "requirement": {
        "requirement_id": "ATOM_008",
        "requirement_text": "XS2A API must support OAuth2 Authorization Code Grant flow for payment authorization using scope attribute to refer to payment data",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "eef9ab97432c - 4.2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0092_1",
          "text": "## Create API resources\n\nWSO2 Identity Server provides comprehensive capabilities for managing and securing API resources, particularly in the context of authorization and access control. You need to create below API resources in order to successfully invoke Open Banking APIs.\n\n    | API Resource | Identifier | Display Names | Scopes | \n    |------------- | ---------- | ------------- | ------ |\n    | API Resource for access scopes attached to customer facing Open Banking APIs | User-defined-oauth2-resource | User-defined-oauth2-resource | accounts </br>payments </br>fundsconfirmations |\n    | API resource to acccess internal Open Banking APIs provided by WSO2 | OB-internal-api-resource | OB-internal-api-resource | ob-internal-api-access |\n\nFollow the below steps to create above API Reources.\n\n1. Go to the **Api Resources** tab in the left pane.\n\n2. Click **New API Resource**.\n\n      ![create-api-resource.png](../assets/img/get-started/quick-start-guide/create-api-resource.png)\n    \n3. Enter **Identifier** and **Display Names**.\n\n      | Text Field    | Value                        | \n      |---------------|------------------------------|\n      | Identifier    | User-defined-oauth2-resource |\n      | Display Names | User-defined-oauth2-resource |\n\n      ![api_resource_basic_detail_page.png](../assets/img/get-started/quick-start-guide/api_resource_basic_detail_page.png)\n\n4. Click **Next**.\n\n5. Add the following scopes one at a time: **accounts**, **payments**, and **fundsconfirmations**. \n   For each scope, enter the Scope and Display Name as shown below.\n    ![api_resource_scopes_page.png](../assets/img/get-started/quick-start-guide/api_resource_scopes_page.png)\n\n6. Once all scopes have been added, they will be displayed as shown below.\n    ![api_resource_scopes_added_page.png](../assets/img/get-started/quick-start-guide/api_resource_scopes_added_page.png)\n\n7. Click **Next**.\n\n8. Click **Create**.\n\n    ![api_resource_authorisation_page.png](../assets/img/get-started/quick-start-guide/api_resource_authorisation_page.png)\n\n9. Create **OB-internal-api-resource** by flowing the above steps.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_2",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_3",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n!!!note\n      Replace the <AUTH_HEADER_VALUE> with Base64 encoded \"admin_username:admin_password\" value.\n               `Eg: Base64(admin_username:admin_password)`\n\n```\ncurl --location --request POST 'https://localhost:9446/api/fs/consent/manage/account-access-consents' \\\n--header 'Authorization: Basic <AUTH_HEADER_VALUE>' \\\n--header 'x-wso2-client-id: <CLIENT_ID>' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n   \"Data\":{\n      \"Permissions\":[\n         \"ReadAccountsBasic\",\n         \"ReadAccountsDetail\",\n         \"ReadBalances\",\n         \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\",\n      \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\"\n   },\n   \"Risk\":{\n   }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"ConsentId\": \"12a4ebc8-b98c-4f80-9a37-44679363b97b\",\n        \"StatusUpdateDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n        \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\",\n        \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_4",
          "text": "### Step 5: Validate Account Information Invocation\n\nThe Consent Validate implements the validations that are required when the resource endpoints are invoked with a user access token.\n\n!!! note\n    In a real-life open banking environment, the API consumer applications can retrieve details of accounts for which \n    the bank customer has granted them consent.\n \n- A sample request looks as follows:\n   ```\n   curl -X POST \\\n   https://localhost:9446/api/fs/consent/validate/validate \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'x-wso2-client-id: <CLIENT_ID>' \\\n   -H 'Authorization: Basic <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/jwt \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   --data 'eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.CgkJCXsKICAgICAgCQkJImhlYWRlcnMiOiB7CiAJCQkgIAkJIkF1dGhvcml6YXRpb24iOiAiQmFzaWMgYVhOZllXUnRhVzVBZDNOdk1pNWpiMjA2ZDNOdk1qRXlNdz09IiwKIAkJCSAJIAkiY29uc2VudC1pZCI6ICIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLAogCQkJICAJCSJhY3Rpdml0eWlkIjogIjg2NjZhYTg0LWZjNWEtNDI1ZS05MWM5LTM3ZmEzMGE5NTc4NCIsCiAJCQkgIAkJIkNhY2hlLUNvbnRyb2wiOiAibm8tY2FjaGUiLAogCQkJICAJCSJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogCQkgICAgICAJCSJVc2VyLUFnZW50IjogIlBvc3RtYW5SdW50aW1lLzcuMjguNCIsCiAJCQkgIAkJIkhvc3QiOiAibG9jYWxob3N0OjgyNDMiLAogCQkJICAJCSJQb3N0bWFuLVRva2VuIjogIjI0NGQxNWI2LWViMTgtNDA0NS1iYTg3LThlZTZjODMwYjg0YyIsCiAJCQkgIAkJIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlLCBiciIsCiAJCQkgIAkJImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IgogCQkJICAJfSwKICAgICAgICAJCSJjb25zZW50SWQiOiAiMTJhNGViYzgtYjk4Yy00ZjgwLTlhMzctNDQ2NzkzNjNiOTdiIiwKICAgICAgICAJCSJyZXNvdXJjZVBhcmFtcyI6IHsKCQkJCQkicmVzb3VyY2UiOiAiL2Fpc3AvYWNjb3VudHMiLAoJCQkJCSJjb250ZXh0IjogIi9vcGVuLWJhbmtpbmcvdjMuMS9haXNwIiwKCQkJCQkiaHR0cE1ldGhvZCI6ICJHRVQiCiAJCQkgCSB9LAogCQkJICAgICJ1c2VySWQiOiAicHN1QHdzbzIuY29tIiwKICAgICAJCSAJImVsZWN0ZWRSZXNvdXJjZSI6ICIvYWNjb3VudHMiLAoJCQkJImNsaWVudElkIjogImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiCiAJCQl9CiAgICAJCQk.mjbOnLQUvpCfIpy8WRaYxBmSMnENNIu7OG89Dc7kLJTk9NebnKsgFRo0PAyrkCN-h0g5PRfM0HPhSeBxbazgjekaLpA0iSXiuaXKZUmIUSBORNxORjvqD6flQRzUraaf2qG_OKSBMBpal-unqjcCAlNdgwclCnJMwDmQrJPMqs7jJoiJAudIHwppnJ1uK82Zz_J3bWkL4kEuT4Hz4P8ukdTzTALCPGqxt4VT4dh_ADzR-NTGmpAuSNo8dEWkW9a3QAxhS4WZXRTK192wAS16YqRPOk3UXasqF2qI1KVBb5txNFtjw5eZFW0Eg8cNSOQ0BSwp3B_6zd0jHf9EiwTbLA'\n   ```\n\n???tip \"Click here to see a sample data payload...\"\n      - Given below is a sample payload in the JWT format:\n\n           ```\n           {\n               \"kid\": \"<The KID value of the signing jwk set>\",\n               \"alg\": \"<SUPPORTED_ALGORITHM>\",\n               \"typ\": \"JWT\"\n           }\n           {\n               \"headers\": {\n                  \"Authorization\": \"Basic aXNfYWRtaW5Ad3NvMi5jb206d3NvMjEyMw==\",\n                  \"consent-id\": \"12a4ebc8-b98c-4f80-9a37-44679363b97b\",\n                  \"activityid\": \"8666aa84-fc5a-425e-91c9-37fa30a95784\",\n                  \"Cache-Control\": \"no-cache\",\n                  \"Connection\": \"keep-alive\",\n                  \"User-Agent\": \"PostmanRuntime/7.28.4\",\n                  \"Host\": \"localhost:8243\",\n                  \"Postman-Token\": \"244d15b6-eb18-4045-ba87-8ee6c830b84c\",\n                  \"Accept-Encoding\": \"gzip, deflate, br\",\n                  \"accept\": \"application/json; charset=utf-8\"\n               },\n               \"consentId\": \"<CONSENT_ID>\",\n               \"resourceParams\": {\n               \"resource\": \"/aisp/accounts\",\n               \"context\": \"/open-banking/v3.1/aisp\",\n               \"httpMethod\": \"GET\"\n           },\n           \"userId\": \"psu@wso2.com\",\n           \"electedResource\": \"/accounts\",\n           \"clientId\": \"<CLIENT_ID>\"\n           }\n           ```\n     \n- The request validates the Account Information access request. \n\n    !!! note\n        The response contains the validity of the Account access request along with consent information or the reason for the validation failure.\n\n```\n{\n    \"isValid\": true,\n    \"consentInformation\": \"eyJhbGciOiJSUzI1NiJ9.eyJjbGllbnRJZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJjdXJyZW50U3RhdHVzIjoiQXV0aG9yaXNlZCIsImNyZWF0ZWRUaW1lc3RhbXAiOjE3NDkwMTQ4MjYsInJlY3VycmluZ0luZGljYXRvciI6ZmFsc2UsImF1dGhvcml6YXRpb25SZXNvdXJjZXMiOlt7InVwZGF0ZWRUaW1lIjoxNzQ5MDE0ODU4LCJjb25zZW50SWQiOiIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLCJhdXRob3JpemF0aW9uSWQiOiI0NzRlYzFhMS1kZDRkLTQ1YjQtYTk4Zi1kMWYwNGRlMjUxYWEiLCJhdXRob3JpemF0aW9uVHlwZSI6ImF1dGhvcmlzYXRpb24iLCJ1c2VySWQiOiJwc3VAd3NvMi5jb20iLCJhdXRob3JpemF0aW9uU3RhdHVzIjoiQXV0aG9yaXNlZCJ9XSwidXBkYXRlZFRpbWVzdGFtcCI6MTc0OTAxNDg1OCwiY29uc2VudF90eXBlIjoiYWNjb3VudHMiLCJ2YWxpZGl0eVBlcmlvZCI6MCwiY29uc2VudEF0dHJpYnV0ZXMiOnt9LCJjb25zZW50SWQiOiIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLCJjb25zZW50TWFwcGluZ1Jlc291cmNlcyI6W3sibWFwcGluZ0lkIjoiNjZhOTU4YWItMjNkNC00ODhhLTg3M2EtYzM3MzRjN2VlMzVkIiwibWFwcGluZ1N0YXR1cyI6ImFjdGl2ZSIsImFjY291bnRfaWQiOiIzMDA4MDAxMjM0MzQ1NiIsImF1dGhvcml6YXRpb25JZCI6IjQ3NGVjMWExLWRkNGQtNDViNC1hOThmLWQxZjA0ZGUyNTFhYSIsInBlcm1pc3Npb24iOiJwcmltYXJ5In1dLCJhZGRpdGlvbmFsQ29uc2VudEluZm8iOnt9LCJyZWNlaXB0Ijp7IlJpc2siOnt9LCJEYXRhIjp7IlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjUtMDYtMDdUMTA6NTc6MDIuOTczNDIxKzA1OjMwIiwiRXhwaXJhdGlvbkRhdGVUaW1lIjoiMjAyNS0wNi0wOVQxMDo1NzowMi45NzIyNjErMDU6MzAiLCJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNCYXNpYyIsIlJlYWRBY2NvdW50c0RldGFpbCIsIlJlYWRCYWxhbmNlcyIsIlJlYWRUcmFuc2FjdGlvbnNEZXRhaWwiXSwiVHJhbnNhY3Rpb25Gcm9tRGF0ZVRpbWUiOiIyMDI1LTA2LTA0VDEwOjU3OjAyLjk3MzMyNCswNTozMCJ9fSwiY29uc2VudEZyZXF1ZW5jeSI6MH0.dtk8sPwuLdgHENiu7soD-I7cinmVGKn2Dn23pfcrPzqoGC5HuSJ9pPvYnCOeEMvf0gtvSaLbtn02CIo3oNn9JQiyQeR6iaINMfnXxINybWZvIlYowXAePESt3mh9BKNJ8SUWBdQQ1rjq5Jv4WY2Y3rKSqVyxn1l-5bmS7hiE6eb-REE4zqQY4sD8cfQAtJPcn5QWBDjUTssiTHuHJlROdXZTs7NpexzueFWOnMEPw00u9agW-hVnq6i8bDT4AH-ZLNZVT8IozGZ0AFbf9qBbYr5t0wmmiRwXmMEeoXa4np_nFOxzlt4kFdqdM47QIwq71dAzhQW9psMoZd6p6yMPug\"\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0092_5",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0093",
      "requirement": {
        "requirement_id": "ATOM_148",
        "requirement_text": "The system SHALL support multicurrency accounts by setting currency code to 'XXX' for aggregated multicurrency account views",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0093_1",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_2",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_3",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_4",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0093_5",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': \"Error processing question: Does this repository support: The system SHALL support multicurrency accounts by setting currency code to 'XXX' for aggregated multicurrency account views\\n                \\nSpecifically looking for:\\n- Implementation details\\n- Configuration options\\n- API endpoints or features\\n- Documentation references\\n\\nRequirement strength: SHALL\\nTest criteria: Verify that multicurrency accounts return currency value 'XXX' and that sub-accounts with specific currencies (EUR, USD) are also returned with their respective currency codes\", 'id': 'lc_e9a06bad-bf4c-461d-91ca-49c6e1227058'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0094",
      "requirement": {
        "requirement_id": "ATOM_179",
        "requirement_text": "The response MUST echo back the X-Request-ID header value from the request.",
        "strength": "MUST",
        "capability": "General",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0094_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, `wso2/product-is`, does not appear to explicitly support echoing back the `X-Request-ID` header value from the request in its responses. The snippets primarily focus on SAML and Identity Federation functionalities, as well as utility methods for handling HTTP responses and JSON parsing in integration tests.\\n\\nThere are no implementation details, configuration options, API endpoints, or documentation references within the provided context that indicate support for echoing the `X-Request-ID` header.\\n\\n## Implementation Details <cite/>\\nThe provided code snippets do not contain any direct implementation that reads an `X-Request-ID` header from an incoming request and then sets it in the outgoing response. The `Utils.java` file contains methods for extracting information from HTTP responses, such as claims or redirect URLs, but not for manipulating request or response headers in the manner described . Similarly, `ApplicationNativeAuthentication2FATestCase.java` and `RESTTestBase.java` are test classes that validate aspects of responses, such as JSON body content or HTTP status codes, but do not show any logic related to `X-Request-ID` headers  .\\n\\n## Configuration Options <cite/>\\nNo configuration options related to `X-Request-ID` header echoing are present in the provided context. The wiki page on \"SAML and Identity Federation\" discusses various configuration parameters for SAML SSO, Identity Federation, and Passive STS, but none of these relate to request ID headers .\\n\\n## API Endpoints or Features <cite/>\\nThe provided snippets do not expose any API endpoints or features that specifically handle or echo the `X-Request-ID` header. The `getResponseOfJSONPost` method in `ApplicationNativeAuthentication2FATestCase.java` shows how to send a JSON POST request with custom headers, but it does not imply that the server echoes back any specific request headers .\\n\\n## Documentation References <cite/>\\nThe \"SAML and Identity Federation\" wiki page, which serves as a documentation reference for a significant part of the repository\\'s functionality, does not mention `X-Request-ID` or any similar mechanism for tracing requests through header echoing .\\n\\n## Notes\\nThe provided code snippets are primarily from integration tests (`tests-backend` module) and a wiki page describing SAML and Identity Federation. While these tests interact with the system\\'s APIs, they do not reveal any server-side logic for handling `X-Request-ID` headers. The absence of such details in the provided context suggests that this specific functionality might not be directly supported or implemented within the scope of the given information.\\n\\nWiki pages you might want to explore:\\n- [SAML and Identity Federation (wso2/product-is)](/wiki/wso2/product-is#3.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6097071c-10fb-407e-a02d-f9e06e08b2d3\\n', 'id': 'lc_298358d4-8238-44d6-827d-dc04a099ec94'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0094_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided codebase, there is no direct support for echoing back the `X-Request-ID` header value from the request. The relevant configuration files and documentation do not mention `X-Request-ID` or a similar mechanism for request correlation in responses. \\n\\n## Implementation Details and Configuration Options\\n\\nThe `wso2/product-apim` repository contains documentation for \"Mediators\" which are components used to process messages. The `<property>` mediator allows setting properties on the message context, which can then be retrieved using `synapse:get-property(prop-name)` XPath extension function.  While this could potentially be used to extract an `X-Request-ID` from the incoming request and set it as a property, there is no explicit mechanism described to automatically echo this property back as a response header. \\n\\nThe `send` mediator copies message context properties to the reply message for correlation, but this is primarily for WS-A Message-ID or custom text labels, not general HTTP headers. \\n\\nThe `Owasp.CsrfGuard.Carbon.properties` files mention `X-Requested-With` header in the context of CSRF protection for Ajax requests, but this is unrelated to echoing `X-Request-ID`. \\n\\n## API Endpoints or Features\\n\\nThe OpenAPI specifications (`openapi.yaml` files) define various API endpoints and their expected request and response headers.  These specifications include headers like `If-None-Match`, `ETag`, `Last-Modified`, and `X-WSO2-Tenant`, but there is no mention of `X-Request-ID` being echoed in the responses. \\n\\n## Documentation References\\n\\nThe provided documentation snippets do not contain any explicit references or instructions for configuring the system to echo the `X-Request-ID` header in responses. \\n\\n## Notes\\n\\nThe codebase primarily focuses on mediation, security (CSRF), and API definitions. While it\\'s possible to implement custom logic to echo headers using mediators, there is no out-of-the-box feature or configuration option that directly addresses the requirement of echoing the `X-Request-ID` header. The `property` mediator could be used to manipulate headers, but it would require explicit configuration to extract and then set the `X-Request-ID` in the response. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ed6095fb-8e8a-40bd-93c9-fdedadecc2e2\\n', 'id': 'lc_a8f4e251-535a-4a81-9fd3-a9680c434708'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0095",
      "requirement": {
        "requirement_id": "ATOM_022",
        "requirement_text": "The specification SHALL support cancellation of payment initiations by PISPs starting from version 1.2.",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0095_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_2",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_3",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_4",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_5",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0095_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support the cancellation of payment initiations by PISPs starting from version 1.2 based on the provided code snippets. The `payment-initiation-openapi.yaml`  defines API endpoints for creating and retrieving payment consents and payments, but there is no explicit endpoint or functionality for cancelling an initiated payment.\\n\\n## Implementation Details and API Endpoints\\nThe `payment-initiation-openapi.yaml`  defines the following key endpoints related to payment initiation:\\n*   `POST /payment-consents`: Used to create payment consents. \\n*   `GET /payment-consents/{consentId}`: Used to retrieve payment consents. \\n*   `POST /payments`: Used to create payments. \\n*   `GET /payments/{paymentId}`: Used to retrieve payments. \\n\\nThe `PaymentService.java`  in the demo backend implements the `POST /payments` endpoint for payment submission  and a `GET /payment-consents/{ConsentId}/funds-confirmation` endpoint . However, there are no `DELETE` or `PATCH` methods defined for `/payments` or `/payment-consents` that would indicate a cancellation feature.\\n\\nThe `ConsentCoreService.java`  interface provides methods for `createAuthorizableConsent`  and `createExclusiveConsent` , and also `deleteConsentAttributes` . While consent attributes can be deleted, this does not directly translate to the cancellation of an initiated payment. The `README.md` for `org.wso2.financial.services.accelerator.consent.mgt.endpoint`  mentions a `revokeConsents` endpoint  in the `AdminApi`, which allows for revoking consents. However, revoking a consent is distinct from cancelling an already initiated payment.\\n\\n## Configuration Options\\nThe provided context does not show any specific configuration options related to enabling or disabling payment cancellation functionality. The `Overview` wiki page mentions a `financial-services.xml` file parsed by `FinancialServicesConfigParser`  for configuration management, but no details regarding payment cancellation are present.\\n\\n## Documentation References\\nThe `Overview` wiki page  describes the WSO2 Financial Services Accelerator as providing Open Banking capabilities including payment initiation . The `payment-initiation-openapi.yaml`  is a Swagger definition for the Payment Initiation API Specification, version \"v3.1\" . This specification outlines the available endpoints for payment initiation and consent management, but not for cancellation.\\n\\n## Test Criteria\\nThe provided test files, such as `PaymentsInitiationRequestHeaderValidationTests.groovy` , focus on validating request headers for payment initiation. There are no explicit tests for payment cancellation endpoints or processes.\\n\\n## Notes\\nThe provided codebase snippets primarily focus on the creation and retrieval of payment consents and payments. While consent revocation is mentioned, it is not equivalent to the cancellation of an initiated payment. To support the cancellation of payment initiations, new API endpoints (e.g., `DELETE` or `PATCH` on `/payments/{paymentId}`), corresponding backend logic in services like `PaymentService`, and relevant configuration and documentation would be required. The current codebase does not show these elements.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Identity Extensions (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2fad8380-4475-4489-a08e-fd8495f5bd42\\n', 'id': 'lc_56e233f9-7bc1-4470-8c1f-ab9d90547ddd'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0096",
      "requirement": {
        "requirement_id": "ATOM_013",
        "requirement_text": "The NextGenPSD2 API SHALL support dedicated authorisation endpoints for payment initiation transactions and establish consent transactions to handle transaction authorisation by PSUs.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0096_1",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_2",
          "text": "## What is new in this release\n\n####WSO2 Open Banking Accelerator for Identity Server \n\n- Accelerator-level support for both pre-initiated and scope-based consent flows\n- OpenAPI based accelerator extension points to implement specification compliance addition to supported java based extension points. Fore more information, see [OpenAPI for Accelerator extensions](../references/accelerator-extensions-api.md)\n- JDK21 runtime support\n- Idempotency feature support from accelerator layer\n- Generalized consent management support for common open banking use cases. For more information, see [Consent Management](../learn/consent-management.md).\n- New features support from WSO2 Identity Server\n\n    - Native support for Financial grade API (FAPI) Security. For more info,[refer](https://is.docs.wso2.com/en/7.0.0/references/financial-grade-api/)  \n    - OAuth2 Rich Authorization Request (RAR) support.For more info ,[refer](https://is.docs.wso2.com/en/latest/guides/authorization/rich-authorization-requests/) \n    \n\n\n\n##What has changed in this release\n\nWSO2 Open Banking Accelerator 4.0 is an improved version of WSO2 Open Banking Accelerator 3.0 to expand covering\ndomain from Open Banking to Open Finance and improve developer experience of implementing accelerator extension points\nto cater regulatory and other open banking/ open finance requirements. Some significant changes in this release are,\n\n- OpenAPI based extensions support for IAM Accelerators.  Fore more information, see [OpenAPI for Accelerator extensions](../references/accelerator-extensions-api.md)\n- Out of the box support for both of the consent flows of pre-initiated and scopes based",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_3",
          "text": "### push-auth/authenticate endpoint\n\nThe SDK invokes the `push-auth/authenticate` endpoint within the `sendAuthRequest()` method to send the consent \nauthorization status (approved/denied) to the authorization server/WSO2 Identity Server.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_4",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n!!!note\n      Replace the <AUTH_HEADER_VALUE> with Base64 encoded \"admin_username:admin_password\" value.\n               `Eg: Base64(admin_username:admin_password)`\n\n```\ncurl --location --request POST 'https://localhost:9446/api/fs/consent/manage/account-access-consents' \\\n--header 'Authorization: Basic <AUTH_HEADER_VALUE>' \\\n--header 'x-wso2-client-id: <CLIENT_ID>' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n   \"Data\":{\n      \"Permissions\":[\n         \"ReadAccountsBasic\",\n         \"ReadAccountsDetail\",\n         \"ReadBalances\",\n         \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\",\n      \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\"\n   },\n   \"Risk\":{\n   }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"ConsentId\": \"12a4ebc8-b98c-4f80-9a37-44679363b97b\",\n        \"StatusUpdateDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n        \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\",\n        \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0096_5",
          "text": "6. After the user approves/denies the consent and selects the accounts, a `PATCH authorize/persist` request is made to persist the consent information. 7. Finally, if the persistence is successful, to complete the flow the `/authorize` endpoint is invoked. This results in a redirection to the callback URL of the API consumer application, which is deep linked to the API consumer application. Therefore, the customer is redirected to the mobile application of the API consumer.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0097",
      "requirement": {
        "requirement_id": "ATOM_122",
        "requirement_text": "The payment cancellation DELETE request SHALL return HTTP 202 if authorisation of the cancellation by the PSU is needed",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0097_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0097_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0097_3",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0097_4",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports payment cancellation requests that may require PSU (Payment Services User) authorization, returning an HTTP 202 status code in such scenarios.  This functionality is primarily handled through the consent revocation operations, which can integrate with external services for pre-revocation processing and validation. \\n\\n## Implementation Details\\n\\nThe core of the consent revocation process is managed by the `DefaultConsentAdminHandler` class.  This handler coordinates administrative consent operations, including revocation. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n\\nThe revocation process involves several steps:\\n1.  **Revoke Request**: An initial request to revoke a consent is made. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n2.  **Consent ID Validation**: The provided consent ID is validated. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n3.  **Consent Retrieval**: The consent resource associated with the ID is retrieved. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n4.  **External Pre-Revocation Check**: The system checks if external pre-revocation processing is enabled. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" /> If enabled, an external service is called for validation. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" /> This external service can determine if PSU authorization is needed. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n5.  **Status Check**: The consent\\'s current status is checked. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n6.  **Revocation Execution**: The revocation is executed. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n7.  **Token Revocation**: If required by the external service, associated tokens are revoked. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n8.  **Response Generation**: A response is generated, which can include an HTTP 202 status if PSU authorization is pending. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n\\nThe `ResponseStatus` enum defines `ACCEPTED(202, \"Accepted\")`, indicating support for the HTTP 202 status code. \\n\\n## Configuration Options\\n\\nThe system provides an extension point for pre-processing consent revocation requests, named `PRE_PROCESS_CONSENT_REVOKE`. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" /> This extension allows for custom business logic to be executed before a consent is revoked, which can include checks for PSU authorization. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n\\nThe external service integration uses `ExternalAPIAdminConsentRevokeRequestDTO` to send consent resource information and request headers to the external service, and expects `ExternalAPIAdminConsentRevokeResponseDTO` in return. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" /> The response DTO can specify `revocationStatusName` and `requireTokenRevocation`, allowing the external service to dictate the outcome of the revocation, including a pending authorization state. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint for consent revocation is `DELETE /admin/revoke`.  This endpoint is exposed through the `AdminApi` and is used to revoke consents. \\n\\nThe `accelerator-extensions-v1.0.0.yaml` file defines a `/pre-process-consent-revoke` endpoint that handles pre-consent revocation validations when a TPP (Third Party Provider) calls consent `/DELETE`.  This endpoint is designed to return a `200 OK` response, but the underlying logic can trigger a 202 if PSU authorization is required. \\n\\n## Documentation References\\n\\nThe \"Admin Operations\" wiki page provides a detailed overview of the consent revocation process, including the external service integration. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" /> It describes how the `DefaultConsentAdminHandler` and `ExternalAPIConsentAdminUtils` classes are used to manage consent revocation and integrate with external services for custom logic. <cite repo=\"wso2/financial-services-accelerator\" path=\"wso2/financial-services-accelerator\" start=\"3.3\" end=\"3.3\" />\\n\\nThe `README.md` for `org.wso2.financial.services.accelerator.consent.mgt.endpoint` also lists the `DELETE /admin/revoke` endpoint and provides a Java example for calling `AdminApi#revokeConsents`. \\n\\n## Notes\\n\\nThe provided code snippets and wiki documentation indicate that the system is designed to handle scenarios where external authorization is required for consent revocation. The `PRE_PROCESS_CONSENT_REVOKE` extension point is crucial for implementing the logic to determine if PSU authorization is needed and to return the appropriate HTTP 202 status. While the OpenAPI specification for `/pre-process-consent-revoke` explicitly lists a `200 OK` response, the overall framework\\'s support for `ACCEPTED (202)` in `ResponseStatus` and the external service integration capabilities suggest that a 202 response for pending PSU authorization is an intended feature that would be implemented within the external service logic.  \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Admin Operations (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e64e7e6e-4ef8-4623-b082-58143caadf4a\\n', 'id': 'lc_33a2e7c1-692d-40ea-822e-15571b092c95'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0098",
      "requirement": {
        "requirement_id": "ATOM_149",
        "requirement_text": "The system SHALL provide _links object with balances and transactions href URLs for each accessible account based on consent permissions",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0098_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_2",
          "text": "### Retrieve a consent \n- An API consumer can retrieve a consent resource that they have created to check its status. In order to make this request, \nthe API consumer must have an access token issued by the bank using the client credentials grant.\n\n??? tip \"Click here to find how to generate an application access token...\"\n    - Generate an application access token using the following command: \n      ```\n      curl -X POST \\\n      https://<IS_HOST>:9446/oauth2/token \\\n      --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n      -d 'grant_type=client_credentials&scope=accounts%20openid&client_assertion=eyJraWQiOiJEd01LZFdNbWo3UFdpbnZvcWZReVhWe\n      nlaNlEiLCJhbGciOiJQUzI1NiJ9.eyJzdWIiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OT\n      Q0Ni9vYXV0aDIvdG9rZW4iLCJpc3MiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiZXhwIjoxNjg0MDk5ODEyLCJpYXQiOjE2ODQwOTk4\n      MTMsImp0aSI6IjE2ODQwOTk4MTIifQ.EMZ2q3jciJ4MmrsH93kH_VGacrt2izbLaCBchGWiyUltdWwj3GwDMKfhpeMHtThd0DszwV8LUPKZaMT3wUS\n      oH3adY2IBC8aa2GKeb_vaQB5b0ZO6WpYQ45y_xIttAVj56d6oPli8wN4MlJoJsFPUlaxQohCLunN43BxSr-kFgeFMj7ynEsVbQvuYuEiTppwTSyXlt\n      Jmv70-nwpGU9UyuPCkXUsU53ShICrY0nC-3NUhY6oNpZclJP4MwG8mP4ZOvUIez_PSoP3AiaNithWhPCfLuKd68OLAReTBGdItqidsWWnn8lPVbM2F\n      LvehukHDCJhf9-ev1pdWIiwDSVDV7uQ&redirect_uri=www.wso2.com'\n      ```\n      - The request payload contains a client assertion in the following format:\n      ```\n      {\n      \"alg\": \"<<The algorithm used for signing>>\",\n      \"kid\": \"<<The KID value of the signing jwk set>>\",\n      \"typ\": \"JWT\"\n      }\n        \n      {\n      \"iss\": \"<<This is the issuer of the token. For example, client ID of your application>>\",\n      \"sub\": \"<<This is the subject identifier of the issuer. For example, client ID of your application>>\",\n      \"exp\": <<This is epoch time of the token expiration date/time>>,\n      \"iat\": <<This is epoch time of the token issuance date/time>>,\n      \"jti\": \"<<This is an incremental unique value>>\",\n      \"aud\": \"<<This is the audience that the ID token is intended for. For example, https://<APIM_HOST>:8243/token>>\"\n      }\n        \n      <signature: For DCR, the client assertion is signed by the private key of the signing certificate. Otherwise the private\n      signature of the application certificate is used.>\n      ```\n      - Upon successful token generation, you obtain a token as follows:\n      ```\n      {\n         \"access_token\":\"aa8ce78b-d81e-3385-81b1-a9fdd1e71daf\",\n         \"scope\":\"accounts payments  openid\",\n         \"id_token\":\"eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5HWXdZbU00WlRBM01XSTJOREF6WkdRek5HTTBaR1JsTmpKa09ERmtaRFJpT1RGa01XRmhNelUyWkdWbE5nX1JTMjU2IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiaHVBcS1GbzB0N2pFZmtiZ1A4TkJwdyIsImF1ZCI6WyJrYkxuSkpfdVFMMlllNjh1YUNSYlBJSk9SNFVhIiwiaHR0cDpcL1wvb3JnLndzbzIuYXBpbWd0XC9nYXRld2F5Il0sInN1YiI6ImFkbWluQHdzbzIuY29tQGNhcmJvbi5zdXBlciIsIm5iZiI6MTYwMTk5MzA5OCwiYXpwIjoia2JMbkpKX3VRTDJZZTY4dWFDUmJQSUpPUjRVYSIsImFtciI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwic2NvcGUiOlsiYW1fYXBwbGljYXRpb25fc2NvcGUiLCJvcGVuaWQiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo4MjQzXC90b2tlbiIsImV4cCI6MTYwMTk5NjY5OCwiaWF0IjoxNjAxOTkzMDk4fQ.cGdQ-9qK5JvKW32lK_PqhyJZyRb3r_86UPRFI2hlgiScnLYD8RsXDBNalmmnHiAbfb06e69QHQnmEKa6pcSSFWor0OAuzisBb6C5V51E9vH0eCr4hIa_lBtmjvLmsSue7puRUaYcyptwiuUkwjLFb-3_cpeuzWH29Knwne6zVD8gav_FPi1ub4vkrkX8ktLZH_JQG20fim1Ai5j2Q7jcnaMIHShYnC9sLBP5usp3thFLdQEyH8KCHJK79yNKzaruUntkq9yqqO_MQvY7VevLlDEDPllniRVih0r4TICdGrgJ0Ibr4wh_xFksVhYqa2_6x71ed_K9SX3hG-6T6pBUVA\",\n         \"token_type\":\"Bearer\",\n         \"expires_in\":3600\n      }\n      ```\n- A sample request to retrieve a consent looks as follows:\n```\ncurl GET \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- A sample response looks as follows:\n```\n{\n    \"Meta\": {\n        \"TotalPages\": 1\n    },\n    \"Risk\": {},\n    \"Links\": {\n        \"Self\": \"https://<IS_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID>\"\n    },\n    \"Data\": {\n        \"Status\": \"Authorised\",\n        \"StatusUpdateDateTime\": \"2020-10-07T12:46Z\",\n        \"CreationDateTime\": \"2020-10-07T09:29Z\",\n        \"TransactionToDateTime\": \"2020-10-09T10:28:49+05:30\",\n        \"ExpirationDateTime\": \"2020-10-11T10:28:49+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"41042513-fa45-4da8-93be-1513b3caffac\",\n        \"TransactionFromDateTime\": \"2020-10-06T10:28:49+05:30\"\n    }\n}\n```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_3",
          "text": "### Delete a consent\n- If the customer revokes a consent to data access with the API consumer, the API consumer must delete the consent resource. \nIn order to make this request, the API consumer must have an access token issued by the API consumer using the client \ncredentials grant.\n\n- A sample request to delete a consent looks as follows:\n```\ncurl DELETE \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- If the deletion is successful you will get a `204 No Content` response.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_4",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_5",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0098_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator supports providing `_links` objects with balances and transactions href URLs for each accessible account based on consent permissions.    This functionality is primarily defined within the OpenAPI specifications for the Account Information APIs and is demonstrated through integration tests.    \\n\\n## Implementation Details\\n\\nThe `_links` object is part of the response structure for account-related API calls, as defined in the OpenAPI specification `account-info-swagger.yaml` . Specifically, the `OBReadAccount4`, `OBReadAccount5`, `OBReadBalance1`, and `OBReadTransaction5` schemas include a `Links` property that references a shared `#/definitions/Links` object.     This `Links` object is expected to contain self-referential URLs and potentially other related resource URLs. \\n\\nFor example, the `PaymentService.java` in the demo backend explicitly constructs a `linksObject` with a \"Self\" URL for payments, indicating a similar pattern for other resources like accounts, balances, and transactions. \\n\\n## API Endpoints and Features\\n\\nThe `account-info-swagger.yaml` defines the following relevant API endpoints:\\n*   `/accounts/{AccountId}/balances`: This endpoint is used to retrieve balances for a specific account.  It requires `PSUOAuth2Security` or `default` security with the `accounts` scope. \\n*   `/accounts/{AccountId}/transactions`: This endpoint is used to retrieve transactions for a specific account.  It also requires `PSUOAuth2Security` or `default` security with the `accounts` scope. \\n\\nThe `x-scope: accounts` attribute indicates that access to these endpoints is governed by the `accounts` OAuth scope, ensuring that only authorized Third Party Providers (TPPs) with appropriate consent can access the information.  \\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, manages configurations related to consent management and identity server extensions.  While the provided snippets do not directly show configuration for the `_links` object generation, the overall consent management framework ensures that access to account information, including balances and transactions, is permission-based. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page for `wso2/financial-services-accelerator` provides a high-level overview of the system\\'s capabilities, including support for account information services and consent management.  It explicitly mentions that the accelerator implements regulatory standards for consent management and secure API access. \\n\\n## Test Criteria Verification\\n\\nThe integration test suite, specifically `EndToEndAccountFlowTest.groovy`, includes tests that verify the retrieval of account, transaction, and balance information after a consent has been authorized.    These tests confirm that the system provides access to these resources based on authorized consent, which implies the presence and accessibility of the corresponding href URLs within the `_links` object in the API responses. \\n\\n## Notes\\n\\nThe `_links` object itself is a common pattern in HATEOAS (Hypermedia as the Engine of Application State) APIs, which is often used in Open Banking specifications to provide discoverability of related resources. The provided `account-info-swagger.yaml` defines the structure for `OBReadAccount4`, `OBReadAccount5`, `OBReadBalance1`, and `OBReadTransaction5` to include a `Links` object, which is a strong indicator of support for this requirement.     The actual generation of the specific href URLs would be handled by the backend services implementing these API specifications. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0e43b74a-44a5-4c15-a12e-2878d9c151f4\\n', 'id': 'lc_2a139c6c-f832-464d-9959-fdc5b24ecd1d'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0099",
      "requirement": {
        "requirement_id": "ATOM_180",
        "requirement_text": "The API MUST support a GET endpoint at /v1/card-accounts to read a list of card accounts with additional information including balance information.",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0099_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0099_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0099_3",
          "text": "### Retrieve a consent \n- An API consumer can retrieve a consent resource that they have created to check its status. In order to make this request, \nthe API consumer must have an access token issued by the bank using the client credentials grant.\n\n??? tip \"Click here to find how to generate an application access token...\"\n    - Generate an application access token using the following command: \n      ```\n      curl -X POST \\\n      https://<IS_HOST>:9446/oauth2/token \\\n      --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n      -d 'grant_type=client_credentials&scope=accounts%20openid&client_assertion=eyJraWQiOiJEd01LZFdNbWo3UFdpbnZvcWZReVhWe\n      nlaNlEiLCJhbGciOiJQUzI1NiJ9.eyJzdWIiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OT\n      Q0Ni9vYXV0aDIvdG9rZW4iLCJpc3MiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiZXhwIjoxNjg0MDk5ODEyLCJpYXQiOjE2ODQwOTk4\n      MTMsImp0aSI6IjE2ODQwOTk4MTIifQ.EMZ2q3jciJ4MmrsH93kH_VGacrt2izbLaCBchGWiyUltdWwj3GwDMKfhpeMHtThd0DszwV8LUPKZaMT3wUS\n      oH3adY2IBC8aa2GKeb_vaQB5b0ZO6WpYQ45y_xIttAVj56d6oPli8wN4MlJoJsFPUlaxQohCLunN43BxSr-kFgeFMj7ynEsVbQvuYuEiTppwTSyXlt\n      Jmv70-nwpGU9UyuPCkXUsU53ShICrY0nC-3NUhY6oNpZclJP4MwG8mP4ZOvUIez_PSoP3AiaNithWhPCfLuKd68OLAReTBGdItqidsWWnn8lPVbM2F\n      LvehukHDCJhf9-ev1pdWIiwDSVDV7uQ&redirect_uri=www.wso2.com'\n      ```\n      - The request payload contains a client assertion in the following format:\n      ```\n      {\n      \"alg\": \"<<The algorithm used for signing>>\",\n      \"kid\": \"<<The KID value of the signing jwk set>>\",\n      \"typ\": \"JWT\"\n      }\n        \n      {\n      \"iss\": \"<<This is the issuer of the token. For example, client ID of your application>>\",\n      \"sub\": \"<<This is the subject identifier of the issuer. For example, client ID of your application>>\",\n      \"exp\": <<This is epoch time of the token expiration date/time>>,\n      \"iat\": <<This is epoch time of the token issuance date/time>>,\n      \"jti\": \"<<This is an incremental unique value>>\",\n      \"aud\": \"<<This is the audience that the ID token is intended for. For example, https://<APIM_HOST>:8243/token>>\"\n      }\n        \n      <signature: For DCR, the client assertion is signed by the private key of the signing certificate. Otherwise the private\n      signature of the application certificate is used.>\n      ```\n      - Upon successful token generation, you obtain a token as follows:\n      ```\n      {\n         \"access_token\":\"aa8ce78b-d81e-3385-81b1-a9fdd1e71daf\",\n         \"scope\":\"accounts payments  openid\",\n         \"id_token\":\"eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5HWXdZbU00WlRBM01XSTJOREF6WkdRek5HTTBaR1JsTmpKa09ERmtaRFJpT1RGa01XRmhNelUyWkdWbE5nX1JTMjU2IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiaHVBcS1GbzB0N2pFZmtiZ1A4TkJwdyIsImF1ZCI6WyJrYkxuSkpfdVFMMlllNjh1YUNSYlBJSk9SNFVhIiwiaHR0cDpcL1wvb3JnLndzbzIuYXBpbWd0XC9nYXRld2F5Il0sInN1YiI6ImFkbWluQHdzbzIuY29tQGNhcmJvbi5zdXBlciIsIm5iZiI6MTYwMTk5MzA5OCwiYXpwIjoia2JMbkpKX3VRTDJZZTY4dWFDUmJQSUpPUjRVYSIsImFtciI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwic2NvcGUiOlsiYW1fYXBwbGljYXRpb25fc2NvcGUiLCJvcGVuaWQiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo4MjQzXC90b2tlbiIsImV4cCI6MTYwMTk5NjY5OCwiaWF0IjoxNjAxOTkzMDk4fQ.cGdQ-9qK5JvKW32lK_PqhyJZyRb3r_86UPRFI2hlgiScnLYD8RsXDBNalmmnHiAbfb06e69QHQnmEKa6pcSSFWor0OAuzisBb6C5V51E9vH0eCr4hIa_lBtmjvLmsSue7puRUaYcyptwiuUkwjLFb-3_cpeuzWH29Knwne6zVD8gav_FPi1ub4vkrkX8ktLZH_JQG20fim1Ai5j2Q7jcnaMIHShYnC9sLBP5usp3thFLdQEyH8KCHJK79yNKzaruUntkq9yqqO_MQvY7VevLlDEDPllniRVih0r4TICdGrgJ0Ibr4wh_xFksVhYqa2_6x71ed_K9SX3hG-6T6pBUVA\",\n         \"token_type\":\"Bearer\",\n         \"expires_in\":3600\n      }\n      ```\n- A sample request to retrieve a consent looks as follows:\n```\ncurl GET \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- A sample response looks as follows:\n```\n{\n    \"Meta\": {\n        \"TotalPages\": 1\n    },\n    \"Risk\": {},\n    \"Links\": {\n        \"Self\": \"https://<IS_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID>\"\n    },\n    \"Data\": {\n        \"Status\": \"Authorised\",\n        \"StatusUpdateDateTime\": \"2020-10-07T12:46Z\",\n        \"CreationDateTime\": \"2020-10-07T09:29Z\",\n        \"TransactionToDateTime\": \"2020-10-09T10:28:49+05:30\",\n        \"ExpirationDateTime\": \"2020-10-11T10:28:49+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"41042513-fa45-4da8-93be-1513b3caffac\",\n        \"TransactionFromDateTime\": \"2020-10-06T10:28:49+05:30\"\n    }\n}\n```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0099_4",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0099_5",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0099_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports retrieving a list of accounts, including balance information, through its Account Information APIs. While it doesn\\'t explicitly define a `/v1/card-accounts` endpoint, it provides a `/accounts` endpoint that returns account details, and a separate `/accounts/{AccountId}/balances` endpoint to retrieve balance information for a specific account.   The system is designed for Open Banking, which typically includes various types of accounts, not just card accounts. \\n\\n## Implementation Details\\n\\nThe core of the Account Information Service Provider (AISP) functionality is defined in the `account-info-swagger.yaml` file.  This OpenAPI specification outlines the available endpoints and their expected request/response structures. \\n\\n### API Endpoints\\n\\n*   **GET `/accounts`**: This endpoint is used to retrieve a list of accounts.  The response for this endpoint is defined by `#/responses/200AccountsRead`, which references the `OBReadAccount5` schema.   The `OBReadAccount5` schema contains an array of `OBAccount4` objects, which represent individual accounts. \\n*   **GET `/accounts/{AccountId}/balances`**: This endpoint retrieves balance information for a specific account identified by `AccountId`.  The response is defined by `#/responses/200AccountsAccountIdBalancesRead`, which uses the `OBReadBalance1` schema.   The `OBReadBalance1` schema includes an array of `Balance` objects, each containing details like `AccountId`, `Amount`, `CreditDebitIndicator`, and `Type`. \\n\\n### Backend Service\\n\\nThe `AccountService.java` in the `demo.backend` module provides a sample implementation for these endpoints. \\n*   The `getAccounts` method at `/accountservice/accounts` returns a hardcoded JSON response containing a list of two accounts. \\n*   The `getAccountBalance` method at `/accountservice/accounts/{AccountId}/balances` returns a hardcoded JSON response with balance information for the specified `AccountId`. \\n\\n### Authentication and Authorization\\n\\nThe API endpoints are secured using OAuth2.  For account retrieval, the `accounts` scope is required.  The `x-auth-type` is specified as \"Application User\", indicating that the user\\'s consent is required. \\n\\n## Configuration Options\\n\\nThe WSO2 Financial Services Accelerator uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class.  This configuration manages various aspects, including consent management and identity server extensions, which are crucial for securing and managing access to account information. \\n\\n## Test Criteria\\n\\nThe integration tests in `fs-integration-test-suite` verify the functionality of account retrieval. \\n*   The `EndToEndAccountFlowTest` class includes tests for initiating an account consent, authorizing it, and then retrieving accounts and balances. \\n*   Specifically, the `Verify Accounts Retrieval Request for a Authorised Consent` test makes a GET request to the `/accounts` endpoint after authorization and asserts a `200` status code. \\n*   The `Verify Accounts balances Retrieval Request for a Authorised Consent` test makes a GET request to the `/accounts/{AccountId}/balances` endpoint and also asserts a `200` status code. \\n*   The `FSAPIMConnectorTest` class provides utility methods like `doDefaultAccountRetrieval()` which performs the GET request to the `accountsPath`.  The `accountsPath` is dynamically set in the test classes to point to either `/aisp/accounts` or `/aisp/accounts/{AccountId}/balances`.  \\n\\n## Documentation References\\n\\nThe `Overview` wiki page for `wso2/financial-services-accelerator` provides a high-level overview of the system, including its support for Account Information APIs.  It explicitly mentions \"Account Information APIs\" with categories like \"Accounts\" and \"Balances\". \\n\\n## Notes\\n\\nThe prompt specifically asks for `/v1/card-accounts`. The provided codebase uses `/open-banking/{version}/aisp/accounts` as the base path for account-related APIs.  While the system supports retrieving a list of accounts and their balances, it does not explicitly differentiate between \"card accounts\" and other types of accounts in the endpoint path. The `AccountType` and `AccountSubType` fields within the account data might be used to identify card accounts if such a distinction is needed.  The versioning in the API path is `{version}`, which is specified as `v3.1` in the swagger definition. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_485d62cb-1282-47b8-ad6f-3753fe6c6077\\n', 'id': 'lc_108b7906-3beb-4a72-95e4-d2c26049ff41'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0100",
      "requirement": {
        "requirement_id": "ATOM_211",
        "requirement_text": "For messages without a body, the Digest header must contain the hash of an empty byte list",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0100_1",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0100_2",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the automatic generation of a `Digest` header containing the hash of an empty byte list for messages without a body. The provided code snippets primarily focus on OAuth2/OpenID Connect functionalities, DPoP proof generation, and general REST client operations, none of which explicitly implement or configure this specific `Digest` header behavior.\\n\\n### Implementation Details   \\nThe codebase contains several instances of hash generation, but none are directly related to the `Digest` header for empty message bodies.\\nFor example, the `DPoPProofGenerator.java` file includes a `generateAccessTokenHash` method that uses SHA-256 to hash an access token . This is used in the context of DPoP (Demonstrating Proof of Possession) to bind an access token to a DPoP proof .\\nAnother example is in `OAuth2PKCETestCase.java`, where `getPKCECodeChallenge` generates a SHA-256 hash for PKCE code challenge .\\nSimilarly, `MockOIDCIdentityProvider.java` uses SHA-256 to generate a key ID from a private key .\\nThese hashing mechanisms are for specific security protocols (DPoP, PKCE, JWT signing) and not for general HTTP message body digests.\\n\\n### Configuration Options \\nWhile there is a `DigestAlgorithm` property in `saml-idp.xml` , this is specific to SAML configurations and refers to the algorithm used for signing SAML assertions, not for HTTP `Digest` headers. There are no apparent configuration options within the provided context that would enable or disable the automatic generation of a `Digest` header for empty message bodies.\\n\\n### API Endpoints or Features  \\nThe `SCIM2RestClient.java` and `RESTTestBase.java` files demonstrate how HTTP headers are constructed for various API calls, including `Authorization` and `Content-Type` headers  . However, there is no code that suggests the automatic inclusion or validation of a `Digest` header for requests without a message body. If such a feature were to be implemented, it would likely involve modifying these client-side header generation methods or introducing a new interceptor/filter to handle this logic.\\n\\n### Documentation References \\nThe \"OAuth2 and OpenID Connect\" wiki page provides a comprehensive overview of the OAuth2 and OIDC implementation . It details supported grant types, token management, and standards compliance, including DPoP tokens . While DPoP involves hashing, it is distinct from the general HTTP `Digest` header requirement for empty bodies. The documentation does not mention any feature or requirement related to the `Digest` header for messages without a body.\\n\\n## Notes\\nThe user\\'s query specifically asks about the `Digest` header for messages without a body, which is a general HTTP security mechanism often used for message integrity. The provided codebase snippets, while containing hashing functions and HTTP client implementations, do not show any direct support for this particular requirement. The hashing functions found are tied to specific security protocols like DPoP, PKCE, and JWT signing, which are different from the generic `Digest` header.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-f_2a1b7432-abcd-4127-aa60-88dfc26b1ba6\\n', 'id': 'lc_7ce4685d-401b-490d-85f3-e0cc4385110e'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0100_3",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to have some support for Digest Authentication, but it does not explicitly confirm or implement the specific requirement of including a Digest header with the hash of an empty byte list for messages without a body.  \\n\\n## Implementation Details\\n\\nThe `wso2/product-apim` repository includes a `DigestAuth_API` defined in Synapse configurations, which handles Digest Authorization headers.  This API checks for the presence of the `Authorization` header.  If the header is present, it sends a 200 OK response; otherwise, it sends a 401 Unauthorized response with a `WWW-Authenticate` header.  \\n\\nA `DigestAuthenticationTestCase` exists to test the functionality of an API configured with Digest Authentication.  This test case sets up an API with `digestAuth` as the endpoint authentication type.  It then invokes the API with an `Authorization` header containing a Bearer token. \\n\\nThe `api_product_template.xml` includes a `<class name=\"org.wso2.carbon.apimgt.gateway.mediators.DigestAuthMediator\"/>` which suggests a mediator for handling Digest Authentication.  However, the provided snippets do not detail the internal logic of this mediator or how it specifically handles Digest headers for messages without a body. \\n\\nThe `NO_ENTITY_BODY` property is used in Synapse configurations to indicate that a message does not have an entity body.   This property is removed when a response is generated for a request without an entity body.  While this property acknowledges the concept of messages without bodies, there\\'s no explicit link shown in the provided context to how this interacts with the Digest header generation for an empty byte list. \\n\\n## Configuration Options\\n\\nThe `DigestAuth_API` configuration in Synapse XML files defines resources that accept various HTTP methods, including `GET`, `DELETE`, and `HEAD`, which typically do not have message bodies.  The `WWW-Authenticate` header in the 401 Unauthorized response specifies `Digest realm=\\'digestAuth\\', qop=\\'auth\\', nonce=\\'...\\'`.  This indicates that the system is configured to challenge clients for Digest authentication. \\n\\nThe `APICreationRequestBean` in `DigestAuthenticationTestCase` allows setting the endpoint authentication type to `digestAuth` and providing a username and password for the endpoint.  This suggests that Digest authentication can be configured at the API level. \\n\\n## API Endpoints or Features\\n\\nThe `DigestAuth_API` is exposed at the context `/digestAuth` and handles requests to `/*`.  This API is designed to test Digest authentication. \\n\\nThe `cache` mediator, described in `api-control-plane/docs/xdoc/mediators/cache.xml`, uses a `hashGenerator` which defaults to `org.wso2.caching.digest.DOMHashGenerator` to evaluate the hash value of incoming messages.  While this mentions \"digest\" and \"hash generation,\" it is related to caching mechanisms and not directly to the HTTP Digest header for authentication purposes. \\n\\n## Documentation References\\n\\nThe documentation for the `cache` mediator mentions `org.wso2.caching.digest.DigestGenerator` interface and `org.wso2.caching.digest.DOMHashGenerator` as the default hash generator.  This is a general hashing mechanism within the WSO2 ESB context, used for caching, and not specifically for HTTP Digest authentication headers. \\n\\nThe `properties_guide.xml` documents the `NO_ENTITY_BODY` property, explaining its use for requests without an entity body.  This indicates awareness of messages without bodies, but it does not specify how Digest headers are handled in such cases. \\n\\nBased on the provided code snippets, there is no explicit evidence that the repository enforces or verifies the specific requirement that \"For messages without a body, the Digest header must contain the hash of an empty byte list.\" The existing Digest authentication mechanisms focus on the presence and validation of the `Authorization` header, but not on the content of the Digest header for empty bodies. \\n\\n## Notes\\n\\nThe provided snippets indicate that Digest Authentication is supported and tested in the `wso2/product-apim` repository.  However, the specific requirement regarding the Digest header containing the hash of an empty byte list for messages without a body is not explicitly addressed in the provided context. The `NO_ENTITY_BODY` property is related to handling requests without a body, but its interaction with Digest header generation is not detailed.  The `DigestAuthMediator` is mentioned, but its implementation details regarding this specific requirement are not available in the given snippets. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-f_0fa0a4e4-24b6-4268-8b0d-de2bdac4f2fb\\n', 'id': 'lc_f6260535-832b-4b25-8825-3674d96f0acc'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0101",
      "requirement": {
        "requirement_id": "ATOM_124",
        "requirement_text": "The ASPSP SHALL check if the payment-product matches the payment initiation addressed by paymentId",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0101_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_2",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_4",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_5",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0101_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, the WSO2 Financial Services Accelerator, supports the validation of payment initiation requests, including checks related to the `paymentId` and the overall payment initiation payload. The system uses an external service integration framework to allow for custom validation logic.  \\n\\n## Implementation Details\\n\\nThe `DefaultConsentManageValidator.java` class contains the `validatePaymentRequestPayload` method, which is responsible for validating payment initiation requests.  This method performs several checks, including validating the `Data` object and the `Initiation` object within the request body. \\n\\nSpecifically, the `validatePaymentInitiationPayload` method is called to validate the `Initiation` object, which includes checks for `DebtorAccount`, `CreditorAccount`, `LocalInstrument`, and `InstructedAmount`.  If any of these validations fail, a `ConsentPayloadValidationResult` indicating an invalid request is returned.  \\n\\nThe `PaymentService.java` in the demo backend handles payment submissions and retrieval.  When a payment is submitted via the `/payments` endpoint, the `paymentSubmission` method processes the request and caches the payment response.  The `paymentId` is then used to retrieve payment details via the `/payments/{paymentId}` endpoint. \\n\\nThe system also leverages an \"External Service Integration\" framework, which allows for custom validation logic to be invoked at various extension points, including `VALIDATE_CONSENT_ACCESS`.  This framework can be used to implement checks for mismatched `payment-product` and `paymentId` combinations. \\n\\n## Configuration Options\\n\\nThe \"External Service Integration\" framework is configured through the `FinancialServicesConfigParser`.  This allows enabling or disabling external service calls, specifying the base URL for external services, and configuring retry attempts and timeouts. \\n\\n## API Endpoints or Features\\n\\nThe Payment Initiation API defines several endpoints related to payments:\\n*   `/payment-consents`: Used to create payment consents. \\n*   `/payment-consents/{consentId}`: Used to retrieve payment consents by `consentId`. \\n*   `/payment-consents/{consentId}/funds-confirmation`: Used to get funds confirmation for a given `consentId`. \\n*   `/payments`: Used to create payments. \\n*   `/payments/{paymentId}`: Used to retrieve payments by `paymentId`. \\n\\nThe `paymentId` and `consentId` are defined as path parameters of type string.  \\n\\n## Documentation References\\n\\nThe \"Overview\" wiki page provides a high-level understanding of the WSO2 Financial Services Accelerator, including its modular architecture and core components.  It also details the API specifications, including those for Payment Initiation APIs. \\n\\nThe \"External Service Integration\" wiki page describes the framework for extending functionality through external services, including the various extension points and how to configure them.  This framework is crucial for implementing custom validation logic, such as checking for mismatched `payment-product` and `paymentId` combinations. \\n\\n## Notes\\n\\nThe provided code snippets indicate that the system has mechanisms for validating payment requests and retrieving payment information using `paymentId`.   While there isn\\'t an explicit code snippet showing a direct check for \"payment-product matches payment initiation addressed by paymentId\", the \"External Service Integration\" framework allows for such custom validation to be implemented.  The `DefaultConsentManageValidator` performs general validation of the payment initiation payload, and an external service could be configured to perform more specific checks.  The `ErrorConstants.java` file contains various error messages, including those related to missing or mismatched parameters, which could be used for rejecting invalid combinations. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [External Service Integration (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#5)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c84cd8ab-5642-4de3-b0e7-2b7d0fde03cd\\n', 'id': 'lc_2fb3f8d0-5cdb-4302-ac45-3fc05d574397'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0102",
      "requirement": {
        "requirement_id": "ATOM_063",
        "requirement_text": "The system shall provide optional fundsAvailable boolean data element with transaction status codes ACTC, ACWC, and ACCP to indicate funds check results",
        "strength": "SHALL",
        "capability": "Funds Confirmation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0102_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository does not appear to support the `fundsAvailable` boolean data element with transaction status codes ACTC, ACWC, and ACCP. The snippets primarily deal with SCIM2 schema validation and claim management within the WSO2 Identity Server, which are unrelated to financial transaction status or funds availability.\\n\\nThere are no implementation details, configuration options, API endpoints, or documentation references within the provided context that relate to a `fundsAvailable` field or the specified transaction status codes <cite/>. The code snippets focus on user schema validation, including boolean elements like `emailVerified` , and claim management operations  . The `scim2.yaml` file defines error schemas for SCIM operations , but again, this is not related to financial transactions.\\n\\n## Notes\\nThe provided code snippets are from the `wso2/product-is` repository and primarily concern SCIM2 (System for Cross-domain Identity Management) schema validation and claim management. These functionalities are related to identity and access management, not financial transaction processing or funds availability. Therefore, the requested `fundsAvailable` boolean data element and transaction status codes are not found within this context.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_cd0cee36-47a1-46e6-aa20-4496e5fca155\\n', 'id': 'lc_e85c1068-20f0-45b8-aa7a-1b2790f622e3'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0102_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, the repository `wso2/product-apim` does not appear to directly support an optional `fundsAvailable` boolean data element with transaction status codes ACTC, ACWC, and ACCP to indicate funds check results. The code primarily deals with API management, lifecycle, and sample services, none of which explicitly implement or reference such a feature.\\n\\n### Implementation Details <cite/>\\nThe `StarbucksOutletServiceImpl.java` file contains a `doPayment` method that checks for \"Insufficient Funds\" . However, this is a simple string message within a sample service and does not correspond to a standardized `fundsAvailable` boolean or specific transaction status codes like ACTC, ACWC, or ACCP . The `doPayment` method returns a `PaymentStatus` object, which includes a status message and the registered payment details, but no `fundsAvailable` boolean .\\n\\n### Configuration Options <cite/>\\nThere are no explicit configuration options visible in the provided snippets that would enable or disable a `fundsAvailable` boolean or define custom transaction status codes <cite/>. The `publisher-api.yaml` file defines API scopes and paths , but it does not contain any configuration related to funds availability checks.\\n\\n### API Endpoints or Features <cite/>\\nThe `StarbucksOutletServiceImpl.java` file exposes a `doPayment` endpoint , which performs a basic check for \"Insufficient Funds\" . However, this is part of a sample JAX-RS application  and does not provide the requested `fundsAvailable` boolean or specific transaction status codes in its response . Other API definitions, such as those in `publisher-api.yaml` , do not show any features related to funds availability checks.\\n\\n### Documentation References <cite/>\\nNo documentation references within the provided snippets describe the implementation of an optional `fundsAvailable` boolean data element with transaction status codes ACTC, ACWC, and ACCP <cite/>.\\n\\n## Notes\\nThe provided code snippets are primarily from a sample JAX-RS application (`StarbucksOutletServiceImpl.java`)  and API management related files. While `StarbucksOutletServiceImpl.java` does include a basic check for \"Insufficient Funds\" , it is a simplified example and does not align with the specific requirement of a `fundsAvailable` boolean with ACTC, ACWC, and ACCP status codes. The other files, such as `APIManagerLifecycleBaseTest.java`  and `Application.java` , deal with API lifecycle and application status, respectively, and are not relevant to funds availability.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_568bbc4e-41fd-475f-9e23-5fc7beb4583b\\n', 'id': 'lc_f84afa40-3434-444a-88c2-7e7f438253d8'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0103",
      "requirement": {
        "requirement_id": "ATOM_181",
        "requirement_text": "The API MUST support a GET endpoint at /v1/card-accounts/{account-id} to read details about a specific card account.",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0103_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0103_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0103_3",
          "text": "### Retrieve a consent \n- An API consumer can retrieve a consent resource that they have created to check its status. In order to make this request, \nthe API consumer must have an access token issued by the bank using the client credentials grant.\n\n??? tip \"Click here to find how to generate an application access token...\"\n    - Generate an application access token using the following command: \n      ```\n      curl -X POST \\\n      https://<IS_HOST>:9446/oauth2/token \\\n      --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n      -d 'grant_type=client_credentials&scope=accounts%20openid&client_assertion=eyJraWQiOiJEd01LZFdNbWo3UFdpbnZvcWZReVhWe\n      nlaNlEiLCJhbGciOiJQUzI1NiJ9.eyJzdWIiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OT\n      Q0Ni9vYXV0aDIvdG9rZW4iLCJpc3MiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiZXhwIjoxNjg0MDk5ODEyLCJpYXQiOjE2ODQwOTk4\n      MTMsImp0aSI6IjE2ODQwOTk4MTIifQ.EMZ2q3jciJ4MmrsH93kH_VGacrt2izbLaCBchGWiyUltdWwj3GwDMKfhpeMHtThd0DszwV8LUPKZaMT3wUS\n      oH3adY2IBC8aa2GKeb_vaQB5b0ZO6WpYQ45y_xIttAVj56d6oPli8wN4MlJoJsFPUlaxQohCLunN43BxSr-kFgeFMj7ynEsVbQvuYuEiTppwTSyXlt\n      Jmv70-nwpGU9UyuPCkXUsU53ShICrY0nC-3NUhY6oNpZclJP4MwG8mP4ZOvUIez_PSoP3AiaNithWhPCfLuKd68OLAReTBGdItqidsWWnn8lPVbM2F\n      LvehukHDCJhf9-ev1pdWIiwDSVDV7uQ&redirect_uri=www.wso2.com'\n      ```\n      - The request payload contains a client assertion in the following format:\n      ```\n      {\n      \"alg\": \"<<The algorithm used for signing>>\",\n      \"kid\": \"<<The KID value of the signing jwk set>>\",\n      \"typ\": \"JWT\"\n      }\n        \n      {\n      \"iss\": \"<<This is the issuer of the token. For example, client ID of your application>>\",\n      \"sub\": \"<<This is the subject identifier of the issuer. For example, client ID of your application>>\",\n      \"exp\": <<This is epoch time of the token expiration date/time>>,\n      \"iat\": <<This is epoch time of the token issuance date/time>>,\n      \"jti\": \"<<This is an incremental unique value>>\",\n      \"aud\": \"<<This is the audience that the ID token is intended for. For example, https://<APIM_HOST>:8243/token>>\"\n      }\n        \n      <signature: For DCR, the client assertion is signed by the private key of the signing certificate. Otherwise the private\n      signature of the application certificate is used.>\n      ```\n      - Upon successful token generation, you obtain a token as follows:\n      ```\n      {\n         \"access_token\":\"aa8ce78b-d81e-3385-81b1-a9fdd1e71daf\",\n         \"scope\":\"accounts payments  openid\",\n         \"id_token\":\"eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5HWXdZbU00WlRBM01XSTJOREF6WkdRek5HTTBaR1JsTmpKa09ERmtaRFJpT1RGa01XRmhNelUyWkdWbE5nX1JTMjU2IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiaHVBcS1GbzB0N2pFZmtiZ1A4TkJwdyIsImF1ZCI6WyJrYkxuSkpfdVFMMlllNjh1YUNSYlBJSk9SNFVhIiwiaHR0cDpcL1wvb3JnLndzbzIuYXBpbWd0XC9nYXRld2F5Il0sInN1YiI6ImFkbWluQHdzbzIuY29tQGNhcmJvbi5zdXBlciIsIm5iZiI6MTYwMTk5MzA5OCwiYXpwIjoia2JMbkpKX3VRTDJZZTY4dWFDUmJQSUpPUjRVYSIsImFtciI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwic2NvcGUiOlsiYW1fYXBwbGljYXRpb25fc2NvcGUiLCJvcGVuaWQiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo4MjQzXC90b2tlbiIsImV4cCI6MTYwMTk5NjY5OCwiaWF0IjoxNjAxOTkzMDk4fQ.cGdQ-9qK5JvKW32lK_PqhyJZyRb3r_86UPRFI2hlgiScnLYD8RsXDBNalmmnHiAbfb06e69QHQnmEKa6pcSSFWor0OAuzisBb6C5V51E9vH0eCr4hIa_lBtmjvLmsSue7puRUaYcyptwiuUkwjLFb-3_cpeuzWH29Knwne6zVD8gav_FPi1ub4vkrkX8ktLZH_JQG20fim1Ai5j2Q7jcnaMIHShYnC9sLBP5usp3thFLdQEyH8KCHJK79yNKzaruUntkq9yqqO_MQvY7VevLlDEDPllniRVih0r4TICdGrgJ0Ibr4wh_xFksVhYqa2_6x71ed_K9SX3hG-6T6pBUVA\",\n         \"token_type\":\"Bearer\",\n         \"expires_in\":3600\n      }\n      ```\n- A sample request to retrieve a consent looks as follows:\n```\ncurl GET \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- A sample response looks as follows:\n```\n{\n    \"Meta\": {\n        \"TotalPages\": 1\n    },\n    \"Risk\": {},\n    \"Links\": {\n        \"Self\": \"https://<IS_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID>\"\n    },\n    \"Data\": {\n        \"Status\": \"Authorised\",\n        \"StatusUpdateDateTime\": \"2020-10-07T12:46Z\",\n        \"CreationDateTime\": \"2020-10-07T09:29Z\",\n        \"TransactionToDateTime\": \"2020-10-09T10:28:49+05:30\",\n        \"ExpirationDateTime\": \"2020-10-11T10:28:49+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"41042513-fa45-4da8-93be-1513b3caffac\",\n        \"TransactionFromDateTime\": \"2020-10-06T10:28:49+05:30\"\n    }\n}\n```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0103_4",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0103_5",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0103_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports a GET endpoint to read details about a specific card account, although the path is `/open-banking/{version}/aisp/accounts/{AccountId}` rather than `/v1/card-accounts/{account-id}`.  \\n\\n### Implementation Details\\nThe API is defined in the `account-info-swagger.yaml` file <cite repo=\"wso2/financial-services-accelerator\" path=\"financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml\" start=\"1-60\" end=\"1-60\" />. The specific endpoint for retrieving a single account by ID is `/accounts/{AccountId}` with a GET method . This endpoint is tagged under \"Accounts\"  and has an `operationId` of `GetAccountsAccountId` . It requires an `AccountId` as a path parameter  .\\n\\nThe backend service that handles this request is `AccountService.java` . Specifically, the `getOneAccount` method within this class is responsible for processing GET requests to `/accountservice/accounts/{AccountId}` . This method takes `AccountId` as a path parameter and returns a JSON response containing details for the specified account . The `cxf-servlet.xml` file maps the `/accounts` address to the `AccountService` bean  .\\n\\n### Configuration Options\\nThe API definition specifies that the endpoint consumes and produces `application/json; charset=utf-8` . Security is handled via OAuth2, requiring the `accounts` scope . The `x-auth-type` is \"Application User\" and `x-throttling-tier` is \"Unlimited\" .\\n\\n### API Endpoints or Features\\nThe relevant API endpoint is `/open-banking/{version}/aisp/accounts/{AccountId}`  . This endpoint allows retrieval of detailed information for a single account identified by `AccountId` . It returns a `200` HTTP status code on success, with the response schema defined by `#/responses/200AccountsAccountIdRead` . Error responses for various HTTP status codes (400, 401, 403, 404, 405, 406, 429, 500) are also defined .\\n\\n### Documentation References\\nThe API specification is documented in the `account-info-swagger.yaml` file <cite repo=\"wso2/financial-services-accelerator\" path=\"financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml\" start=\"1-60\" end=\"1-60\" />. The `Overview` wiki page also mentions \"Account Information APIs\" which include \"Accounts\" for account retrieval .\\n\\n### Test Criteria\\nThe `EndToEndAccountFlowTest.groovy` file contains a test case named `\"Verify Retrieving a Specific Account for a Authorised Consent\"` . This test verifies that a GET request to the specific account endpoint returns a `200` status code after a consent has been authorized . Another test, `\"OBA-794_Account retrieval request with valid consent id\"`, also confirms that a `200` status code is returned for account retrieval with a valid consent ID .\\n\\n## Notes\\nThe user\\'s requested endpoint path `/v1/card-accounts/{account-id}` does not directly match the implemented path `/open-banking/{version}/aisp/accounts/{AccountId}`  . However, the functionality to retrieve details for a specific account by ID is present. The `AccountService` in the demo backend uses `/accountservice/accounts/{AccountId}` , which is likely an internal mapping that gets exposed through the API Gateway with the Open Banking path. The term \"card-accounts\" is not explicitly used in the provided snippets; instead, the general term \"accounts\" is used.   \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Core Components (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ff3904b3-775c-4cb0-9e7c-ef7de9c605f3\\n', 'id': 'lc_4e52caa7-9537-4b19-82c8-77ee18e73853'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0104",
      "requirement": {
        "requirement_id": "ATOM_003",
        "requirement_text": "TPP certificate must be compliant with EBA-RTS requirements and indicate all roles the TPP is authorised to use",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "eef9ab97432c - 4.2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0104_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, appears to have some support for certificate validation, including the ability to check for invalid certificate content. However, the provided context does not offer specific implementation details, configuration options, or API endpoints directly related to EBA-RTS compliance or the extraction and validation of TPP roles from certificates.\\n\\n### Implementation Details\\n\\nThe codebase includes a test case, `PreUpdatePasswordActionFailureTest.java` , that specifically tests for invalid certificate content. This test method, `testCreateActionWithInvalidPasswordSharingCertificate` , attempts to create an action with an invalid certificate and asserts that a `HTTP.SC_BAD_REQUEST` status code is returned with the description \"Certificate content is invalid.\" . This suggests that there is a mechanism within the system to validate the format or basic integrity of a provided certificate.\\n\\nAdditionally, the `identity-default.xml`  and `identity-ssoservice-entityid-changed.xml`  configuration files show a `<TokenValidationPolicy>CertValidate</TokenValidationPolicy>`  setting, indicating that certificate validation is a configurable aspect of token validation.\\n\\n### Configuration Options\\n\\nThe `identity-default.xml`  and `identity-ssoservice-entityid-changed.xml`  files define security configurations related to trusted RP stores and keystores. Specifically, `<UserTrustedRPStore>`  is configured with a location, type (PKCS12), password, and key password. This suggests that the system can be configured to trust certificates from a specific store. However, there are no explicit configuration options provided in the snippets that directly address EBA-RTS compliance or the definition of TPP roles within the certificate validation process.\\n\\n### API Endpoints or Features\\n\\nThe `PreUpdatePasswordActionFailureTest.java`  test interacts with an API endpoint `ACTION_MANAGEMENT_API_BASE_PATH + PRE_UPDATE_PASSWORD_PATH`  for creating actions. Within this API, a `passwordSharing`  object can include a `certificate`  field. This indicates that certificates can be submitted via this API. However, the provided context does not detail any specific API features for EBA-RTS compliance or TPP role validation.\\n\\n### Documentation References\\n\\nThe provided context does not include any direct documentation references that specifically address EBA-RTS requirements or TPP certificate validation. The wiki page \"Architecture\"  provides a high-level overview of the WSO2 Identity Server architecture but does not delve into specific regulatory compliance details.\\n\\n## Notes\\n\\nThe term \"TPP\" (Third Party Provider) and \"EBA-RTS\" (European Banking Authority - Regulatory Technical Standards) are not explicitly mentioned in the provided code snippets or the architecture documentation. While the system has general certificate validation capabilities, there is no direct evidence in the given context to confirm its compliance with EBA-RTS requirements or its ability to specifically extract and validate TPP roles from certificates. Further investigation into the `org.wso2.carbon.extension.identity.authenticator.x509Certificate.connector`  module or related components might reveal more specific functionalities.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_45d08bdc-072c-4bd4-8cb8-326db9a571c7\\n', 'id': 'lc_33611aac-d1d0-487e-a21f-d64e8581ebfd'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0104_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"This repository, `wso2/product-apim`, appears to provide API endpoints for managing client and endpoint certificates, but it does not contain explicit implementation details, configuration options, or documentation references directly related to EBA-RTS compliance or TPP (Third Party Provider) roles within certificates.  The provided code snippets primarily show API client classes for certificate operations. \\n\\n### Implementation Details and API Endpoints\\nThe `ClientCertificatesApi.java` file defines API operations for managing client certificates.  These operations include:\\n*   `deleteAPIClientCertificateByKeyTypeAndAlias`: Deletes a client certificate by key type and alias. \\n*   `getAPIClientCertificateByAlias`: Retrieves information about a client certificate using its alias. \\n*   `getAPIClientCertificateByKeyTypeAndAlias`: Retrieves information about a client certificate by key type and alias. \\n*   `getAPIClientCertificateContentByAlias`: Downloads a client certificate by alias. \\n*   `getAPIClientCertificateContentByKeyTypeAndAlias`: Downloads a client certificate by key type and alias. \\n*   `updateAPIClientCertificateByAlias`: Updates an uploaded client certificate. \\n*   `updateAPIClientCertificateByKeyTypeAndAlias`: Updates an uploaded client certificate of a given key type. \\n\\nSimilarly, `EndpointCertificatesApi.java` provides operations for endpoint certificates, such as `getEndpointCertificateContentByAlias` for downloading a certificate and `updateEndpointCertificateByAlias` for updating one. \\n\\nThese APIs allow for the management of certificates, but they do not inherently provide mechanisms to verify EBA-RTS compliance or extract TPP roles from certificate content.  The `certificate` parameter in the update operations is of type `File`, suggesting that the certificate content is uploaded as a file, but there's no indication of internal parsing or validation against EBA-RTS requirements. \\n\\n### Configuration Options and Documentation References\\nThe provided snippets do not reveal any specific configuration options or documentation references related to EBA-RTS compliance or TPP roles. <cite /> The `automationXMLSchema.xsd` file defines XML schema for automation tests, including `truststore` configurations, but this is for system-wide trust stores and not directly related to TPP certificate content validation. \\n\\n### Test Criteria\\nThe `APIComplianceTestCase.java` file indicates the presence of API governance tests, including `APIMGovernancePolicyDTO` and `PolicyAdherenceWithRulesetsDTO`.  While this suggests a framework for API compliance, the specific details of EBA-RTS compliance and TPP role validation are not present in the provided snippet. \\n\\n## Notes\\nThe provided code snippets are primarily API client definitions for managing certificates.  They do not contain direct evidence of EBA-RTS compliance checks or TPP role extraction from certificates. <cite /> The `APIComplianceTestCase.java` file hints at a governance framework, but without further context, it's impossible to confirm if it covers the specific requirements mentioned in the query.  The `JWTGrantTestCase.java` and `AwsLambdaIndividualApi.java` files are not relevant to certificate content validation. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_eeced92f-2ab6-410b-a093-b67607d81f9f\\n\", 'id': 'lc_d73b6783-b325-4aad-9b65-f320c85d4f71'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0105",
      "requirement": {
        "requirement_id": "ATOM_105",
        "requirement_text": "ASPSPs MUST return transaction status PATC for multilevel SCA when payment is partially authorized",
        "strength": "MUST",
        "capability": "Payment Initiation",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0105_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_2",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_3",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_4",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_5",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0105_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly support returning the transaction status `PATC` (Partially Authorised Transaction Completed) for multilevel SCA when a payment is partially authorized. The `payment-initiation-openapi.yaml` defines a `Status` enum for payment responses, but `PATC` is not among the listed values .\\n\\n### Implementation Details\\n\\nThe `financial-services-accelerator` repository uses OpenAPI specifications to define its APIs. The `obWritePaymentResponse5` schema, which dictates the structure of a payment status response, includes a `Status` field . The allowed values for this `Status` field are defined as an enum :\\n*   `AcceptedCreditSettlementCompleted`\\n*   `AcceptedSettlementCompleted`\\n*   `AcceptedSettlementInProcess`\\n*   `AcceptedWithoutPosting`\\n*   `Pending`\\n*   `Rejected`\\n\\nThe `PATC` status is not present in this enumeration .\\n\\nThe `PaymentService.java` in the demo backend sets the payment status to `AcceptedSettlementCompleted` by default . This service is responsible for handling payment submissions and generating responses .\\n\\nFor multi-level authorization, the `obWritePaymentResponse5` schema includes a `MultiAuthorisation` object with its own `Status` enum . The possible values for this multi-authorization status are:\\n*   `Authorised`\\n*   `AwaitingFurtherAuthorisation`\\n*   `Rejected`\\n\\nAgain, `PATC` is not an option here .\\n\\n### Configuration Options\\n\\nThe `financial-services-accelerator` uses `financial-services.xml` for configuration, parsed by `FinancialServicesConfigParser` . Deployment configurations are also found in `wso2is-7.0.0-deployment.toml` and `wso2is-7.1.0-deployment.toml`  . However, there are no explicit configuration options within these files that allow for the definition or modification of payment transaction statuses to include `PATC`  .\\n\\nThe system does support extensions through `ServiceExtensionTypeEnum` and `ServiceExtensionUtils` . It might be possible to implement custom logic to handle and return a `PATC` status through these extension points, specifically `enrich_consent_creation_response` or `map_accelerator_error_response` . However, this would require custom development and is not a natively supported feature.\\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoint for payment submission is `/payments` which accepts `POST` requests . The response to this endpoint, as defined by `obWritePaymentResponse5`, does not include `PATC` as a possible status .\\n\\nThe `FSKeyManagerImpl.java` handles OAuth application management and updates . It also has extension points like `PRE_PROCESS_APPLICATION_UPDATE` . While these extensions allow for customization of application-related processes, they do not directly influence the payment transaction status returned by the ASPSP.\\n\\n### Documentation References\\n\\nThe \"Overview\" wiki page describes the WSO2 Financial Services Accelerator as a solution for Open Banking capabilities, including payment initiation . It mentions that the solution supports multiple financial service use cases including account information services, payment initiation, and confirmation of funds . However, there is no specific documentation within the provided context that details the handling of `PATC` status for partially authorized payments or multilevel SCA. The API specifications for payments are defined in `payment-initiation-openapi.yaml` .\\n\\n## Notes\\n\\nThe provided codebase does not explicitly define or use the `PATC` transaction status. The `Status` enum in `obWritePaymentResponse5` and the `MultiAuthorisation` status enum do not include `PATC`  . To support this requirement, modifications to the OpenAPI specification and the backend payment processing logic would be necessary. The existing extension framework might allow for custom implementation, but it\\'s not an out-of-the-box feature.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_94310704-ea6a-48aa-82c4-b41b14a60b81\\n', 'id': 'lc_51a94b42-d190-4979-95ca-40a3ef3da5d7'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0106",
      "requirement": {
        "requirement_id": "ATOM_213",
        "requirement_text": "The keyId field in the Signature header must contain the serial number of the TPP's certificate formatted as keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\"",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0106_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the use of certificate serial numbers and CA distinguished names in the `keyId` field of a `Signature` header, particularly within the context of Financial-grade API (FAPI) conformance testing and DPoP (Demonstrating Proof of Possession) token handling. The system processes and validates certificate information, including thumbprints and X.509 certificate chains, which are relevant for constructing such `keyId` formats.\\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository includes code that handles X.509 certificates and their properties, such as thumbprints. For instance, the `Oauth2JWKSEndpointTestCase.java` file demonstrates how the system retrieves and validates public key sets from JWKS endpoints, including the `x5c` (X.509 certificate chain) and `x5t#S256` (X.509 certificate SHA-256 thumbprint) fields . The `getX509CertSHA256Thumbprint` method in this file specifically calculates the SHA-256 thumbprint from a given X.509 certificate string . This functionality is crucial for verifying certificate-bound tokens.\\n\\nAnother relevant implementation detail is found in `DPoPProofGenerator.java`, which includes a method `getThumbprintOfKeyFromDpopProof` that extracts the key thumbprint from a DPoP proof (a Signed JWT) . This method parses the JWT header to obtain the JWK (JSON Web Key) and then computes its thumbprint . This indicates the system\\'s capability to work with key identifiers derived from certificates or keys embedded within JWTs.\\n\\nThe `ClientSignKeyDataHolder.java` file, although related to SAML, provides a general mechanism for loading private keys and certificate chains from a keystore . It extracts the `X509Certificate` from the chain  and makes it available via `getEntityCertificate()` . This demonstrates the underlying capability to access certificate details.\\n\\n### Configuration Options\\n\\nWhile direct configuration options for the exact `keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\"` format are not explicitly detailed in the provided snippets, the presence of FAPI conformance tests suggests that the system is designed to handle such specific requirements. The `oidc-fapi-conformance-tests` directory contains `client_configs.py`  and `serverjwks.py`  and `serverjwks2.py`  files, which define JWKS with `x5c` and `x5t#S256` fields. These files are used in testing scenarios to ensure compliance with FAPI specifications, which often involve strict certificate and key identifier requirements. The `x5c` field, for example, contains the X.509 certificate chain, from which the serial number and issuer (CA) distinguished name can be extracted.\\n\\n### API Endpoints or Features\\n\\nThe `OAuth2 and OpenID Connect` wiki page mentions \"Certificate\" as a binding type for token management . This implies that the system supports mechanisms to bind tokens to client certificates, which would necessitate the processing and validation of certificate details, including their serial numbers and issuer information.\\n\\nThe `JWKS Endpoint` is also a key feature, providing public keys used to verify signatures of ID tokens . The `Oauth2JWKSEndpointTestCase.java` confirms the existence of `/oauth2/jwks` endpoints for both super tenant and tenant contexts . These endpoints expose JWKS that can include `x5c` and `x5t#S256` fields, which are derived from certificates.\\n\\n### Documentation References\\n\\nThe `OAuth2 and OpenID Connect` wiki page provides a high-level overview of the OAuth2 and OpenID Connect implementation, including token management and standards compliance, specifically mentioning FAPI conformance . While it doesn\\'t directly specify the `keyId` format, the emphasis on FAPI conformance strongly suggests support for such detailed certificate-based key identifiers, as FAPI profiles often mandate these.\\n\\n### Test Criteria\\n\\nThe presence of FAPI conformance tests, as indicated by the `oidc-fapi-conformance-tests` directory and the `FAPI Conformance` section in the wiki , suggests that the system is tested against requirements that would include specific `keyId` formats. The `resource-server.py` script within these tests demonstrates how a resource server might validate client certificates by extracting a thumbprint from the `X-Ssl-Cert` header and comparing it with a thumbprint from an access token . This implies that the system has the capability to process and compare certificate-derived identifiers.\\n\\n## Notes\\n\\nThe provided snippets primarily focus on the technical capabilities of handling X.509 certificates, extracting thumbprints, and supporting DPoP and FAPI conformance. While the exact string format `keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\"` is not explicitly shown in the code, the underlying mechanisms for processing certificate serial numbers and issuer distinguished names are present. The system\\'s adherence to FAPI standards strongly implies that it can be configured or extended to produce and validate `keyId` fields in the specified format. Further investigation into the FAPI-specific modules and configurations would be necessary to pinpoint the exact code responsible for generating this specific `keyId` format.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_53501176-7e35-42da-bfcb-fd223903e56b\\n', 'id': 'lc_810408e9-5e37-4b29-aff6-73f635aedaae'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0106_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the use of certificate serial numbers and issuer distinguished names in security policies, which could be relevant to the `keyId` field format you described. Specifically, the security policy XML files contain the `<sp:MustSupportRefIssuerSerial/>` element, indicating support for referencing certificates by their issuer and serial number.   \\n\\n### Implementation Details\\n\\nThe presence of `<sp:MustSupportRefIssuerSerial/>` within the `<sp:Wss11>` and `<sp:Wss10>` policy assertions suggests that the system is configured to process security tokens that identify certificates using their issuer serial number.   This element is part of the WS-SecurityPolicy specification and indicates that the system must support referencing security tokens by their X.509 Issuer Serial. \\n\\nFor example, in `scenario11-policy.xml`, the policy includes `<sp:MustSupportRefIssuerSerial/>` under `<sp:Wss11>`, which means that the system expects to be able to identify certificates using their issuer and serial number when WS-Security 1.1 is in use.  Similar configurations are found in `scenario13-policy.xml`, `scenario14-policy.xml`, `scenario3-policy.xml`, `scenario5-policy.xml`, `scenario7-policy.xml`, `scenario8-policy.xml`, `scenario9-policy.xml`, `scenario4-policy.xml`, `scenario10-policy.xml`, `scenario12-policy.xml`, `scenario15-policy.xml`, and `scenario2-policy.xml`.            \\n\\n### Configuration Options\\n\\nThe configuration for this feature is primarily done through WS-SecurityPolicy XML files.  To enable the use of certificate serial numbers and CA distinguished names in the `keyId` field, you would need to ensure that the relevant security policy applied to your API includes the `<sp:MustSupportRefIssuerSerial/>` element. \\n\\nThe policies also include `<sp:MustSupportRefKeyIdentifier/>` and `<sp:MustSupportRefThumbprint/>`, which are other ways to reference security tokens.  This indicates flexibility in how certificates can be identified. \\n\\n### API Endpoints or Features\\n\\nThe provided snippets are security policy definitions, which are typically applied to API endpoints to enforce security requirements.  While no specific API endpoints are directly mentioned in these policy files, the policies themselves define the security features that would be enforced on an API.  The presence of these policies suggests that the WSO2 API Manager (APIM) product supports these WS-Security features for its managed APIs. \\n\\n### Documentation References\\n\\nThe snippets themselves are XML policy files, which serve as configuration examples for various security scenarios.  These files are located in the `tests-backend/src/test/resources/security/policies/` directory, indicating they are used for integration testing of security policies within the WSO2 API Manager.  Further documentation would likely be found in the official WSO2 API Manager documentation regarding WS-Security policies and certificate management. <cite/>\\n\\n## Notes\\n\\nThe provided code snippets are XML policy definitions used for testing within the `wso2/product-apim` repository. They demonstrate the system\\'s capability to handle various WS-Security configurations, including the use of `IssuerSerial` for certificate identification. The specific format `keyId=\"SN=XXX,CA=YYYYYYYYYYYYYYYY\"` is a common way to represent an X.509 Issuer Serial in a `keyId` attribute, and the presence of `<sp:MustSupportRefIssuerSerial/>` indicates that the system is designed to process such references.  The snippets do not directly show the parsing logic for the `keyId` attribute, but rather the policy assertion that such a reference mechanism is supported. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_67c97815-5ec9-443f-8b92-d41ca386db1a\\n', 'id': 'lc_8a746bab-1177-4eea-9e97-4814227b3eb2'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0107",
      "requirement": {
        "requirement_id": "ATOM_182",
        "requirement_text": "Card account access MUST assume that PSU consent is already given and stored on the ASPSP system.",
        "strength": "MUST",
        "capability": "Consent Management",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0107_1",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_2",
          "text": "#### Add CustomerCareOfficerRole Role\n\nCustomerCareOfficerRole is required for bank users to log into the Consent Manager Portal and search for the consents granted by any user.\n\n1. Go to **Roles** under the **User Management** tab in the left pane.\n\n2. Click on **+ New Role**.<br/> \n![roles](../assets/img/learn/consent-manager/roles.png)\n\n3. Enter following details and click on Next button.\n    - Role Name: CustomerCareOfficerRole\n    - Role audience: Organization<br/> \n![create-cc-role](../assets/img/learn/consent-manager/create-cc-role.png)\n\n4. Select the created **API Resource** under the **Permission Selection** section.\n\n5. Add the **consents:read_all** permission from the API resource separately.<br/> \n![create-role-step2](../assets/img/learn/consent-manager/create-role-step2.png)\n\n6. Click on the **Finish** button.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_3",
          "text": "## Shareable and payable accounts \n   \nSome bank customers may have a certain number of bank accounts in a particular bank, but not all these accounts have \nthe ability to be shared externally or to make a payment online. These accounts are known as shareable and payable \naccounts respectively. In a bank, the list of shareable accounts and the payable accounts can either be the same or \ndifferent.\n   \nThe WSO2 Open Banking solution expects at least two APIs from the bank that return shareable and payable accounts when \nthe `user_id` is provided. The response must be in the JSON format and it will automatically load the accounts list on \nthe consent page during the consent authorization flow. \n\n![consent-page-with-accounts](../assets/img/learn/integration/list-of-accounts.png)\n\nThe responses of shareable and payable accounts APIs depend on your open banking specification and what you need to \ndisplay on the consent page. You can configure customized steps for retrieval by following the \n[Consent Authorize endpoint](https://ob.docs.wso2.com/en/latest/develop/consent-management-authorize/#configuration) \ndocumentation.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_4",
          "text": "#### Add ConsentPortalRole Role\n\nConsentPortalRole is required for users to log into the Consent Manager Portal and search for the consents granted by them.\n\nSimilarly create another role named as **ConsentPortalRole** and assign **consents:read_self** scope to the role.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_5",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support consent management, which is a prerequisite for handling PSU (Payment Services User) consent in an ASPSP (Account Servicing Payment Service Provider) system. The codebase includes integration tests and configuration options related to user consent for OAuth2/OIDC and SAML SSO flows. However, there is no direct evidence within the provided snippets that explicitly addresses \"card account access\" or verifies that \"card account endpoints only function when valid PSU consent exists and is stored in the ASPSP system.\"   \\n\\n## Implementation Details\\n\\nThe system handles user consent through various mechanisms, primarily within OAuth2/OIDC and SAML SSO flows.  \\n\\n### Consent Approval in OAuth2/OIDC\\nThe `OAuth2ServiceAbstractIntegrationTest` class contains methods for sending approval post requests with consent.  The `sendApprovalPostWithConsent` method takes an `HttpClient`, `sessionDataKeyConsent`, and a list of `consentClaims` as parameters.  This method constructs a POST request with \"consent\" and \"scope-approval\" set to \"approve\", along with the `sessionDataKeyConsent` and any additional `consentClaims`.  This indicates that the system can process user consent for specific claims or scopes. \\n\\nThe `OAuthAppsWithSameClientIdTestCase` and `OAuth2TokenRevocationWithSessionTerminationTestCase` use this `sendApprovalPostWithConsent` method to simulate consent approval during OAuth2 flows.  \\n\\n### Consent Management in Self-Registration\\nThe `SelfSignUpConsentTest` class demonstrates how consent is handled during user self-registration.  The `selfRegister` method constructs a request body that includes consent information, such as `jurisdiction`, `collectionMethod`, `piiPrincipalId`, and `purposes`.  This consent data is then sent to the `/api/identity/user/v1.0/me` endpoint.  The `getConsents` method retrieves consent receipts for a given user from the `/api/identity/consent-mgt/v1.0/consents` endpoint. \\n\\n### Consent in SAML SSO\\nThe `SAMLSSOConsentTestCase` indicates that consent management is also integrated with SAML SSO flows.  The test case includes steps for SAML SSO login, testing claims, and then updating application claim configurations, implying that consent for claims is part of the SAML SSO process. \\n\\n## Configuration Options\\n\\nThe system provides configuration options to enable or disable consent management. \\n\\n### `EnableSSOConsentManagement`\\nIn `default-identity.xml`, there is a configuration entry `<EnableSSOConsentManagement>true</EnableSSOConsentManagement>` under the `<Consent>` section.  This setting explicitly enables consent management during SSO. \\n\\n### `SkipUserConsent`\\nFor OpenID Connect, the `identity-default.xml` file contains a `<SkipUserConsent>false</SkipUserConsent>` setting within the `<OpenIDConnect>` section.  This indicates that user consent is not skipped by default for OpenID Connect flows, meaning it is required.  A similar setting, `<OpenIDSkipUserConsent>false</OpenIDSkipUserConsent>`, is present under the `<OpenID>` section. \\n\\n## API Endpoints or Features\\n\\nThe API layer includes endpoints for consent management. \\n\\n### Consent Management API\\nThe `default-identity.xml` file defines resource access control for consent management APIs. \\n- `(.*)/api/identity/consent-mgt/v1.0/consents`: This endpoint is secured and allows all HTTP methods, suggesting it\\'s used for general consent management operations. \\n- `(.*)/api/identity/consent-mgt/v1.0/consents/receipts/(.*)`: This endpoint is also secured for all HTTP methods and likely deals with consent receipts.  The `SelfSignUpConsentTest` uses this endpoint to retrieve consent receipts. \\n\\n## Documentation References\\n\\nThe \"Integration Tests\" wiki page provides an overview of the integration testing framework, including tests for OAuth2/OIDC and SAML, which involve consent management. <wiki_page repo_name=\"wso2/product-is\" id=\"6.1\" page_name=\"Integration Tests\" /> The \"API Layer\" wiki page describes the RESTful APIs, including user APIs that allow end-users to manage application consents. <wiki_page repo_name=\"wso2/product-is\" id=\"4\" page_name=\"API Layer\" />\\n\\n## Notes\\n\\nWhile the codebase demonstrates robust consent management capabilities within the context of OAuth2/OIDC and SAML SSO, there is no explicit mention or implementation related to \"card account access\" or \"ASPSP system\" within the provided snippets. The existing consent mechanisms could potentially be extended or integrated with such a system, but the current code does not directly address this specific use case. Therefore, it is not possible to verify the test criteria that \"card account endpoints only function when valid PSU consent exists and is stored in the ASPSP system\" based on the given information.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-c_f1244946-9da3-4cfa-be4e-b0db42b0fc83\\n', 'id': 'lc_63a638dc-1275-49bb-a58a-c1092cb8a5d3'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0107_6",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_de018b9b-aaaf-4189-8eb0-280a728979ac'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0108",
      "requirement": {
        "requirement_id": "ATOM_152",
        "requirement_text": "The system SHALL require X-Request-ID header as mandatory UUID for all account information requests",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0108_1",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_2",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_3",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_4",
          "text": "Sun, 10 Sep 2017 19:43:31 UTC\n    pattern: >-\n      ^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\d{2}\n      (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\d{4} \\d{2}:\\d{2}:\\d{2}\n      (GMT|UTC)$\n  ConsentId:\n    name: ConsentId\n    in: path\n    description: ConsentId\n    required: true\n    type: string\n  AccountId:\n    name: AccountId\n    in: path\n    description: AccountId\n    required: true\n    type: string\n  x-fapi-interaction-id:\n    in: header\n    name: x-fapi-interaction-id\n    type: string\n    required: false\n    description: An RFC4122 UID used as a correlation id.\nresponses:\n  201AccountAccessConsentsCreated:\n    description: Account Access Consents Created\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadConsentResponse1'\n  200AccountAccessConsentsConsentIdRead:\n    description: Account Access Consents Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadConsentResponse1'\n  204AccountAccessConsentsConsentIdDeleted:\n    description: Account Access Consents Deleted\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  200AccountsRead:\n    description: Accounts Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadAccount5'\n  200AccountsAccountIdRead:\n    description: Accounts Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadAccount4'\n  200AccountsAccountIdBalancesRead:\n    description: Balances Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadBalance1'\n  200AccountsAccountIdTransactionsRead:\n    description: Transactions Read\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        required: true\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBReadTransaction5'\n  400Error:\n    description: Bad request\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\n  401Error:\n    description: Unauthorized\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  403Error:\n    description: Forbidden\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\n  404Error:\n    description: Not found\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  405Error:\n    description: Method Not Allowed\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  406Error:\n    description: Not Acceptable\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  415Error:\n    description: Unsupported Media Type\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  429Error:\n    description: Too Many Requests\n    headers:\n      Retry-After:\n        description: Number in seconds to wait\n        type: integer\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n  500Error:\n    description: Internal Server Error\n    headers:\n      x-fapi-interaction-id:\n        type: string\n        description: An RFC4122 UID used as a correlation id.\n    schema:\n      $ref: '#/definitions/OBErrorResponse1'\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    tokenUrl: 'https://authserver.example/token'\n    scopes:\n      accounts: Ability to read Accounts information\n    description: TPP client credential authorisation flow with the ASPSP\n    x-scopes-bindings:\n      accounts: Internal/consumer\n  PSUOAuth2Security:\n    type: oauth2\n    flow: accessCode\n    tokenUrl: 'https://authserver.example/token'\n    authorizationUrl: 'https://authserver.example/authorization'\n    scopes:\n      accounts: Ability to read Accounts information\n    description: >-\n      OAuth flow, it is required when the PSU needs to perform SCA with the\n      ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\n    x-scopes-bindings:\n      accounts: Internal/consumer\n  default:\n    type: oauth2\n    authorizationUrl: 'https://test.com'\n    flow: implicit\n    scopes:\n      accounts: Ability to read Accounts information\n    x-scopes-bindings:\n      accounts: Internal/consumer\ndefinitions:\n  OBReadConsent1:\n    type: object\n    required:\n      - Data\n      - Risk\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadData1'\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n  OBReadConsentResponse1:\n    type: object\n    required:\n      - Data\n      - Risk\n    properties:\n      Data:\n        type: object\n        required:\n          - ConsentId\n          - CreationDateTime\n          - StatusUpdateDateTime\n          - Permissions\n        properties:\n          ConsentId:\n            description: >-\n              Unique identification as assigned to identify the account access\n              consent resource.\n            type: string\n            minLength: 1\n            maxLength: 128\n          CreationDateTime:\n            $ref: '#/definitions/CreationDateTime'\n          Status:\n            $ref: '#/definitions/OBExternalRequestStatus1Code'\n          StatusUpdateDateTime:\n            $ref: '#/definitions/StatusUpdateDateTime'\n          Permissions:\n            type: array\n            items:\n              $ref: '#/definitions/OBExternalPermissions1Code'\n            minItems: 1\n          ExpirationDateTime:\n            description: >-\n              Specified date and time the permissions will expire.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_5",
          "text": "### Delete a consent\n- If the customer revokes a consent to data access with the API consumer, the API consumer must delete the consent resource. \nIn order to make this request, the API consumer must have an access token issued by the API consumer using the client \ncredentials grant.\n\n- A sample request to delete a consent looks as follows:\n```\ncurl DELETE \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- If the deletion is successful you will get a `204 No Content` response.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0108_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the requirement for an `X-Request-ID` header as a mandatory UUID for account information requests. The `x-fapi-interaction-id` header, which serves as a correlation ID and is described as an RFC4122 UID (UUID), is used for this purpose.\\n\\n## Implementation Details\\nThe `x-fapi-interaction-id` header is defined in the OpenAPI specifications for Account Information APIs. For instance, in the `account-info-swagger.yaml` file, this header is referenced in various API endpoints related to account access consents, accounts, balances, and transactions. While the `x-fapi-interaction-id` header is described as \"An RFC4122 UID used as a correlation id\" , it is marked as `required: false` in the parameter definitions for these API calls . However, for responses, the `x-fapi-interaction-id` header is often marked as `required: true` .\\n\\nIn the `DefaultConsentManageHandler.java`  for consent management operations, if the `x-fapi-interaction-id` header is not present in the request, a new UUID is generated and set as the response header . This indicates that while it might not be strictly enforced as mandatory on the request side for all API calls, the system ensures its presence in responses and uses it for correlation.\\n\\n## API Endpoints or Features\\nThe `x-fapi-interaction-id` header is used across various Account Information API endpoints defined in `account-info-swagger.yaml` :\\n*   `/account-access-consents` (POST, GET, DELETE)   \\n*   `/accounts` (GET) \\n*   `/accounts/{AccountId}` (GET) \\n*   `/accounts/{AccountId}/balances` (GET) \\n*   `/accounts/{AccountId}/transactions` (GET) \\n\\nThe `AccountService.java`  in the demo backend also includes `@HeaderParam(\"x-fapi-interaction-id\") String xFapiInteractionId` in its methods, and if it\\'s `null`, a new UUID is generated .\\n\\n## Configuration Options\\nThe `wso2is-7.1.0-deployment.toml` file  defines various extension points, including `validate_authorization_request` . This extension point could potentially be used to enforce the mandatory presence and UUID format of the `x-fapi-interaction-id` header for incoming requests.\\n\\n## Documentation References\\nThe `Overview` wiki page mentions \"API Gateway Extensions\"  as a component for API processing and gateway functionality, which would be the logical place for enforcing such header requirements. The `Consent Management` wiki page also discusses idempotency support and external service integration, which could be relevant for validating request headers .\\n\\n## Notes\\nThe prompt specifically asks for `X-Request-ID`, but the codebase consistently uses `x-fapi-interaction-id` for correlation purposes, which is described as an RFC4122 UID (UUID). While the OpenAPI specifications mark `x-fapi-interaction-id` as optional for requests, the internal handling in `DefaultConsentManageHandler.java` and `AccountService.java` ensures a UUID is present in responses, generating one if missing from the request. To strictly enforce the \"SHALL require\" aspect for incoming requests, a custom validation would likely need to be implemented using the `validate_authorization_request` extension point.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2a0b392d-ab9e-44d6-b01a-77f7d224932a\\n', 'id': 'lc_219465e2-cbf4-4660-827f-8ae37545cc61'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0109",
      "requirement": {
        "requirement_id": "ATOM_047",
        "requirement_text": "Error responses shall include a type field with URI reference to the specific error code documentation",
        "strength": "SHALL",
        "capability": "Error Handling",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0109_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support error responses that include a `type` field, but it does not explicitly use a URI reference to specific error code documentation within this field. Instead, the `type` field seems to be used for internal categorization of error types, such as `invalid_authorization_details`  or `scimType` values like \"invalidSyntax\" .\\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository uses a structured approach for error responses, particularly within its REST APIs. Error responses generally include fields such as `code`, `message`, and `description` .\\n\\nFor SCIM 2.0 APIs, the error definitions in `scim2.yaml`  include a `schemas` field, which is an array of strings, typically containing \"urn:ietf:params:scim:api:messages:2.0:Error\" . This `schemas` field acts as a URI reference to the SCIM error message specification, but it\\'s not a direct URI to specific error code documentation. Additionally, a `scimType` field is present, which provides a more specific, human-readable error type like \"invalidSyntax\"  or \"Unauthorized\" .\\n\\nIn the context of Rich Authorization Requests, a `TYPE` constant is defined as \"type\" , and various test types are defined, some of which are URI-like, such as \"https://example.com/rar_authorization_details_type_1\" . These are used to construct authorization details objects . However, this `type` field is part of the authorization details themselves, not directly an error response field for documentation.\\n\\n### API Endpoints or Features\\n\\nThe `AuthenticatorFailureTest.java`  demonstrates error responses for invalid API requests. For example, when an invalid endpoint URI is provided, the API returns a `400 Bad Request` status code with a `code` of \"UE-10000\" and a `description` indicating the expected URI format . Similarly, an invalid endpoint authentication type results in a `400 Bad Request` with `code` \"UE-10000\" and a message about the invalid request body format . These error responses do not contain a `type` field with a URI reference to documentation.\\n\\nThe `RESTTestBase.java`  defines a standard error response format that includes `code`, `message`, `description`, and `traceId`. There is no mention of a `type` field with a URI reference in this base error response structure.\\n\\n### Documentation References\\n\\nThe `scim2.yaml`  file defines various error objects (e.g., `ErrorIvalidInput`, `ErrorUnauthorized`, `ErrorForbidden`, `ErrorUserNotAvailable`, `ErrorInternalServerError`). Each of these error definitions includes a `schemas` field that references \"urn:ietf:params:scim:api:messages:2.0:Error\" . This URI points to the SCIM 2.0 Protocol specification for error responses, which is a general standard, not specific documentation for each error code within the WSO2 Identity Server.\\n\\n## Notes\\n\\nThe codebase demonstrates a structured approach to error handling, including specific error codes and descriptions. While the SCIM 2.0 API definitions include a `schemas` field that is a URI, it refers to the general SCIM error specification rather than specific documentation for each error code. The `type` field mentioned in `RichAuthorizationRequestsUtils.java`  is related to authorization details and not directly to error response documentation. Therefore, based on the provided snippets, the repository does not appear to explicitly support a `type` field with a URI reference to specific error code documentation in its general error responses.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_8aeb8e11-300c-401e-95f5-ef4bce7c730b\\n', 'id': 'lc_0f92724f-de14-4dc3-8ce0-3a887cd4b022'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0109_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, defines error responses in its OpenAPI/Swagger specifications that include a `moreInfo` field intended to contain a URI with more details about the error . While the `Error` schema includes a `moreInfo` field for a URI reference, it does not explicitly define a `type` field for URI reference to specific error code documentation as requested .\\n\\n## Implementation Details\\n\\nThe error response structure is primarily defined within various OpenAPI/Swagger YAML files across the repository. The common `Error` schema includes the following fields:\\n*   `code`: An integer representing the error code .\\n*   `message`: A string providing a concise error message .\\n*   `description`: A detailed description of the error message .\\n*   `moreInfo`: A string field described as \"Preferably an url with more details about the error\" .\\n*   `error`: An array of `ErrorListItem` objects for listing multiple errors .\\n\\nThe `ErrorListItem` further defines `code`, `message`, and `description` for individual errors .\\n\\nExamples of this error structure are present in various API definitions, such as `service-catalog-api.yaml` , `store-api.yaml` , `admin/api/openapi.yaml` , and `gateway-api.yaml` .\\n\\nA test case in `GraphqlSubscriptionTestCase.java` verifies that GraphQL subscription error responses contain a `type` field with the value \"error\" and a `payload` containing `message` and `code` fields . However, this `type` field is specific to the GraphQL WebSocket protocol and indicates the message type, not a URI reference to error documentation .\\n\\n## Configuration Options\\n\\nThe `moreInfo` field in the `Error` schema is designed to hold a URL . The content of this field would be configured at the point where the error response is generated within the application logic. The OpenAPI definitions themselves do not provide a global configuration for the base URI or a templating mechanism for the `moreInfo` field.\\n\\n## API Endpoints or Features\\n\\nThe `Error` schema is referenced by various API endpoints for different HTTP status codes (e.g., 400, 401, 404, 409, 415, 500) across multiple API definitions   . This indicates that error responses across these APIs are expected to conform to this defined structure.\\n\\n## Documentation References\\n\\nThe OpenAPI/Swagger YAML files serve as the primary documentation for the error response structure . The `description` field within the `Error` and `ErrorListItem` schemas provides human-readable explanations of the error fields  . The `moreInfo` field is explicitly documented as an optional URL for further details .\\n\\n## Notes\\n\\nThe repository supports including a URI reference in error responses through the `moreInfo` field . However, it does not explicitly define a `type` field for this purpose, nor does it enforce a URI format for the `moreInfo` field beyond its description as an \"url\" . The `type` field observed in `GraphqlSubscriptionTestCase.java` is specific to the GraphQL WebSocket protocol and is not the `type` field for URI reference to error code documentation that you are looking for . To fully meet the requirement, the `Error` schema would need to be modified to include a dedicated `type` field with a URI format constraint for error code documentation.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_49071229-12ee-4a5f-8f83-faae0b6c7ebf\\n', 'id': 'lc_a83764e4-4675-48f7-bb81-f948b68484f5'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0110",
      "requirement": {
        "requirement_id": "ATOM_153",
        "requirement_text": "The system SHALL require Consent-ID header as mandatory for account information requests",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0110_1",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_2",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_3",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_4",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0110_5",
          "text": "## Setting up Consent manager app",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0111",
      "requirement": {
        "requirement_id": "ATOM_183",
        "requirement_text": "The card account list response MUST include a cardAccounts array containing Card Account Details objects.",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0111_1",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_3",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_4",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_5",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0111_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports the retrieval of account information, including a list of accounts, through its Account and Transaction API. The API defines a `/accounts` endpoint that returns account details. The response structure for account lists, as defined in the OpenAPI specification, includes an `Account` array within a `Data` object, where each element of the `Account` array represents an `OBAccount4` object containing account details.   \\n\\n## Implementation Details\\n\\nThe `AccountService.java` file in the `org.wso2.financial.services.accelerator.demo.backend` module provides a demo implementation for retrieving account lists.  The `getAccounts` method, mapped to the `/accountservice/accounts` endpoint, returns a hardcoded JSON string that includes an `Account` array.   This array contains multiple account objects, each with fields like `AccountId`, `Status`, `Currency`, `AccountType`, and `AccountSubType`. \\n\\nThe `account-info-swagger.yaml` defines the OpenAPI specification for the Account and Transaction API.  Specifically, the `OBReadAccount5` and `OBReadAccount4` definitions describe the structure of the response for account lists, both of which contain a `Data` object with an `Account` array.   Each item in this `Account` array is an `OBAccount4` object, which details properties such as `AccountId`, `Currency`, `AccountType`, and `AccountSubType`. \\n\\n## API Endpoints and Features\\n\\nThe relevant API endpoint for retrieving a list of accounts is `/accounts` under the `/open-banking/{version}/aisp` base path.   This endpoint supports a `GET` operation, `GetAccounts`, which returns a `200 Accounts Read` response.  The response schema for this operation is defined by `#/responses/200AccountsRead`, which references `#/definitions/OBReadAccount5`. \\n\\nThe API also includes an endpoint for retrieving a specific account by `AccountId`: `/accounts/{AccountId}`.  This endpoint\\'s response schema is `#/definitions/OBReadAccount4`. \\n\\n## Test Criteria\\n\\nThe integration tests in `EndToEndAccountFlowTest.groovy` verify the functionality of account retrieval.  Specifically, the test `\"Verify Accounts Retrieval Request for a Authorised Consent\"` checks that a `200 OK` status code is returned when requesting accounts.  Another test, `\"Verify Retrieving a Specific Account for a Authorised Consent\"`, confirms the retrieval of individual account details.  These tests implicitly verify the presence and structure of the account data in the response. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page for the `wso2/financial-services-accelerator` repository mentions \"Account Information APIs\" and specifically lists \"Accounts\" as a category with the OAuth scope `accounts` and endpoints for account retrieval.    This aligns with the OpenAPI specification found in `account-info-swagger.yaml`. \\n\\n## Notes\\n\\nThe prompt specifically asks about a \"cardAccounts array\" and \"Card Account Details objects\". While the provided context extensively covers \"Account\" arrays and \"Account Details\" objects, there is no explicit mention of a `cardAccounts` array or `Card Account Details` objects as distinct entities in the API responses for listing accounts. The `OBAccount4` definition does include an `Account` array within itself, which provides details to identify an account, and `OBExternalAccountSubType1Code` enum lists `ChargeCard`, `CreditCard`, and `PrePaidCard` as possible account subtypes.   This suggests that card accounts are represented as a type of `Account` within the general account list, rather than in a separate `cardAccounts` array. The `OBTransactionCardInstrument1` definition exists, but it is used within transaction details (`OBTransaction6`) and not directly in the account list response.  \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0380a00a-20e8-4606-a8e4-fb34c5e0c742\\n', 'id': 'lc_6a0f7b14-cbb0-42ea-8b5a-3ac7343e12dd'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0112",
      "requirement": {
        "requirement_id": "ATOM_108",
        "requirement_text": "The ASPSP SHALL validate that the payment-product matches the payment initiation addressed by paymentId",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0112_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0112_2",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0112_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0112_4",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0112_5",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0112_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, appears to support validation of payment initiation requests, but the provided context does not explicitly detail a mechanism to validate that the `payment-product` matches the original payment initiation addressed by `paymentId` <cite />. The system does include components for payment initiation and consent management, with validation logic for the structure and content of payment requests .\\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` repository includes a `PaymentService` within the `org.wso2.financial.services.accelerator.demo.backend` component, which handles payment submissions . This service processes incoming payment requests and caches them .\\n\\nPayment initiation requests are defined by the `payment-initiation-openapi.yaml` file, which specifies the structure for creating payment consents (`/payment-consents`) and initiating payments (`/payments`)  . The `obWritePayment2` schema, used for `/payments` POST requests, includes a `ConsentId` field, linking the payment to a previously established consent .\\n\\nThe `DefaultConsentManageValidator` class contains methods for validating payment initiation request payloads . Specifically, the `validatePaymentRequestPayload` method checks the overall structure of the payment request, including the `Data` and `Initiation` objects . The `validatePaymentInitiationPayload` method further validates elements within the `Initiation` object, such as `DebtorAccount`, `CreditorAccount`, `LocalInstrument`, and `InstructedAmount` . However, there is no explicit code snippet provided that performs a direct comparison between a `payment-product` from a payment initiation and a `paymentId` to ensure they match.\\n\\nThe system also leverages an \"External Service Integration\" framework, which allows for custom validation logic to be injected at various extension points . This framework could potentially be used to implement the required `payment-product` validation, although no specific implementation for this particular validation is shown .\\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, is used for centralized configuration . This configuration includes settings for consent management and can enable or disable external service calls for validation . While the existing configuration options do not directly address `payment-product` matching, the extensibility of the system suggests that such a validation could be configured through an external service.\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoints for payment initiation are defined in `payment-initiation-openapi.yaml` .\\n\\n*   `POST /payment-consents`: Used to create payment consents .\\n*   `GET /payment-consents/{consentId}`: Retrieves details of a specific payment consent .\\n*   `GET /payment-consents/{consentId}/funds-confirmation`: Provides funds confirmation for a given consent .\\n*   `POST /payments`: Initiates a payment based on a previously created consent .\\n*   `GET /payments/{paymentId}`: Retrieves the status and details of a specific payment .\\n\\nThe `paymentId` is a path parameter used to identify a specific payment . The `obWritePayment2` schema, used for payment initiation, requires a `ConsentId` . The `obWritePaymentConsentResponse5` schema, returned after creating a payment consent, also includes a `ConsentId` . While these APIs handle payment initiation and retrieval, the explicit validation of `payment-product` against `paymentId` is not directly visible in the provided API definitions or the `PaymentService` implementation.\\n\\n## Documentation References\\n\\nThe `Overview` wiki page describes the WSO2 Financial Services Accelerator as a solution that implements regulatory standards for consent management and secure API access, supporting payment initiation . The `External Service Integration` wiki page details how external services can be used to extend functionality, including validation . This framework could be utilized to implement the required `payment-product` validation.\\n\\n## Notes\\n\\nThe provided code snippets and wiki pages indicate that the system has robust mechanisms for consent management and payment initiation, including structural validation of payment requests . However, there is no direct evidence in the provided context that the system explicitly validates whether the `payment-product` matches the original payment initiation identified by `paymentId`. This specific validation might be implemented as part of a custom extension using the \"External Service Integration\" framework, or it might be handled at a higher level of the application logic not covered by the provided snippets. The `TestConstants.java` file contains a `PAYMENT_SUBMISSION_WITH_DIFFERENT_INITIATION` string, which suggests that scenarios involving differing initiation details are considered in testing, but the validation logic for such a scenario is not explicitly shown .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [External Service Integration (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#5)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_32abcccc-7f84-4358-937b-c7fb6c06a1ca\\n', 'id': 'lc_e16cc8fe-6798-4302-ac72-96a01504a6a9'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0113",
      "requirement": {
        "requirement_id": "ATOM_214",
        "requirement_text": "The algorithm parameter in the Signature header is mandatory and must identify the same signature algorithm as the TPP's public key in the certificate",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0113_1",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_2",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_3",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_4",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_5",
          "text": "Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a secure TLS channel and protect the transport layer communication from potential attackers on the network. WSO2 Open Banking Accelerator validates the following aspects of the QWAC if it is used for an API invocation: - The certificate is qualified, technically correct, and is not expired. - The PSD2 information in the certificate such as PSD2 roles, Authorization Number matches with the API being invoked. - The certificate is not revoked using CRL or Online OCSP validations. ####Qualified e-Seal Certificate (QSealC) QSealC seals application data and sensitive information to ensure that the origin of the document is trusted. WSO2 Open Banking Accelerator allows using QSealC as the signing certificates in application layer security to ensure protecting the data or messages from potential attackers during or after the communication. <hr> Generally, open banking flows always consist of 3 different types of API requests by the client applications. The following section lists the different security measures taken at each of the request types.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Yes, the WSO2 Identity Server repository supports the requirement that the algorithm parameter in the Signature header is mandatory and must identify the same signature algorithm as the TPP\\'s public key in the certificate, specifically for OAuth2/OpenID Connect and FAPI conformance. The system allows configuration of signature algorithms for various components like ID Tokens, Request Objects, and Token Endpoint authentication, and it includes mechanisms for validating these algorithms against certificates.\\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server handles signature algorithm validation and configuration in several areas:\\n\\n### FAPI Conformance\\nFor Financial-grade API (FAPI) conformance, the system explicitly defines allowed signature algorithms. The `oidc-metadata.json` file, which is part of the integration tests, specifies `\"PS256\"` and `\"ES256\"` as allowed signature algorithms for FAPI metadata . This indicates that the system is designed to enforce specific, strong signature algorithms for FAPI-compliant applications.\\n\\n### Token Endpoint Authentication Signing Algorithm\\nThe `tokenEndpointAuthSigningAlg` property in the `ClientAuthenticationConfiguration` class is used to specify the signature algorithm for token endpoint authentication . This configuration is crucial for ensuring that the algorithm used by the TPP (Third Party Provider) for signing authentication requests matches the expected algorithm. The `oidc-metadata.json` also lists supported algorithms for `tokenEndpointSignatureAlgorithm`, including `\"PS256\"`, `\"ES256\"`, `\"ES384\"`, `\"RS384\"`, and `\"SHA256withRSA\"` .\\n\\n### Request Object Signature Algorithm\\nThe system allows specifying the signature algorithm for Request Objects via the `requestObjectSigningAlg` property . The `oidc-metadata.json` file provides options for this, such as `\"PS256\"`, `\"ES256\"`, and `\"SHA256withRSA\"` . There are also integration tests, like `testCreateOAuthApplicationsWithInvalidRequestObjectSigningAlgorithm`, that specifically verify error scenarios when an invalid signature algorithm is provided for Request Objects . This indicates that the system validates the provided algorithm against a set of supported algorithms.\\n\\n### ID Token Signature Algorithm\\nSimilarly, the `idTokenSignatureAlgorithm` can be configured, with supported options including `\"PS256\"`, `\"ES256\"`, and `\"SHA256withRSA\"` . The `default-identity.xml` configuration file also shows a default `SignatureAlgorithm` for OpenID Connect ID Tokens as `SHA256withRSA` .\\n\\n### Certificate Thumbprint Calculation\\nThe `DPoPProofGenerator.java` utility class includes methods to extract and compute key thumbprints from DPoP proofs . Specifically, the `getKeyThumbprintOfKey` method verifies the signature with the public key and then computes the thumbprint for both EC and RSA keys . This demonstrates the system\\'s capability to work with public key information from certificates. The `resource-server.py` script in the FAPI conformance tests also contains a `computeSHA256Thumbprint` function that extracts the SHA256 thumbprint from a client certificate . This is used to verify that the thumbprint from the access token matches the client certificate.\\n\\n## Configuration Options\\n\\nThe following configuration options are available:\\n\\n*   **`tokenEndpointAuthSigningAlg`**: Configures the signature algorithm for token endpoint authentication. This can be set to values like `\"PS256\"`, `\"ES256\"`, `\"ES384\"`, `\"RS384\"`, or `\"SHA256withRSA\"` .\\n*   **`requestObjectSigningAlg`**: Configures the signature algorithm for Request Objects. Supported values include `\"PS256\"`, `\"ES256\"`, and `\"SHA256withRSA\"` .\\n*   **`idTokenSignatureAlgorithm`**: Configures the signature algorithm for ID Tokens. Options include `\"PS256\"`, `\"ES256\"`, and `\"SHA256withRSA\"` . The default is `SHA256withRSA` .\\n*   **`allowedSignatureAlgorithms` (for FAPI)**: Specifies the signature algorithms allowed for FAPI applications, currently `\"PS256\"` and `\"ES256\"` .\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoints and features include:\\n\\n*   **Application Management API**: This API allows for the configuration of OAuth2/OIDC applications, including their signature algorithms. The `ClientAuthenticationConfiguration` model is used for this purpose .\\n*   **Token Endpoint**: This endpoint processes authentication requests where the `tokenEndpointAuthSigningAlg` parameter is validated.\\n*   **Request Object Processing**: The system validates the `requestObjectSigningAlg` parameter when processing Request Objects.\\n*   **ID Token Generation**: The system uses the configured `idTokenSignatureAlgorithm` when generating ID Tokens.\\n*   **JWKS Endpoint**: While not directly related to the *algorithm parameter in the Signature header*, the JWKS endpoint provides the public keys used to verify signatures of ID tokens . This is a critical component for verifying the TPP\\'s public key.\\n\\n## Documentation References\\n\\nThe provided wiki page \"OAuth2 and OpenID Connect\"  gives a high-level overview of the OAuth2 and OpenID Connect implementation in WSO2 Identity Server, including token management and standards compliance, such as FAPI conformance. It mentions that ID Tokens can be configured with various signing algorithms .\\n\\n## Test Criteria Verification\\n\\nThe repository contains tests that verify the matching of signature algorithms and the use of SHA-256 or SHA-512.\\n\\n*   **Invalid Request Object Signing Algorithm Test**: The `testCreateOAuthApplicationsWithInvalidRequestObjectSigningAlgorithm` test case in `ApplicationManagementOAuthFailureTest.java` specifically checks for error scenarios when an invalid signature algorithm is used for a Request Object . This implies that the system validates the provided algorithm against a predefined set of acceptable algorithms. The `create-oauth-app-with-invalid-request-object-signing-algorithm.json` file used in this test demonstrates an attempt to use `\"random_signature_algorithm_not_supported_by_the_server\"` , which would fail, confirming the validation.\\n*   **SHA-256 Hashing**: The `DPoPProofGenerator.java` class explicitly uses `SHA-256` for generating access token hashes . This demonstrates the use of SHA-256 as a hash algorithm within the system.\\n*   **SHA-256 Thumbprint Calculation**: The `computeSHA256Thumbprint` function in `resource-server.py` calculates the SHA256 thumbprint of a client certificate . This is used in FAPI conformance tests to ensure that the thumbprint from the access token matches the client certificate, which is a form of proof-of-possession.\\n*   **SAML Signature Algorithms**: While not directly related to the Signature header in the context of TPP\\'s public key in the certificate for OAuth2/OIDC, the `SAML2SSOTestBase.java` class shows how signature algorithms are set for SAML requests, including the use of `XML_DIGEST_ALGORITHM_SHA1` (though the prompt specifies SHA-256 or SHA-512) . This indicates a general capability within the codebase to handle and configure various signature and digest algorithms. The `default-identity.xml` also specifies `SHA256withRSA` as the `SignatureAlgorithm` for `AuthorizationContextTokenGeneration` .\\n\\n## Notes\\n\\nThe provided snippets primarily focus on the WSO2 Identity Server\\'s capabilities related to OAuth2, OpenID Connect, and FAPI. The system offers robust configuration and validation mechanisms for signature algorithms, including the use of SHA-256 for hashing and certificate thumbprint generation. While SHA-512 is not explicitly mentioned in the provided snippets for direct configuration or validation, the presence of SHA-256 and the extensibility of the platform suggest that SHA-512 could be supported or easily integrated. The `oidc-metadata.json` file is a test resource, but it reflects the configurable options and supported algorithms within the WSO2 Identity Server.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_284a70bf-691d-44fa-a44b-35854964529d\\n', 'id': 'lc_07078b7d-6ca0-4850-9d13-d0d327fc2a28'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0113_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports the validation of the algorithm parameter in the Signature header against the TPP\\'s public key certificate, specifically for JWTs. The system checks if the `alg` parameter in the JWT header matches the signature algorithm used for verification, supporting `SHA256withRSA`, `SHA512withRSA`, and `SHA384withRSA`. \\n\\n## Implementation Details\\n\\nThe core logic for validating the JWT signature, including the algorithm parameter, resides within the `isJwtSignatureValid` method in `APIMTestCaseUtils.java`.  This method extracts the `alg` parameter from the JWT header.  It then maps common JWT algorithm names (e.g., \"RS256\", \"RS512\", \"RS384\") to their corresponding Java Security API algorithm names (e.g., \"SHA256withRSA\", \"SHA512withRSA\", \"SHA384withRSA\").  If the `alg` parameter is not one of the explicitly handled values, it defaults to \"SHA256withRSA\". \\n\\nThe method proceeds to retrieve the TPP\\'s public key certificate using a thumbprint (`x5t`) extracted from the JWT header.   Finally, it initializes a `Signature` object with the determined algorithm and verifies the JWT signature against the certificate. \\n\\nThe `JWTGeneratorUtil.java` file also demonstrates how JWTs are generated with a specified signing algorithm, defaulting to `JWSAlgorithm.RS256` for the header.  This utility class builds the JWT header and body, then signs the JWT using the private key associated with a given alias and keystore.  \\n\\n## Configuration Options\\n\\nThe signature algorithm for JWTs can be configured in the `api-manager.xml` file.  The `<SignatureAlgorithm>` element within the `<JWTConfiguration>` section allows specifying the algorithm, with \"SHA256withRSA\" as a common default.  It accepts \"SHA256withRSA\" or \"NONE\" to disable signing. \\n\\nAdditionally, the `deployment.toml` file provides a `signing_algorithm` property under the `[apim.jwt]` section, which can be used to configure the JWT signing algorithm.  This configuration also defaults to \"SHA256withRSA\". \\n\\nFor WebSub subscriptions, the `WebsubSubscriptionConfigurationDTO` includes a `signingAlgorithm` property, indicating that the signing algorithm can be configured for WebSub related signatures as well. \\n\\n## API Endpoints or Features\\n\\nThe provided snippets do not directly expose specific API endpoints related to the signature header validation. However, the `APIMTestCaseUtils.java` file is part of integration tests, suggesting that this validation is an internal mechanism within the API Management platform.  The validation occurs during the processing of JWTs, which are commonly used for authentication and authorization in API gateways.\\n\\n## Documentation References\\n\\nThe configuration files, such as `api-manager.xml`  and `deployment.toml` , contain inline comments that serve as documentation for the `SignatureAlgorithm` and `signing_algorithm` parameters, respectively. These comments explain the accepted values and their purpose.\\n\\n## Notes\\n\\nThe `isJwtSignatureValid` method in `APIMTestCaseUtils.java` is an integration test utility.  While it demonstrates the logic for JWT signature validation, the actual production implementation might reside in different modules. The presence of this utility strongly indicates that the system performs such validation. The `JWTGeneratorUtil.java` file is also a test utility for generating JWTs.  The `WebsubSubscriptionConfigurationDTO` suggests that similar signature algorithm configurations might apply to WebSub, but the specific validation logic for WebSub signatures is not detailed in the provided snippets. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_098b4805-2770-45c1-8a84-d8f6ed6bc8a1\\n', 'id': 'lc_e20b612e-a2cf-4d78-abef-6206eea3a1eb'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0114",
      "requirement": {
        "requirement_id": "ATOM_215",
        "requirement_text": "The headers parameter in the Signature header must include digest and x-request-id",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0114_1",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_2",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_3",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_4",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_5",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the specific requirement of including `digest` and `x-request-id` in the `headers` parameter of a `Signature` header for HTTP message signing. The provided code snippets and wiki page primarily focus on OAuth2 and OpenID Connect protocols, token management, and FAPI conformance, which involve different aspects of security and signature validation.\\n\\nWhile there are mentions of digest algorithms and signature validation, they are in the context of SAML assertions and OAuth2 request objects, not HTTP message signing with a `Signature` header.\\n\\n## Implementation Details and Configuration Options\\n\\nThe codebase contains references to signature validation in different contexts:\\n\\n*   **SAML Assertions**: The `saml-idp.xml` file shows configuration for `DigestAlgorithm` for SAML assertions, with a default value of `MD5` . Similarly, `saml-metadata-super-tenant.json` lists various `responseDigestAlgorithm` options, including SHA256 and SHA512 . However, these are related to SAML message integrity, not HTTP `Signature` headers.\\n*   **OAuth2 Request Object Signature Validation**: The `OAuth2RequestObjectSignatureValidationTestCase.java` file demonstrates how to enable and test the validation of signatures for OAuth2 request objects . This is configured via the `validateRequestObjectSignature` property within `OpenIDConnectConfiguration` . This mechanism is for validating the integrity of the request object itself, not for signing HTTP requests with specific headers like `digest` and `x-request-id`.\\n*   **DPoP Proof Generation**: The `DPoPProofGenerator.java` file includes methods for generating and validating DPoP (Demonstrating Proof of Possession) proofs, which involve hashing access tokens (`generateAccessTokenHash`)  and computing key thumbprints . While DPoP involves cryptographic proofs and headers, it\\'s a specific mechanism for token binding and does not directly address the general HTTP `Signature` header requirement with `digest` and `x-request-id`.\\n*   **FAPI Conformance Tests**: The `resource-server.py` script in the `oidc-fapi-conformance-tests` directory performs FAPI validations, including checking for `X-Ssl-Cert` headers and computing SHA256 thumbprints from client certificates . It also validates that thumbprints from client certificates and access tokens match . This is related to client certificate-based authentication and FAPI security profiles, which are distinct from the requested HTTP `Signature` header.\\n\\n## API Endpoints or Features\\n\\nThe `OAuth2 and OpenID Connect` wiki page and `OIDCMetadataTest.java` list various OAuth2/OIDC endpoints such as `/oauth2/authorize`, `/oauth2/token`, `/oauth2/revoke`, `/oauth2/userinfo`, and `/oauth2/jwks` . None of these endpoints or their associated features explicitly mention support for an HTTP `Signature` header that includes `digest` and `x-request-id` as parameters for general HTTP message signing.\\n\\n## Documentation References\\n\\nThe provided wiki page on `OAuth2 and OpenID Connect` gives a high-level overview of the implementation but does not delve into the specifics of HTTP message signing with a `Signature` header including `digest` and `x-request-id` .\\n\\n## Notes\\n\\nThe prompt specifically asks about the `Signature` header in HTTP message signing, which is a standard defined in RFC 9421 (formerly RFC Draft HTTP Message Signatures). The provided codebase context, while extensive on OAuth2, OpenID Connect, and FAPI, does not contain any direct references or implementations related to this specific HTTP message signing standard or the inclusion of `digest` and `x-request-id` within its `headers` parameter. The mentions of \"digest\" and \"signature\" are in different security contexts (SAML, OAuth2 request objects, DPoP) and should not be conflated with the HTTP `Signature` header.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f3eebb16-e592-4824-94bf-d8cdddc810e0\\n', 'id': 'lc_0bdaa5bd-6ab5-496b-927f-96a5f8b33e1e'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0114_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not appear to directly support the explicit inclusion of `digest` and `x-request-id` within the `headers` parameter of a `Signature` header for signature calculation. While there are references to `Digest` authentication and `X-Hub-Signature` generation, there\\'s no direct evidence of a configurable mechanism to include arbitrary headers like `x-request-id` in a `Signature` header\\'s `headers` parameter.\\n\\n## Implementation Details\\n\\nThe codebase contains examples of `Digest` authentication, such as in the `dummy_digest_api.xml` files  and . These files demonstrate how an API can be configured to handle `Digest` authentication by checking for the `Authorization` header and sending a `WWW-Authenticate` header if it\\'s not present  . The `DigestAuthenticationTestCase.java` further illustrates the testing of such an API .\\n\\nThere is also a `WebsubSubscriptionConfigurationDTO.java` file that includes properties for `signingAlgorithm` and `signatureHeader`  . This suggests that signature headers are used in the context of WebSub subscriptions. The `websub_api_template.xml` shows the generation of an `X-Hub-Signature` header using `hmac-generate` and a `SUBSCRIBER_SECRET` . However, this is specific to `X-Hub-Signature` and does not indicate support for a generic `Signature` header with a configurable `headers` parameter including `digest` and `x-request-id`.\\n\\nThe `ApiClient.java` file contains methods for processing and updating header parameters  . While this allows for setting arbitrary headers, it doesn\\'t provide a mechanism to define which headers should be included in a `Signature` header\\'s `headers` parameter for signature calculation.\\n\\n## Configuration Options\\n\\nThe `deployment.toml` file  and `api-manager.xml` files   show various configuration options related to security, JWT generation, and authentication. For instance, `api-manager.xml` allows configuring the `SignatureAlgorithm` for JWTs . However, none of these configurations directly address the inclusion of specific headers like `digest` and `x-request-id` in a `Signature` header\\'s `headers` parameter for signature calculation.\\n\\n## API Endpoints or Features\\n\\nThe codebase includes API definitions that handle `Digest` authentication, as seen in `dummy_digest_api.xml` . The `WebsubSubscriptionConfigurationDTO` suggests that WebSub subscriptions involve signature headers . However, there is no explicit API endpoint or feature that allows a user to specify `digest` and `x-request-id` as headers to be included in the `headers` parameter of a `Signature` header for calculation.\\n\\n## Documentation References\\n\\nBased on the provided snippets, there are no direct documentation references that describe how to configure the inclusion of `digest` and `x-request-id` in the `headers` parameter of a `Signature` header.\\n\\n## Notes\\n\\nThe term \"digest\" appears in the context of `Digest` authentication  and not as a header to be included in a `Signature` header\\'s `headers` parameter. The `X-Hub-Signature` header generation is present , but this is a specific type of signature and not a generic `Signature` header. There is no mention of `x-request-id` in relation to signature calculation in the provided code.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_a4a1e876-707c-4843-9335-c132ac7bca3d\\n', 'id': 'lc_eeb921d7-92c2-499b-a131-19c69e0c30de'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0115",
      "requirement": {
        "requirement_id": "ATOM_077",
        "requirement_text": "The system shall validate eIDAS certificates in payment initiation requests",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0115_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support eIDAS certificate validation, particularly in the context of payment initiation requests. The system includes a feature group for X.509 certificate validation and has components related to rich authorization requests and Financial-grade API (FAPI) compliance.\\n\\n## Implementation Details\\nThe core of eIDAS certificate validation seems to be handled by the `org.wso2.carbon.extension.identity.x509Certificate.validation.server.feature.group` feature . This feature is included in the product\\'s P2 profile generation, indicating it\\'s a deployable component of the WSO2 Identity Server . Additionally, there\\'s a dependency on `org.wso2.carbon.extension.identity.authenticator.x509Certificate.connector` which suggests an authenticator component for X.509 certificates .\\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` file, although a test resource, demonstrates how client certificates are handled and validated in a FAPI context . Specifically, the `getThumbprintFromClientCertificate` function extracts the `X-Ssl-Cert` header and computes a SHA256 thumbprint, which is then compared against a thumbprint from the access token . This indicates a mechanism for client certificate-based authentication and proof-of-possession.\\n\\n## Configuration Options\\nWhile specific configuration files for eIDAS are not directly visible, the system\\'s architecture includes a \"Configuration System\" that uses `default.json`, `infer.json`, and Jinja2 templates for dynamic configuration . It is likely that the X.509 certificate validation feature would have configurable parameters within this system.\\n\\n## API Endpoints or Features\\nThe `OAuth2RichAuthorizationRequestsTestCase` includes tests for \"payment_initiation\" as an `AuthorizationDetailsType` . This suggests that the system is designed to handle authorization details specifically for payment initiation requests. The `AuthorizationDetailsType` model defines a schema that can include details like `type`, `actions`, `locations`, and `instructedAmount` for payment initiation . The system also exposes an OIDC metadata endpoint that lists supported authorization details types, which would include `payment_initiation` if configured .\\n\\n## Documentation References\\nThe provided context does not include direct documentation references for eIDAS certificate validation. However, the \"Architecture\" wiki page mentions \"Protocol Support\" including FAPI, which is relevant to secure payment initiation .\\n\\n## Notes\\nThe term \"eIDAS certificates\" is not explicitly found in the provided code snippets. However, the presence of `org.wso2.carbon.extension.identity.x509Certificate.validation.server.feature.group`  and the X.509 authenticator connector  strongly suggests support for X.509 certificate validation, which is a core component of eIDAS. The `payment_initiation` authorization details type  indicates that the system is designed to handle payment-related requests, making the combination of X.509 validation and payment initiation highly relevant to the user\\'s query. The FAPI conformance tests also reinforce the system\\'s capability in secure financial transactions .\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_1e509539-2c7b-4fe1-8061-4cdc7971fa7f\\n', 'id': 'lc_2c872c62-5c48-4ad2-bf1b-372e6f4c83b2'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0115_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports certificate validation, including certificate chain validation and revocation checks, which are crucial for eIDAS certificate validation in payment initiation requests. The system allows for the configuration of these validation mechanisms and provides API endpoints for managing client certificates.\\n\\n## Implementation Details\\nThe WSO2 API Manager (APIM) product, specifically within the `wso2/product-apim` repository, implements certificate validation through its transport receivers. The `axis2.xml.j2` template files, found in both `all-in-one-apim/modules/distribution/product/src/main/resources/conf/templates/repository/conf/axis2/axis2.xml.j2`  and `gateway/modules/distribution/product/src/main/resources/conf/templates/repository/conf/axis2/axis2.xml.j2` , contain parameters for `CertificateRevocationVerifier`. This verifier can be enabled to perform certificate revocation validation, full chain validation, and expiry validation. \\n\\nThe integration tests demonstrate the functionality of mutual SSL and certificate chain validation. For instance, `APISecurityMutualSSLCertificateChainValidationTestCase.java`  shows how APIs can be configured with `mutualssl` and `mutualssl_mandatory` security schemes.  It also includes tests for uploading root and intermediate certificates and verifying API invocation with different certificates in the chain.  \\n\\n## Configuration Options\\nCertificate validation can be configured through the `axis2.xml.j2` files. The following parameters are available for configuration:\\n*   `transport.passthru_https.listener.cert_revocation_validation.enable`: Enables or disables certificate revocation validation. \\n*   `transport.passthru_https.listener.cert_revocation_validation.cache_size`: Configures the cache size for revocation checks. \\n*   `transport.passthru_https.listener.cert_revocation_validation.cache_delay`: Sets the cache delay for revocation checks. \\n*   `transport.passthru_https.listener.cert_revocation_validation.allow_full_cert_chain_validation`: Enables or disables full certificate chain validation. \\n*   `transport.passthru_https.listener.cert_revocation_validation.allow_cert_expiry_validation`: Enables or disables certificate expiry validation. \\n\\nThese parameters are used within the `transportReceiver` configuration for HTTPS listeners. \\n\\n## API Endpoints or Features\\nThe system provides API endpoints for managing client certificates. The `ClientCertificatesApi`  allows for retrieving client certificate content by API ID and alias. \\n\\nAdditionally, the `EndpointCertificatesApi`  provides operations for:\\n*   Uploading new certificates for an endpoint using `addEndpointCertificate`. \\n*   Retrieving all APIs that use a given certificate by alias using `getCertificateUsageByAlias`. \\n*   Retrieving and searching uploaded certificates using `getEndpointCertificatesWithHttpInfo`. \\n\\nThese APIs are used in integration tests like `APISecurityMutualSSLCertificateChainValidationTestCase.java` to upload certificates and configure APIs for mutual SSL. \\n\\n## Documentation References\\nThe `ClientCertificatesApi.md`  and `EndpointCertificatesApi.md`  files provide documentation for the respective API endpoints, including parameters, return types, and HTTP response details.\\n\\n## Notes\\nThe provided snippets indicate strong support for certificate validation, including chain and revocation checks, which are essential for eIDAS compliance. The configuration options are available in the `axis2.xml.j2` files, and the `ClientCertificatesApi` and `EndpointCertificatesApi` provide programmatic access for managing certificates. The integration tests confirm the functionality of these features. While the term \"eIDAS\" is not explicitly mentioned in the code, the underlying certificate validation mechanisms are directly applicable to eIDAS certificates.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_cf25c528-6cd3-444e-94ad-7d1f8e8dd1d1\\n', 'id': 'lc_04033b99-10df-4e81-97cf-b4e16dc3931a'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0116",
      "requirement": {
        "requirement_id": "ATOM_184",
        "requirement_text": "The card account details response MUST include a cardAccount object containing Card Account Details.",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0116_1",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_2",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_3",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_4",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_5",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0116_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the inclusion of card account details in account responses, specifically within the context of Open Banking APIs. The `account-info-swagger.yaml` defines the API structure, and the `AccountService.java` in the demo backend provides an example implementation of how account details, including card-related information, are returned.  \\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` repository, specifically within the `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml` file, defines the API specification for account information. \\n\\nThe `OBAccount4` definition, which is used in the responses for retrieving account details, includes fields such as `AccountType` and `AccountSubType`.  The `AccountSubType` enum explicitly lists `ChargeCard`, `CreditCard`, and `PrePaidCard` as possible values, indicating support for various card account types. \\n\\nFurthermore, the `OBAccount4` definition contains an `Account` array, where each item can include `SchemeName`, `Identification`, `Name`, and `SecondaryIdentification`.  The `SchemeName` can be `UK.OBIE.PAN`, which refers to a Primary Account Number, a common identifier for card accounts. \\n\\nAn example implementation of an account details response can be found in the `AccountService.java` file within the demo backend.  This service provides a `/accounts` endpoint that returns a JSON structure containing an `Account` object.   Within this `Account` object, there is an inner `Account` array that includes `SchemeName` and `Identification`, demonstrating how card account details like \"SortCodeAccountNumber\" and an account ID are represented. \\n\\n## API Endpoints and Features\\n\\nThe relevant API endpoints are defined in `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml`. \\n\\n*   **GET /accounts**: This endpoint is used to retrieve a list of accounts.  The successful response (`200AccountsRead`) refers to the `OBReadAccount5` definition, which contains the `Account` object. \\n*   **GET /accounts/{AccountId}**: This endpoint retrieves details for a specific account.  The successful response (`200AccountsAccountIdRead`) refers to the `OBReadAccount4` definition, also containing the `Account` object. \\n\\nThe `Account` object within these responses is where the card account details would be present, as defined by the `OBAccount4` schema.  \\n\\n## Documentation References\\n\\nThe `Overview` wiki page for the `wso2/financial-services-accelerator` repository mentions that the accelerator implements regulatory standards for Open Banking APIs, including account information services.  The API specifications section of the wiki further details the \"Account Information APIs\" which include endpoints for `Accounts`.  \\n\\nThe `permissionDataLanguage.js` file also indicates that \"Your card number\" is a piece of information that can be shared under the `ReadAccountsDetail` scope, which aligns with the concept of providing card account details. \\n\\n## Notes\\n\\nThe term \"cardAccount object\" as a top-level entity is not explicitly found in the provided `account-info-swagger.yaml`.  Instead, card-related details are integrated within the `Account` object, specifically through the `AccountSubType` field (e.g., `CreditCard`, `ChargeCard`) and the nested `Account` array which can contain `SchemeName` like `UK.OBIE.PAN` (Primary Account Number).     The demo backend\\'s `AccountService.java` also reflects this structure. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_aabb494c-7518-4307-b51d-47747ad110f3\\n', 'id': 'lc_836f76c7-cfe6-491a-8245-38c04f1f7b13'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0117",
      "requirement": {
        "requirement_id": "ATOM_107",
        "requirement_text": "The payment-service path parameter SHALL accept values 'payments', 'bulk-payments', and 'periodic-payments'",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0117_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_2",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_3",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_4",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_5",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0117_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports payment services, but the specific path parameter values \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\' as a single path parameter are not directly evident in the provided API definitions. The API definitions show distinct paths for different payment-related functionalities.       The system uses separate endpoints for payment consents and payments, and the concept of \\'bulk-payments\\' or \\'periodic-payments\\' as distinct path parameters is not explicitly defined in the OpenAPI specification for Payment Initiation.  \\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` repository includes an OpenAPI specification for Payment Initiation, which defines several endpoints related to payments. \\n\\n### API Endpoints and Features\\n\\nThe `payment-initiation-openapi.yaml` file defines the following payment-related API endpoints:\\n*   `/payment-consents`: Used for creating payment consents via a `POST` request. \\n*   `/payment-consents/{consentId}`: Used for retrieving specific payment consents via a `GET` request. \\n*   `/payment-consents/{consentId}/funds-confirmation`: Used for getting funds confirmation for a payment consent via a `GET` request. \\n*   `/payments`: Used for creating payments via a `POST` request. \\n*   `/payments/{paymentId}`: Used for retrieving specific payments via a `GET` request. \\n\\nThe `PaymentService.java` in the demo backend also exposes a `/paymentservice/payments` endpoint for payment submission and `/paymentservice/payment-consents/{ConsentId}/funds-confirmation` for funds confirmation.   \\n\\nThe `ConnectorTestConstants.groovy` file defines various payment-related paths, including `PAYMENT_CONSENT_PATH`, `PAYMENT_SUBMISSION_PATH`, `CONSENT_PATH_DOMESTIC`, `CONSENT_PATH_SCHEDULE`, `CONSENT_PATH_STANDING_ORDERS`, `SUBMISSION_PATH_DOMESTIC_PAYMENTS`, `SUBMISSION_PATH_DOMESTIC_SCHEDULE`, and `SUBMISSION_PATH_DOMESTIC_STANDING_ORDERS`.         These constants suggest that the system differentiates between domestic payments, scheduled payments, and standing orders, which align with the concepts of \\'payments\\', \\'periodic-payments\\' (scheduled payments/standing orders), and potentially \\'bulk-payments\\' (though not explicitly named as such).  \\n\\nThe `FSDefaultAuthServletImpl.java` class handles different consent types, including `PAYMENTS` and `FUNDS_CONFIRMATIONS`, which are mapped to specific utility functions for populating data. \\n\\n## Configuration Options\\n\\nThe `ConnectorTestConstants.groovy` file defines constants for various payment consent and submission paths.   These constants are used in the test framework to construct request payloads and paths for different payment types. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page mentions \"Payment Initiation APIs\" as one of the API categories supported by the accelerator.  It also refers to `payment-initiation-openapi.yaml` as a source for API specifications. \\n\\n## Test Criteria\\n\\nThe `fs-integration-test-suite` contains test frameworks that define constants for various payment-related paths, including domestic, scheduled, and standing order payments.   This suggests that the system is designed to handle and test these different payment types. The `ConsentDataProviders.groovy` file further indicates that different initiation payloads and paths are used for various consent types, including payments. \\n\\n## Notes\\n\\nWhile the prompt specifically asks for a single `payment-service` path parameter accepting \\'payments\\', \\'bulk-payments\\', and \\'periodic-payments\\', the codebase indicates that these are handled as distinct API paths or types rather than values for a single path parameter. For example, `/payments` is a path for general payments, while `/domestic-scheduled-payment-consents` and `/domestic-standing-order-consents` are separate paths for periodic payments.   The term \\'bulk-payments\\' is not explicitly found as a path parameter value, but the system\\'s ability to handle different payment types suggests that such functionality might be implemented through specific API endpoints or request body structures rather than a path parameter.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_f37efdd4-c633-4496-870b-95c4a77988e8\\n', 'id': 'lc_586eaeb1-6347-45e5-b579-e6b20e8dc416'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0118",
      "requirement": {
        "requirement_id": "ATOM_071",
        "requirement_text": "The system shall support consent status 'terminatedByTpp' when AIS has terminated the consent",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0118_1",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0118_2",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0118_3",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0118_4",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0118_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0118_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports consent management, including the ability to define purposes, PII categories, and record consent receipts. However, based on the provided code snippets, there is no explicit mention or implementation of a consent status `\\'terminatedByTpp\\'` or functionality for a Third Party Provider (TPP) to terminate consent. The existing consent management features primarily focus on user consent collection and enforcement during authentication and self-registration processes.\\n\\n## Implementation Details\\n\\nThe consent management framework in `wso2/product-is` allows for the creation and management of PII categories, purposes, and consent receipts . The `ConsentMgtTestCase.java` file demonstrates how to add PII categories, purpose categories, purposes, and consent receipts via REST API calls .\\n\\nThe `default_receipt.jag` file in the `consent_management` gadget is responsible for loading and populating default consent receipt information, including service details, purposes, and PII categories . It handles the `termination` field for purposes, which is set to `DATE_UNTIL:INDEFINITE` or `INFINITE_TERMINATION` in the provided examples  . However, there is no specific value like `\\'terminatedByTpp\\'` or logic to handle such a termination event.\\n\\n## Configuration Options\\n\\nThe `default-identity.xml` configuration file includes a `<Consent>` section with an `<EnableSSOConsentManagement>` flag, which can be set to `true` to enable consent management during SSO . This indicates that consent is an integral part of the SSO flow.\\n\\nThe `UserConsentEnabledGrantTypes` section in `default-identity.xml` specifies which OAuth2 grant types will filter user claims based on user consent in their responses . This configuration ensures that only consented claims are released.\\n\\n## API Endpoints or Features\\n\\nThe consent management functionality is exposed through REST API endpoints under `/api/identity/consent-mgt/v1.0/consents` . These endpoints allow for:\\n*   Adding PII categories: `POST /api/identity/consent-mgt/v1.0/consents/pii-categories` \\n*   Adding purpose categories: `POST /api/identity/consent-mgt/v1.0/consents/purpose-categories` \\n*   Adding purposes: `POST /api/identity/consent-mgt/v1.0/consents/purposes` \\n*   Adding consent receipts: `POST /api/identity/consent-mgt/v1.0/consents` \\n\\nThe `SelfSignUpConsentTest.java` file also shows how to retrieve consents for a user using a GET request to the consent endpoint .\\n\\nWhile these APIs allow for managing consent, there is no explicit API or feature demonstrated in the provided snippets that allows a TPP to terminate consent and set a status like `\\'terminatedByTpp\\'`. The existing `termination` field in consent receipts appears to be related to the duration of the consent rather than an external termination event .\\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, describing it as a framework to collect, store, and manage user consent for personal data processing . It outlines key components like PII Categories, Purposes, Purpose Categories, and Consent Receipts . The wiki also mentions that consent decisions affect token issuance and API responses, ensuring only consented attributes are shared . However, it does not detail any mechanism for TPP-initiated consent termination or the `\\'terminatedByTpp\\'` status.\\n\\n## Conclusion\\n\\nBased on the provided codebase context, the `wso2/product-is` repository supports a robust consent management system for collecting and enforcing user consent. However, there is no direct evidence or implementation details within the provided snippets that explicitly support a consent status of `\\'terminatedByTpp\\'` or a mechanism for a Third Party Provider to terminate consent. The existing `termination` field seems to relate to the consent\\'s validity period rather than an external termination action.\\n\\n## Notes\\n\\nThe provided snippets primarily focus on the creation and retrieval of consent-related entities and the enforcement of consent during authentication flows. The concept of a TPP terminating consent and a specific status like `\\'terminatedByTpp\\'` is not directly addressed in the available code or documentation. Further investigation into the core consent management modules beyond the integration tests and configuration files would be necessary to definitively confirm or deny this capability.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_48e7c0a0-b1fb-4cad-bad4-49e8d0bc0a1b\\n', 'id': 'lc_f8ce766d-3e2b-4346-bbbe-3d66173a2fe5'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0118_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_85b7acc0-6bc3-402f-9182-982067ffb72f'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0119",
      "requirement": {
        "requirement_id": "ATOM_123",
        "requirement_text": "The TPP-Redirect-URI header SHALL be mandatory for the Redirect SCA Approach when TPP-Redirect-Preferred equals true",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0119_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_2",
          "text": "### Step 2: Sign in to the Developer Portal as the TPP\n\n1. Now, sign in to the [Developer portal](https://<APIM_HOST>:9443/devportal) as the TPP.\n\n2. Enter the username and the password you entered when signing up as a TPP.\n\n3. Click Continue. Now, you are on the home page of the Developer Portal.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_3",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_4",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_5",
          "text": "## How WSO2 Open Banking supports App-to-App redirection [ ![](../assets/img/learn/app-to-app-redirection/app-to-app-redirection-sequence-flow.png) ](../assets/img/learn/app-to-app-redirection/app-to-app-redirection-sequence-flow.png) WSO2 Open Banking supports the App-to-App redirection flow as follows: The API consumer mobile application invokes the `authorize` endpoint, similar to a basic browser-based auth-code/hybrid redirect flow. When the bank\u2019s mobile application is installed in the customer\u2019s device with a deep link connected to this authorize request, the request is handled by the bank\u2019s mobile application instead of the browser. !!! note If the bank\u2019s mobile application is not available in the customer\u2019s device, the customer is taken through a typical browser-based flow. Once the mobile application handles the customer authentication and consent, it obtains a callback URI. This is the URL to the API consumer application. Using deep links, the bank application redirects the customer to the API consumer\u2019s mobile application. Here, similar to the initial scenario, the callback URI is deep linked to the API consumer\u2019s mobile application. Using this, the flow continues from the bank\u2019s mobile application to the API consumer\u2019s mobile application again. In the App-to-App redirection method, the flow should be handled in the bank\u2019s mobile application as follows: 1. The bank\u2019s mobile application is opened using the deep link. 2. The application invokes the `/authorize` endpoint to initiate the authorization flow. The response redirect is sent by an authenticator that is customized to the app-based flow. !!! note You need to configure custom authenticators that address the requirements of both browser-based and app-based redirection flows. For more information, see [Adding Custom Authenticators](https://is.docs.wso2.com/en/5.11.0/develop/writing-a-custom-local-authenticator/#writing-a-custom-local-authenticator). If this is not an error page or application callback redirect, the application can gain the authentication of the bank customer. For example, using biometrics. !!! info Based on the user agent of the auth request in the adaptive authentication script, a mobile app-based flow can be detected. This states which authenticators need to be invoked in each scenario. 3. Once the authentication is provided, a `/commonauth` request has to be made. This is processed by the authenticator mentioned above. In a biometric scenario, since the verification happens in the mobile application, this request should guarantee non-repudiation and client identification. Given below is a sample request, modify the payload according to your requirements: ``` cURL curl -X POST \\ https://<IS_HOST>:9446/commonauth \\ -H 'Content-Type: application/x-www-form-urlencoded' \\ -d 'sessionDataKey=value&username=value&password=value' ``` - It is recommended to have a key pair for the mobile application. So that the response can be included with a signed JWT, which helps to identify the client with guaranteed non-repudiation. 4. Successful authentication prompts a redirection response to the consent page that contains `sessionDataKeyConsent`. This value is extracted and will be used in the next step. 5. The `authorize/retrieve` request has to be sent with the `SessionDataKeyConsent`. This is to retrieve the data that is required to display on the consent page. 6. After the user approves/denies the consent and selects the accounts, a `PATCH authorize/persist` request is made to persist the consent information. 7. Finally, if the persistence is successful, to complete the flow the `/authorize` endpoint is invoked. This results in a redirection to the callback URL of the API",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'The provided codebase, specifically within the WSO2 Identity Server, does not directly reference \"TPP-Redirect-URI\" or \"TPP-Redirect-Preferred\" headers, which appear to be specific to a Financial-grade API (FAPI) or similar standard for Strong Customer Authentication (SCA) <cite/>. However, the codebase does implement OAuth 2.0 and OpenID Connect, which are foundational protocols for such requirements, and includes mechanisms for handling `redirect_uri` parameters and dynamic client registration  .\\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server supports OAuth 2.0 and OpenID Connect, which are relevant to the context of redirect URIs . The `redirect_uri` parameter is a standard part of OAuth 2.0 authorization requests .\\n\\nThe `OAuth2Constant.java` file defines the constant `OAUTH2_REDIRECT_URI` , which is used in various OAuth 2.0 flows. For instance, in the `OAuth2CommonClient.java`, the `sendAuthorizeGet` method takes a `redirectUri` as a parameter and includes it in the authorization request .\\n\\nThe `OAuth2ServiceAuthCodeGrantTestCase.java` includes tests that verify the behavior when `redirect_uri` is missing or invalid . Specifically, the `testInvalidRedirectUri` method asserts that an error response is redirected to a default OAuth error URL if the `redirect_uri` parameter is not provided in the authorization request . This indicates that the `redirect_uri` is a mandatory component for certain OAuth 2.0 flows.\\n\\n## Configuration Options\\n\\nDuring Dynamic Client Registration (DCR), `redirect_uris` are registered for an OAuth 2.0 application . The `OAuthDCRMTestCase.java` demonstrates that an OAuth application registration with the `authorization_code` grant type requires `redirect_uris` to be provided . If `redirect_uris` are empty, the registration fails with a 400 Bad Request status code . This implies that the system enforces the presence of `redirect_uris` for certain grant types.\\n\\n## API Endpoints or Features\\n\\nThe `redirect_uri` is used in the `/oauth2/authorize` endpoint . The `OAuth2RestClient.java` shows the `initiateAuthRequest` method which constructs an authorization request including the `redirectUrl` parameter .\\n\\n## Documentation References\\n\\nThe \"Features and Capabilities\" wiki page mentions comprehensive support for OAuth 2.0 and OpenID Connect protocols, including various grant types and advanced OAuth features . While it doesn\\'t explicitly mention \"TPP-Redirect-URI\" or \"TPP-Redirect-Preferred\", the underlying mechanisms for handling `redirect_uri` are well-established within the OAuth 2.0 framework that WSO2 Identity Server implements .\\n\\n## Notes\\n\\nThe terms \"TPP-Redirect-URI\" and \"TPP-Redirect-Preferred\" are not directly found in the provided code snippets. These terms are typically associated with specific profiles of Open Banking or Financial-grade API (FAPI) standards, which build upon OAuth 2.0 and OpenID Connect. The codebase demonstrates strong enforcement of the standard `redirect_uri` parameter in OAuth 2.0 flows and during dynamic client registration. It is highly probable that if a FAPI or similar profile is implemented, the \"TPP-Redirect-URI\" would map to the standard `redirect_uri` and its mandatory nature would be enforced through the existing OAuth 2.0 validation mechanisms. To confirm the exact behavior for \"TPP-Redirect-URI\" and \"TPP-Redirect-Preferred\", further investigation into specific FAPI-related modules or configurations within the WSO2 Identity Server would be necessary.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0221014e-9e2e-460e-91b3-bf968ab38820\\n', 'id': 'lc_099c9f65-433a-4726-b9b5-f9eb1c194e84'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0119_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_19cf9c85-30fb-4c2b-bee1-edce3ce0f77b'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0120",
      "requirement": {
        "requirement_id": "ATOM_026",
        "requirement_text": "TPPs SHALL be identified by PSD2 related eIDAS certificates as mandated by PSD2.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0120_1",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0120_2",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0120_3",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0120_4",
          "text": "The TPPs can create OAuth 2.0 client applications to facilitate banking services exposed via Bank APIs. WSO2 Open Banking provides the Client Registration feature to register the applications in the bank's back end. The TPP applications go through an in-depth verification during this process to make sure the application is authorized and secured before sharing customers\u2019 financial data.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0120_5",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0120_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the identification of Third-Party Providers (TPPs) using PSD2-related eIDAS certificates, specifically through Mutual TLS (mTLS) client authentication. This is primarily implemented within the OAuth2/OpenID Connect framework, particularly for Financial-grade API (FAPI) compliance.   \\n\\n### Implementation Details\\nThe system supports `tls_client_auth` (Mutual TLS) as a `token_endpoint_auth_method` for client authentication.   This method is explicitly listed as an option for FAPI metadata, indicating its relevance for financial-grade API security.  Additionally, the system can be configured to use `tls_client_certificate_bound_access_tokens`, which binds access tokens to the client\\'s TLS certificate, enhancing security. \\n\\nThe `IdentityProviderPOSTRequest.Certificate` class includes fields for `certificates` (a list of strings) and `jwksUri` for managing identity provider certificates.  This suggests that certificates can be provided directly or referenced via a JWKS URI.  \\n\\n### Configuration Options\\nConfiguration for mTLS and certificate handling can be found in several places:\\n*   **Application Metadata**: The `oidc-metadata.json` file defines available options for `tokenEndpointAuthMethod`, including `tls_client_auth` (Mutual TLS).  \\n*   **FAPI Conformance Tests**: The `constants_fapi.py` file shows how applications are configured for FAPI compliance, including setting `token_endpoint_auth_method` to `tls_client_auth` and enabling `tls_client_certificate_bound_access_tokens`.  \\n*   **Identity Provider Configuration**: When configuring an Identity Provider, certificates can be added directly or via a JWKS URI using the `IdentityProviderPOSTRequest.Certificate` model.  This is demonstrated in `IdPSuccessTest.java` where JWKS URI and certificates are patched for an Identity Provider.  \\n\\n### API Endpoints or Features\\nThe relevant API features include:\\n*   **Dynamic Client Registration (DCR)**: The `DCR_BODY` in `constants_fapi.py` indicates that `tls_client_certificate_bound_access_tokens` can be set during client registration.  The `DCR_ENDPOINT` is `/api/identity/oauth2/dcr/v1.1/register`. \\n*   **Identity Provider Management API**: The Identity Provider API allows for updating certificate information, including JWKS URIs and direct certificate uploads.   The base path for this API is `IDP_API_BASE_PATH`. \\n*   **Token Endpoint**: The `TOKEN_ENDPOINT` is `/oauth2/token`.  This endpoint would be used by TPPs to obtain tokens after successful authentication using their eIDAS certificates.\\n\\n### Documentation References\\nThe \"Features and Capabilities\" wiki page mentions \"Financial-grade API (FAPI) Support\" and \"DPoP (Demonstrating Proof of Possession)\" as advanced security features, which are relevant to PSD2 compliance.   The \"OAuth2 and OpenID Connect\" wiki page further details FAPI conformance testing. \\n\\n## Notes\\nThe provided snippets strongly indicate support for PSD2-related eIDAS certificates through the implementation of Mutual TLS (mTLS) client authentication and FAPI compliance. The `tls_client_auth` method and `tls_client_certificate_bound_access_tokens` are key indicators. While the term \"eIDAS\" is not explicitly found in the snippets, the underlying mechanisms for certificate-based authentication and FAPI support align with the requirements for TPP identification using such certificates. The `OAuth2RequestObjectSignatureValidationTestCase.java` file, while related to certificate handling, focuses on signed request object validation rather than TPP identification via eIDAS certificates. \\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6a4e294f-d0c1-4cbd-955a-eb14cab68703\\n', 'id': 'lc_0ec7a1d2-4be8-4ebf-a4b0-e750acdccf33'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0120_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_79d86ebf-15a2-4c1e-b944-2b8a5879cf96'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0121",
      "requirement": {
        "requirement_id": "ATOM_185",
        "requirement_text": "The GET /v1/card-accounts/{account-id}/balances endpoint SHALL return HTTP response code 200 on successful balance retrieval.",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0121_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_3",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_4",
          "text": "### Authorize a consent\n\nThe bank sends the request to the customer stating the accounts and information that the API consumer wishes to access.\n    \n       \n  1. Generate the request object by signing the following JSON payload using the supported algorithms. Given below is \n  a sample request object in the JWT format:\n  \n      ``` tab='Sample'\n      eyJraWQiOiJfTG03VFVWNF8yS3dydWhJQzZUWTdtel82WTQxMlhabG54dHl5QXB6eEw4IiwiYWxnIjoiUFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJtYXhfYWdlIjo4NjQwMCwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OTQ0Ni9vYXV0aDIvdG9rZW4iLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImlzcyI6IjRoWklMQVRmUHlYbExGcWtQM1owT0JZaG1Ed2EiLCJjbGFpbXMiOnsiaWRfdG9rZW4iOnsiYWNyIjp7InZhbHVlcyI6WyJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpjYSJdLCJlc3NlbnRpYWwiOnRydWV9LCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOnsidmFsdWUiOiI4NmM4YTA4NS1hNDQ0LTQyZDUtYmU0My05NjhiMzY2YTU0NjciLCJlc3NlbnRpYWwiOnRydWV9fSwidXNlcmluZm8iOnsib3BlbmJhbmtpbmdfaW50ZW50X2lkIjp7InZhbHVlIjoiODZjOGEwODUtYTQ0NC00MmQ1LWJlNDMtOTY4YjM2NmE1NDY3IiwiZXNzZW50aWFsIjp0cnVlfX19LCJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIsInJlZGlyZWN0X3VyaSI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3RhdGUiOiJZV2x6Y0Rvek1UUTIiLCJleHAiOjE2MzM1ODY0MDgsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiY2xpZW50X2lkIjoiNGhaSUxBVGZQeVhsTEZxa1AzWjBPQllobUR3YSJ9.LytrdYnlos_hq5p21KVf8P0KkixetUseR1RnhMLtvQJOZow2vspm-XGltU5b4ciFdfdvkRvOh4qSjFozrYabMDToUnSDjoxyLTi5e5kBld81SyWeCt2XQwMV1qQdS4N-ISuTHHUsECox73-rF5kRmi_8RFfJSi2fUjtXkGZpo5JhQIJ1v37IQrOi3RlPhhH33kiVataXtWP1Dy5c28xAKXFaMkm7apRT5X6Rf1s34A9iouQuuxdVi6PCrwFutbYZnrNwy8EW7UMI7YNZsrkfhcXgJt0BMMsgNdIhYXdr7Ui3_q-ICi6zMRQuov0yTbVuHEkjsK2u81EIV3e2C_u_Jg\n      ```\n      \n      ``` tab='Format'\n      {\n        \"kid\": \"<The KID value of the signing jwk set>\",\n        \"alg\": \"<SUPPORTED_ALGORITHM>\",\n        \"typ\": \"JWT\"\n      }\n      {\n        \"max_age\": 86400,\n            \"aud\": \"<This is the audience that the ID token is intended for. Example: https://<IS_HOST>:9446/oauth2/token>\",\n        \"scope\": \"accounts openid\",\n        \"iss\": \"<CLIENT_ID>\",\n        \"claims\": {\n          \"id_token\": {\n            \"acr\": {\n              \"values\": [\n                \"urn:openbanking:psd2:sca\",\n                \"urn:openbanking:psd2:ca\"\n              ],\n              \"essential\": true\n            },\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          },\n          \"userinfo\": {\n            \"openbanking_intent_id\": {\n              \"value\": \"<CONSENTID>\",\n              \"essential\": true\n            }\n          }\n        },\n        \"response_type\": \"code id_token\",  \n        \"redirect_uri\": \"<CLIENT_APPLICATION_REDIRECT_URI>\",\n        \"state\": \"YWlzcDozMTQ2\",\n        \"exp\": <The expiration time of the request object in Epoch format>,\n        \"nonce\": \"<PREVENTS_REPLAY_ATTACKS>\",\n        \"client_id\": \"<CLIENT_ID>\"\n      }\n      ```\n      \n  2. The request that the bank sends to the customer is in the format of a URL as follows: \n         \n    ``` url tab=\"Sample\"\n    https://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=LvbSjaOIUPmAWZT8jdzyvjqCqY8a&redirect_uri=https://wso2.com&scope=openid accounts&state=0pN0NBTHcv&nonce=jBXhOmOKCB&request=<REQUEST_OBJECT>\n    ```\n   \n    ``` url tab=\"Format\"\n    https://<IS_HOST>:9446/oauth2/authorize?response_type=code%20id_token&client_id=<CLIENT_ID>&scope=accounts%20op\n    enid&redirect_uri=<APPLICATION_REDIRECT_URI>&state=YWlzcDozMTQ2&request=<REQUEST_OBJECT>&prompt=login&nonce=<REQUEST_OBJECT_NONCE>\n    ```\n    \n  3. Change the value of the `<CLIENT_ID>` placeholder with the value you obtained in the application registration.\n    \n  4. Upon successful authentication, the user is redirected to the consent authorize page. Use the login \n  credentials of a user that has a `subscriber` role. \n    \n  5. You can view the list of bank accounts and the information that the API consumer wishes to access.\n     ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png)  \n  \n  6. Data requested by the consent such as permissions, transaction period, and expiration date are displayed. \n  Click **Confirm** to grant these permissions.\n    ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) \n  \n  7. Upon providing consent, an authorization code is generated on the URL of the web page defined in `redirect_uri`.\n  See the sample given below:\n  \n    - The authorization code from the below URL is in the code parameter (`code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775`).\n  \n      ```\n      https://wso2.com/#code=e61579c3-fe9c-3dfe-9af2-0d2f03b95775&id_token=eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1\n      NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5\n      a4f936c74e2ca7f4250208aa42.sk_04ejciXBj6DnpALyYaw\n      ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_5",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0121_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports the `GET /accounts/{AccountId}/balances` endpoint, which is designed to return an HTTP 200 status code upon successful balance retrieval.  This functionality is defined in the OpenAPI specification and implemented in a demo backend service.   Integration tests also confirm this behavior. \\n\\n## Implementation Details\\n\\nThe `GET /accounts/{AccountId}/balances` endpoint is specified in the `account-info-swagger.yaml` file.  This specification indicates that a successful response will have a `200` status code, referencing the `#/responses/200AccountsAccountIdBalancesRead` definition for the response structure.  The `200AccountsAccountIdBalancesRead` response is described as \"Balances Read\" and includes a schema reference to `#/definitions/OBReadBalance1`.  The `OBReadBalance1` definition outlines the expected structure of the balance data, including `AccountId`, `CreditDebitIndicator`, `Type`, `DateTime`, and `Amount`. \\n\\nA demo backend service, `AccountService.java`, implements this endpoint.  The `getAccountBalance` method in this service is annotated with `@GET` and `@Path(\"/accounts/{AccountId}/balances\")`, and it explicitly returns an HTTP 200 status code with a hardcoded JSON response representing account balance data. \\n\\n## API Endpoints and Features\\n\\nThe relevant API endpoint is `/open-banking/{version}/aisp/accounts/{AccountId}/balances`.   This endpoint is part of the Account Information Service Provider (AISP) APIs.  The `x-scope` for this operation is `accounts`, indicating the required OAuth scope for accessing this resource. \\n\\n## Test Criteria\\n\\nThe `EndToEndAccountFlowTest.groovy` integration test verifies that a `GET` request to the balances endpoint returns an HTTP 200 status code.  Specifically, the test method `\"Verify Accounts balances Retrieval Request for a Authorised Consent\"` sets the `accountsPath` to `ConnectorTestConstants.BALANCES_SINGLE_PATH` and asserts that `retrievalResponse.statusCode()` is equal to `ConnectorTestConstants.STATUS_CODE_200`.  The `BALANCES_SINGLE_PATH` constant is defined as `ACCOUNTS_PATH + \"/\" + accountID + \"/balances\"`. \\n\\n## Notes\\n\\nThe provided context does not include specific configuration options directly related to the HTTP 200 response for this endpoint, as the response code is part of the API specification and implementation.   The `AccountService.java` is noted as a \"demo endpoint that is not exposed in production\", suggesting that in a production environment, the actual balance retrieval logic would integrate with a bank\\'s backend systems.  The `Overview` wiki page mentions \"Bank Backend Systems\" as an external system that the API Gateway interacts with. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2d1ab024-4bd9-4d05-8abe-538169991681\\n', 'id': 'lc_c422800e-e9f5-450c-a41a-aa4ae1fa0843'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0122",
      "requirement": {
        "requirement_id": "ATOM_006",
        "requirement_text": "Electronic signature of TPP must be based on a qualified certificate for electronic seals issued by eIDAS-compliant qualified trust service provider",
        "strength": "MUST",
        "capability": "Certificate Management",
        "section_id": "eef9ab97432c - 4.2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0122_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not directly support the specific requirement of verifying that a TPP (Third Party Provider) signing certificate is qualified for electronic seals and issued by an eIDAS-compliant qualified trust service provider. The codebase primarily focuses on general SAML and OAuth2 signature validation, and does not contain explicit implementations or configurations for eIDAS-specific certificate validation or electronic seals.\\n\\n### Implementation Details   \\n\\nThe codebase includes functionalities for validating signatures in OAuth2 request objects and SAML assertions/responses. For instance, `OAuth2RequestObjectSignatureValidationTestCase.java` demonstrates how to enable and test the validation of signed OAuth2 request objects . This involves updating the application\\'s OpenID Connect inbound configuration to set `validateRequestObjectSignature` to `true` .\\n\\nSimilarly, `SAML2SSOTestBase.java` contains methods like `validateSAMLResponseSignature`  and `validateSAMLAssertionSignature`  which validate the digital signatures of SAML responses and assertions respectively. These methods utilize a `SAMLSignatureProfileValidator` and `SignatureValidator` to ensure the signature conforms to SAML signature profiles and is cryptographically valid using an `X509Credential` .\\n\\nHowever, these implementations focus on the technical validity of the signature and the certificate chain, but do not include logic to specifically check for eIDAS compliance, qualified electronic seals, or the trust service provider\\'s qualification status.\\n\\n### Configuration Options   \\n\\nFor OAuth2, the `requestObjectSignatureValidationEnabled` flag can be set in the application\\'s inbound configuration to enforce signature validation for request objects .\\n\\nFor SAML, properties like `SAML2.EnableResponseSigning`, `SAML2.EnableAssertionSigning`, and `SAML2.EnableRequestSigning` in `travelocity.properties`  control whether SAML responses, assertions, and requests are signed. The `default-identity.xml` file also defines default signing and digest algorithms for SAML, such as `SAMLDefaultSigningAlgorithmURI` and `SAMLDefaultDigestAlgorithmURI` .\\n\\nThese configurations enable or disable signature validation and specify algorithms, but they do not provide options to configure eIDAS-specific certificate policies or trust anchors for qualified trust service providers.\\n\\n### API Endpoints or Features \\n\\nThe `updateApplicationInboundConfig` method is used to update the OpenID Connect inbound configuration of an application, including the `validateRequestObjectSignature` setting . This is an internal API used within the test cases. The `Features and Capabilities` wiki page mentions \"Financial-grade API (FAPI) Support\" <cite repo=\"wso2/product-is\" path=\"Features and Capabilities\" start=\"1.2\" end=\"1.2\" /> as an advanced security feature, which often involves stricter security requirements for APIs, but it does not explicitly state eIDAS compliance for electronic seals.\\n\\n### Documentation References <cite repo=\"wso2/product-is\" path=\"Features and Capabilities\" start=\"1.2\" end=\"1.2\" />\\n\\nThe `Features and Capabilities` wiki page provides an overview of the WSO2 Identity Server\\'s features, including OAuth 2.0, OpenID Connect, and SAML 2.0 support, along with advanced security features like FAPI <cite repo=\"wso2/product-is\" path=\"Features and Capabilities\" start=\"1.2\" end=\"1.2\" />. While it covers general security and authentication protocols, there is no specific mention of eIDAS compliance, qualified electronic seals, or the validation of certificates from eIDAS-compliant qualified trust service providers.\\n\\n## Notes\\n\\nThe codebase demonstrates strong capabilities in general digital signature validation for OAuth2 and SAML protocols. However, the specific requirement for verifying TPP signing certificates based on eIDAS-compliant qualified electronic seals and trust service providers is not explicitly addressed within the provided snippets. This would typically require specialized certificate policy validation, potentially involving external trust lists or services for eIDAS compliance, which are not evident in the current context.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_7fe4a575-f870-4060-b4ab-b08bea6ff06e\\n', 'id': 'lc_3016d2d7-cf3d-41d7-843a-f3f265b34c2a'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0122_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not appear to directly support the specific requirement of verifying a TPP signing certificate based on a qualified certificate for electronic seals issued by an eIDAS-compliant qualified trust service provider. The codebase primarily deals with general certificate management and JWT signature validation, but lacks explicit eIDAS-specific implementations or configurations.\\n\\n### Implementation Details \\nThe `wso2/product-apim` repository includes functionality for validating JWT signatures using certificates from a trust store. The `isJwtSignatureValid` method in `APIMTestCaseUtils.java` is responsible for this validation.  This method retrieves a certificate from a `KeyStore` based on a thumbprint and then uses it to verify the JWT signature.  However, there is no explicit code to check if the certificate is a \"qualified certificate for electronic seals\" or if it\\'s \"issued by an eIDAS-compliant qualified trust service provider.\" <cite />\\n\\nThe `applySslSettings` method, found in various `ApiClient.java` files, handles SSL certificate trust management.    This involves initializing `TrustManagerFactory` with a `KeyStore` containing trusted certificates.  While it allows for the configuration of trusted certificates, it does not include logic to specifically validate eIDAS compliance or the qualification of electronic seals. <cite />\\n\\n### Configuration Options \\nThe `automationXMLSchema.xsd` defines the structure for configuring trust stores, including `fileName`, `type`, and `password`.  This allows for the specification of a system-wide trust store to maintain certificates of trusted parties.  However, these configurations are generic for certificate management and do not provide specific options for eIDAS-compliant qualified certificates or electronic seals. <cite />\\n\\n### API Endpoints or Features  \\nThe API Publisher client includes operations for managing client certificates and endpoint certificates.   For instance, `updateAPIClientCertificateByAlias` allows updating a certificate, and `getCertificateUsageByAlias` retrieves APIs using a specific certificate.   The `EndpointCertificatesApi` also provides methods to retrieve and search uploaded certificates.  These APIs facilitate the management of certificates within the system, but they do not offer specific features to enforce eIDAS compliance or verify the qualification of electronic seals. <cite />\\n\\n### Documentation References <cite />\\nThe provided snippets include API documentation for `ClientCertificatesApi` and `EndpointCertificatesApi`.   These documents describe the parameters, return types, and authorization for certificate-related operations.   However, there are no specific documentation references within the provided context that detail support for eIDAS-compliant qualified certificates for electronic seals. <cite />\\n\\n## Notes\\nThe codebase demonstrates robust functionality for general certificate management, including uploading, updating, and validating certificates, particularly for JWT signatures.    The integration tests also confirm the ability to manage endpoint certificates and validate JWTs signed by external identity providers.   However, the specific requirements for eIDAS compliance, qualified certificates for electronic seals, and verification against a qualified trust service provider are not explicitly addressed in the provided code snippets. <cite /> The existing certificate handling mechanisms could potentially be extended to support these requirements, but such an implementation is not present in the current context. <cite />\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_50563349-0d10-4657-bb23-b960b3f1f134\\n', 'id': 'lc_ed504fd5-03ae-45f6-8318-2ecb25cef040'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0123",
      "requirement": {
        "requirement_id": "ATOM_216",
        "requirement_text": "The headers parameter must conditionally include psu-id if and only if PSU-ID header is present in the HTTP request",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0123_1",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0123_2",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, appears to support the conditional inclusion of a `psu-id` parameter in headers, specifically within the context of DPoP (Demonstrating Proof-of-Possession) token requests. The `OAuth2DPopTestCase.java`   test class demonstrates how `DPOP_HEADER` is added to HTTP requests, which is relevant to your query about conditional header inclusion.\\n\\n### Implementation Details\\n\\nThe `OAuth2DPopTestCase.java`   file contains several test methods that construct HTTP requests and add headers. For instance, in the `getDPoPTokenWithExpiredDPoPProof` method, a `DPOP_HEADER` is explicitly added to the request headers . The `genarateDPoPProof` method is used to create the DPoP proof, which is then included in the `DPOP_HEADER` . This suggests that the inclusion of specific headers like `DPOP_HEADER` (which could conceptually be extended to `PSU-ID`) is handled programmatically based on the requirements of the DPoP protocol.\\n\\nThe `RestBaseClient.java`  class provides utility methods for sending HTTP requests, such as `getResponseOfHttpPost`  and `getResponseOfHttpGet` , which accept an array of `Header` objects. This design allows for dynamic construction and inclusion of headers in outgoing requests  .\\n\\n### Configuration Options\\n\\nThe provided context does not explicitly detail configuration options for conditionally including a `psu-id` header. However, the `Application Management` wiki page mentions `Token Binding` types, including `DPoP` . This implies that the system is designed to handle specific header requirements related to different token binding mechanisms. The conditional logic for including `psu-id` would likely be implemented within the application's code that constructs the HTTP requests, similar to how `DPOP_HEADER` is handled in the test cases .\\n\\n### API Endpoints or Features\\n\\nThe `Application Management API`  provides RESTful endpoints for managing applications, but it does not directly expose features for conditionally including specific HTTP headers like `psu-id` in runtime requests. The conditional inclusion of `psu-id` would occur at the client-side or within a custom handler that processes outgoing HTTP requests, based on the presence of a `PSU-ID` header in the incoming request.\\n\\n### Documentation References\\n\\nThe `Application Management` wiki page provides an overview of the system, including `OAuth2/OIDC Configuration`  and `Token Binding` . While it discusses `DPoP` as a token binding type, there is no specific documentation reference for the conditional inclusion of a `psu-id` header based on the presence of a `PSU-ID` header in the HTTP request. The provided code snippets are integration tests that demonstrate how headers are added, rather than formal documentation of this specific requirement.\\n\\n## Notes\\n\\nThe prompt specifically asks about the conditional inclusion of `psu-id` in the `headers` parameter if and only if the `PSU-ID` header is present in the HTTP request. While the provided code demonstrates the dynamic addition of headers, particularly `DPOP_HEADER` , there is no direct evidence or explicit implementation for a `psu-id` header with the exact conditional logic described. The `OAuth2DPopTestCase.java`   tests focus on DPoP-related headers and their validation. The general mechanism for adding headers exists through `RestBaseClient.java` , but the specific conditional logic for `psu-id` is not explicitly present in the provided snippets.\\n\\nWiki pages you might want to explore:\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_8c3d66f9-e46a-4e04-9fd8-4ad54312fdc9\\n\", 'id': 'lc_173c2cdf-3fae-4380-8bdd-cce7dbb61abd'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0123_3",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support conditional header manipulation, which could be used to implement the requirement of conditionally including `psu-id` based on the presence of a `PSU-ID` header in the HTTP request. The `addHeader` policy allows for adding headers, and the system also supports header-based conditions for throttling.\\n\\n## Implementation Details\\n\\nThe `wso2/product-apim` repository includes a policy definition for `addHeader` . This policy, categorized as \"Mediation\", allows you to add a new header to the request . It defines `headerName` and `headerValue` as required string attributes . This policy is applicable to \"request\", \"response\", and \"fault\" flows and is supported by the \"Synapse\" gateway .\\n\\nWhile the `addHeader` policy itself doesn\\'t explicitly define conditional logic, the documentation mentions that a header mediator can be used to dynamically change the endpoint based on an XPath expression . This suggests that conditional logic based on request headers is possible within the mediation framework.\\n\\nThe `HeaderCondition` class  is used for defining conditions based on header names and values, primarily for throttling purposes . This class has fields for `headerName` and `headerValue` . Although this is specifically for throttling, it demonstrates the capability of the system to inspect and act upon HTTP headers.\\n\\n## Configuration Options\\n\\nThe `addHeader` policy can be configured with the `headerName` and `headerValue` attributes . To achieve conditional inclusion of `psu-id`, you would likely need to combine this `addHeader` policy with a conditional mediation sequence that checks for the presence of the `PSU-ID` header.\\n\\nThe `api_product_template.xml` and `prototype_template.xml` files show examples of how properties and headers can be set within Synapse mediation sequences . For instance, a property named \"Authorization\" can be set using an expression . This suggests that dynamic evaluation and setting of headers is possible.\\n\\n## API Endpoints or Features\\n\\nThe `admin-api.yaml` defines API endpoints related to throttling and blocking conditions . Specifically, it includes operations to add  and delete  blocking conditions, which can be based on headers. While these are for administrative tasks and not directly for conditional header inclusion, they highlight the system\\'s ability to process and manage header-based rules.\\n\\n## Documentation References\\n\\nThe `faq.xml` files in `api-control-plane/docs/xdoc/faq.xml`  and `traffic-manager/docs/xdoc/faq.xml`  discuss how to dynamically change endpoints using a header mediator and XPath expressions. This is a strong indicator that conditional logic based on request headers can be implemented within the mediation flow. The example provided shows how to set the \"To\" header dynamically .\\n\\n## Test Criteria\\n\\nTo verify the requirement, you would need to:\\n1.  **Verify `psu-id` is included when `PSU-ID` header exists:** Send a request with the `PSU-ID` header and check if the `psu-id` header is added to the outgoing request. This would involve inspecting the request after it has passed through the mediation sequence.\\n2.  **Verify `psu-id` is excluded when `PSU-ID` header does not exist:** Send a request without the `PSU-ID` header and ensure that the `psu-id` header is *not* added to the outgoing request.\\n\\nThe `JWTRequestCountThrottlingTestCase.java`  demonstrates testing with header conditions for throttling. This test case sets various request headers, including \"Authorization\", \"accept\", \"content-type\", and \"Host\", and then asserts whether throttling occurred based on these headers . This indicates that the testing framework supports manipulating and asserting on HTTP headers, which would be crucial for validating your requirement.\\n\\n## Notes\\n\\nThe provided snippets suggest that while there isn\\'t a direct \"conditional add header\" policy, the underlying Synapse mediation engine, which WSO2 API Manager uses, is capable of complex conditional logic and header manipulation through custom mediation sequences. The `addHeader_v2.json`  defines a basic policy, but the `faq.xml`  indicates that more advanced scenarios involving dynamic header modification using XPath are possible. The `HeaderCondition.java`  and related throttling tests  further confirm the system\\'s ability to work with HTTP headers for conditional processing.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_91fe26dd-fd22-43ab-943d-939b16d01f4e\\n', 'id': 'lc_55b9f3c3-1f97-4263-8b0a-f9e3330d4906'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0124",
      "requirement": {
        "requirement_id": "ATOM_154",
        "requirement_text": "The system SHALL include PSU-IP-Address header when request was actively initiated by PSU",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0124_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, appears to have mechanisms for handling and potentially manipulating IP addresses in HTTP requests, but there is no direct evidence or explicit configuration option for a \"PSU-IP-Address\" header or the specific logic to differentiate between actively initiated and automated/background requests for this purpose. \\n\\n## Implementation Details\\n\\nThe `catalina-server.xml.j2` file, which is a Jinja2 template for generating Tomcat\\'s `catalina-server.xml` configuration, includes a `RemoteIpValve` . This valve is designed to get the real client IP addresses via request headers .\\n\\nThe `RemoteIpValve` can be configured with `remoteIpHeader` , which specifies the header that contains the remote IP address. However, there is no explicit mention of a \"PSU-IP-Address\" header . The configuration for this valve is dynamically generated based on `catalinaValves.remoteIpValve` properties .\\n\\nOther valves like `RequestCorrelationIdValve`  and `X509CertificateAuthenticationValve`  are present, but they do not directly address the \"PSU-IP-Address\" requirement .\\n\\n## Configuration Options\\n\\nThe `RemoteIpValve` can be enabled and configured through the `catalinaValves.remoteIpValve` properties . Specifically, the `remoteIpHeader` property can be set to specify which header carries the client IP . However, to meet the requirement of including a \"PSU-IP-Address\" header, you would need to configure the system to set this specific header, which is not directly supported by the existing `remoteIpHeader` property .\\n\\nThe `catalina-server.xml.j2` template uses Jinja2 templating, which means these configurations are likely derived from a `deployment.toml` file or similar configuration source . To introduce a \"PSU-IP-Address\" header, you would likely need to extend the existing valve mechanism or implement a custom valve .\\n\\n## API Endpoints or Features\\n\\nThe provided codebase context does not explicitly show any API endpoints or features that directly handle or generate a \"PSU-IP-Address\" header based on whether a request was actively initiated by a PSU or is an automated/background request . The `Architecture` wiki page mentions an \"API Layer\"  with \"Server APIs\" and \"User APIs\" , but the details provided do not indicate support for this specific header or its conditional inclusion .\\n\\n## Documentation References\\n\\nThe `Architecture` wiki page provides a high-level overview of the WSO2 Identity Server . While it discusses the configuration system  and how configuration files are generated from templates , it does not contain specific documentation regarding the \"PSU-IP-Address\" header or the logic for differentiating request types . The `catalina-server.xml.j2` file itself contains comments about the `RemoteIpValve` , but these are general to Tomcat\\'s functionality and not specific to the \"PSU-IP-Address\" requirement .\\n\\n## Notes\\n\\nThe prompt\\'s requirement for a \"PSU-IP-Address\" header and the distinction between actively initiated and automated/background requests suggests a need for custom logic, potentially within a custom Tomcat Valve or a similar request processing component. While the `RemoteIpValve` can extract IP addresses from headers, it doesn\\'t inherently create a new header with a specific name like \"PSU-IP-Address\" or implement the conditional logic described. The existing codebase provides the framework for request processing and configuration, but the specific implementation for this requirement would likely need to be added.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_fe1a9fe4-2cfa-451c-b031-2b315b0de69c\\n', 'id': 'lc_0f6ef784-22c4-46a3-833f-d9be0dad7a11'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0124_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to handle IP addresses for security and analytical purposes, but there is no direct evidence of a \"PSU-IP-Address\" header being explicitly included in requests when actively initiated by a PSU (presumably \"Policy Service Unit\" or \"Power Supply Unit\" based on the context, though the exact meaning is not defined in the provided snippets). The codebase primarily focuses on tracking and using IP addresses for internal functions like suspicious login detection, geographic information derivation, and statistical analysis.    \\n\\n### Implementation Details\\n\\nThe `wso2/product-apim` repository, specifically within the `privacy-policy-content.jsp` files, indicates that API-M (API Manager) uses IP addresses for several internal functions. For instance, it uses IP addresses to detect suspicious login attempts  and to protect accounts from unauthorized access . The system also tracks IP addresses via HTTP requests, HTTP headers, and TCP/IP for collecting information and deriving geographic data  . However, there is no explicit mention of a \"PSU-IP-Address\" header being added to outgoing requests based on the initiation source. The provided snippets describe how API-M *uses* IP addresses it receives, not how it *adds* specific IP headers to requests it sends out.\\n\\n### Configuration Options\\n\\nThe provided code snippets do not directly show configuration options for adding a \"PSU-IP-Address\" header. The `privacy-policy-content.jsp` files describe the system\\'s use of IP addresses, which is more about data handling and privacy than configurable request headers  . Other files like `publisher-tenant.json`  and `velocity_template.xml`  deal with tenant configurations and API templates, respectively, but do not contain information about dynamically adding an `PSU-IP-Address` header.\\n\\n### API Endpoints or Features\\n\\nThe codebase does not explicitly expose API endpoints or features for managing a \"PSU-IP-Address\" header. The `APIRevisionTestCase.java` file  is an integration test case for API revisions and does not indicate any such functionality. The `IPCondition.java` file  is a model for IP conditions, which might be used for filtering or policy enforcement, but not for adding a specific header to requests.\\n\\n### Documentation References\\n\\nThe `privacy-policy-content.jsp` files   serve as documentation for how API-M handles personal information, including IP addresses. These documents state that API-M tracks IP addresses with HTTP requests and headers  and uses them for security and analytics  . However, they do not describe a mechanism for the system to *add* a \"PSU-IP-Address\" header to requests it initiates. The `properties_guide.xml` files   discuss properties related to HTTP transport and preserving processed headers, but again, there\\'s no direct mention of a \"PSU-IP-Address\" header.\\n\\n## Notes\\n\\nThe term \"PSU\" is not explicitly defined within the provided codebase snippets. The context of IP address usage primarily revolves around security, tracking, and analytics within the API Manager, rather than the explicit addition of a custom \"PSU-IP-Address\" header to outgoing requests. While the system clearly processes and utilizes IP addresses from incoming requests, the mechanism for *adding* such a header to requests *initiated by the system* (especially distinguishing between actively initiated and automated/background requests) is not evident in the provided code.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_360b9f52-9429-4d36-8bf2-c773aff11b5c\\n', 'id': 'lc_b1cfb8bc-6780-4e0b-aa22-526d25482f55'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0125",
      "requirement": {
        "requirement_id": "ATOM_015",
        "requirement_text": "The API SHALL support signing of a group of transactions with one SCA as offered by ASPSPs in online banking.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0125_1",
          "text": "ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify fraudulent activities. 7. **API Security** - API consumers invoke APIs to access customer\u2019s financial information. Therefore, API security plays a vital role in open banking to mitigate data theft. The solution has built-in support for global industry-standards such as OpenID Connect Financial Grade API (FAPI), OAuth 2.0, Electronic Identification and Trust Services (eIDAS). API security can be categorised into two main levels: - Application layer security - Validates API consumers against the certificates issued by competent authorities. For example: open banking directories, Qualified Trust Service Providers (QTSPs). Also, the solution supports OAuth2 security implementations such as Private key JWT authentication, client-credentials grant type, and authorization code grant type. - Transport layer security - Secures the communication between the API consumer, and the bank using Mutual Transport Layer Security (MTLS). 8. **User Experience** - The solution provides an enhanced user experience for the banks, API consumers, and customers with self-explanatory and simple actions. 9. **Premium APIs and Monetization** - Using the capabilities in WSO2 API Manager, WSO2 Open Banking Accelerator allows: - banks to publish highly-performant custom APIs for API consumers. - banks to expose their performance and compliance data by integrating into analytics engines. - banks to plug in any billing engines with subscription-based freemium, tiered pricing, or per-request pricing. 10. **Standards-based API Templates** - WSO2 API Manager offers standard API management capabilities, and you can customize the API templates according to your open banking and other requirements.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_2",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_3",
          "text": "reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank. In this web application, the customer: - Logs in using the login credentials. - Views information that the API consumer requested to access. - Selects the accounts that the API consumer can access. - Provides consent to the API consumer to access the information. ###Identifier-first authenticator Banks use Identifier-first authentication to authenticate the user with a second-factor authenticator instead of a password. The user who logs into the authorization web application, can provide the username, and authenticate using a second-factor authentication mechanism such as SMS-OTP/TOTP.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_4",
          "text": "### Account Information Service\n\nIf the API consumer application is aggregating account information on behalf of the bank user, the APP-to-APP redirection \nflow is as follows: \n\n[ ![](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Account Information Service, it is known as an Account Information Service Provider (AISP).\n\n| Implementation | Requirement | Participant |\n|----------------|-------------|-------------|\n| A- AISP requests the bank customer to identify the bank. | Required | AISP |\n| B- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | bank |\n| C- The customer consents to the accounts, which the AISP is allowed to have access | Required | Bank |\n| D- Confirms the completion of AIS request | Recommended | AISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0125_5",
          "text": "## How WSO2 Open Banking Accelerator delivers open banking requirements 1. **API Consumer Onboarding** - API consumer onboarding is the process of verifying an API consumer when they register with a bank to provide services to customers. It is important since the API consumer has access to the customer's financial information via their applications. The solution provides dynamic client registration for API consumers. 2. **Consent Management** - Consent management is the process of prompting, collecting, and managing bank customer\u2019s consent before an API consumer collects or shares the customer's financial information. The Solution includes a fully-featured consent management module that: - securely exposes consent data through an API - provides in-built consent management user interfaces for customers and bank staff - manages the entire consent life cycle A consent goes through a phased life cycle as follows: ![lifecycle of a consent](../assets/img/get-started/open-banking-requirements/consent-lifecycle.png) - **Consent provision**: An API consumer application sends a consent request to the bank containing the customer\u2019s financial information that it wants to access. - **Consent grant**: The bank redirects the consent request to the customer to approve/deny. - **Consent verification**: The bank verifies if the customer has approved the API consumer application to access the information. If the bank customer has denied the consent, the bank must detect and stop the application from invoking the banking APIs. - **Consent revocation**: A customer can revoke the consent via consent management applications. It can either be done by the customer themselves or by a bank representative upon the customer\u2019s request. - **Consent expiration**: When the consent validity period expires, the bank sets the consent status as expired. For the API consumer application to access the customer\u2019s financial information again, the customer needs to regrant the consent. 3. **Consumer Authentication** - Consumer authentication is an authentication mechanism with a layered defence. When a user initiates a payment or accesses information via an API consumer application, it authenticates the user using the following factors one at a time: ![authentication factors](../assets/img/get-started/open-banking-requirements/authentication-factors.png) - Knowledge : something the user knows. For example: password. - Possession : something the user owns. For example: ATM cards. - Inherence : something the user is. For example: fingerprint. The solution supports multifactor authentication and identifier-first authentication. In addition, you can extend the existing authenticators or write new authenticators in accordance with your open banking standard. 4. **Developer Portal** - The solution offers a customizable Developer Portal that enables application developers to publish, republish, subscribe, and test APIs. 5. **Banking Systems Integration** - The solution uses the integration capabilities of [WSO2 Micro Integrator](https://apim.docs.wso2.com/en/latest/integrate/integration-overview/) to help banks connect their core banking systems and overcome the challenges of legacy technology. With the help of the Micro Integrator, WSO2 Open Banking can support: - different message protocols (HTTP/TCP), message types (REST/SOAP), and formats (ISO 8583, ISO 20022). - mediation between a legacy or digital core and other banking systems, and the bank\u2019s library of open banking APIs. 6. **Data Analytics** - The solution to mediate between the bank\u2019s systems and modern analytics systems. Analytics allows banks to monitor user patterns and behaviours and to identify",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0126",
      "requirement": {
        "requirement_id": "ATOM_155",
        "requirement_text": "The GET /v1/accounts/{account-id}/balances endpoint SHALL return account balances with balanceAmount, balanceType, and reference date information",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0126_1",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0126_2",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0126_3",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0126_4",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0126_5",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0126_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the WSO2 Financial Services Accelerator repository supports the `GET /v1/accounts/{account-id}/balances` endpoint, which returns account balances with `balanceAmount`, `balanceType`, and `reference date` information.  This functionality is defined in the OpenAPI specification and has a demo implementation and integration tests.  \\n\\n## Implementation Details\\n\\nThe `GET /accounts/{AccountId}/balances` endpoint is defined in the `account-info-swagger.yaml` file . This endpoint is responsible for retrieving balance information for a specific account. The response for this endpoint is defined by the `200AccountsAccountIdBalancesRead` schema, which references `#/definitions/OBReadBalance1` .\\n\\nThe `OBReadBalance1` definition specifies that the response will contain an array of `Balance` objects . Each `Balance` object includes:\\n*   `AccountId`: The identifier for the account. \\n*   `Amount`: An object containing the `Amount` and `Currency` of the balance. \\n*   `CreditDebitIndicator`: Indicates whether the balance is a credit or debit. \\n*   `Type`: The type of balance (e.g., `InterimAvailable`, `ClosingBooked`). \\n*   `DateTime`: The date and time of the balance, represented in ISO 8601 format. \\n\\nA demo backend service, `AccountService.java`, provides a sample implementation for this endpoint . This service returns a hardcoded JSON response that includes `AccountId`, `Amount` (with `Amount` and `Currency`), `CreditDebitIndicator`, `Type`, and `DateTime` .\\n\\n## Configuration Options\\n\\nThe `account-info-swagger.yaml` file specifies that the `GET /accounts/{AccountId}/balances` endpoint requires `PSUOAuth2Security` or `default` security with the `accounts` scope . The `x-auth-type` is `Application User` .\\n\\nThe `OBBalanceType1Code` definition lists various balance types that can be returned, such as `ClosingAvailable`, `InterimAvailable`, and `OpeningBooked` .\\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `GET /accounts/{AccountId}/balances` . This endpoint is part of the Account Information APIs, which also include endpoints for account access consents, accounts, and transactions .\\n\\n## Documentation References\\n\\nThe OpenAPI specification for the Accounts API is located at `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml` . This file details the structure of requests and responses for the balances endpoint, including the data types and formats for `balanceAmount`, `balanceType`, and `DateTime` (reference date) .\\n\\nIntegration tests confirm the functionality of this endpoint. The `EndToEndAccountFlowTest.groovy` file includes a test case named `\"Verify Accounts balances Retrieval Request for a Authorised Consent\"` which asserts a `200` status code for the balances retrieval request . The `AccountsRequestPayloads.groovy` file also contains a `buildValidationBalancePayload` method, which constructs a payload for validating balance requests, indicating the expected resource path `/aisp/accounts/30080012343456/balances` .\\n\\n## Notes\\n\\nThe `DateTime` field in the `OBReadBalance1` definition serves as the reference date information, and it is explicitly stated to be in ISO 8601 date-time format . The `balanceAmount` is represented by the `Amount` object within the `Balance` object, which includes both the `Amount` value and its `Currency` . The `balanceType` is represented by the `Type` field, which uses the `OBBalanceType1Code` enumeration .\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0d0a35ee-cc1e-4ff7-9f4c-c68c394a347c\\n', 'id': 'lc_c350a427-530c-48dd-b2c8-17e11289a3ab'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0127",
      "requirement": {
        "requirement_id": "ATOM_217",
        "requirement_text": "The headers parameter must conditionally include psu-corporate-id if and only if PSU-Corporate-ID header is present in the HTTP request",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0127_1",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0127_2",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0127_3",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the conditional inclusion of a `psu-corporate-id` header based on the presence of a `PSU-Corporate-ID` header in the HTTP request. The provided code snippets primarily focus on OAuth2/OIDC DPoP (Demonstrating Proof-of-Possession) token handling, federated token sharing, and general REST client operations, none of which explicitly implement or mention the `psu-corporate-id` or `PSU-Corporate-ID` headers.\\n\\n## Implementation Details, Configuration Options, and API Endpoints\\n\\nBased on the provided context, there are no explicit implementation details, configuration options, or API endpoints that directly address the conditional inclusion of a `psu-corporate-id` header. The `OAuth2DPopTestCase.java` file demonstrates how headers are added to HTTP requests for DPoP token-related operations  . For instance, in the `getDPoPTokenWithExpiredDPoPProof` method, headers like `AUTHORIZATION_HEADER`, `Content-Type`, `User-Agent`, and `DPOP_HEADER` are added to a `POST` request . Similarly, the `accessResourceWithDPoPTokenFromClientCredentialsWithDifferentThumbprint` method adds headers to a `GET` request . These examples show how headers are constructed and sent, but they do not include any logic for conditionally adding `psu-corporate-id` based on another header.\\n\\nThe `RestBaseClient.java` provides utility methods for sending HTTP requests with headers   . For example, `getResponseOfHttpPost` takes an array of `Header` objects  and sets them on the `HttpPost` request . However, the logic for determining which headers to include is external to these utility methods and is handled by the calling test cases.\\n\\nThe wiki page on \"Application Management\" describes various aspects of application configuration, including OAuth2/OIDC settings and token binding types . While it mentions different token binding types like DPoP and client-request, there is no mention of `psu-corporate-id` or any mechanism for conditionally adding headers based on incoming request headers.\\n\\n## Documentation References\\n\\nThere are no specific documentation references within the provided context that describe the conditional inclusion of `psu-corporate-id` based on the presence of `PSU-Corporate-ID` in the HTTP request. The existing documentation focuses on general application management, protocol configurations, and API metadata.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests (`modules/integration/tests-integration/tests-backend/src/test/java/`). These tests demonstrate how the system behaves under various conditions, including how HTTP requests are constructed with specific headers. While they show how headers are added, they do not indicate any built-in functionality within the core product to automatically handle the conditional inclusion of `psu-corporate-id` as described in the query. It is possible that such functionality might exist in other parts of the codebase not provided, or it might be a feature that needs to be implemented as a custom extension.\\n\\nWiki pages you might want to explore:\\n- [Application Management (wso2/product-is)](/wiki/wso2/product-is#4.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_3d32e194-d1dd-45bb-8ea9-bcd0f0ca067b\\n', 'id': 'lc_dcf1609b-dd49-4929-b14f-09e6e81c83c2'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0127_4",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support conditional header inclusion through its mediation policies, specifically using the `addHeader` policy. The `addHeader` policy allows you to add a new header to the request, and while it doesn\\'t directly support conditional logic based on the presence of another header, the underlying Synapse mediation engine, which WSO2 API Manager uses, offers the flexibility to implement such conditional logic.\\n\\n### Implementation Details\\nThe `addHeader` policy is defined in `api-control-plane/modules/distribution/resources/operation_policies/specifications/addHeader_v2.json` . This policy takes `headerName` and `headerValue` as attributes . It is applicable to `request`, `response`, and `fault` flows .\\n\\nTo achieve conditional inclusion of `psu-corporate-id` based on the presence of `PSU-Corporate-ID` in the HTTP request, you would typically leverage the Synapse mediation capabilities. The WSO2 API Manager uses Apache Synapse as its mediation engine. Synapse allows for advanced message mediation, including conditional logic using XPATH or other expressions.\\n\\nFor example, the `api_product_template.xml`  and `prototype_template.xml`  files show how properties and headers can be manipulated within the mediation flow. Specifically, the `<header>` mediator can be used to add or remove headers . The `gateway/docs/xdoc/faq.xml` also mentions using a header mediator to dynamically change the \\'To\\' address, which implies the flexibility to manipulate headers based on expressions .\\n\\nA common approach in Synapse for conditional header manipulation is to use a `<filter>` mediator to check for the existence of a header and then apply an `<enrich>` or `<property>` mediator to add the new header.\\n\\n### Configuration Options\\nWhile the `addHeader_v2.json` policy itself doesn\\'t expose conditional logic directly, the WSO2 API Manager allows for custom mediation policies. You would define a custom mediation sequence that includes the conditional logic. This sequence would then be applied to your API.\\n\\nThe `HeaderCondition.java`  and `HeaderConditionDTO.java`  files indicate that header conditions can be defined, likely for throttling or other policy enforcement. While these are not directly for adding headers, they demonstrate the system\\'s capability to inspect and act upon HTTP headers.\\n\\n### API Endpoints or Features\\nThe WSO2 API Manager\\'s Admin API, as described in `admin-api.yaml` , provides endpoints for managing throttling policies and other configurations. Custom mediation policies can be uploaded and applied to APIs through the API Publisher portal or via the Admin API.\\n\\n### Documentation References\\nThe `all-in-one-apim/docs/xdoc/samples/message_mediation_samples.xml`  provides examples of message mediation, including the use of `in` and `out` mediators and header manipulation. This document would be a good starting point for understanding how to implement custom mediation logic. The `gateway/docs/xdoc/faq.xml`  also contains information on dynamic sequences and endpoints, which are relevant to custom mediation.\\n\\n### Test Criteria\\nTo verify the conditional inclusion, you would need to:\\n1.  **Send a request with `PSU-Corporate-ID` header**: The mediation sequence should detect this header and add `psu-corporate-id`.\\n2.  **Send a request without `PSU-Corporate-ID` header**: The mediation sequence should not add `psu-corporate-id`.\\n\\nThe `DuplicateHeaderTestCase.java`  demonstrates how integration tests are written to verify header behavior, although it focuses on duplicate headers rather than conditional inclusion.\\n\\n## Notes\\nThe provided snippets indicate that WSO2 API Manager, through its underlying Synapse mediation engine, offers the necessary primitives to implement conditional header manipulation. While there isn\\'t a direct \"conditional add header\" policy, the flexibility of custom mediation sequences allows for this requirement to be met. The `addHeader_v2.json`  policy is a basic building block, and more complex logic would be built around it using Synapse configurations.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_93a08523-173f-4f38-aec2-8674c8f5080f\\n', 'id': 'lc_8512886b-013a-4b3d-b7fe-2592191794d6'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0128",
      "requirement": {
        "requirement_id": "ATOM_186",
        "requirement_text": "The account-id parameter SHALL be constant at least throughout the lifecycle of a given consent.",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0128_1",
          "text": "## Persist\n\nThe second endpoint of the Consent Authorize component is the Persist Flow. The Persistent Steps are engaged once the \nuser approves/denies the consent via an API invocation made from the consent page. When the `/persist` endpoint is \ninvoked, the steps to persist are also invoked and the data required for persistence will be provided to these steps.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_2",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_3",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_4",
          "text": "### getConsentAmendmentHistoryData method\n\n!!! info\n    This is only available as a WSO2 Update from **WSO2 Open Banking Identity Server Accelerator Level\n    3.0.0.33** onwards. For more information on updating,\n    see [Getting WSO2 Updates](../install-and-setup/setting-up-servers.md#getting-wso2-updates).\n\nThis method retrieves the consent amendment history for a given consent. Given below is the method signature:\n\n``` java\nMap < String, ConsentHistoryResource > getConsentAmendmentHistoryData(\n    String consentID)\nthrows ConsentManagementException\n```\nInput parameter:\n\n- `consentID`: consent ID of the consent. This is a mandatory parameter.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_5",
          "text": "### storeConsentAmendmentHistory method\n\n!!! info\n    This is only available as a WSO2 Update from **WSO2 Open Banking Identity Server Accelerator Level\n    3.0.0.33** onwards. For more information on updating,\n    see [Getting WSO2 Updates](../install-and-setup/setting-up-servers.md#getting-wso2-updates).\n\nThis method stores the details of the previous consent when a consent amendment happens. Given below is the method signature:\n\n``` java\nboolean storeConsentAmendmentHistory(\n    String consentID,\n    ConsentHistoryResource consentHistoryResource,\n    DetailedConsentResource detailedCurrentConsent)\nthrows ConsentManagementException\n```\nInput parameters:\n\n- `consentID`: consent ID of the consent. This is a mandatory parameter.\n- `consentHistoryResource`: a model that includes the detailed consent resource and other history parameters (for example: amended Timestamp, reason caused the amendment) of the previous consent. This is a mandatory parameter.\n- `currentConsentResource`: detailed consent resource of the existing consent. This is an optional parameter.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, supports the concept of consent management, which involves an `account-id` that remains constant throughout the lifecycle of a given consent. The `account-id` is typically represented by the `piiPrincipalId` in the consent management API.\\n\\n### Implementation Details\\nThe WSO2 Identity Server includes a consent management feature, which is evident from the presence of the `org.wso2.carbon.consent.mgt` module   . This module provides APIs for managing user consents. The `SelfSignUpConsentTest.java` integration test demonstrates how consents are handled during self-registration, specifically showing the construction of a consent request body that includes a `piiPrincipalId` . This `piiPrincipalId` is used to identify the user for whom the consent is being managed. The test also includes methods to retrieve consents using this `piiPrincipalId` .\\n\\n### Configuration Options\\nThe `SkipUserConsent` configuration option, found in `identity-default.xml`  and `identity-identitymgtlistener-enabled.xml` , can be set to `false` to ensure that user consent is always prompted. This is further supported by the `disable_skipping_consent` function in `configure_is_fapi.py`, which explicitly sets the \"Skip Login consent\" to false for an application . This indicates that the system is designed to enforce consent flows when required.\\n\\n### API Endpoints or Features\\nThe consent management APIs are exposed through the `/api/identity/consent-mgt/v1.0/consents` endpoint . This endpoint is defined in `web.xml` as `IdentityConsentMgtV1ApiServlet` with the URL pattern `/identity/consent-mgt/v1.0/*` . The `SelfSignUpConsentTest` uses this endpoint to manage consents, including retrieving consents for a given `piiPrincipalId` (which represents the `account-id`) . The `OIDCSSOConsentTestCase` also demonstrates consent management in the context of OIDC SSO, where claims requiring consent are prompted to the user .\\n\\n### Documentation References\\nThe provided context does not include direct documentation references for the `account-id` parameter\\'s constancy throughout a consent lifecycle. However, the integration tests, particularly `SelfSignUpConsentTest.java`  and `OIDCSSOConsentTestCase.java` , serve as executable documentation for how consent management, including the `piiPrincipalId` (account-id), is implemented and expected to behave. The `piiPrincipalId` is consistently used to identify the user associated with a consent, implying its constancy during the consent\\'s lifecycle.\\n\\n## Notes\\nThe term `account-id` in the prompt directly maps to `piiPrincipalId` within the WSO2 Identity Server codebase, particularly in the context of consent management. The provided snippets strongly suggest that this `piiPrincipalId` is a stable identifier for a user\\'s consent.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4ef88a5d-2dda-4d0f-8b87-951cf19c69a5\\n', 'id': 'lc_8764731c-b5a0-4679-867e-279a4d26acb2'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0128_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_7e4ddcf4-e5ba-4129-9fe7-f2b0ba13499b'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0129",
      "requirement": {
        "requirement_id": "ATOM_017",
        "requirement_text": "Payment resources that need to be signed n times SHALL end up with n SCA sub-resources in a normal successful process.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0129_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_2",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_3",
          "text": "## Create API resources\n\nWSO2 Identity Server provides comprehensive capabilities for managing and securing API resources, particularly in the context of authorization and access control. You need to create below API resources in order to successfully invoke Open Banking APIs.\n\n    | API Resource | Identifier | Display Names | Scopes | \n    |------------- | ---------- | ------------- | ------ |\n    | API Resource for access scopes attached to customer facing Open Banking APIs | User-defined-oauth2-resource | User-defined-oauth2-resource | accounts </br>payments </br>fundsconfirmations |\n    | API resource to acccess internal Open Banking APIs provided by WSO2 | OB-internal-api-resource | OB-internal-api-resource | ob-internal-api-access |\n\nFollow the below steps to create above API Reources.\n\n1. Go to the **Api Resources** tab in the left pane.\n\n2. Click **New API Resource**.\n\n      ![create-api-resource.png](../assets/img/get-started/quick-start-guide/create-api-resource.png)\n    \n3. Enter **Identifier** and **Display Names**.\n\n      | Text Field    | Value                        | \n      |---------------|------------------------------|\n      | Identifier    | User-defined-oauth2-resource |\n      | Display Names | User-defined-oauth2-resource |\n\n      ![api_resource_basic_detail_page.png](../assets/img/get-started/quick-start-guide/api_resource_basic_detail_page.png)\n\n4. Click **Next**.\n\n5. Add the following scopes one at a time: **accounts**, **payments**, and **fundsconfirmations**. \n   For each scope, enter the Scope and Display Name as shown below.\n    ![api_resource_scopes_page.png](../assets/img/get-started/quick-start-guide/api_resource_scopes_page.png)\n\n6. Once all scopes have been added, they will be displayed as shown below.\n    ![api_resource_scopes_added_page.png](../assets/img/get-started/quick-start-guide/api_resource_scopes_added_page.png)\n\n7. Click **Next**.\n\n8. Click **Create**.\n\n    ![api_resource_authorisation_page.png](../assets/img/get-started/quick-start-guide/api_resource_authorisation_page.png)\n\n9. Create **OB-internal-api-resource** by flowing the above steps.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_4",
          "text": "### Account Information Service\n\nIf the API consumer application is aggregating account information on behalf of the bank user, the APP-to-APP redirection \nflow is as follows: \n\n[ ![](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Account Information Service, it is known as an Account Information Service Provider (AISP).\n\n| Implementation | Requirement | Participant |\n|----------------|-------------|-------------|\n| A- AISP requests the bank customer to identify the bank. | Required | AISP |\n| B- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | bank |\n| C- The customer consents to the accounts, which the AISP is allowed to have access | Required | Bank |\n| D- Confirms the completion of AIS request | Recommended | AISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_5",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to be a testing framework for the WSO2 Identity Server, and it does not directly support \"Payment resources that need to be signed n times SHALL end up with n SCA sub-resources in a normal successful process.\"  The provided code snippets and wiki page describe a testing framework for identity management features like OAuth2/OIDC and SAML, not payment processing or Strong Customer Authentication (SCA) sub-resources. \\n\\n## Analysis of User Query in Context of Codebase\\n\\nThe user\\'s query focuses on \"Payment resources,\" \"signed n times,\" and \"n SCA sub-resources.\" <cite/> These terms are not present in the provided codebase context, which primarily deals with identity and access management protocols. \\n\\n### Irrelevant Concepts\\n\\n*   **Payment Resources**: There is no mention of payment resources or related functionalities within the provided snippets. <cite/>\\n*   **SCA Sub-resources**: The concept of Strong Customer Authentication (SCA) sub-resources is not found in the codebase. <cite/>\\n*   **Signing n times**: While there are references to signing in the context of SAML assertions and responses, this refers to cryptographic signing for security and integrity, not a multi-signature requirement for payment resources.           \\n\\n## Conclusion\\n\\nBased on the provided codebase context, this repository does not appear to support the functionality described in your query regarding payment resources, multiple signatures, or SCA sub-resources. <cite/> The `wso2/product-is` repository is focused on testing identity management features. \\n\\n## Notes\\n\\nThe provided snippets are primarily from the `modules/integration/tests-integration/tests-backend/src/test/` directory, indicating they are part of the integration testing framework for WSO2 Identity Server.      The wiki page \"Testing Framework\" further confirms this.  While some files mention \"signing\" in the context of SAML assertions and requests, this is related to cryptographic integrity and not to a multi-signature payment process.          \\n\\nWiki pages you might want to explore:\\n- [Testing Framework (wso2/product-is)](/wiki/wso2/product-is#6)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-p_a3b8269e-8256-4de2-ba88-a49411f3f0dc\\n', 'id': 'lc_d2d48c0c-1ce6-42b0-be94-61ff6b0c5f5c'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0129_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_0e3063c9-6c7b-4c08-b0e8-2d3e9d759123'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0130",
      "requirement": {
        "requirement_id": "ATOM_072",
        "requirement_text": "The system shall provide hyperlinks with semantic tags in the _links data element to guide TPP through API processes for payment initiation and account information services",
        "strength": "SHALL",
        "capability": "General",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0130_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the inclusion of hyperlinks with semantic tags in API responses, specifically within a `_links` data element, to guide users through API processes. This functionality is primarily demonstrated in the context of pagination for various API endpoints, including Organization Management and User Application APIs.  \\n\\n## Implementation Details\\n\\nThe `_links` data element is a JSON object that contains an array of link objects. Each link object typically includes a `rel` (relation) field and an `href` (hyperlink reference) field.   The `rel` field provides semantic meaning to the hyperlink, such as \"next\" for the next page in a paginated result set, or \"previous\" for the previous page.   The `href` field contains the actual URL for the linked resource.  \\n\\nFor example, in the `OrganizationManagementSuccessTest.java` file, the `testGetPaginatedOrganizations` method demonstrates how `next` and `previous` links are extracted and validated from API responses for paginated organization lists.  The `getLink` helper method is used to parse these links from the JSON response. \\n\\nSimilarly, the `UserDiscoverableApplicationSuccessTest.java` file includes assertions for `next` and `previous` links in paginated application lists, confirming their presence and correct URL construction.  \\n\\n## API Endpoints or Features\\n\\nThe `_links` element with semantic tags is a feature of the REST APIs within the `wso2/product-is` repository, particularly for endpoints that support pagination.  \\n\\nExamples of API endpoints where this is implemented include:\\n\\n*   **Organization Management API**: Endpoints for listing organizations, such as `/api/server/v1/organizations`.  \\n*   **Organization Discovery API**: Endpoints related to organization discovery, which also support pagination. \\n*   **Meta Attributes API**: Endpoints for managing meta attributes of organizations, which also provide paginated results with `_links`.  \\n*   **User Application API**: Endpoints for listing user discoverable applications, which include `next` and `previous` links for pagination.  \\n\\nThe `rel` values observed in the provided snippets are primarily `next` and `previous`, indicating support for navigating through paginated results.    \\n\\n## Documentation References\\n\\nThe \"API Layer\" wiki page provides a general overview of the API architecture, including a section on \"Advanced API Features\" that mentions pagination and the inclusion of `links` in the response.  This section explicitly states that \"The response includes pagination links for navigating through the result set.\" \\n\\n## Notes\\n\\nThe provided code snippets are primarily integration tests, which demonstrate the expected behavior of the API responses. While these tests confirm the presence and structure of the `_links` element with semantic tags for pagination, they do not explicitly detail the underlying implementation logic within the API itself. The semantic tags observed are `next` and `previous`, which are standard for pagination. The prompt mentions \"semantic tags... to guide TPP through API processes for payment initiation and account information services,\" which is a broader scope than what is directly evidenced in the provided snippets. The snippets focus on general resource listing and management (organizations, applications, meta-attributes) rather than specific financial services. Therefore, while the mechanism for providing tagged hyperlinks exists, its application to \"payment initiation and account information services\" is not directly confirmed by the given context.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ae91e687-a447-4d07-a44d-c2950ef9932a\\n', 'id': 'lc_47a46bbb-1120-42f3-a560-8b8de3d994ab'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0130_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to be an API Management solution. The provided code snippets do not directly show support for the `_links` data element with semantic tags for HATEOAS (Hypermedia as the Engine of Application State) to guide TPPs (Third Party Providers) through API processes for payment initiation and account information services.    While the API definitions use OpenAPI/Swagger, which can describe API endpoints, they do not explicitly define a `_links` element in their response schemas for hypermedia controls.   \\n\\n### Implementation Details\\n\\nThe provided snippets primarily define API endpoints and their parameters and responses in OpenAPI/Swagger format.    For example, `publisher-api.yaml` defines a `GET /apis` endpoint that returns a list of APIs.  The response structure for this endpoint, as shown in an example, includes fields like `previous`, `list`, `next`, and `count`, but no `_links` element with semantic tags.  Similarly, `openapi.yaml` files define various API operations and their expected responses, but none of them explicitly include a `_links` element.  \\n\\nThe `services-config.xml` file contains a table named \"Doc Links\" with fields for \"Document Type\" and \"URL\", which are used for documentation purposes, but this is not related to hypermedia controls in API responses. \\n\\n### Configuration Options\\n\\nThere are no explicit configuration options visible in the provided snippets that would enable or disable the inclusion of `_links` elements with semantic tags in API responses. <cite/> The `api-manager.xml` file shows whitelisted URIs and ETag skip lists, which are related to API security and caching, not hypermedia. \\n\\n### API Endpoints or Features\\n\\nThe repository provides various API endpoints for managing APIs, applications, subscriptions, and documents.  For instance, there are endpoints to retrieve a list of APIs (`GET /apis`), get details of a specific API (`GET /apis/{apiId}`), and manage documents associated with an API.   However, none of the API endpoint definitions or example responses in the provided context demonstrate the inclusion of a `_links` data element for hypermedia. \\n\\n### Documentation References\\n\\nThe `README.md` files provide documentation for API endpoints and models, listing available API calls and their descriptions.  These documents describe the API\\'s functionality and data models but do not mention the use of `_links` for hypermedia controls. \\n\\n## Notes\\n\\nThe user\\'s query specifically asks about the presence of a `_links` data element with semantic tags to guide TPPs through API processes. While the codebase contains numerous API definitions and related configurations, the provided snippets do not show any evidence of this specific hypermedia control implementation. The API responses, as exemplified in `publisher-api.yaml`, contain pagination links (`previous`, `next`) but these are not the semantically tagged `_links` element typically associated with HATEOAS.  The OpenAPI definitions describe the structure of requests and responses, but they do not include a `_links` object as part of the response schema.  \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_047617cd-733f-4516-9022-df96ce58b41a\\n', 'id': 'lc_eaf2f795-36f8-4d91-bef7-de40e06dad28'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0131",
      "requirement": {
        "requirement_id": "ATOM_218",
        "requirement_text": "The headers parameter must conditionally include tpp-redirect-uri if and only if TPP-Redirect-URI header is present in the HTTP request",
        "strength": "MUST",
        "capability": "Security",
        "section_id": "ca341668f949",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0131_1",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0131_2",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0131_3",
          "text": "# redirect_endpoint config defines the user's succesfull authorisations redirect endpoint. This page displays the succesful CIBA flow completions.\nredirect_endpoint = \"https://localhost:9446/authenticationendpoint/ciba.jsp\"",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0131_4",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the conditional inclusion of a `tpp-redirect-uri` header based on the presence of a `TPP-Redirect-URI` header in the HTTP request. The provided code snippets primarily focus on OAuth2 and OpenID Connect functionalities, including DPoP (Demonstrating Proof of Possession) token handling and general HTTP request utilities. There are no explicit references to `tpp-redirect-uri` or `TPP-Redirect-URI` within the provided context.\\n\\nThe `OAuth2DPopTestCase.java` file demonstrates how DPoP proofs are generated and included in request headers for various OAuth2 flows, such as client credentials, authorization code, and refresh token grants   . However, this is related to DPoP token binding and not the `tpp-redirect-uri` header.\\n\\nThe `RESTTestBase.java` file contains utility methods for sending HTTP requests with basic authentication and various content types, but it does not show any specific logic for conditionally adding headers like `tpp-redirect-uri`  . Similarly, `OAuth2CommonClient.java` and `Utils.java` provide general methods for sending authorization requests and extracting query parameters, without any mention of `tpp-redirect-uri`  .\\n\\nBased on the provided context, there is no direct implementation, configuration option, API endpoint, or documentation reference that addresses the conditional inclusion of `tpp-redirect-uri` based on the presence of `TPP-Redirect-URI` in the HTTP request.\\n\\n## Notes\\nThe provided code snippets are primarily integration tests and utility classes for OAuth2 and OpenID Connect functionalities within the `wso2/product-is` repository. While they demonstrate how HTTP headers are constructed and sent in various scenarios, they do not contain any specific logic related to the `tpp-redirect-uri` or `TPP-Redirect-URI` headers. Therefore, I cannot confirm support for the specified requirement based on the given information.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_7c630194-9d3b-4818-b7cb-7574cefc151d\\n', 'id': 'lc_85d111e2-d252-432f-966d-5a6b2ff8d79d'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0131_5",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports conditional routing and header manipulation based on HTTP headers. While there isn\\'t a direct, explicit implementation for \"tpp-redirect-uri\" as a special header, the system provides mechanisms to define and evaluate conditions based on arbitrary HTTP headers, and to add or modify headers.\\n\\n### Implementation Details\\nThe WSO2 API Manager (APIM) allows for conditional routing of messages based on various criteria, including HTTP headers. This functionality is demonstrated in the `proxy_samples.xml` files, which show how to use a `<conditionalRouter>` with `<match type=\"header\" .../>` elements to define routing rules based on the presence and value of specific headers.  \\n\\nFor example, a condition can be set to match a header named \"foo\" with a regex \"bar.*\" . This indicates that you can define a condition to check for the presence of a header like `TPP-Redirect-URI` and its value.\\n\\nFurthermore, the system supports defining throttling policies based on header conditions. The `JWTRequestCountThrottlingTestCase.java` and `AdvancedThrottlingPolicyTestCase.java` files illustrate how `HeaderConditionDTO` objects are created and used within `ThrottleConditionDTO` to enforce throttling based on HTTP headers.   The `DtoFactory.java` provides static methods to create these DTOs, such as `createHeaderConditionDTO(String headerName, String headerValue)`. \\n\\nThe `admin-api.yaml` defines the `HeaderCondition` schema, which includes `headerName` and `headerValue` as required properties for HTTP header-based throttling conditions. \\n\\nFor adding headers, the `addHeader_v2.json` policy specification allows adding new headers to a request.  This policy takes `headerName` and `headerValue` as attributes. \\n\\n### Configuration Options\\nYou can configure conditional logic based on HTTP headers using:\\n*   **Synapse Configurations**: By defining `<conditionalRouter>` elements in proxy services, you can specify conditions to match HTTP headers using the `<match type=\"header\" source=\"header_name\" regex=\"header_value_regex\"/>` syntax. \\n*   **Throttling Policies**: Advanced throttling policies can include `HeaderConditionDTO` to apply throttling based on the presence or value of specific headers.  These policies are managed via the Admin API. \\n*   **Operation Policies**: The `addHeader` policy can be used to add headers to requests. \\n\\n### API Endpoints or Features\\nThe relevant features include:\\n*   **Conditional Routing**: The Synapse-based gateway allows for defining complex routing logic based on various message properties, including HTTP headers. \\n*   **Advanced Throttling Policies**: The Admin API exposes endpoints to create and manage advanced throttling policies that can incorporate header conditions. \\n*   **Operation Policies**: Policies like `addHeader` can be applied to API operations to manipulate headers. \\n\\n### Documentation References\\nThe `proxy_samples.xml` files provide examples of conditional routing based on HTTP headers.   These samples demonstrate how to use the `<match type=\"header\" .../>` element within a `<conditionalRouter>` to evaluate header conditions. \\n\\n## Notes\\nThe provided code snippets demonstrate the capability to define conditions based on HTTP headers and to add headers. While there is no specific mention of `tpp-redirect-uri` as a predefined special header, the generic header manipulation and conditional routing features can be used to implement the described requirement. You would need to configure a conditional rule to check for the presence of the `TPP-Redirect-URI` header and then, if present, add the `tpp-redirect-uri` header to the outgoing request. The exact mechanism for \"excluding\" a header when the condition is not met would depend on the specific policy or mediator used, but the conditional routing allows for different processing paths.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_382c7b63-fbf9-499f-818f-5310329a8c14\\n', 'id': 'lc_f362b61e-b334-4c28-8445-e51cbbf60adf'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0132",
      "requirement": {
        "requirement_id": "ATOM_055",
        "requirement_text": "The system shall support transaction status ACTC (AcceptedTechnicalCorrect) to indicate successful PSU authentication and syntactical/semantical product checks for batch booking processes",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0132_1",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0132_2",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0132_3",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0132_4",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports payment initiation processes, but the provided code snippets do not explicitly show support for the transaction status `ACTC` (AcceptedTechnicalCorrect) for batch booking. The `payment-initiation-openapi.yaml` defines various payment statuses, but `ACTC` is not among them.  The system does include mechanisms for PSU authentication and syntactical/semantical checks during payment initiation. \\n\\n## Implementation Details\\n\\nThe `wso2/financial-services-accelerator` repository provides an OpenAPI specification for payment initiation, which includes endpoints for creating and retrieving payment consents and payments.  The `obWritePaymentResponse5` schema defines the possible statuses for a payment, which are: \"AcceptedCreditSettlementCompleted\", \"AcceptedSettlementCompleted\", \"AcceptedSettlementInProcess\", \"AcceptedWithoutPosting\", \"Pending\", and \"Rejected\".  The `PaymentService.java` in the demo backend handles payment submissions and returns a `201 Created` status for successful operations. \\n\\nSyntactical and semantical checks for payment initiation payloads are performed by the `DefaultConsentManageValidator.java`.  This validator checks for the presence and validity of `DebtorAccount`, `CreditorAccount`, `LocalInstrument`, and `InstructedAmount`.  If any validation fails, it returns a `ConsentPayloadValidationResult` indicating `BAD_REQUEST`. \\n\\nPSU authentication is handled through OAuth2 security, as indicated in the `payment-initiation-openapi.yaml` for the `/payments` endpoint, which uses `PSUOAuth2Security`. \\n\\n## Configuration Options\\n\\nThe `financial-services.xml` file, parsed by `FinancialServicesConfigParser`, is used for centralized configuration.   While the provided snippets do not show specific configuration for `ACTC` status, the system is extensible through external services.  The `wso2is-7.1.0-deployment.toml` file lists various extension points, such as `pre_process_consent_creation` and `validate_authorization_request`, which could be used to integrate custom logic for status handling. \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoints for payment initiation are defined in `payment-initiation-openapi.yaml`:\\n*   `POST /payment-consents`: Used to create payment consents. \\n*   `GET /payment-consents/{consentId}`: Used to retrieve payment consents. \\n*   `POST /payments`: Used to create payments. \\n*   `GET /payments/{paymentId}`: Used to retrieve payments. \\n\\nThe `PaymentService` in the demo backend implements the `/paymentservice/payments` endpoint for payment submission. \\n\\n## Documentation References\\n\\nThe `Overview` wiki page for `wso2/financial-services-accelerator` provides a high-level overview of the system architecture and core components, including API specifications for payment initiation.  It mentions that the solution supports payment initiation use cases. \\n\\n## Notes\\n\\nThe provided code snippets do not explicitly define or use the `ACTC` transaction status. The `obWritePaymentResponse5` schema lists other accepted statuses, but `ACTC` is not among them.  It is possible that `ACTC` could be mapped to one of the existing \"Accepted\" statuses or implemented through custom extensions, but this is not directly visible in the provided context. The system does perform PSU authentication and various checks, which are prerequisites for an `ACTC` status.  \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_c27480e6-71d5-4b19-80af-52ebd3439567\\n', 'id': 'lc_73b50b84-a695-4e05-965a-96fd25caf5b1'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0133",
      "requirement": {
        "requirement_id": "ATOM_187",
        "requirement_text": "The X-Request-ID header field SHALL be mandatory and contain a UUID that is unique to the call as determined by the initiating party.",
        "strength": "SHALL",
        "capability": "General",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0133_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not explicitly enforce the `X-Request-ID` header field to be mandatory or to contain a UUID in all requests as a core feature. However, there is an instance within the `oidc-fapi-conformance-tests` module where an `X-Fapi-Interaction-Id` header, which serves a similar purpose to `X-Request-ID`, is handled and a UUID is generated if it\\'s not present . The codebase also includes a \"UUID Generator feature\"  , indicating that UUID generation capabilities are available within the product.\\n\\n### Implementation Details\\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` file, part of the OIDC FAPI conformance tests, demonstrates a resource server that checks for an `X-Fapi-Interaction-Id` header . If this header is not present in the incoming request, a new UUID is generated and assigned to it . This generated or existing `xFapi` value is then set in the response header . This specific implementation is within a test component and not a core product feature that enforces the `X-Request-ID` header across all API endpoints.\\n\\nThe `modules/p2-profile-gen/pom.xml` file lists a `UUID Generator feature`  . This indicates that the WSO2 Identity Server product includes a module for generating UUIDs, which could be utilized by other components or custom extensions to implement the `X-Request-ID` requirement.\\n\\n### Configuration Options\\n\\nThere are no explicit configuration options found in the provided snippets that directly enforce the mandating of an `X-Request-ID` header or its UUID format across all requests. The `Architecture` wiki page mentions a \"Configuration System\"  that uses `default.json`, `infer.json`, and `deployment.toml`  for dynamic configuration, but no specific settings related to `X-Request-ID` were identified.\\n\\n### API Endpoints or Features\\n\\nThe core API layer of WSO2 Identity Server, as described in the `Architecture` wiki page, includes \"Server APIs\" and \"User APIs\" . However, the provided context does not show any built-in API endpoints or features that automatically enforce the `X-Request-ID` header as mandatory. The `X-Fapi-Interaction-Id` handling is specific to the FAPI conformance test resource server .\\n\\n### Documentation References\\n\\nThe provided `Architecture` wiki page gives a high-level overview of the system . It does not contain specific documentation references regarding the `X-Request-ID` header or its enforcement.\\n\\n## Notes\\n\\nThe prompt specifically asks about the `X-Request-ID` header. While the `oidc-fapi-conformance-tests/resource-server/resource-server.py` file handles an `X-Fapi-Interaction-Id` header , which is functionally similar, it is not the exact header specified in the prompt. The presence of a `UUID Generator feature`   suggests that the capability to generate UUIDs exists within the product, which could be used to implement the requirement, but it does not imply that the `X-Request-ID` header is mandatory by default. The other snippets related to UUIDs, such as `UUID.randomUUID().toString()` in `ApplicationNativeAuthenticationTestCase.java`  and `OAuth2RequestObjectSignatureValidationTestCase.java` , are for generating UUIDs for nonces or JWT `kid` values, not for a request ID header. The `AbstractUUIDUMTestCase.java`  deals with user management based on UUIDs, which is a different context.\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_5ff795ef-eec7-45bd-a53d-82f6f3e00a57\\n', 'id': 'lc_9a1be02e-801f-4b4a-8fc7-099bc992d262'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0133_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"This repository, `wso2/product-apim`, does not explicitly support a mandatory `X-Request-ID` header field containing a UUID for all requests. However, it does define and utilize `MessageID` and `RelatesTo` headers, which are described as containing UUIDs for unique message identification and correlation.   These headers are internal properties within the WSO2 API Manager's message mediation flow.  \\n\\n### Implementation Details\\n\\nThe documentation refers to `MessageID` and `RelatesTo` as header names that can hold UUID values.   These are described as internal properties of a message within the system, and it is not recommended to alter them.   The `get-property('MessageID')` and `get-property('RelatesTo')` examples suggest these are accessible within Synapse configurations, which is the mediation engine used by WSO2 products.  \\n\\n### Configuration Options\\n\\nThere are no explicit configuration options found in the provided snippets to enforce a mandatory `X-Request-ID` header or to automatically generate one if missing. The `properties_guide.xml` files list various properties, but none directly correspond to `X-Request-ID`.  \\n\\nThe `Owasp.CsrfGuard.Carbon.properties` file mentions `X-Requested-With` header in the context of CSRF protection for Ajax requests, but this is distinct from `X-Request-ID`. \\n\\n### API Endpoints or Features\\n\\nThe provided context does not detail any specific API endpoints or features that would automatically enforce or generate an `X-Request-ID` header. The `MessageID` and `RelatesTo` headers are described as internal message properties rather than external API requirements. \\n\\n### Documentation References\\n\\nThe primary documentation references for message properties, including `MessageID` and `RelatesTo`, are found in the `properties_guide.xml` files within the `all-in-one-apim`, `gateway`, and `traffic-manager` modules.    These documents describe the purpose and usage of these internal message identifiers. \\n\\n## Notes\\n\\nWhile the repository uses `MessageID` and `RelatesTo` headers with UUIDs for internal message correlation, these are not the same as the `X-Request-ID` header specified in your requirement. The provided snippets do not indicate direct support for enforcing or generating an `X-Request-ID` header as a mandatory external requirement. To implement this, custom mediation policies or handlers would likely be needed within the WSO2 API Manager.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e84dff42-1bf3-4bbb-8c68-125732b9a5e1\\n\", 'id': 'lc_c26babde-466c-43c7-a2b9-36310f8d0e66'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0134",
      "requirement": {
        "requirement_id": "ATOM_157",
        "requirement_text": "The GET /v1/accounts/{account-id}/transactions endpoint SHALL support bookingStatus parameter with values 'booked', 'pending', 'both', and 'information'",
        "strength": "SHALL",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0134_1",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_2",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_3",
          "text": "For transaction entries subject to availability/float and for which\n      availability information is provided, the value date must not be used. In\n      this case the availability component identifies the number of availability\n      days.All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  AddressLine:\n    description: >-\n      Information that locates and identifies a specific address for a\n      transaction entry, that is presented in free format text.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBActiveOrHistoricCurrencyAndAmount:\n    type: object\n    required:\n      - Amount\n      - Currency\n    description: Amount of money in the cash transaction entry.\n    properties:\n      Amount:\n        $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n      Currency:\n        $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBCurrencyExchange5:\n    type: object\n    required:\n      - SourceCurrency\n      - ExchangeRate\n    description: Set of elements used to provide details on the currency exchange.\n    properties:\n      SourceCurrency:\n        description: >-\n          Currency from which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      TargetCurrency:\n        description: >-\n          Currency into which an amount is to be converted in a currency\n          conversion.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      UnitCurrency:\n        description: >-\n          Currency in which the rate of exchange is expressed in a currency\n          exchange. In the example 1GBP = xxxCUR, the unit currency is GBP.\n        type: string\n        pattern: '^[A-Z]{3,3}$'\n      ExchangeRate:\n        description: >-\n          Factor used to convert an amount from one currency into another. This\n          reflects the price at which one currency was bought with another\n          currency.\n\n          Usage: ExchangeRate expresses the ratio between UnitCurrency and\n          QuotedCurrency (ExchangeRate = UnitCurrency/QuotedCurrency).\n        type: number\n      ContractIdentification:\n        description: >-\n          Unique identification to unambiguously identify the foreign exchange\n          contract.\n        type: string\n        minLength: 1\n        maxLength: 35\n      QuotationDate:\n        description: >-\n          Date and time at which an exchange rate is quoted.All dates in the\n          JSON payloads are represented in ISO 8601 date-time format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_4",
          "text": "If this is not populated, the permissions will be open ended.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionFromDateTime:\n            description: >-\n              Specified start date and time for the transaction query period.\n\n              If this is not populated, the start date will be open ended, and\n              data will be returned from the earliest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n          TransactionToDateTime:\n            description: >-\n              Specified end date and time for the transaction query period.\n\n              If this is not populated, the end date will be open ended, and\n              data will be returned to the latest available transaction.All\n              dates in the JSON payloads are represented in ISO 8601 date-time\n              format.\n\n              All date-time fields in responses must include the timezone. An\n              example is below:\n\n              2017-04-05T10:43:07+00:00\n            type: string\n            format: date-time\n      Risk:\n        $ref: '#/definitions/OBRisk2'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadData1:\n    type: object\n    required:\n      - Permissions\n    properties:\n      Permissions:\n        type: array\n        items:\n          $ref: '#/definitions/OBExternalPermissions1Code'\n        minItems: 1\n        description: >-\n          Specifies the Open Banking account access data types. This is a list\n          of the data clusters being consented by the PSU, and requested for\n          authorisation with the ASPSP.\n      ExpirationDateTime:\n        description: >-\n          Specified date and time the permissions will expire.\n\n          If this is not populated, the permissions will be open ended.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionFromDateTime:\n        description: >-\n          Specified start date and time for the transaction query period.\n\n          If this is not populated, the start date will be open ended, and\n          data will be returned from the earliest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      TransactionToDateTime:\n        description: >-\n          Specified end date and time for the transaction query period.\n\n          If this is not populated, the end date will be open ended, and\n          data will be returned to the latest available transaction.All\n          dates in the JSON payloads are represented in ISO 8601 date-time\n          format.\n\n          All date-time fields in responses must include the timezone. An\n          example is below:\n\n          2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n  OBRisk2:\n    description: >-\n      The Risk section is sent by the initiating party to the ASPSP. It is used\n      to specify additional details for risk scoring for Account Info.\n    type: object\n    properties: {}\n    additionalProperties: false\n  OBExternalPermissions1Code:\n    description: >-\n      Specifies the Open Banking account access data types. This is a\n          list of the data clusters being consented by the PSU, and\n          requested for authorisation with the ASPSP.\n    type: string\n    enum:\n      - ReadAccountsBasic\n      - ReadAccountsDetail\n      - ReadBalances\n      - ReadTransactionsDetail\n  CreationDateTime:\n    description: >-\n      Date and time at which the resource was created.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_5",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0134_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The `wso2/financial-services-accelerator` repository, specifically within its `AccountandTransactionAPI` as defined in `account-info-swagger.yaml`, supports a `GET /v1/accounts/{account-id}/transactions` endpoint. However, based on the provided context, this endpoint does not explicitly support a `bookingStatus` parameter with values \\'booked\\', \\'pending\\', \\'both\\', and \\'information\\' for filtering transactions.\\n\\n### API Endpoint and Features\\nThe `GET /accounts/{AccountId}/transactions` endpoint is defined in the `account-info-swagger.yaml` file . This endpoint is intended to retrieve transaction details for a specific account . The `account-info-swagger.yaml` defines the structure of the `OBTransaction5` object, which includes a `Status` field that can be either `Booked` or `Pending` . This `Status` field is a required property of a transaction .\\n\\n### Implementation Details\\nThe `AccountService.java` file contains a demo implementation of the `getAccountTransactions` method, which corresponds to the `GET /accounts/{AccountId}/transactions` endpoint . This demo implementation returns a hardcoded JSON response that includes a transaction with a `Status` of \"Booked\" . However, this implementation does not show any logic for accepting or filtering based on a `bookingStatus` parameter . The parameters accepted by this method are `AccountId`, `x-fapi-interaction-id`, and `Account-Request-Information` .\\n\\n### Configuration Options\\nThere are no explicit configuration options in the provided snippets that would enable or disable the `bookingStatus` parameter for the transactions endpoint. The `Overview` wiki page mentions a centralized configuration approach using `financial-services.xml` . However, the details provided about this configuration do not include any settings related to transaction filtering by `bookingStatus` .\\n\\n### Documentation References\\nThe `account-info-swagger.yaml` file serves as the API specification for the Account and Transaction API . While it defines the `Status` of a transaction as `Booked` or `Pending` , it does not list `bookingStatus` as a query parameter for the `GET /accounts/{AccountId}/transactions` endpoint .\\n\\n### Test Criteria\\nThe integration tests in `EndToEndAccountFlowTest.groovy` include a test for \"Verify Accounts transaction Retrieval Request for a Authorised Consent\" . This test calls `doDefaultAccountRetrieval()` with `accountsPath` set to `ConnectorTestConstants.TRANSACTIONS_SINGLE_PATH` . The `TRANSACTIONS_SINGLE_PATH` is defined as `/open-banking/v3.1/aisp/accounts/{accountID}/transactions` . However, the test does not appear to include any parameters for `bookingStatus` or verify filtering based on such a parameter .\\n\\nIn summary, while the concept of transaction status (`Booked`, `Pending`) exists within the API definitions, the provided codebase does not indicate support for a `bookingStatus` query parameter on the `GET /v1/accounts/{account-id}/transactions` endpoint for filtering purposes.  \\n\\n## Notes\\nThe `account-info-swagger.yaml` file defines the API contract for the Account and Transaction API.  The `OBEntryStatus1Code` definition explicitly lists \"Booked\" and \"Pending\" as possible statuses for a transaction entry.  However, this is a definition of the *response* structure, not an indication of a *request* parameter for filtering.  The `parameters` section for the `GET /accounts/{AccountId}/transactions` endpoint does not include any parameter related to `bookingStatus`. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_538896bc-6ba8-4f53-8356-316328963879\\n', 'id': 'lc_57e0c14c-8fce-4319-9715-b5e07ba13a4b'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0135",
      "requirement": {
        "requirement_id": "ATOM_070",
        "requirement_text": "The system shall support consent status 'revokedByPsu' when consent has been revoked by the Payment Service User",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0135_1",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_2",
          "text": "### revokeConsent method\n\nThis method lets you revoke a consent by performing the following: \n\n - Retrieves the consent for status validation\n - Updates the existing status of the consent\n - Creates an audit record for the consent update\n - Updates the account mapping status as inactive\n\n``` java\nboolean revokeConsent(String consentID, String revokedConsentStatus) throws ConsentManagementException;\n```\n\nTo revoke tokens related to a consent, invoke the method by setting the `shouldRevokeTokens` flag `true`.\n\n``` java\nboolean revokeConsent(String consentID, String revokedConsentStatus, String userID, boolean shouldRevokeTokens) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_3",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_4",
          "text": "### revokeExistingApplicableConsents method\n\nThis method lets you revoke existing consents for a given combination of `clientID`, `userID`, `consent type`, and \n`status` parameters. It also revokes any tokens related to the consents if the `shouldRevokeTokens` flag is set to `true`.\n\n``` java\nboolean revokeExistingApplicableConsents(String clientID, String userID, String consentType, String applicableStatusToRevoke, String revokedConsentStatus, boolean shouldRevokeTokens) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0135_5",
          "text": "## Using Consent Core Service\n\nThe consent management [extension points](consent-management-manage.md) can invoke the Consent core service. WSO2 Open \nBanking Accelerator handles consent creation, update, deletion, and any other consent related functionality using a \nservice named `ConsentCoreService`. This is an interface, which you can simply invoke via any WSO2 Identity Server \nextension. The Fully Qualified Name (FQN) of `ConsentCoreService` is as follows:\n\n``` java\ncom.wso2.openbanking.accelerator.consent.mgt.service.ConsentCoreService\n```\n\n!!! note\n    The `com.wso2.openbanking.accelerator.consent.service-3.0.0.jar` JAR file inside the \n    `<IS_HOME>/repository/components/dropins` directory contains the Java implementation related to consent \n    management core services.\n    \nAccording to your requirements, invoke the relevant methods of this service. Given below is a brief description of each \nmethod.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0136",
      "requirement": {
        "requirement_id": "ATOM_188",
        "requirement_text": "The Consent-ID header field SHALL be mandatory and contain identification of the corresponding consent as granted by the PSU.",
        "strength": "SHALL",
        "capability": "Consent Management",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0136_1",
          "text": "### getDetailedConsent method\n \nThis method lets you retrieve detailed consent for a given consent ID. A detailed consent includes the following in \naddition to consent resource-specific data: \n\n - Relative consent authorization data\n - Relative consent account mapping data \n - Relative consent attributes\n \n``` java\nDetailedConsentResource getDetailedConsent(String consentID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_2",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_3",
          "text": "### Data\nThe following table explains the data available in `ConsentValidateData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| headers   | JSONObject            | The request headers sent in the request. |\n| body   | JSONObject            | The payload sent in the request. |\n| electedResource   | String            | The path invoked in the request. For example: `/accounts/{AccountId}`|\n| consentId | String                | The consent ID related to the current resource request. This consent ID is bound to the user access token used. |\n| userId | String                | The user ID related to the current resource request. This user ID is retrieved from the user access token. |\n| clientId | String                | The ID of the TPP application related to the current resource request. This client ID is retrieved from the user access token.|\n| comprehensiveConsent  | DetailedConsentResource   | The comprehensive consent object related to the consent that is being validated. This object contains all the details related to the consent. |\n| resourceParams | Map<String, String>                | A map containing the full resource path with query parameters (ex: `aisp/accounts/{AccountId}?queryParam=urlEncodedQueryParamValue`), HTTP method, and context (ex: `/open-banking/v3.1/aisp`) of the request. |\n\nThe following table explains the data available in `ConsentValidationResult`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| isValid | boolean | An attribute to identify whether the consent is in a valid state or not. |\n| modifiedPayload | JSONObject | Optionally used to set a modified error payload to be sent with the consent validation response. If a modified payload is set, it is given priority over creating a generic error response using the message and code information. |\n| consentInformation | JSONObject | Used to set the consent data to the consent validation result. This data will be sent to the bank backend. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_4",
          "text": "### amendConsentData method\n\nThis method lets you amend the consent receipt or validity period. It is mandatory to provide the consent ID with \neither the consent receipt or validity period. When the consent is amended, an audit record is created to indicate that \nhowever the status of the consent won't be changed.\n\n``` java\nConsentResource amendConsentData(String consentID, String consentReceipt, Long consentValidityTime, String userID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_5",
          "text": "### Data \nThe following table explains the data available in `ConsentRetrieveData`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| sessionDataKey| String    | The session data key of the current authorization consent. If required, this can be used as a unique identifier. |\n| userId        | String    | The user ID of the currently authenticated user. |\n| spQueryParams | String    | The query parameters related to the current consent invocation. This contains details such as the request object of the authorize request. |\n| scopeString   | String    | The scopes that the user is being authorized for. |\n| application   | String    | The application that is requesting consent from the user to make requests on behalf of them. |\n| consentId     | String    | The consent ID of the currently requested consent. This has to be set in the retrieval steps. |\n| requestHeaders| Map<String, String>   | Any request headers sent from the client UI during the consent flow. |\n| consentResource   | ConsentResource   | The consent resource object of the consent that is currently requested. |\n| authResource  | AuthorizationResource | The authorization resource object of the current authorization. |",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support consent management, including the handling of consent receipts and related API endpoints. However, there is no direct evidence within the provided snippets to confirm that a `Consent-ID` header field is mandatory for balance requests or that it is explicitly validated against an active consent. The existing code primarily focuses on managing consent records and self-registration with consent.\\n\\n### Implementation Details  \\nThe repository includes integration tests for consent management, specifically within the `ConsentMgtTestCase.java`  and `SelfSignUpConsentTest.java`  files. These tests demonstrate the creation and retrieval of consent receipts.\\n\\nThe `ConsentMgtTestCase` class defines an endpoint suffix `CONSENT_ENDPOINT_SUFFIX = \"/api/identity/consent-mgt/v1.0/consents\"`  for consent-related operations. It includes methods to add PII categories, purpose categories, purposes, and consent receipts . The `addReceipt` method constructs a JSON payload for a consent receipt, which includes details like `piiPrincipalId`, `service`, `consentType`, and `policyURL` .\\n\\nThe `SelfSignUpConsentTest` class also interacts with consent endpoints, specifically for self-registration with consent. It has methods to `getConsents` and `getConsent` by `receiptId` . The `getConsentReqBody` method constructs a consent request body that includes `piiPrincipalId` and `purposeId` .\\n\\nThe `OAuth2ServiceAbstractIntegrationTest` class contains methods like `sendApprovalPostWithConsent`  which indicates that consent approval is part of the OAuth2 flow. The `Utils.java` file provides a utility method `getConsentRequiredClaimsFromResponse`  to extract claims requiring user consent from an HTTP response.\\n\\n### Configuration Options  \\nThe `default-identity.xml` configuration file includes a `<Consent>` section with an `<EnableSSOConsentManagement>` flag . Setting this to `true` enables consent management during SSO.\\n\\nThe `db_separation_config.toml` file defines a `CONSENT_DB` datasource  and links it to `authentication.consent.data_source` , indicating that consent data is persisted in a dedicated database.\\n\\n### API Endpoints or Features  \\nThe primary API endpoint for consent management is `/api/identity/consent-mgt/v1.0/consents` . This endpoint is used for managing consent receipts. There\\'s also a specific endpoint for retrieving consent receipts by ID: `/api/identity/consent-mgt/v1.0/consents/receipts/(.*)` .\\n\\nOther related endpoints include:\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes` for managing purposes .\\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories` for managing PII categories .\\n*   `/api/identity/consent-mgt/v1.0/consents/purpose-categories` for managing purpose categories .\\n\\nThese endpoints support various HTTP methods (POST, GET, DELETE) with corresponding permissions defined in `default-identity.xml` .\\n\\n### Documentation References  \\nThe provided wiki page \"Advanced Features\"   includes a section on \"Consent Management\" that describes its purpose, key components (PII Categories, Purposes, Purpose Categories, Consent Receipts), and the consent collection and enforcement processes. It also references the `SelfSignUpConsentTest.java` and `ConsentMgtTestCase.java` files as sources for consent management.\\n\\n## Notes\\n\\nWhile the repository clearly supports consent management and the concept of consent receipts, the provided code snippets do not explicitly show the enforcement of a mandatory `Consent-ID` header field for \"balance requests\" or its validation against an active consent. The existing consent management features are more focused on recording and retrieving consent decisions for user attributes and services. To verify the specific requirement of a mandatory `Consent-ID` header for balance requests, further investigation into the API layer handling such requests would be necessary.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e5adc29d-cf55-483c-b1eb-5f7e31579e28\\n', 'id': 'lc_e20b2fd2-b626-4e01-84dd-84f51e110cab'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0136_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_1e213b2c-18d1-421a-9e29-4a5a82d90b0e'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0137",
      "requirement": {
        "requirement_id": "ATOM_220",
        "requirement_text": "TPP SHALL include the TPP-Signature-Certificate header containing the TPP's eIDAS certificate when making authenticated requests",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "4e52743eb3ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0137_1",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0137_2",
          "text": "### Step 5: Invoking Accounts and Transaction API\n\nOnce the user approves the account consent, the TPP is eligible to access the account details of the user.\n\nThe TPP can now invoke the GET/ accounts endpoint available in the Account and Transaction API. This retrieves a full list of accounts that the user has authorised the TPP to access. The Account Ids returned are used to retrieve other resources for a specific AccountId.\n \n- A sample request looks as follows:\n   ```\n   curl -X GET \\\n   https://localhost:8243/open-banking/v3.1/aisp/accounts \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'Authorization: Bearer <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/json; charset=UTF-8' \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   ```\n\n- The request retrieves the account information for all the accounts related to the user. Given below is a sample response:\n\n```\n{\n    \"Data\": {\n        \"Account\": [\n            {\n                \"AccountId\": \"30080012343456\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\",\n                \"Account\": [\n                    {\n                        \"SchemeName\": \"SortCodeAccountNumber\",\n                        \"Identification\": \"30080012343456\",\n                        \"Name\": \"Mr Kevin\",\n                        \"SecondaryIdentification\": \"00021\"\n                    }\n                ]\n            },\n            {\n                \"AccountId\": \"30080098763459\",\n                \"Status\": \"Enabled\",\n                \"StatusUpdateDateTime\": \"2020-04-16T06:06:06+00:00\",\n                \"Currency\": \"GBP\",\n                \"AccountType\": \"Personal\",\n                \"AccountSubType\": \"CurrentAccount\",\n                \"Nickname\": \"Bills\",\n                \"OpeningDate\": \"2020-01-16T06:06:06+00:00\",\n                \"MaturityDate\": \"2025-04-16T06:06:06+00:00\"\n            }\n        ]\n    },\n    \"Links\": {\n        \"Self\": \"https://api.alphabank.com/open-banking/v4.0/accounts\"\n    },\n    \"Meta\": {\n        \"TotalPages\": 1\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0137_3",
          "text": "swagger: '2.0'\ninfo:\n  title: DynamicClientRegistrationAPI\n  description: >\n    This specification defines the APIs for a TPP to submit a Software Statement\n    Assertion to an ASPSP for the purpose of creating OAuth clients that are\n    registered with ASPSP.\n  version: v3.3.0\nbasePath: /open-banking/{version}\nschemes:\n  - https\nconsumes:\n  - application/jwt\nproduces:\n  - application/json\npaths:\n  /register:\n    post:\n      summary: Register a client by way of a Software Statement Assertion\n      description: Endpoint will be secured by way of Mutual Authentication over TLS\n      tags:\n        - Client Registration\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n      responses:\n        '201':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n      x-auth-type: None\n      x-throttling-tier: Unlimited\n  '/register/{ClientId}':\n    get:\n      summary: Get a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    put:\n      summary: Update a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientRegistrationRequest'\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/ClientRegistration'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n    delete:\n      summary: Delete a client by way of Client ID\n      tags:\n        - Client Registration\n        - Optional\n      parameters:\n        - $ref: '#/parameters/ClientId'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          description: Client deleted\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/403Error'\n      security:\n        - TPPOAuth2Security: []\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\nparameters:\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  ClientId:\n    name: ClientId\n    description: The client ID\n    in: path\n    type: string\n    required: true\n  ClientRegistrationRequest:\n    name: requestBody\n    description: A request to register a Software Statement Assertion with an ASPSP\n    in: body\n    schema:\n      type: string\n      format: ClientRegistration\nresponses:\n  ClientRegistration:\n    description: Client registration\n    schema:\n      allOf:\n        - $ref: '#/definitions/ClientRegistration'\n        - required:\n            - client_id\n  400Error:\n    description: Request failed due to client error\n    schema:\n      $ref: '#/definitions/RegistrationError'\n  401Error:\n    description: Request failed due to unknown or invalid Client or invalid access token\n    headers:\n      WWW-Authenticate:\n        description: 'Response header field specified in https://tools.ietf.org/html/rfc6750'\n        type: string\n        pattern: ^Bearer .*\n  403Error:\n    description: 'The client does not have permission to read, update or delete the Client'\n  405Error:\n    description: Method Not Allowed\ndefinitions:\n  SupportedAlgorithms:\n    type: string\n    enum:\n      - RS256\n      - PS256\n      - ES256\n  RegistrationProperties:\n    type: object\n    required:\n      - redirect_uris\n      - token_endpoint_auth_method\n      - grant_types\n      - scope\n      - software_statement\n      - application_type\n      - id_token_signed_response_alg\n      - request_object_signing_alg\n    properties:\n      client_id:\n        description: OAuth 2.0 client identifier string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_secret:\n        description: OAuth 2.0 client secret string\n        type: string\n        minLength: 1\n        maxLength: 36\n      client_id_issued_at:\n        description: >-\n          Time at which the client identifier was issued expressed as seconds\n          since 1970-01-01T00:00:00Z as measured in UTC\n        type: integer\n        format: int32\n        minimum: 0\n      client_secret_expires_at:\n        description: >-\n          Time at which the client secret will expire expressed as seconds since\n          1970-01-01T00:00:00Z as measured in UTC. Set to 0 if does not expire\n        type: integer\n        format: int32\n        minimum: 0\n      redirect_uris:\n        type: array\n        items:\n          type: string\n          format: uri\n          minLength: 1\n          maxLength: 256\n      token_endpoint_auth_method:\n        type: string\n        enum:\n          - private_key_jwt\n          - client_secret_jwt\n          - client_secret_basic\n          - client_secret_post\n          - tls_client_auth\n      grant_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - client_credentials\n            - authorization_code\n            - refresh_token\n            - urn:openid:params:grant-type:ciba\n        minItems: 1\n      response_types:\n        type: array\n        items:\n          type: string\n          enum:\n            - code\n            - code id_token\n      software_id:\n        type: string\n        minLength: 1\n        maxLength: 22\n        pattern: '^[0-9a-zA-Z]{1,22}$'\n      scope:\n        type: string\n        minLength: 1\n        maxLength: 256\n      software_statement:\n        type: string\n        format: JWT\n      application_type:\n        type: string\n        enum:\n          - web\n          - mobile\n      id_token_signed_response_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      request_object_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      token_endpoint_auth_signing_alg:\n        $ref: '#/definitions/SupportedAlgorithms'\n      tls_client_auth_subject_dn:\n        type: string\n        minLength: 1\n        maxLength: 128\n      backchannel_token_delivery_mode:\n        type: string\n        enum:\n          - poll\n          - ping\n          - push\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba\n      backchannel_client_notification_endpoint:\n        type: string\n        minLength: 1\n        maxLength: 256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba and \n          backchannel_token_delivery_mode is not poll. \n          This must be a valid HTTPS URL\n      backchannel_authentication_request_signing_alg:\n        type: string\n        enum:\n          - RS256\n          - PS256\n          - ES256\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified iff the grant_types includes \n          urn:openid:params:grant-type:ciba.\n      backchannel_user_code_parameter_supported:\n        type: boolean\n        description: >-\n          As defined in CIBA - Registration and Discovery Metadata. \n          This value MUST be specified only if the grant_types includes \n          urn:openid:params:grant-type:ciba. \n          If specified, it MUST be set to false.\n  ClientRegistration:\n    allOf:\n      - type: object\n        required:\n          - iss\n          - iat\n          - exp\n          - aud\n          - jti\n        properties:\n          iss:\n            description: Unique identifier for the TPP. Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,22}$'\n            minLength: 1\n            maxLength: 22\n          iat:\n            description: >-\n              The time at which the request was issued by the TPP  expressed as\n              seconds since 1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          exp:\n            description: >-\n              The time at which the request expires expressed as seconds since\n              1970-01-01T00:00:00Z as measured in UTC\n            type: integer\n            format: int32\n          aud:\n            description: |\n              The audience for the request. This should be the unique identifier\n              for the ASPSP issued by the issuer of the software statement.\n              Implemented as Base62 encoded GUID\n            type: string\n            pattern: '^[0-9a-zA-Z]{1,18}$'\n            minLength: 1\n            maxLength: 18\n          jti:\n            description: Unique identifier for the JWT implemented as UUID v4\n            type: string\n            pattern: >-\n              ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$\n            minLength: 36\n            maxLength: 36\n      - $ref: '#/definitions/RegistrationProperties'\n  RegistrationError:\n    type: object\n    required:\n      - error\n    properties:\n      error:\n        type: string\n        enum:\n          - invalid_redirect_uri\n          - invalid_client_metadata\n          - invalid_software_statement\n          - unapproved_software_statement\n      error_description:\n        type: string\n        minLength: 1\n        maxLength: 500\nsecurityDefinitions:\n  TPPOAuth2Security:\n    type: oauth2\n    flow: application\n    description: >-\n      TPP client credential authorisation flow with the ASPSP. No scopes defined\n      as per specification\n    tokenUrl: 'https://authserver.example/token'\n    scopes: {}",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0137_4",
          "text": "### Step 5: Generate keys\n\nThe TPP application requires a Client ID (Consumer Key) to access the subscribed API.\n\n1. Go to the **Applications** tab in the Developer Portal.\n\n2. From the application list, select your application, which has subscribed to the API.\n\n3. Select **Production Keys** > **OAuth2 Tokens or Sandbox Keys** > **OAuth2 Tokens** according to the type of key you require:\n    a. Production Keys: Generates access tokens in the production environment.\n    b. Sandbox Keys: Generates access tokens in the sandbox environment. \n     ![generate_keys](../../assets/img/learn/mcr/generate-keys.png)\n\n4. Provide the requested information as defined below:\n\n    | Field | Description |\n    |-------|-------------|\n    | Grant Types | Determine the credentials that are used to generate the access token. <ul> <li> Code: Relates to the authorisation code grant type and is applicable when consuming the API as a user. **It is mandatory to select the code grant type for regulatory applications.** </li> <li> Client Credentials: Relates to the client credentials grant type and is applicable when consuming the API as an application. </li> <li> Refresh Token: To renew an expired access token. </li> </ul> |\n    | Callback URL | The URL used by the TPP to receive the authorization code sent from the bank. The authorisation code can be used later to generate an OAuth2 access token. <br/> **This is a mandatory field for the authorization code grant type.** |\n    | Enable PKCE | Enable if you want to enable PKCE support for your application |\n    | Support PKCE Plain text | Enable if you want to enable PKCE Plain Text support for your application |\n    | Application Certificate | This is the content of the application certificate (.PEM). For Regulatory applications, it is mandatory to use an application certificate. Use [Signing Certificate](../../assets/attachments/signing-certs/obsigning.pem) for testing porpose. |\n    | Regulatory Application | The type of application. If your application complies with the Open Banking Regulation, it is a Regulatory application. |\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-1.png)\n\n    ![enter_application_details](../../assets/img/learn/mcr/enter-application-details-2.png)\n\n5. Click **GENERATE KEYS** to generate production or sandbox keys.\n\n6. It generates the consumer key and consumer secret and displays them at the top of the page.\n\n    ![generated-keys](../../assets/img/learn/mcr/generated-keys.png)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0137_5",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0137_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the use of client certificates for authentication, which is relevant to the `TPP-Signature-Certificate` header requirement. Specifically, it includes components for handling X.509 certificates and certificate-bound tokens, which are foundational for such a feature.\\n\\n## Implementation Details \\n\\nThe `wso2/product-is` repository contains code that demonstrates the processing of client certificates for authentication, particularly within the context of Financial-grade API (FAPI) conformance tests. The `oidc-fapi-conformance-tests/resource-server/resource-server.py` file includes functions to extract and validate client certificate thumbprints. \\n\\nThe `computeSHA256Thumbprint` function in `resource-server.py` takes a client certificate as input, decodes it, and computes its SHA256 thumbprint.  This thumbprint is then compared with a thumbprint extracted from the access token (`cnf` claim), indicating support for certificate-bound access tokens.  The `getThumbprintFromClientCertificate` function retrieves the client certificate from the `X-Ssl-Cert` header of the request. \\n\\nFurthermore, the `catalina-server.xml.j2` template includes a `X509CertificateAuthenticationValve` which suggests that the server can be configured to perform X.509 certificate authentication at the Tomcat level.  This valve is responsible for handling client certificates presented during the TLS handshake. \\n\\nThe `OAuth2RequestObjectSignatureValidationTestCase.java` test case demonstrates how an application\\'s public certificate can be updated, which is a prerequisite for validating signed requests or client certificates.  This test updates the application\\'s certificate using the `updateApplicationCertificate` method. \\n\\n## Configuration Options \\n\\nThe `oidc-metadata.json` file indicates that `certificate` is a supported `accessTokenBindingType`.  This suggests that access tokens can be bound to client certificates, which is a mechanism often used in conjunction with the `TPP-Signature-Certificate` header. \\n\\nThe `catalina-server.xml.j2` template also shows a `custom_transport.x509` configuration block, which allows for custom X.509 certificate-based transport configurations.  This implies that the server can be configured to accept and process client certificates at the transport layer. \\n\\n## API Endpoints or Features \\n\\nThe `OAuth2 and OpenID Connect` wiki page mentions \"Certificate\" as a token binding type, indicating that the system supports binding tokens to client certificates.  This is a key feature for implementing the `TPP-Signature-Certificate` header requirement. \\n\\nThe `tokenEndpointAuthMethod` options in `oidc-metadata.json` include `tls_client_auth` (Mutual TLS), which is directly related to client certificate authentication at the token endpoint. \\n\\n## Documentation References \\n\\nThe `OAuth2 and OpenID Connect` wiki page, under the \"Token Binding\" section, lists \"Certificate\" as a binding type.  This implies that the system is designed to handle scenarios where tokens are bound to client certificates. \\n\\nThe `Features and Capabilities` wiki page also mentions \"Certificate\" as a token binding type under \"Token Management\" -> \"Token Binding\".  This further confirms the system\\'s capability to work with certificate-bound tokens. \\n\\n## Notes\\n\\nThe provided snippets strongly suggest that WSO2 Identity Server supports client certificate authentication and certificate-bound tokens, which are crucial for implementing the `TPP-Signature-Certificate` header requirement. The `oidc-fapi-conformance-tests/resource-server/resource-server.py` file provides a concrete example of how client certificates are processed and validated in a FAPI context.  The `catalina-server.xml.j2` configuration and the `oidc-metadata.json` file indicate that these features are configurable within the product.   While the snippets don\\'t explicitly mention \"eIDAS certificate\" or \"TPP-Signature-Certificate header\", the underlying mechanisms for client certificate handling and token binding are present and align with the requirements.  \\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_847a34bd-02c7-4a5a-ae35-92bd14b0eb5a\\n', 'id': 'lc_765ad060-9c51-48cd-84e3-b44b1b74ba8d'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0137_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_0257ec38-5bc0-4749-b599-dd0f92d1483b'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0138",
      "requirement": {
        "requirement_id": "ATOM_031",
        "requirement_text": "The card-accounts endpoint MUST deliver credit card account related account information where the account is used to reconcile credit card transactions with the PSU",
        "strength": "MUST",
        "capability": "Account Information",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0138_1",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_2",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_3",
          "text": "This document provides step by step instructions to tryout the flow with Manual Client Registration. This includes\n\n- Setting up WSO2 FInancial Services Key Manager\n- Create application using Manual Client Registration\n- Tryout Accounts Information Flow using application created using Manual Client Registration",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0138_4",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, the WSO2 Financial Services Accelerator, supports the retrieval of credit card account information through its Account Information Service Provider (AISP) APIs. Specifically, the `GET /accounts` endpoint can deliver account details, and the `GET /accounts/{AccountId}/transactions` endpoint provides transaction information, which can be used for reconciling credit card transactions. \\n\\n### API Endpoints and Features\\n\\nThe `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml` file defines the OpenAPI specification for the Account and Transaction API. This specification includes the following relevant endpoints:\\n*   `GET /accounts`: This endpoint is used to retrieve a list of accounts. It is secured with `PSUOAuth2Security` and requires the `accounts` scope. \\n*   `GET /accounts/{AccountId}`: This endpoint retrieves details for a specific account identified by `AccountId`. It also requires `PSUOAuth2Security` and the `accounts` scope. \\n*   `GET /accounts/{AccountId}/transactions`: This endpoint provides transaction details for a given `AccountId`. It is secured with `PSUOAuth2Security` and the `accounts` scope. \\n\\nThe `OBExternalAccountSubType1Code` definition within the OpenAPI specification explicitly lists `CreditCard` as a possible account sub-type, indicating support for credit card accounts.  The `OBTransaction5` schema, used for transaction responses, includes fields like `AccountId`, `CreditDebitIndicator`, `Amount`, and `CardInstrument`, which are crucial for transaction reconciliation. \\n\\n### Implementation Details\\n\\nThe `AccountService.java` in the `demo.backend` module provides a sample implementation for these account-related endpoints.  For instance, the `getAccounts` method returns a hardcoded JSON response that includes an `AccountSubType` of \"CurrentAccount\", demonstrating the structure for account information.  While this is a demo backend, it illustrates the expected data structure and the presence of account sub-types.\\n\\nThe `fs-integration-test-suite` includes `EndToEndAccountFlowTest.groovy`, which verifies the functionality of these account APIs.  Specifically, the test `Verify Accounts transaction Retrieval Request for a Authorised Consent` confirms that transaction retrieval works for an authorized consent, which is directly relevant to reconciling credit card transactions. \\n\\n### Configuration Options\\n\\nThe `financial-services-accelerator` uses a centralized configuration approach through the `financial-services.xml` file, parsed by the `FinancialServicesConfigParser` class.  While the provided snippets do not show specific configuration options directly related to enabling or disabling \"card-accounts\" as a distinct endpoint, the overall API management and consent framework are configurable. The `financial-services.xml` file and `wso2is-7.0.0-deployment.toml` contain settings for consent management, identity extensions, and event notifications, which indirectly affect how account information, including credit card data, is exposed and managed. \\n\\n### Documentation References\\n\\nThe `Overview` wiki page for the `wso2/financial-services-accelerator` repository mentions \"Account Information APIs\" as one of the API categories supported, which includes `Accounts`, `Balances`, and `Transactions`. <cite repo=\"wso2/financial-services-accelerator\" path=\"financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml\" start=\"1-30\" /> This overview also states that the solution supports \"account information services\" and implements regulatory standards for consent management and secure API access.  The OpenAPI specification in `financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml` serves as the primary documentation for the structure and behavior of the account information endpoints. <cite repo=\"wso2/financial-services-accelerator\" path=\"financial-services-accelerator/accelerators/fs-apim/repository/resources/apis/Accounts/account-info-swagger.yaml\" start=\"1-60\" />\\n\\n## Notes\\n\\nThe prompt specifically asks about a \"card-accounts\" endpoint. While there isn\\'t an endpoint explicitly named `/card-accounts`, the existing `/accounts` endpoint, combined with the `AccountSubType` of `CreditCard` in the OpenAPI definition, indicates that credit card account information would be delivered through the general account information APIs. The `GET /accounts/{AccountId}/transactions` endpoint would then provide the necessary transaction details for reconciliation.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_d64691f7-09d5-4744-aeac-7cadf7e4b7b0\\n', 'id': 'lc_108e6fd1-fb4f-4941-94a7-0f140b83ac9a'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0139",
      "requirement": {
        "requirement_id": "ATOM_189",
        "requirement_text": "The Authorization header field SHALL only be contained if an OAuth2 based authentication was performed in a pre-step or an OAuth2 based SCA was performed in the related consent authorisation.",
        "strength": "SHALL",
        "capability": "Authentication",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0139_1",
          "text": "During the consent authorization process, the banks redirect customers to provide consent for API consumers to access their banking information. The process is as follows: 1. API consumer requests to access the banking information of a customer. 2. Bank validates the API consumer\u2019s request. 3. The bank redirects the requested information (containing the information the API consumer application wants to access) to the customer. 4. The bank authenticates the customer. See below for the default login page of the consent page: ![login-consent-page](../assets/img/develop/customizing-consent-page/login-of-consent-page.png) 5. A list of bank accounts and the information that the API consumer wishes to access are displayed. ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png) 6. The customer can view the information before consenting or denying it. For example, ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) ##Consent Authorization in WSO2 Open Banking Accelerator Following components perform the consent authorization: ###Authorization endpoint Before the API consumer application accesses the customer's banking information, the API consumer sends an authorization request to get the customer's consent for it. The authorization request contains a request object. This request object is a self-contained JWT, which helps banks to validate the API consumer. The method of sending the authorization request can vary as follows: - **Send the authorization details in the authorization URL** The API consumers share the request object containing the authorization details to the authorization server and obtain the authorization URL. - **Send the authorization details as a reference in the authorization URL** The API consumers push authorization details directly to the authorization server and obtain a reference. This method is also known as **Pushed Authorization**. The reference is notated by the claim; `request_uri`. Thereby, it prevents: - Intruders from intercepting the authorization information sent in the request_object - Authorization request calls becoming bulky with the authorization details signed in the JWT and protects the confidentiality and integrity of the authorization details when passing through an API consumer application. ###Pushed Authorization web application The API consumers obtain `request_uri` which is a reference to the authentication and authorization details sent in the pushed authorization request. - **Pushed Authorization - /par endpoint** Upon successful invocation of the `/par` endpoint, API consumers will receive a `request_uri` value with an expiration time. Therefore, the reference is only valid until the expiration time for the subsequent authorization invocation. Given below is a successful response: ``` { \"request_uri\": \"urn:ietf:params:oauth:request_uri:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` This same `request_uri` value is used in the subsequent authorization request as well. WSO2 Open Banking Accelerator allows you to perform custom validations for the pushed authorization request. For more information, see [writing a Custom Pushed Auth Request Validator](../develop/custom-pushed-auth-request-validator.md). ??? tip \"Click here to see configurations related to the Pushed Authorization web application...\" 1. Open the `<IS_HOME>/repository/conf/deployment.toml` file. 2. Add the following configurations that allow you to change the format and the expiration time of the `request_uri` reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_2",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_3",
          "text": "### Step 5: Validate Account Information Invocation\n\nThe Consent Validate implements the validations that are required when the resource endpoints are invoked with a user access token.\n\n!!! note\n    In a real-life open banking environment, the API consumer applications can retrieve details of accounts for which \n    the bank customer has granted them consent.\n \n- A sample request looks as follows:\n   ```\n   curl -X POST \\\n   https://localhost:9446/api/fs/consent/validate/validate \\\n   -H 'x-fapi-financial-id: open-bank' \\\n   -H 'x-wso2-client-id: <CLIENT_ID>' \\\n   -H 'Authorization: Basic <AUTH_HEADER_VALUE>' \\\n   -H 'Accept: application/json' \\\n   -H 'Content-Type: application/jwt \\\n   --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH> \\\n   --data 'eyJraWQiOiJjSVlvLTV6WDRPVFdacEhybW1pWkRWeEFDSk0iLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.CgkJCXsKICAgICAgCQkJImhlYWRlcnMiOiB7CiAJCQkgIAkJIkF1dGhvcml6YXRpb24iOiAiQmFzaWMgYVhOZllXUnRhVzVBZDNOdk1pNWpiMjA2ZDNOdk1qRXlNdz09IiwKIAkJCSAJIAkiY29uc2VudC1pZCI6ICIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLAogCQkJICAJCSJhY3Rpdml0eWlkIjogIjg2NjZhYTg0LWZjNWEtNDI1ZS05MWM5LTM3ZmEzMGE5NTc4NCIsCiAJCQkgIAkJIkNhY2hlLUNvbnRyb2wiOiAibm8tY2FjaGUiLAogCQkJICAJCSJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogCQkgICAgICAJCSJVc2VyLUFnZW50IjogIlBvc3RtYW5SdW50aW1lLzcuMjguNCIsCiAJCQkgIAkJIkhvc3QiOiAibG9jYWxob3N0OjgyNDMiLAogCQkJICAJCSJQb3N0bWFuLVRva2VuIjogIjI0NGQxNWI2LWViMTgtNDA0NS1iYTg3LThlZTZjODMwYjg0YyIsCiAJCQkgIAkJIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlLCBiciIsCiAJCQkgIAkJImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IgogCQkJICAJfSwKICAgICAgICAJCSJjb25zZW50SWQiOiAiMTJhNGViYzgtYjk4Yy00ZjgwLTlhMzctNDQ2NzkzNjNiOTdiIiwKICAgICAgICAJCSJyZXNvdXJjZVBhcmFtcyI6IHsKCQkJCQkicmVzb3VyY2UiOiAiL2Fpc3AvYWNjb3VudHMiLAoJCQkJCSJjb250ZXh0IjogIi9vcGVuLWJhbmtpbmcvdjMuMS9haXNwIiwKCQkJCQkiaHR0cE1ldGhvZCI6ICJHRVQiCiAJCQkgCSB9LAogCQkJICAgICJ1c2VySWQiOiAicHN1QHdzbzIuY29tIiwKICAgICAJCSAJImVsZWN0ZWRSZXNvdXJjZSI6ICIvYWNjb3VudHMiLAoJCQkJImNsaWVudElkIjogImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiCiAJCQl9CiAgICAJCQk.mjbOnLQUvpCfIpy8WRaYxBmSMnENNIu7OG89Dc7kLJTk9NebnKsgFRo0PAyrkCN-h0g5PRfM0HPhSeBxbazgjekaLpA0iSXiuaXKZUmIUSBORNxORjvqD6flQRzUraaf2qG_OKSBMBpal-unqjcCAlNdgwclCnJMwDmQrJPMqs7jJoiJAudIHwppnJ1uK82Zz_J3bWkL4kEuT4Hz4P8ukdTzTALCPGqxt4VT4dh_ADzR-NTGmpAuSNo8dEWkW9a3QAxhS4WZXRTK192wAS16YqRPOk3UXasqF2qI1KVBb5txNFtjw5eZFW0Eg8cNSOQ0BSwp3B_6zd0jHf9EiwTbLA'\n   ```\n\n???tip \"Click here to see a sample data payload...\"\n      - Given below is a sample payload in the JWT format:\n\n           ```\n           {\n               \"kid\": \"<The KID value of the signing jwk set>\",\n               \"alg\": \"<SUPPORTED_ALGORITHM>\",\n               \"typ\": \"JWT\"\n           }\n           {\n               \"headers\": {\n                  \"Authorization\": \"Basic aXNfYWRtaW5Ad3NvMi5jb206d3NvMjEyMw==\",\n                  \"consent-id\": \"12a4ebc8-b98c-4f80-9a37-44679363b97b\",\n                  \"activityid\": \"8666aa84-fc5a-425e-91c9-37fa30a95784\",\n                  \"Cache-Control\": \"no-cache\",\n                  \"Connection\": \"keep-alive\",\n                  \"User-Agent\": \"PostmanRuntime/7.28.4\",\n                  \"Host\": \"localhost:8243\",\n                  \"Postman-Token\": \"244d15b6-eb18-4045-ba87-8ee6c830b84c\",\n                  \"Accept-Encoding\": \"gzip, deflate, br\",\n                  \"accept\": \"application/json; charset=utf-8\"\n               },\n               \"consentId\": \"<CONSENT_ID>\",\n               \"resourceParams\": {\n               \"resource\": \"/aisp/accounts\",\n               \"context\": \"/open-banking/v3.1/aisp\",\n               \"httpMethod\": \"GET\"\n           },\n           \"userId\": \"psu@wso2.com\",\n           \"electedResource\": \"/accounts\",\n           \"clientId\": \"<CLIENT_ID>\"\n           }\n           ```\n     \n- The request validates the Account Information access request. \n\n    !!! note\n        The response contains the validity of the Account access request along with consent information or the reason for the validation failure.\n\n```\n{\n    \"isValid\": true,\n    \"consentInformation\": \"eyJhbGciOiJSUzI1NiJ9.eyJjbGllbnRJZCI6ImpYdUhQeFBoaXRNVWV2ZDRkMzFHU3MyNXVXY2EiLCJjdXJyZW50U3RhdHVzIjoiQXV0aG9yaXNlZCIsImNyZWF0ZWRUaW1lc3RhbXAiOjE3NDkwMTQ4MjYsInJlY3VycmluZ0luZGljYXRvciI6ZmFsc2UsImF1dGhvcml6YXRpb25SZXNvdXJjZXMiOlt7InVwZGF0ZWRUaW1lIjoxNzQ5MDE0ODU4LCJjb25zZW50SWQiOiIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLCJhdXRob3JpemF0aW9uSWQiOiI0NzRlYzFhMS1kZDRkLTQ1YjQtYTk4Zi1kMWYwNGRlMjUxYWEiLCJhdXRob3JpemF0aW9uVHlwZSI6ImF1dGhvcmlzYXRpb24iLCJ1c2VySWQiOiJwc3VAd3NvMi5jb20iLCJhdXRob3JpemF0aW9uU3RhdHVzIjoiQXV0aG9yaXNlZCJ9XSwidXBkYXRlZFRpbWVzdGFtcCI6MTc0OTAxNDg1OCwiY29uc2VudF90eXBlIjoiYWNjb3VudHMiLCJ2YWxpZGl0eVBlcmlvZCI6MCwiY29uc2VudEF0dHJpYnV0ZXMiOnt9LCJjb25zZW50SWQiOiIxMmE0ZWJjOC1iOThjLTRmODAtOWEzNy00NDY3OTM2M2I5N2IiLCJjb25zZW50TWFwcGluZ1Jlc291cmNlcyI6W3sibWFwcGluZ0lkIjoiNjZhOTU4YWItMjNkNC00ODhhLTg3M2EtYzM3MzRjN2VlMzVkIiwibWFwcGluZ1N0YXR1cyI6ImFjdGl2ZSIsImFjY291bnRfaWQiOiIzMDA4MDAxMjM0MzQ1NiIsImF1dGhvcml6YXRpb25JZCI6IjQ3NGVjMWExLWRkNGQtNDViNC1hOThmLWQxZjA0ZGUyNTFhYSIsInBlcm1pc3Npb24iOiJwcmltYXJ5In1dLCJhZGRpdGlvbmFsQ29uc2VudEluZm8iOnt9LCJyZWNlaXB0Ijp7IlJpc2siOnt9LCJEYXRhIjp7IlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjUtMDYtMDdUMTA6NTc6MDIuOTczNDIxKzA1OjMwIiwiRXhwaXJhdGlvbkRhdGVUaW1lIjoiMjAyNS0wNi0wOVQxMDo1NzowMi45NzIyNjErMDU6MzAiLCJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNCYXNpYyIsIlJlYWRBY2NvdW50c0RldGFpbCIsIlJlYWRCYWxhbmNlcyIsIlJlYWRUcmFuc2FjdGlvbnNEZXRhaWwiXSwiVHJhbnNhY3Rpb25Gcm9tRGF0ZVRpbWUiOiIyMDI1LTA2LTA0VDEwOjU3OjAyLjk3MzMyNCswNTozMCJ9fSwiY29uc2VudEZyZXF1ZW5jeSI6MH0.dtk8sPwuLdgHENiu7soD-I7cinmVGKn2Dn23pfcrPzqoGC5HuSJ9pPvYnCOeEMvf0gtvSaLbtn02CIo3oNn9JQiyQeR6iaINMfnXxINybWZvIlYowXAePESt3mh9BKNJ8SUWBdQQ1rjq5Jv4WY2Y3rKSqVyxn1l-5bmS7hiE6eb-REE4zqQY4sD8cfQAtJPcn5QWBDjUTssiTHuHJlROdXZTs7NpexzueFWOnMEPw00u9agW-hVnq6i8bDT4AH-ZLNZVT8IozGZ0AFbf9qBbYr5t0wmmiRwXmMEeoXa4np_nFOxzlt4kFdqdM47QIwq71dAzhQW9psMoZd6p6yMPug\"\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_4",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n!!!note\n      Replace the <AUTH_HEADER_VALUE> with Base64 encoded \"admin_username:admin_password\" value.\n               `Eg: Base64(admin_username:admin_password)`\n\n```\ncurl --location --request POST 'https://localhost:9446/api/fs/consent/manage/account-access-consents' \\\n--header 'Authorization: Basic <AUTH_HEADER_VALUE>' \\\n--header 'x-wso2-client-id: <CLIENT_ID>' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n   \"Data\":{\n      \"Permissions\":[\n         \"ReadAccountsBasic\",\n         \"ReadAccountsDetail\",\n         \"ReadBalances\",\n         \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\",\n      \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\"\n   },\n   \"Risk\":{\n   }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"ConsentId\": \"12a4ebc8-b98c-4f80-9a37-44679363b97b\",\n        \"StatusUpdateDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n        \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\",\n        \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0139_5",
          "text": "## Client Authentication \n\nAccording to OAuth 2.0, the authorization server and the client need to establish a client authentication method that \nmeets the security requirements of the authorization server. The client has the option of choosing the authentication \nmethod. However, the algorithm to sign the ID token needs to be restricted for each client. The OpenID specification \nmentions a set of client authentication methods to authenticate the clients to the authorization server when using the \ntoken endpoint.\n\nDuring the client registration process, the client can register an authentication method. Regulatory applications are \nallowed to register either `private_key_jwt` or `tls_client_auth` as the authentication method. However, if no \nauthentication method is registered, \n[the default method](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication), \nwhich is `client_secret_basic` is used. \n\nAccording to [OAuth 2.0 Dynamic Client Registration (DCR)](https://www.google.com/url?q=https://tools.ietf.org/html/rfc7591%23section-2&sa=D&source=editors&ust=1619022501431000&usg=AOvVaw2Axr2N7pHOdBR0co99WNkV), \na registered client has a set of metadata values that are associated with their client identifier. \n\n  - The **token_endpoint_auth_method** metadata field specifies the client authentication method. If the value of this field \n  is not specified, the default client authentication method which is `client_secret_basic` is configured.\n  - The **token_endpoint_auth_signing_alg** field specifies the token endpoint signing algorithm.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0140",
      "requirement": {
        "requirement_id": "ATOM_136",
        "requirement_text": "The ASPSP shall deny data access if actual access does not match consented duration or frequency",
        "strength": "SHALL",
        "capability": "Data Access",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Data Access",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0140_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports consent management, which is a prerequisite for enforcing data access based on consented duration or frequency. However, the provided context does not contain explicit implementation details, configuration options, or API endpoints that directly enforce data access denial based on *consented duration or frequency* for an ASPSP (Account Servicing Payment Service Provider)  . The existing consent management features primarily focus on collecting, storing, and managing user consent for sharing personal data and filtering claims based on consent decisions .\\n\\n## Implementation Details\\n\\nThe `wso2/product-is` repository includes a \"Consent Framework\" that handles the collection, storage, and management of user consent for processing personal data . This framework is designed to help comply with privacy regulations like GDPR .\\n\\nThe consent collection process can occur during:\\n*   **Self-Registration**: Consent is collected for required attributes when a user registers . The `SelfSignUpConsentTest.java` file demonstrates how purposes are shown during self-registration and how consents are retrieved  .\\n*   **Authentication**: Consent is collected for sharing attributes with applications during login . The `OIDCSSOConsentTestCase.java` and `SAMLSSOConsentTestCase.java` files illustrate consent management in the context of OIDC and SAML SSO flows, respectively  .\\n*   **Profile Update**: Consent may be requested for new attributes when updating profile information .\\n\\nConsent enforcement ensures that only attributes with consent are included in tokens and API responses . The `OAuth2ServiceAbstractIntegrationTest.java` file contains a method `sendApprovalPostWithConsent` which is used to send an approval post request with user consent for claims .\\n\\nThe `getConsentReqBody` method in `SelfSignUpConsentTest.java` shows how a consent request body is constructed, including a `validity` field that can be set to `\"DATE_UNTIL:INDEFINITE\"` . This suggests that consent duration can be specified, but the mechanism for enforcing this duration to deny access is not explicitly detailed in the provided snippets.\\n\\n## Configuration Options\\n\\nThe `default-identity.xml` configuration file indicates that certain grant types filter user claims based on user consent . Specifically, `authorization_code` and `implicit` grant types are configured to have user consent enabled .\\n\\nThe `EnableSSOConsentManagement` property within the `<Consent>` section of `default-identity.xml` can be set to `true` to enable consent management during SSO .\\n\\nWhile the system allows for defining validity periods for tokens (e.g., `AccessTokenDefaultValidityPeriod`, `RefreshTokenValidityPeriod`)  , these are related to token validity rather than the consented duration of data access.\\n\\n## API Endpoints or Features\\n\\nThe repository exposes several REST API endpoints related to consent management :\\n*   `/api/identity/consent-mgt/v1.0/consents`: For managing consents .\\n*   `/api/identity/consent-mgt/v1.0/consents/receipts/{receiptId}`: For retrieving specific consent receipts .\\n*   `/api/identity/consent-mgt/v1.0/consents/purposes`: For managing purposes of data collection .\\n*   `/api/identity/consent-mgt/v1.0/consents/pii-categories`: For managing Personally Identifiable Information (PII) categories .\\n*   `/api/identity/consent-mgt/v1.0/consents/purpose-categories`: For managing purpose categories .\\n\\nThe `SelfSignUpConsentTest.java` file interacts with these endpoints to add PII categories, purposes, and retrieve consents  . The `getConsentReqBody` method constructs a consent request that includes a `validity` field, which can be set to control the duration of consent .\\n\\nHowever, the provided context does not explicitly show how the system actively monitors and denies data access if the actual access does not match the consented duration or frequency. The enforcement described primarily involves filtering claims based on consent at the time of token issuance or API response .\\n\\n## Documentation References\\n\\nThe \"Advanced Features\" wiki page provides an overview of Consent Management, explaining its purpose, key components (PII Categories, Purposes, Purpose Categories, Consent Receipts), and the consent collection and enforcement processes . It also mentions that consent decisions affect how user information is shared, including token issuance and API responses .\\n\\n## Notes\\n\\nThe provided codebase demonstrates robust consent management capabilities, including the ability to define consent validity periods. However, the explicit mechanism for an ASPSP to *deny data access if actual access does not match consented duration or frequency* is not directly visible in the provided snippets. The current enforcement focuses on filtering data based on consent at the point of data sharing (e.g., token issuance, API responses) rather than continuous monitoring and denial of access based on exceeding frequency or duration limits. To fully address the requirement, additional implementation would likely be needed to integrate the consent duration and frequency information with access control policies and runtime enforcement.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n- [Advanced Features (wso2/product-is)](/wiki/wso2/product-is#7.3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6fa6f0ac-6d69-46bf-8475-843ba6c75e6a\\n', 'id': 'lc_30ec49e3-b007-4ae5-9913-43d97d0c4e58'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0140_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports denying data access based on frequency limits through its throttling mechanisms. The system can enforce limits on the number of requests within a specified time period and deny access if these limits are exceeded.  \\n\\n## Implementation Details\\n\\nThe core of this functionality lies in the `throttle` mediator, which is used to restrict request counts based on defined policies.  This mediator can be configured within a Synapse sequence to apply throttling to incoming messages.  When a request is accepted, it proceeds through the `onAccept` sequence, and if rejected, it goes through the `onReject` sequence, which typically logs the denial and sends a fault message. \\n\\n## Configuration Options\\n\\nThrottling policies are defined using XML within the `throttle` mediator.  Key configuration elements include:\\n\\n*   `throttle:MaximumCount`: Specifies the maximum number of requests allowed. \\n*   `throttle:UnitTime`: Defines the time period in milliseconds during which the `MaximumCount` is enforced. \\n*   `throttle:ProhibitTimePeriod`: Specifies the duration to prohibit further requests after the `MaximumCount` is exceeded. \\n\\nThese policies can be applied based on various criteria, such as IP addresses.  The system also supports advanced throttling policies that can be engaged with APIs. \\n\\n## API Endpoints or Features\\n\\nThe WSO2 API Manager provides administrative APIs to manage throttling policies. For instance, the `/throttling/deny-policies` endpoint allows retrieval of existing deny policies.  There are also API calls to update deny policies using `PATCH /throttling/deny-policy/{conditionId}`. \\n\\n## Documentation References\\n\\nSeveral documentation samples illustrate the use of throttling:\\n\\n*   **Sample 371: Restricting requests based on policies**: This sample demonstrates how to use the `throttle` mediator to restrict request counts.  It shows how to configure `MaximumCount`, `UnitTime`, and `ProhibitTimePeriod` and provides an example where the fifth request is denied after the limit of four requests within a `UnitTime` is reached. \\n*   **Sample 372: Use of both concurrency throttling and request rate based throttling**: This sample shows how to combine different throttling mechanisms. \\n*   The `throttle.xml` mediator documentation provides details on configuring the throttle mediator. \\n\\n## Notes\\n\\nThe provided context primarily focuses on request rate-based throttling and does not explicitly mention \"consented duration\" in the context of ASPSP (Account Servicing Payment Service Provider) or Open Banking specific consent management. While the system can enforce frequency limits, the direct linkage to a \"consented duration\" as part of a financial data access consent is not detailed in the snippets. The throttling mechanism is a general-purpose feature for API management.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_e903f68a-40d7-48fb-a910-e5378d7533b2\\n', 'id': 'lc_283eefcf-6320-458f-a66b-38fc900da1f8'}]",
          "capability": "Data Access",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0141",
      "requirement": {
        "requirement_id": "ATOM_103",
        "requirement_text": "ASPSPs MUST support multilevel SCA approach with explicit start of multiple authorisation mechanisms",
        "strength": "MUST",
        "capability": "Authentication",
        "section_id": "f5ea71603fb5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0141_1",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_2",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_3",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_4",
          "text": "### setConditionalAuthScript method\nThis method lets you set a [conditional authentication script](https://is.docs.wso2.com/en/5.11.0/learn/using-opa-policies-for-adaptive-auth/#configure-the-adaptive-authentication-script). \nUsing this script, you can dynamically set the authentication steps according to the context.\n\n``` java\npublic void setConditionalAuthScript(boolean isRegulatoryApp, ServiceProvider serviceProvider,\n  LocalAndOutboundAuthenticationConfig localAndOutboundAuthenticationConfig)\nthrows OpenBankingException {\n\n  if (isRegulatoryApp) {\n    if (localAndOutboundAuthenticationConfig.getAuthenticationScriptConfig() == null) {\n      TextFileReader textFileReader = TextFileReader.getInstance();\n      try {\n        String authScript = textFileReader.readFile(IdentityCommonConstants.CONDITIONAL_COMMON_AUTH_SCRIPT_FILE_NAME);\n        if (StringUtils.isNotEmpty(authScript)) {\n          AuthenticationScriptConfig scriptConfig = new AuthenticationScriptConfig();\n          scriptConfig.setContent(authScript);\n          scriptConfig.setEnabled(true);\n          localAndOutboundAuthenticationConfig.setAuthenticationScriptConfig(scriptConfig);\n        }\n      } catch (IOException e) {\n        throw new OpenBankingException(\"Error occurred while reading file\", e);\n      }\n\n    }\n  }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_5",
          "text": "## Configuring a custom Push Authenticator  \n\n1. Once implemented, build a JAR file for your project.\n2. Place the above-created JAR file in the `<IS_HOME>/repository/components/dropins` directory.\n3. Open the `<IS_HOME>/repository/conf/deployment.toml` file and configure your custom authenticator using the Fully \nQualified Name (FQN):\n\n      ``` toml\n      [open_banking.sca.idp]\n      name = \"CIBA-Push-Auth\"\n      ```\n    \n4. Save the configurations and restart the Identity Server.\n5. Follow the [Set up CIBA flow](../learn/ciba-set-up-flow.md#configuring-authenticator) documentation and try out the \nflow.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'WSO2 Identity Server (IS) supports multilevel Strong Customer Authentication (SCA) through its extensible authentication framework, which allows for the configuration of various authenticators, including multi-factor authentication (MFA) options  . The system\\'s architecture includes a \"Flow Orchestration\" component within its \"Core Identity Services\" that is responsible for managing authentication flows . This enables the processing of multiple authorization mechanisms, which can be configured to achieve scenarios like the 4-eyes principle.\\n\\n## Implementation Details\\n\\nThe WSO2 Identity Server\\'s authentication framework is designed to support various authentication mechanisms, including local, federated, social, and multi-factor authenticators . The `ApplicationAuthentication` configuration file defines the extensions and authenticators that can be used . Specifically, the `StepBasedSequenceHandler` is implemented by `GraphBasedSequenceHandler`, which suggests a flexible way to define authentication steps and sequences . This allows for the orchestration of multiple authentication challenges, fulfilling the multilevel SCA requirement.\\n\\nThe system also supports \"Rich Authorization Requests\" as indicated by the `OAuth2RichAuthorizationRequestsTestCase` . This test case demonstrates the ability to register and manage API resources with different `AuthorizationDetailsType` , which can be used to define various authorization requirements.\\n\\n## Configuration Options\\n\\nMultilevel SCA can be configured by enabling and defining different authenticators within the `ApplicationAuthentication` configuration . For instance, `MultifactorAuthentication` settings are present in configuration files, allowing for the enablement of MFA . The `pom.xml` also lists various authenticators, including `smsotp`, `emailotp`, and `totp` , which are common components for MFA.\\n\\n## API Endpoints or Features\\n\\nThe WSO2 Identity Server provides an API layer with both Server and User APIs . The `api-resources-full.war` packages these API endpoints . Specifically, the `modules/api-resources/api-resources-full/pom.xml` lists dependencies related to user MFA APIs, such as `org.wso2.carbon.identity.rest.api.user.mfa.v1` , indicating API support for managing MFA.\\n\\nThe `OAuth2RichAuthorizationRequestsTestCase` demonstrates API features related to managing authorization details types for API resources . This includes registering, updating, and deleting `AuthorizationDetailsType` objects  . The OIDC metadata endpoint also exposes supported `authorization_details_types_supported` , which is crucial for ASPSPs to discover and utilize different authorization mechanisms.\\n\\n## Documentation References\\n\\nThe `README.md` file directs users to the WSO2 Identity Server website for more information  and to `is.docs.wso2.com` for documentation . These resources would contain detailed guides on configuring and utilizing the multilevel SCA features.\\n\\n## Notes\\n\\nThe provided snippets indicate strong support for multilevel SCA through a modular and extensible authentication framework. The `GraphBasedSequenceHandler`  is particularly relevant as it suggests the ability to define complex authentication flows, which is essential for implementing scenarios like the 4-eyes principle. The `OAuth2RichAuthorizationRequestsTestCase`  further confirms the system\\'s capability to handle diverse authorization requirements.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_2c414fd5-ea39-44eb-8b9d-fca967c0e26d\\n', 'id': 'lc_066bdbca-15de-4137-95d8-03bad3783bb8'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0141_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_7d42dd12-241b-4878-a72b-60443b4cd439'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0142",
      "requirement": {
        "requirement_id": "ATOM_125",
        "requirement_text": "The transactionStatus field SHALL be mandatory in payment cancellation response body when HTTP code 202 is returned",
        "strength": "SHALL",
        "capability": "Payment Initiation",
        "section_id": "326a9719d7b5",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0142_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_2",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_3",
          "text": "openapi: \"3.0.0\"\ninfo:\n  title: \"PaymentInitiationAPI\"\n  description: \"Swagger for Payment Initiation API Specification\"\n  version: \"v3.1\"\n\nservers:\n  - url: \"/open-banking/{version}/pisp\"\npaths:\n  /payment-consents:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payment Consents\"\n      operationId: \"CreatePaymentConsents\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWriteConsent4\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentConsentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents\"\n      operationId: \"GetPaymentConsentsConsentId\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payment-consents/{consentId}/funds-confirmation:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payment Consents Funds Confirmation\"\n      operationId: \"GetPaymentConsentsConsentIdFundsConfirmation\"\n      parameters:\n        - $ref: \"#/components/parameters/consentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentConsentsConsentIdFundsConfirmationRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments:\n    post:\n      tags:\n        - \"Payments\"\n      summary: \"Create Payments\"\n      operationId: \"CreatePayments\"\n      parameters:\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n        - $ref: \"#/components/parameters/x-idempotency-key\"\n      requestBody:\n        content:\n          application/json; charset=utf-8:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n          application/jose+jwe:\n            schema:\n              $ref: \"#/components/schemas/obWritePayment2\"\n        description: \"Default\"\n        required: true\n      responses:\n        201:\n          $ref: \"#/components/responses/201PaymentsCreated\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        415:\n          $ref: \"#/components/responses/415Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - PSUOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application User\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\n  /payments/{paymentId}:\n    get:\n      tags:\n        - \"Payments\"\n      summary: \"Get Payments\"\n      operationId: \"GetPaymentsPaymentId\"\n      parameters:\n        - $ref: \"#/components/parameters/paymentId\"\n        - $ref: \"#/components/parameters/x-fapi-auth-date\"\n        - $ref: \"#/components/parameters/x-fapi-customer-ip-address\"\n        - $ref: \"#/components/parameters/x-fapi-interaction-id\"\n        - $ref: \"#/components/parameters/authorization\"\n      responses:\n        200:\n          $ref: \"#/components/responses/200PaymentsPaymentIdRead\"\n        400:\n          $ref: \"#/components/responses/400Error\"\n        401:\n          $ref: \"#/components/responses/401Error\"\n        403:\n          $ref: \"#/components/responses/403Error\"\n        405:\n          $ref: \"#/components/responses/405Error\"\n        406:\n          $ref: \"#/components/responses/406Error\"\n        429:\n          $ref: \"#/components/responses/429Error\"\n        500:\n          $ref: \"#/components/responses/500Error\"\n      security:\n        - TPPOAuth2Security:\n            - \"payments\"\n        - default:\n            - \"payments\"\n      x-auth-type: \"Application\"\n      x-throttling-tier: \"Unlimited\"\n      x-scope: \"payments\"\n\ncomponents:\n  parameters:\n\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    paymentId:\n      name: \"paymentId\"\n      in: \"path\"\n      description: \"PaymentId\"\n      required: true\n      schema:\n        type: \"string\"\n\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_4",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_5",
          "text": "obExternalAccountIdentification4Code:\n      description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"OB.BBAN\"\n        - \"OB.IBAN\"\n        - \"OB.PAN\"\n        - \"OB.Paym\"\n        - \"OB.SortCodeAccountNumber\"\n    identification_0:\n      description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 256\n\n    links:\n      type: \"object\"\n      additionalProperties: false\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n      required:\n        - \"Self\"\n\n    obExternalPaymentChargeType1Code:\n      description: \"Charge type, in a coded form.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.CHAPSOut\"\n\n    obActiveOrHistoricCurrencyAndAmount:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Amount\"\n        - \"Currency\"\n      description: \"Amount of money associated with the charge type.\"\n      properties:\n        Amount:\n          $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n        Currency:\n          $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n\n    obSupplementaryData1:\n      type: \"object\"\n      properties: { }\n      additionalProperties: true\n      description: \"Additional information that can not be captured in the structured fields and/or any other specific block.\"\n\n    obChargeBearerType1Code:\n      description: \"Specifies which party/parties will bear the charges associated with the processing of the payment transaction.\"\n      type: \"string\"\n      enum:\n        - \"BorneByCreditor\"\n        - \"BorneByDebtor\"\n        - \"FollowingServiceLevel\"\n        - \"Shared\"\n\n    obCashAccountDebtor4:\n      type: \"object\"\n      description: \"^ Only incuded in the response if `Data. ReadRefundAccount` is set to `Yes` in the consent.\"\n      properties:\n        SchemeName:\n          type: \"string\"\n          description: \"^ Name of the identification scheme, in a coded form as published in an external list. | Namespaced Enumeration OBExternalAccountIdentification4Code\"\n        Identification:\n          type: \"string\"\n          description: \"^ Identification assigned by an institution to identify an account. This identification is known by the account owner. | Max256Text\"\n        Name:\n          type: \"string\"\n          description: \"^ Name of the account, as assigned by the account servicing institution.  Usage The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n        SecondaryIdentification:\n          type: \"string\"\n          description: \"^ This is secondary identification of the account, as assigned by the account servicing institution.  This can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination) | Max34Text\"\n\n    obRisk1:\n      type: object\n      additionalProperties: false\n      properties: {}\n      description: |-\n        The Risk section is sent by the initiating party to the ASPSP.\n        It is used to specify additional details for risk scoring for Payments.",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0142_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, does not explicitly define a `transactionStatus` field as mandatory in payment cancellation response bodies when an HTTP 202 status code is returned. The OpenAPI specification for Payments    primarily focuses on payment initiation and retrieval, and the `obWritePaymentResponse5` schema, which is used for successful payment responses, includes a `Status` field, but there is no explicit definition for a payment cancellation endpoint or its response structure with a mandatory `transactionStatus` field for HTTP 202 responses. \\n\\n## Implementation Details and API Endpoints\\n\\nThe `payment-initiation-openapi.yaml` file defines the API for payment initiation and retrieval. \\n\\n*   **Payment Initiation**: The `/payments` endpoint supports `POST` requests for creating payments, which can return a `201 Created` response.  The schema for this response is `obWritePaymentResponse5`. \\n*   **Payment Retrieval**: The `/payments/{paymentId}` endpoint supports `GET` requests for retrieving payment details, which can return a `200 OK` response.  This also uses the `obWritePaymentResponse5` schema. \\n\\nThe `obWritePaymentResponse5` schema includes a `Status` field, which is an enumeration of possible payment statuses such as \"AcceptedCreditSettlementCompleted\", \"AcceptedSettlementCompleted\", \"AcceptedSettlementInProcess\", \"AcceptedWithoutPosting\", \"Pending\", and \"Rejected\".  However, there is no explicit mention of a payment cancellation endpoint or a `transactionStatus` field specifically for HTTP 202 responses in the provided OpenAPI specification.   \\n\\nThe `ResponseStatus` enum in `org.wso2.financial.services.accelerator.consent.mgt.extensions.common` defines `ACCEPTED(202, \"Accepted\")` , indicating that HTTP 202 is a recognized status code within the accelerator. However, this enum is part of the consent management extensions and does not directly dictate the response body for payment cancellation. \\n\\n## Configuration Options\\n\\nThe `financial-services-accelerator` uses `financial-services.xml` and `wso2is-7.0.0-deployment.toml` (or `wso2is-7.1.0-deployment.toml`) for configuration.   The `Overview` wiki page mentions that the `FinancialServicesConfigParser` handles configuration parsing.  These configuration files primarily deal with identity server settings, database connections, and extension points, but they do not contain specific configurations related to mandatory fields in payment cancellation response bodies.  \\n\\n## Documentation References\\n\\nThe provided context includes an `Overview` wiki page that describes the WSO2 Financial Services Accelerator.  This overview mentions \"Payment Initiation APIs\" and \"Payments\" as a core component, but it does not delve into the specifics of payment cancellation responses or mandatory fields within them. \\n\\n## Conclusion\\n\\nBased on the provided codebase context, there is no explicit support or definition for a mandatory `transactionStatus` field in payment cancellation response bodies when an HTTP 202 status code is returned.    The existing OpenAPI specification for payments defines a `Status` field for payment initiation and retrieval responses, but not specifically for cancellation. \\n\\n## Notes\\n\\nThe `payment-initiation-openapi.yaml` file defines the API for payment initiation and retrieval, but it does not appear to contain a specific endpoint or schema for payment cancellation.    The `Status` field within `obWritePaymentResponse5` is for the status of the payment itself, not necessarily a cancellation transaction status.  To confirm the presence of a mandatory `transactionStatus` field for payment cancellation with HTTP 202, a specific OpenAPI definition for payment cancellation would be required. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_386e99e3-b9d4-4f54-a634-8eaa6c1e0be5\\n', 'id': 'lc_1bb68594-3a8e-4cd2-85e0-b5259f37a15d'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0143",
      "requirement": {
        "requirement_id": "ATOM_082",
        "requirement_text": "The ASPSP SHALL validate eIDAS certificate request syntax, TPP role, and semantics during payment initiation",
        "strength": "SHALL",
        "capability": "Certificate Management",
        "section_id": "648825991d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Certificate Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0143_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to have capabilities related to certificate handling and API security, which could be relevant to eIDAS certificate validation, but it does not explicitly mention \"eIDAS\" or \"ASPSP\" in the provided context. The codebase includes features for OAuth 2.0, OpenID Connect, and Financial-grade API (FAPI) support, which often involve certificate-based authentication and validation.\\n\\n### Implementation Details\\nThe `wso2/product-is` repository includes an X.509 Certificate authenticator . This suggests that the system can process and validate X.509 certificates, which are a core component of eIDAS certificates. The `Oauth2JWKSEndpointTestCase.java` file demonstrates how the system handles JWKS (JSON Web Key Set) endpoints and validates X.509 certificates by computing SHA256 thumbprints . This validation includes parsing the certificate and comparing its thumbprint.\\n\\nThe `oidc-fapi-conformance-tests/resource-server/resource-server.py` script, used for FAPI conformance tests, shows an example of validating client certificates against access tokens . Specifically, it extracts a SHA256 thumbprint from the client certificate (`X-Ssl-Cert` header) and compares it with the `x5t#S256` claim in the access token\\'s `cnf` (confirmation) parameter . This mechanism is crucial for mutual TLS (mTLS) and client certificate-bound access tokens, which are often used in secure financial transactions and could be extended to eIDAS.\\n\\n### Configuration Options\\nWhile explicit eIDAS-specific configuration is not detailed, the system allows for the configuration of identity providers (IdPs) and their associated certificates. The `IdPSuccessTest.java` file demonstrates how to update an IdP\\'s certificate configuration, including setting a JWKS URI or directly providing certificate content . This flexibility in certificate management could be leveraged for eIDAS certificates.\\n\\n### API Endpoints or Features\\nThe system supports OAuth 2.0 and OpenID Connect, including advanced features like Proof of Possession (DPoP) and JWT Access Tokens . The `AuthorizationDetailsType.java` model suggests the presence of an API for managing authorization details, with an example type of `payment_initiation` . This indicates that the system is designed to handle payment-related authorization flows, which would be relevant for an ASPSP (Account Servicing Payment Service Provider). The FAPI support also implies strong API security features that could be adapted for eIDAS requirements .\\n\\n### Documentation References\\nThe \"Features and Capabilities\" wiki page provides a high-level overview of the system\\'s support for various authentication protocols and security features . It mentions OAuth 2.0, OpenID Connect, and FAPI, which are foundational for secure API interactions and certificate validation. However, specific documentation directly addressing eIDAS certificate validation or ASPSP roles is not present in the provided context.\\n\\n## Notes\\nThe provided context does not contain explicit mentions of \"eIDAS\" or \"ASPSP\". However, the presence of X.509 certificate handling, JWKS endpoint testing, FAPI conformance tests, and a `payment_initiation` authorization details type suggests that the underlying capabilities could be adapted to meet the requirements for eIDAS certificate validation in a payment initiation context. The `identity-ssoservice-entityid-changed.xml` file  and `APIResourcePatchModel.java`  were reviewed but did not provide direct information regarding eIDAS certificate validation.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_cd22be8b-6fce-40a0-b426-e281a075b3a8\\n', 'id': 'lc_6dd1d8c9-72ea-4d13-ae77-12ee815960bd'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0143_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, `wso2/product-apim`, appears to handle the management of client and endpoint certificates, but there is no direct evidence within the provided context that it specifically supports eIDAS certificate validation, TPP role verification, or semantic validation during payment initiation. The snippets primarily show APIs for uploading, deleting, retrieving, and updating client and endpoint certificates.\\n\\n### Implementation Details  \\nThe codebase includes `ClientCertificatesApi.java`  and `EndpointCertificatesApi.java` , which are generated API clients for managing certificates. These classes provide methods to interact with certificate-related functionalities. For instance, `addAPIClientCertificate`  allows uploading a new certificate for an API, and `addEndpointCertificate`  is for uploading a certificate for an endpoint. The `validate` mediator  is mentioned in the documentation, which suggests a mechanism for schema validation, but it\\'s not explicitly tied to eIDAS certificates or TPP roles.\\n\\n### Configuration Options \\nThe `validate` mediator documentation mentions a configuration option `synapse.schema.resolver=org.wso2.carbon.mediation.initializer.RegistryXmlSchemaURIResolver`  in the `synapse.properties` file for resolving imported schemas. This indicates that schema validation can be configured, but again, there\\'s no specific mention of eIDAS.\\n\\n### API Endpoints or Features  \\nThe `ClientCertificatesApi`  provides endpoints for:\\n*   Uploading a new client certificate: `addAPIClientCertificate` \\n*   Deleting a client certificate: `deleteAPIClientCertificateByAlias` \\n*   Getting client certificate information: `getAPIClientCertificateByAlias`  and `getAPIClientCertificateByKeyTypeAndAlias` \\n*   Downloading client certificates: `getAPIClientCertificateContentByAlias`  and `getAPIClientCertificateContentByKeyTypeAndAlias` \\n*   Updating client certificates: `updateAPIClientCertificateByAlias`  and `updateAPIClientCertificateByKeyTypeAndAlias` \\n\\nSimilarly, `EndpointCertificatesApi`  offers endpoints for:\\n*   Uploading a new endpoint certificate: `addEndpointCertificate` \\n*   Deleting an endpoint certificate: `deleteEndpointCertificateByAlias` \\n*   Getting endpoint certificate information: `getEndpointCertificateByAlias` \\n*   Downloading endpoint certificates: `getEndpointCertificateContentByAlias` \\n*   Updating endpoint certificates: `updateEndpointCertificateByAlias` \\n\\nThese APIs manage certificates but do not explicitly mention eIDAS-specific validation or TPP role checks.\\n\\n### Documentation References \\nThe `validate.xml`  document describes a `validate` mediator that supports schema validation with the feature \"http://javax.xml.XMLConstants/feature/secure-processing\" . This mediator can be used to validate XML messages against a schema. However, it does not specifically refer to eIDAS certificates or the validation of TPP roles and semantics.\\n\\n## Notes\\nThe provided snippets are primarily from generated API client code for managing certificates and documentation for a generic `validate` mediator. While certificate management is a prerequisite for eIDAS validation, the code does not contain specific logic or features for eIDAS certificate request syntax, TPP role, or semantic validation. The `validate` mediator is for XML schema validation and is not directly related to certificate validation. To determine if eIDAS validation is supported, more context on the actual implementation of certificate validation within the WSO2 API Manager would be needed, beyond just the API for uploading and managing certificates.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6d63ea32-1e2a-4266-aadb-4d7984084b72\\n', 'id': 'lc_e829116a-ec03-4ed2-9296-b9dc4c3795da'}]",
          "capability": "Certificate Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0144",
      "requirement": {
        "requirement_id": "ATOM_159",
        "requirement_text": "The system MAY support delta access through entryReferenceFrom parameter or deltaList boolean flag",
        "strength": "MAY",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0144_1",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, appears to support delta access for transactions through date-time parameters in its API specifications, specifically `TransactionFromDateTime` and `TransactionToDateTime`  . While `entryReferenceFrom` and `deltaList` are not explicitly mentioned, the `TransactionFromDateTime` parameter serves a similar purpose by allowing retrieval of transactions from a specified start date and time .\\n\\n### API Endpoints and Features\\n\\nThe `financial-services-accelerator` defines an API endpoint for retrieving transactions: `/accounts/{AccountId}/transactions` . This endpoint is part of the Account Information APIs .\\n\\nThe API specification for transactions, found in `account-info-swagger.yaml`, includes the following parameters for filtering transaction data:\\n*   `TransactionFromDateTime`: This parameter specifies the start date and time for the transaction query period . If not populated, data will be returned from the earliest available transaction . This directly addresses the \"entryReferenceFrom\" concept by allowing retrieval of transactions after a specific point in time.\\n*   `TransactionToDateTime`: This parameter specifies the end date and time for the transaction query period . If not populated, data will be returned up to the latest available transaction .\\n\\nThese date-time parameters are defined within the `OBReadData1` and `Data` schemas, which are used for account access consent data  .\\n\\n### Implementation Details\\n\\nThe `ConsentCoreDAOTests.java` file contains unit tests that demonstrate the usage of time-based filtering for consent searches . The `testConsentSearchWithTimePeriod` method specifically calls `consentCoreDAO.searchConsents` with `currentTime` and `currentTime + 100` as parameters, which are then asserted to filter results based on `updatedTime`  . This indicates that the underlying data access layer supports filtering by time periods, which is essential for delta access.\\n\\nTest payloads in `TestConstants.java` and `AccountsRequestPayloads.groovy` also include `TransactionFromDateTime` and `TransactionToDateTime` fields, confirming their role in consent initiation requests  .\\n\\n### Configuration Options\\n\\nThe system\\'s configuration is managed through `financial-services.xml` and parsed by `FinancialServicesConfigParser` . While the provided snippets do not explicitly show configuration options for `entryReferenceFrom` or `deltaList`, the presence of `TransactionFromDateTime` and `TransactionToDateTime` in the API definitions suggests that the system is designed to handle time-based filtering for transactions.\\n\\n## Notes\\n\\nThe prompt specifically asks about `entryReferenceFrom` and `deltaList`. While these exact terms are not found in the provided codebase, the `TransactionFromDateTime` parameter in the `account-info-swagger.yaml`  serves a functionally equivalent purpose to `entryReferenceFrom` by allowing clients to specify a starting point for retrieving transactions. The absence of a `deltaList` boolean flag suggests that delta access is primarily managed through these date-time parameters. The test cases in `ConsentCoreDAOTests.java`  further confirm the system\\'s ability to filter data based on time periods.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_381b33c9-49f3-4881-bc8e-67cd88ee942a\\n', 'id': 'lc_e9c36380-0bbd-498c-9d7b-33fd5cd09041'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0145",
      "requirement": {
        "requirement_id": "ATOM_032",
        "requirement_text": "The GET card-accounts/{account-id}/transactions endpoint SHALL be mandatory for reading transaction lists related to a given card account",
        "strength": "MANDATORY",
        "capability": "Account Information",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0145_1",
          "text": "swagger: '2.0'\ninfo:\n  title: AccountandTransactionAPI\n  description: Swagger for Account and Transaction API Specification\n  version: v3.1\nbasePath: /open-banking/{version}/aisp\ntags:\n  - name: Account Access\n    description: Account Access Consents\n  - name: Accounts\n    description: Accounts\n  - name: Balances\n    description: Balances\n  - name: Transactions\n    description: Transactions\nschemes:\n  - https\nconsumes:\n  - application/json; charset=utf-8\nproduces:\n  - application/json; charset=utf-8\nsecurity:\n  - default: []\npaths:\n  '/account-access-consents':\n    post:\n      tags:\n        - Account Access\n      summary: Create Account Access Consents\n      operationId: CreateAccountAccessConsents\n      parameters:\n        - $ref: '#/parameters/OBReadConsent1Param'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '201':\n          $ref: '#/responses/201AccountAccessConsentsCreated'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/account-access-consents/{ConsentId}':\n    get:\n      tags:\n        - Account Access\n      summary: Get Account Access Consents\n      operationId: GetAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountAccessConsentsConsentIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n    delete:\n      tags:\n        - Account Access\n      summary: Delete Account Access Consents\n      operationId: DeleteAccountAccessConsentsConsentId\n      parameters:\n        - $ref: '#/parameters/ConsentId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '204':\n          $ref: '#/responses/204AccountAccessConsentsConsentIdDeleted'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - TPPOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccounts\n      parameters:\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}':\n    get:\n      tags:\n        - Accounts\n      summary: Get Accounts\n      operationId: GetAccountsAccountId\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/balances':\n    get:\n      tags:\n        - Balances\n      summary: Get Balances\n      operationId: GetAccountsAccountIdBalances\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdBalancesRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\n  '/accounts/{AccountId}/transactions':\n    get:\n      tags:\n        - Transactions\n      summary: Get Transactions\n      operationId: GetAccountsAccountIdTransactions\n      parameters:\n        - $ref: '#/parameters/AccountId'\n        - $ref: '#/parameters/x-fapi-auth-date'\n        - $ref: '#/parameters/x-fapi-customer-ip-address'\n        - $ref: '#/parameters/x-fapi-interaction-id'\n        - $ref: '#/parameters/Authorization'\n      responses:\n        '200':\n          $ref: '#/responses/200AccountsAccountIdTransactionsRead'\n        '400':\n          $ref: '#/responses/400Error'\n        '401':\n          $ref: '#/responses/401Error'\n        '403':\n          $ref: '#/responses/403Error'\n        '404':\n          $ref: '#/responses/404Error'\n        '405':\n          $ref: '#/responses/405Error'\n        '406':\n          $ref: '#/responses/406Error'\n        '429':\n          $ref: '#/responses/429Error'\n        '500':\n          $ref: '#/responses/500Error'\n      security:\n        - PSUOAuth2Security:\n            - accounts\n        - default:\n            - accounts\n      x-auth-type: Application User\n      x-throttling-tier: Unlimited\n      x-scope: accounts\nparameters:\n  OBReadConsent1Param:\n    name: OBReadConsent1Param\n    in: body\n    description: Default\n    required: true\n    schema:\n      $ref: '#/definitions/OBReadConsent1'\n  Authorization:\n    in: header\n    name: Authorization\n    type: string\n    required: true\n    description: 'An Authorisation Token as per https://tools.ietf.org/html/rfc6750'\n  x-fapi-customer-ip-address:\n    in: header\n    name: x-fapi-customer-ip-address\n    type: string\n    required: false\n    description: The PSU's IP address if the PSU is currently logged in with the TPP.\n  x-fapi-auth-date:\n    in: header\n    name: x-fapi-auth-date\n    type: string\n    required: false\n    description: >-\n      The time when the PSU last logged in with the TPP.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_2",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_3",
          "text": "2017-04-05T10:43:07+00:00\n        type: string\n        format: date-time\n      InstructedAmount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money to be moved between the debtor and creditor, before\n          deduction of charges, expressed in the currency as ordered by the\n          initiating party.\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n      - SubCode\n    description: >-\n      Set of elements used to fully identify the type of underlying transaction\n      resulting in an entry.\n    properties:\n      Code:\n        description: Specifies the family within a domain.\n        type: string\n      SubCode:\n        description: Specifies the sub-product family within a specific family.\n        type: string\n  ProprietaryBankTransactionCodeStructure1:\n    type: object\n    required:\n      - Code\n    description: Set of elements to fully identify a proprietary bank transaction code.\n    properties:\n      Code:\n        description: >-\n          Proprietary bank transaction code to identify the underlying\n          transaction.\n        type: string\n        minLength: 1\n        maxLength: 35\n      Issuer:\n        description: Identification of the issuer of the proprietary bank transaction code.\n        type: string\n        minLength: 1\n        maxLength: 35\n  OBMerchantDetails1:\n    type: object\n    description: Details of the merchant involved in the transaction.\n    properties:\n      MerchantName:\n        description: Name by which the merchant is known.\n        type: string\n        minLength: 1\n        maxLength: 350\n      MerchantCategoryCode:\n        description: >-\n          Category code conform to ISO 18245, related to the type of services or\n          goods the merchant provides for the transaction.\n        type: string\n        minLength: 3\n        maxLength: 4\n  OBTransactionCashBalance:\n    type: object\n    required:\n      - CreditDebitIndicator\n      - Type\n      - Amount\n    description: >-\n      Set of elements used to define the balance as a numerical representation\n      of the net increases and decreases in an account after a transaction entry\n      is applied to the account.\n    properties:\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Type:\n        $ref: '#/definitions/OBBalanceType1Code'\n      Amount:\n        type: object\n        required:\n          - Amount\n          - Currency\n        description: >-\n          Amount of money of the cash balance after a transaction entry is\n          applied to the account..\n        properties:\n          Amount:\n            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n          Currency:\n            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n  OBBranchAndFinancialInstitutionIdentification6:\n    type: object\n    description: Financial institution servicing an account for the creditor.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      PostalAddress:\n        type: object\n  OBCashAccount6:\n    type: object\n    description: >-\n      Unambiguous identification of the account of the creditor, in the case of\n      a debit transaction.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalAccountIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n      Name:\n        $ref: '#/definitions/Name'\n      SecondaryIdentification:\n        $ref: '#/definitions/SecondaryIdentification'\n  OBTransactionCardInstrument1:\n    type: object\n    required:\n      - CardSchemeName\n    description: Set of elements to describe the card instrument used in the transaction.\n    properties:\n      CardSchemeName:\n        description: Name of the card scheme.\n        type: string\n        enum:\n          - AmericanExpress\n          - Diners\n          - Discover\n          - MasterCard\n          - VISA\n      AuthorisationType:\n        description: The card authorisation type.\n        type: string\n        enum:\n          - ConsumerDevice\n          - Contactless\n          - None\n          - PIN\n      Name:\n        description: Name of the cardholder using the card instrument.\n        type: string\n        minLength: 1\n        maxLength: 70\n      Identification:\n        description: >-\n          Identification assigned by an institution to identify the card\n          instrument used in the transaction. This identification is known by\n          the account owner, and may be masked.\n        type: string\n        minLength: 1\n        maxLength: 34\n  OBSupplementaryData1:\n    type: object\n    properties: {}\n    additionalProperties: true\n    description: >-\n      Additional information that can not be captured in the structured fields\n      and/or any other specific block.\n  Links:\n    type: object\n    description: Links relevant to the payload\n    properties:\n      Self:\n        type: string\n        format: uri\n      First:\n        type: string\n        format: uri\n      Prev:\n        type: string\n        format: uri\n      Next:\n        type: string\n        format: uri\n      Last:\n        type: string\n        format: uri\n    additionalProperties: false\n    required:\n      - Self\n  Meta:\n    type: object\n    properties:\n      TotalPages:\n        type: integer\n        format: int32\n      FirstAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n      LastAvailableDateTime:\n        $ref: '#/definitions/ISODateTime'\n    title: MetaData\n    description: Meta Data relevant to the payload\n    additionalProperties: { }\n  ISODateTime:\n    type: string\n    format: date-time\n    description: >-\n      All dates in the JSON payloads are represented in ISO 8601 date-time\n      format.\n      \n      All date-time fields in responses must include the timezone. An example is\n      below:\n      \n      2017-04-05T10:43:07+00:00\n  OBError1:\n    type: object\n    properties:\n      code:\n        description: 'error code'\n        type: string\n      message:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 500\n      description:\n        description: >-\n          A description of the error that occurred. e.g., 'A mandatory field\n          isn't supplied' or 'RequestedExecutionDateTime must be in future'\n        type: string\n        minLength: 1\n        maxLength: 1000\n    required:\n      - code\n      - message\n      - description\n    additionalProperties: false\n    minProperties: 1\n  OBErrorResponse1:\n    type: object\n    properties:\n      errors:\n        type: array\n        items:\n          $ref: '#/definitions/OBError1'\n        minItems: 1\nx-wso2-security:\n  apim:\n    x-wso2-scopes:\n      - name: accounts\n        description: This scope will group the AccountAPI related operations.\n        key: accounts\n        roles: Internal/consumer",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_4",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_5",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0145_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'Yes, the repository supports the `GET card-accounts/{account-id}/transactions` endpoint. This functionality is defined within the `AccountandTransactionAPI` specification and is implemented in the demo backend service.   Integration tests also confirm its functionality. \\n\\n## Implementation Details\\n\\nThe `GET /accounts/{AccountId}/transactions` endpoint is defined in the `account-info-swagger.yaml` file, which specifies the API for Account and Transaction services.  This endpoint is responsible for retrieving transaction lists for a given account ID.  The response for this endpoint is defined by the `200AccountsAccountIdTransactionsRead` schema, which references `OBReadTransaction5` for the transaction data structure. \\n\\nA demo implementation of this endpoint can be found in the `AccountService.java` file within the `org.wso2.financial.services.accelerator.demo.backend` module.  This service provides a mock JSON response for `GET /accounts/{AccountId}/transactions`, including `AccountId`, `TransactionId`, `Amount`, `CreditDebitIndicator`, `Status`, and `BookingDateTime`. \\n\\n## Configuration Options\\n\\nThe API specification indicates that the `accounts` OAuth scope is required for accessing this endpoint.  This scope is bound to `Internal/consumer` for both `TPPOAuth2Security` and `PSUOAuth2Security` flows.  \\n\\n## API Endpoints or Features\\n\\nThe relevant API endpoint is `/accounts/{AccountId}/transactions` which supports the `GET` HTTP method.  It requires an `AccountId` as a path parameter and various headers such as `x-fapi-auth-date`, `x-fapi-customer-ip-address`, `x-fapi-interaction-id`, and `Authorization`. \\n\\n## Documentation References\\n\\nThe API is documented in the `account-info-swagger.yaml` file, which serves as the Swagger/OpenAPI specification for the Account and Transaction API.  The `Overview` wiki page also mentions \"Account Information APIs\" which include \"Transactions\" as a category. \\n\\n## Test Criteria Verification\\n\\nThe `EndToEndAccountFlowTest.groovy` integration test verifies the functionality of the `GET /accounts/{AccountId}/transactions` endpoint.  Specifically, the test method `\"Verify Accounts transaction Retrieval Request for a Authorised Consent\"` sets the `accountsPath` to `ConnectorTestConstants.TRANSACTIONS_SINGLE_PATH` and asserts that the retrieval response status code is `200`.  This confirms that the endpoint is implemented and returns transaction lists for valid card account IDs after proper authorization. \\n\\n## Notes\\n\\nThe prompt specifically mentions `card-accounts/{account-id}/transactions`. While the provided code uses `accounts/{AccountId}/transactions`, the context of \"Account and Transaction API Specification\" and the `AccountId` parameter strongly suggest that `card-accounts` is a conceptual grouping or a specific instance of `accounts`.   The `OBReadTransaction5` definition includes `CardInstrument` as a property, further supporting the relevance to card accounts. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_8f388297-6569-4d53-8a9b-cda504e9d845\\n', 'id': 'lc_e4e04bbd-9bba-499c-a25b-0923be2dec8a'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0146",
      "requirement": {
        "requirement_id": "ATOM_027",
        "requirement_text": "TPP brand names MAY be entered into the certificate field Organisation Unit (OU) and ASPSPs MAY ignore entries in this field.",
        "strength": "MAY",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0146_1",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_2",
          "text": "components:\n  parameters:\n    consentId:\n      name: \"consentId\"\n      in: \"path\"\n      description: \"ConsentId\"\n      required: true\n      schema:\n        type: \"string\"\n    authorization:\n      in: \"header\"\n      name: \"Authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n    x-fapi-customer-ip-address:\n      in: \"header\"\n      name: \"x-fapi-customer-ip-address\"\n      required: false\n      description: \"The PSU's IP address if the PSU is currently logged in with the TPP.\"\n      schema:\n        type: \"string\"\n    x-fapi-auth-date:\n      in: \"header\"\n      name: \"x-fapi-auth-date\"\n      required: false\n      description: \"The time when the PSU last logged in with the TPP. \\nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \\nSun, 10 Sep 2017 19:43:31 UTC\"\n      schema:\n        type: \"string\"\n        pattern: \"^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\\\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} (GMT|UTC)$\"\n    x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n    x-jws-signature:\n      in: \"header\"\n      name: \"x-jws-signature\"\n      required: true\n      description: \"A detached JWS signature of the body of the payload.\"\n      schema:\n        type: \"string\"\n  responses:\n    201FundsConfirmationConsentsCreated:\n      description: \"Funds Confirmation Consent Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    200FundsConfirmationConsentsConsentIdRead:\n      description: \"Funds Confirmation Consent Read\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationConsentResponse1\"\n    204FundsConfirmationConsentsConsentIdDeleted:\n      description: \"Funds Confirmation Consent Deleted\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    201FundsConfirmationsCreated:\n      description: \"Funds Confirmation Created\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obFundsConfirmationResponse1\"\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          required: true\n          description: \"An RFC4122 UID used as a correlation id.\"\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            fundsconfirmations: \"Funds confirmation entitlement\"\n          x-scopes-bindings:\n            fundsconfirmations: \"Internal/consumer\"\n  x-wso2-security:\n    apim:\n      description: \"This scope will group the ConfirmationOfFundsAPI related operations.\"\n      x-wso2-scopes:\n        - name: \"fundsconfirmations\"\n          key: \"fundsconfirmations\"\n          roles: \"Internal/consumer\"\n  schemas:\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n    links:\n      type: \"object\"\n      description: \"Links relevant to the payload\"\n      properties:\n        Self:\n          type: \"string\"\n          format: \"uri\"\n        First:\n          type: \"string\"\n          format: \"uri\"\n        Prev:\n          type: \"string\"\n          format: \"uri\"\n        Next:\n          type: \"string\"\n          format: \"uri\"\n        Last:\n          type: \"string\"\n          format: \"uri\"\n      additionalProperties: false\n      required:\n        - \"Self\"\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n      additionalProperties: false\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obFundsConfirmation1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n      additionalProperties: false\n    obFundsConfirmationConsent1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"DebtorAccount\"\n          properties:\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\n If this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n      additionalProperties: false\n    obFundsConfirmationConsentResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"DebtorAccount\"\n          properties:\n            ConsentId:\n              description: \"Unique identification as assigned to identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Rejected\"\n                - \"Revoked\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpirationDateTime:\n              description: \"Specified date and time the funds confirmation authorisation will expire.\\nIf this is not populated, the authorisation will be open ended.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            DebtorAccount:\n              type: \"object\"\n              required:\n                - \"SchemeName\"\n                - \"Identification\"\n              description: \"Unambiguous identification of the account of the debtor to which a confirmation of funds consent will be applied.\"\n              properties:\n                SchemeName:\n                  description: \"Name of the identification scheme, in a coded form as published in an external list.\"\n                  type: \"string\"\n                  x-namespaced-enum:\n                    - \"UK.OBIE.BBAN\"\n                    - \"UK.OBIE.IBAN\"\n                    - \"UK.OBIE.PAN\"\n                    - \"UK.OBIE.Paym\"\n                    - \"UK.OBIE.SortCodeAccountNumber\"\n                Identification:\n                  description: \"Identification assigned by an institution to identify an account. This identification is known by the account owner.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 256\n                Name:\n                  description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 350\n                SecondaryIdentification:\n                  description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 34\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false\n    obFundsConfirmationResponse1:\n      type: \"object\"\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          required:\n            - \"FundsConfirmationId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"FundsAvailable\"\n            - \"Reference\"\n            - \"InstructedAmount\"\n          properties:\n            FundsConfirmationId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"Unique identification as assigned by the ASPSP to uniquely identify the funds confirmation consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            FundsAvailable:\n              description: \"Flag to indicate the result of a confirmation of funds check.\"\n              type: \"boolean\"\n            Reference:\n              description: \"Unique reference, as assigned by the CBPII, to unambiguously refer to the request related to the payment transaction.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 35\n            InstructedAmount:\n              type: \"object\"\n              required:\n                - \"Amount\"\n                - \"Currency\"\n              description: \"Amount of money to be confirmed as available funds in the debtor account. Contains an Amount and a Currency.\"\n              properties:\n                Amount:\n                  description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n                  type: \"string\"\n                  pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n                Currency:\n                  description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n                  type: \"string\"\n                  pattern: \"^[A-Z]{3,3}$\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n      additionalProperties: false",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_3",
          "text": "### Software Statement Assertion (SSA)\n\nA software statement that is signed by its issuer is referred to as an SSA. An SSA is represented as a JSON Web Signature (JWS). An SSA is unique for an application and contains metadata of the client to be created. It also ensures that the TPP is trusted and is allowed to consume banking APIs and provide services.\n\n- The TPP submits the SSA to an ASPSP to create OAuth clients that are registered with the ASPSP. \n- WSO2 Open Banking supports Dynamic Client Registration (DCR) API.\n- DCR API supersedes the OpenID Connect (OIDC) Dynamic Client Registration profile.\n\nThe diagram below shows the flow of the dynamically registering a client application. \n\n![dcr_floe](../assets/img/learn/client-registration/dcr-flow.png)\n\nThe TPPs need to obtain the Software Statement Assertion (SSA) from a directory solution provider. For example, Open Banking Directory. The DCR API v3.2 consist of POST, GET, PUT and DELETE endpoints. These endpoints rely on the Client Credential Grant Type and TLS Mutual Authentication for authenticating the TPP.  For more information, refer [Dynamic Client Registration](../learn/dynamic-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_4",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_5",
          "text": "### Step 1: Sign up as a TPP\n\n1. Go to the Developer portal at `https://<APIM_HOST>:9443/devportal`.\n\n2. Go to the **Applications** tab. <br/> ![applications_tab](../../assets/img/learn/mcr/applications-tab.png)\n\n3. In the Sign-in form, click **Create Account**. <br/> ![sign_in](../../assets/img/learn/mcr/sign-in-form.png)\n\n4. Provide a username and click **Proceed Self Register**. <br/> ![start_signing_in](../../assets/img/learn/mcr/start-signing-up.png) <br/>\n\n5. Fill out the **Create New Account** form to complete registration.\n\n6. Read terms and conditions and click the checkbox to agree to the terms and conditions. <br/>![terms_conditions](../../assets/img/learn/mcr/read-the-policies.png)\n\n7. Click Register.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the management of certificates, including the ability to add and remove certificate information associated with Identity Providers (IdPs) via its REST APIs. However, there is no explicit mention or implementation detail within the provided snippets that directly addresses the parsing or specific handling of \"TPP brand names\" within the \"Organisation Unit (OU)\" field of a certificate, nor how ASPSPs (Account Servicing Payment Service Providers) might ignore such entries.  The system allows for the management of certificates, but the specific processing logic for the OU field as described in your query is not evident. \\n\\n### Implementation Details and Configuration Options\\n\\nThe `wso2/product-is` repository provides functionality to manage Identity Providers (IdPs) and their associated certificates.  Specifically, the `IdPSuccessTest.java` file demonstrates how to update and retrieve certificate information for an IdP. \\n\\nThe `AdvancedApplicationConfiguration.java` model includes a `Certificate` object, which suggests that certificate management is a part of the application\\'s advanced configuration.  However, the `Certificate` model itself is not detailed in the provided snippets, so it\\'s unclear what specific fields (like OU) it supports or how they are processed. \\n\\nThe `IdPSuccessTest.java` shows that certificates can be added as Base64 encoded strings.  The test case `testPatchIdP` demonstrates patching an IdP to add or remove certificate data, including `jwksUri` and `certificates`.  The `certificate.certificates` field accepts a Base64 encoded certificate.  The content of this certificate, including its OU field, would be part of the encoded string. \\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoint for managing Identity Provider certificates is part of the Identity Provider Management API.  The `PATCH /api/server/v1/identity-providers/{id}` endpoint is used to update an IdP, including its certificate information. \\n\\nThe `testPatchIdP` method in `IdPSuccessTest.java` illustrates how to use this endpoint to:\\n*   Add a `jwksUri` to the certificate configuration. \\n*   Remove a `jwksUri` from the certificate configuration. \\n*   Add a Base64 encoded certificate to the `certificates` array. \\n*   Remove certificates. \\n\\nThe `OAuth2ServiceAbstractIntegrationTest.java` file also contains utility methods for handling certificates, such as `getCertificateContent` which extracts the content of an X509 certificate.  This suggests that the system is capable of reading and processing certificate details, but the specific handling of the OU field for TPP brand names is not explicitly shown. \\n\\n### Documentation References\\n\\nThe \"Server APIs\" wiki page provides an overview of the Identity Provider Management API, which is used for managing identity providers and federated authenticators.  This wiki page indicates that the base path for Identity Provider Management is `/server/v1/identity-providers`.  The `IdPSuccessTest.java` file confirms the usage of this base path for API calls related to IdP management. \\n\\nThe \"Features and Capabilities\" wiki page mentions \"Advanced OAuth Features\" and \"OpenID Connect Features\" which include \"JWKS Endpoint\" and \"ID Token Encryption\", both of which are related to certificate and key management.   The `testPatchIdP` method in `IdPSuccessTest.java` explicitly tests the addition and removal of a `jwksUri`, which aligns with the mentioned JWKS Endpoint feature. \\n\\n## Notes\\n\\nThe provided code snippets and wiki pages confirm that WSO2 Identity Server supports certificate management for Identity Providers through its REST APIs.  However, the specific requirement regarding \"TPP brand names MAY be entered into the certificate field Organisation Unit (OU) and ASPSPs MAY ignore entries in this field\" is not directly addressed. <cite/> While the system handles certificates, there\\'s no explicit code demonstrating how the OU field is parsed, validated for TPP brand names, or how ASPSPs are expected to interact with this specific field. <cite/> To verify the test criteria, further investigation into the certificate parsing and validation logic within the WSO2 Identity Server\\'s core components would be necessary, which is beyond the scope of the provided snippets. <cite/>\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_319d57e5-e859-4208-b9dd-ee9aed5bc313\\n', 'id': 'lc_e7dbebc2-bbf5-463d-b890-849a2aed4263'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0146_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_23dcb8b3-638e-41f1-b745-c18ab172e225'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0147",
      "requirement": {
        "requirement_id": "ATOM_193",
        "requirement_text": "The ASPSP MAY support deltaList parameter to indicate that the AISP wants all transactions after the last report access for the PSU on the addressed account.",
        "strength": "MAY",
        "capability": "Account Information",
        "section_id": "feec7d26c6c6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0147_1",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0147_2",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': \"This repository, `wso2/financial-services-accelerator`, does not explicitly support a `deltaList` parameter for transactions. The provided OpenAPI specifications for the Account Information APIs, specifically for transactions, do not include a `deltaList` parameter. Instead, the API uses `TransactionFromDateTime` and `TransactionToDateTime` parameters to filter transactions by date and time. \\n\\n### Implementation Details and API Endpoints\\n\\nThe `wso2/financial-services-accelerator` repository defines its Account Information APIs using OpenAPI (Swagger) specifications.  The relevant endpoint for retrieving transactions is `/accounts/{AccountId}/transactions` with a `GET` method. \\n\\nThe parameters supported for filtering transactions are:\\n*   `TransactionFromDateTime`: Specifies the start date and time for the transaction query period. If not populated, data will be returned from the earliest available transaction. \\n*   `TransactionToDateTime`: Specifies the end date and time for the transaction query period. If not populated, the end date will be open-ended, and data will be returned to the latest available transaction. \\n\\nThese parameters are defined within the `OBReadData1` schema, which is part of the `OBReadConsent1` object used in the `CreateAccountAccessConsents` operation.  \\n\\nThe `AccountService.java` in the demo backend provides a mock implementation for the `/accounts/{AccountId}/transactions` endpoint.  This mock service currently returns a static JSON response and does not process `TransactionFromDateTime` or `TransactionToDateTime` parameters to filter transactions. \\n\\n### Configuration Options\\n\\nThere are no explicit configuration options found in the provided context that enable or disable a `deltaList` parameter. The configuration management primarily revolves around the `financial-services.xml` file and `FinancialServicesConfigParser` for various financial services settings, but it does not mention transaction filtering parameters. \\n\\n### Documentation References\\n\\nThe OpenAPI specification files, such as `account-info-swagger.yaml`, serve as the primary documentation for the API endpoints and their parameters.  The descriptions for `TransactionFromDateTime` and `TransactionToDateTime` within this file explain their purpose. \\n\\n## Notes\\n\\nThe concept of a `deltaList` parameter, which would return transactions after the last report access, is not directly implemented or referenced in the provided codebase. The existing functionality relies on explicit date-time ranges (`TransactionFromDateTime` and `TransactionToDateTime`) for filtering transactions. While the `MAY` strength of the requirement suggests it's optional, the current implementation does not appear to support this specific `deltaList` mechanism. The `AccountService.java` is a demo backend and does not fully implement the filtering logic based on the date-time parameters defined in the OpenAPI specification. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9d99437a-df47-44f3-a201-7351476040ce\\n\", 'id': 'lc_33cd66f5-eb47-4d14-aca4-30fa0d11f39b'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0148",
      "requirement": {
        "requirement_id": "ATOM_075",
        "requirement_text": "The system may include additional hyperlinks beyond those specified in related API calls and shall document these in ASPSP PSD2 documentation",
        "strength": "MAY",
        "capability": "General",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0148_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, includes documentation and configuration for various API endpoints that may contain hyperlinks. The system\\'s API layer provides both administrative (Server APIs) and end-user (User APIs) functionalities, with specific endpoints for managing applications, identity providers, claims, user stores, and OAuth/OIDC settings . The documentation for these APIs, including any additional hyperlinks, is expected to be found within the official WSO2 Identity Server documentation, as referenced in the `README.md` and `release-notes.html` files  .\\n\\n### Implementation Details and API Endpoints\\n\\nThe WSO2 Identity Server exposes its functionality through a REST API layer, which is divided into Server APIs and User APIs . These APIs are packaged into a single web application, `api-resources-full.war`, and expose multiple endpoints based on URL patterns .\\n\\nExamples of API endpoints that might include hyperlinks are those related to OAuth/OIDC, such as:\\n*   `OAuth1RequestTokenUrl`   \\n*   `OAuth2AuthzEPUrl`   \\n*   `OAuth2TokenEPUrl`   \\n*   `OAuth2UserInfoEPUrl`   \\n*   `OIDCConsentPage`   \\n\\nThese URLs are configured within XML files, such as `identity-identitymgtlistener-enabled.xml`  and `saml-assertion-query-enabled-identity.xml` , and can be explicitly configured if the default format does not suffice .\\n\\nThe `OrganizationManagementSuccessTest.java` file demonstrates how API responses can contain links, specifically for pagination, using `next` and `previous` link relations  . These links are part of the API response structure and are used for navigation within paginated results .\\n\\n### Configuration Options\\n\\nThe configuration of these API endpoints, including their URLs, is managed through XML files . The system uses a flexible configuration system that supports both file-based and database-stored configurations . This allows for explicit configuration of URLs if the default format is not suitable .\\n\\n### Documentation References\\n\\nThe official documentation for WSO2 Identity Server is available at `https://is.docs.wso2.com/en/latest/` . This documentation is the primary source for details on API calls, including any additional hyperlinks and how they are structured or should be handled by Third-Party Providers (TPPs) . The `release-notes.html` also points to `https://wso2.com/identity-and-access-management` and `http://wso2.org/library` for more information .\\n\\n## Notes\\n\\nThe user\\'s query specifically mentions \"ASPSP PSD2 documentation\". While the WSO2 Identity Server supports FAPI (Financial-grade API) compliance  and OAuth2/OIDC protocols , which are relevant to PSD2, there is no direct mention of \"ASPSP PSD2 documentation\" within the provided code snippets. The documentation references point to general WSO2 Identity Server documentation. Therefore, while the system likely supports the technical requirements for PSD2, specific documentation for ASPSP PSD2 would need to be verified through the external documentation links provided. The test criteria regarding TPPs safely ignoring additional hyperlinks would be addressed by ensuring that any such hyperlinks are clearly documented as optional or informational within the official documentation.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9da6e2d1-0b11-4bc6-9d50-d9ed36d08fcb\\n', 'id': 'lc_07589498-3817-445d-9482-d5abfdb4daeb'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0148_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, WSO2 API Manager, supports documenting additional hyperlinks within its API documentation. This is primarily managed through the API Publisher component, which allows for the creation and management of API-related documents, including those with external URLs.  \\n\\n## Implementation Details\\n\\nThe WSO2 API Manager allows for the creation of various document types, including those that can link to external URLs. The `DocumentDTO` object is used to represent these documents, and it includes fields such as `sourceType` (which can be `URL`), `name`, `summary`, `type`, and `sourceUrl` . When the `sourceType` is set to `URL`, the `sourceUrl` field holds the hyperlink .\\n\\nThe system also defines a \"Doc Links\" table in its governance configuration, which explicitly includes fields for \"Document Type\", \"URL\", and \"Comment\" . This indicates a structured way to store and manage these hyperlinks.\\n\\n## Configuration Options\\n\\nThe `services-config.xml` files across different modules (`all-in-one-apim`, `api-control-plane`, `gateway`, `traffic-manager`) define a `<table name=\"Doc Links\">` section    . Within this table, there are fields specifically for `URL` with the attribute `url=\"true\"` . This configuration allows for the definition of multiple document types, each with an associated URL and comment .\\n\\n## API Endpoints or Features\\n\\nThe API Publisher provides specific endpoints for managing API documentation.\\n*   `GET /apis/{apiId}/documents` : Retrieves a list of documents for a given API.\\n*   `POST /apis/{apiId}/documents` : Adds a new document to an API. This is where the `DocumentDTO` with a `sourceType` of `URL` would be used .\\n*   `GET /apis/{apiId}/documents/{documentId}/content` : Retrieves the content of an API document. For URL type documents, the client receives the URL of the document as a Location header with a `303 See Other` response .\\n\\nThe `ApiDocumentsApi.java` client further illustrates these API calls, specifically the `apisApiIdDocumentsGet` method for retrieving documents .\\n\\n## Documentation References\\n\\nThe `README.txt` file mentions that online product documentation is available at `https://apim.docs.wso2.com/en/4.3.0/` . This external documentation would be the primary place to find details on how to use these features.\\n\\nIntegration tests, such as `APIM611AddDocumentationToAnAPIWithDocTypeHowToThroughPublisherRestAPITestCase.java` , `APIM620AddDocumentationToAnAPIWithDocTypeSampleAndSDKThroughPublisherRestAPITestCase.java` , `APIM623AddDocumentationToAnAPIWithDocTypePublicForumThroughPublisherRestAPITestCase.java` , `APIM625AddDocumentationToAnAPIWithDocTypeSupportForumThroughPublisherRestAPITestCase.java` , and `APIM627AddDocumentationToAnAPIWithDocTypeOtherThroughPublisherRestAPITestCase.java` , demonstrate how to add documents with URL sources to APIs, confirming the functionality. These tests specifically use `DocumentDTO.SourceTypeEnum.URL` and set the `sourceUrl` field .\\n\\n## Notes\\n\\nThe provided snippets confirm that WSO2 API Manager has explicit mechanisms for documenting external hyperlinks associated with APIs. The `services-config.xml` files define the structure for \"Doc Links\" with URL fields, and the API Publisher\\'s REST API and corresponding integration tests demonstrate the ability to add and retrieve documents with URL sources. The system is designed to handle these hyperlinks as part of its API documentation features.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-apim)](/wiki/wso2/product-apim#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ccf6f515-0493-48db-8da3-4f8b30ec19c5\\n', 'id': 'lc_7087f7ba-9e34-41e9-be1f-7996dc848a4d'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0149",
      "requirement": {
        "requirement_id": "ATOM_025",
        "requirement_text": "It is strongly RECOMMENDED to send PSU context data elements in all request messages within payment initiation or consent initiation transaction flows with PSU authentication involved.",
        "strength": "RECOMMENDED",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0149_1",
          "text": "## Multi auth user flows\n\nFor example of multi authorisation flow, we can think joint account scenario where all the users need to approve the consent. Below steps are mainly involved for multi auth user flows,\n\n- Sending CIBA request with login_hint.\n- Identifying multiple users involved in the CIBA request using the given `login_hint`.\n- Sending auth weblinks via SMS for **each** user.\n- Access token can **only** be retrieved after all users have approved the consents.\n- Currently `getAuthenticatedUsers()` method is identifying list of users (Ex: `admin@wso2.com, ann@wso2.com`) , However this can be customised to identify users based on any input (Ex: Bank account number etc.)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0149_2",
          "text": "## Assumptions\n- User's mobile number should be configured.\n- Users will receive the notification as web links to authenticate and authorize the consent.\n- For multiple users involved scenarios, Identity server will assume only one user is authenticated (ID Token will contain the details of only one user (Ex: Primary user) ) and the OB consent tables will contain the authentication status of other users. (This user's identity can be customised by extending and overriding `OBCibaResponseTypeHandler.issue()` method.)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0149_3",
          "text": "### Sending CIBA Request\n\n1. Invoke the CIBA request available in the [Postman collection](https://www.getpostman.com/collections/34a4fa4b9184ae3b4821).\n\n       - `login_hint` parameter inside the request object is default set to identify the user's email.\n       - Behaviour of this value can be customised by extending the `com.wso2.openbanking.accelerator.consent.extensions.ciba.authenticator.weblink.CIBAWebLinkAuthenticatorExtensionImpl` class and overriding it's methods.\n       - Please refer to `Custom CIBA Weblink Extension points` section for more information.\n\n2. The response is as follows:\n\n    ```json\n    {\n       \"auth_req_id\":\"293c00d5-b318-484b-8f7a-54b1048a4832\",\n       \"interval\":2,\n       \"expires_in\":3600\n    }\n    ```\n\n3. At the same time, SMS notification with Auth WebLink should receive to user's mobile device. Click it and open in mobile browser.\n\n       - `com.wso2.openbanking.accelerator.consent.extensions.ciba.authenticator.weblink.notification.provider.SMSNotificationProvider` class is responsible to send the SMS service request, For customisations we can extend `SMSNotificationProvider` or create new class by implementing `NotificationProvider`.\n       - Please refer to `Custom CIBA Weblink Extension points` section for more information.\n\n4. Provide approval for the consent as guided by the application.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0149_4",
          "text": "### Authorization Request\n\nWSO2 Open Banking Accelerator supports the following security features and fulfil FAPI requirements \nduring Authorization flows:\n\n  - OIDC Hybrid Flow\n    - Request object verification\n    - Pushed Authorization Request validation\n    - Pairwise Identifier support for ID tokens\n  - Authorization Code Flow\n    - When a request object is not available, support authentication mechanisms such as PKCE\n\nYou can use the provided extension points and customize the authorization flows. For more information, refer to the\n[Authorization Flow Customization](../develop/keyid-provider.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0149_5",
          "text": "### Token Request\n\nAPI consumer applications use the Token Endpoint to obtain access tokens, id tokens, and optionally, a refresh token.\nFollowing security features are available in WSO2 Open Banking during Token flows.\n\n- The API consumer application can authenticate the authorization server when accessing the token endpoint using any of \nthe following methods:\n    - Private key JWT authentication (Auth code grant)\n    - MTLS authentication (Auth code grant)\n    - Client Assertion (Client Credentials Grant)\n- Bind consent Id and MTLS certificate to the token\n- Provide verification mechanisms such as PKCE, if initiated in the authorization flow\n\nYou can use the provided extension points and customize the token flows. For more information, refer to the\n[Token Flow Customization](../develop/jwt-access-tokens.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0149_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to have some support for handling PSU (Payment Services User) context data elements, particularly in the context of consent and authentication flows. However, direct implementation details for explicitly sending `PSU-IP-Address` or `PSU-User-Agent` headers in payment initiation or consent initiation requests are not explicitly visible in the provided snippets. The codebase primarily focuses on integration tests for various authentication and authorization flows.\\n\\n### Implementation Details and API Endpoints\\n\\nThe `wso2/product-is` repository contains integration tests that simulate user interactions and consent flows. For instance, the `OAuth2BackChannelLogoutTestCase.java`  and `SelfSignUpConsentTest.java`  classes demonstrate how consent is handled during OIDC and self-registration flows, respectively. These tests use utility methods like `sendPostRequestWithParameters`  and `sendPOSTConsentMessage`  to send HTTP requests with various parameters, including session data and consent-related information.\\n\\nThe `AuthorizationDetailsType.java`  model class includes a `type` field that can be set to \"payment_initiation\" , suggesting that the system is designed to handle payment initiation authorization details. This indicates a conceptual alignment with the requirement.\\n\\nThe `catalina-server.xml.j2`  configuration file shows the use of `RemoteIpValve` which can extract client IP addresses from request headers like `remoteIpHeader`. This valve is configured to process headers such as `remoteIpHeader`, `protocolHeader`, and `proxiesHeader`, which could potentially be used to capture `PSU-IP-Address` if configured appropriately.\\n\\nThe `RequestCorrelationIdValve`  is also present, which can map request headers to correlation IDs, and it specifically mentions `RelayState` for `Correlation-ID`. While not directly `PSU-User-Agent`, it shows the capability to process and map custom headers.\\n\\n### Configuration Options\\n\\nThe `catalina-server.xml.j2`  file provides configuration options for the `RemoteIpValve`. To capture `PSU-IP-Address`, you would need to ensure that the `remoteIpHeader` attribute is configured to the appropriate header name that carries the PSU\\'s IP address. Similarly, for `PSU-User-Agent`, while not explicitly shown, the `RequestCorrelationIdValve`  demonstrates the ability to configure custom header mappings, which might be extensible to `PSU-User-Agent`.\\n\\n### Test Criteria\\n\\nThe integration tests in the `wso2/product-is` repository, such as those found in `OAuth2BackChannelLogoutTestCase.java`  and `Oauth2OPIframeTestCase.java` , use `HttpClient` to send requests and set a `User-Agent` header. For example, `sendGetRequest`  and `sendPostRequest`  methods explicitly set the `User-Agent` header using `OAuth2Constant.USER_AGENT`. This demonstrates that the testing framework is capable of including such headers in requests. To verify the inclusion of `PSU-IP-Address` and `PSU-User-Agent` in payment and consent initiation requests, you would need to extend these integration tests to specifically assert the presence and correctness of these headers in the relevant server-side processing.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests and configuration templates. While they show the capability to handle and configure HTTP headers like `User-Agent` and to extract IP addresses, there isn\\'t explicit code demonstrating the *automatic inclusion* of `PSU-IP-Address` and `PSU-User-Agent` in all payment or consent initiation requests as a built-in feature. The `RECOMMENDED` strength of the requirement suggests that this might be a configurable or extensible aspect rather than a hardcoded one. Further investigation into the core application logic and specific payment/consent initiation modules would be needed to confirm the exact implementation and configuration for these PSU context data elements.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-i_8612eeb7-207d-4b86-bfca-aa3291b4dc4f\\n', 'id': 'lc_e5a7cbf0-2be7-4ffa-94fe-ed6f406bb729'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0149_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the inclusion of additional context data elements in requests through its Open Policy Agent (OPA) integration. Specifically, the `opaPolicy_v1.json` policy definition allows for the configuration of \"Additional properties\" to be included in the OPA input payload, which can be retrieved from the message context.  This mechanism could potentially be used to send PSU context data elements like `PSU-IP-Address` and `PSU-User-Agent`. \\n\\n## Implementation Details\\n\\nThe `opaPolicy_v1.json` defines a policy named `opaPolicy` with version `v1` for security-related validations.  This policy allows the gateway to extract a predefined set of metadata from a request and query an OPA policy engine for validation.  The key attribute for your requirement is `additionalProperties`.  This attribute is described as \"Additional message context (request context) properties to be included in the OPA input.\"  These properties are added to the OPA input payload after being retrieved from the message context. \\n\\nThe `MessageContext` interface is a core component in the Synapse API, defining the per-message context passed through mediators.  Mediators can store local message properties into the `MessageContext` for later retrieval.  The `extensions_guide.xml` also mentions that expressions can be used to define dynamically extracted values (using xpath) from the message context, including transport headers.  This suggests that `PSU-IP-Address` and `PSU-User-Agent` headers, if present in the transport headers, could be extracted and included as `additionalProperties` for OPA validation. \\n\\n## Configuration Options\\n\\nTo configure the inclusion of PSU context data elements, you would need to:\\n1.  **Configure the OPA Policy**: In the `opaPolicy_v1.json` or through the API Management interface that utilizes this policy definition, you would specify the `additionalProperties` attribute. \\n2.  **Specify Context Properties**: The value for `additionalProperties` would be a comma-separated list of property names that correspond to the PSU context headers (e.g., `PSU-IP-Address`, `PSU-User-Agent`).  These properties would need to be available in the message context when the OPA policy is applied.\\n\\n## API Endpoints or Features\\n\\nThe `opaPolicy` itself is a security policy that can be applied to APIs.  While the snippets do not directly show the API endpoints for configuring this, the presence of `opaPolicy_v1.json` indicates that this is a defined policy within the API management system.  The description mentions that \"Once a gateway receives a request, gateway will extract a predefined set of meta-data from the request and query OPA via HTTP/HTTPS.\"  This implies that the gateway component of WSO2 API Manager is responsible for applying this policy and sending the context data to the OPA engine.\\n\\n## Documentation References\\n\\nThe `gateway/docs/xdoc/extensions_guide.xml` and `gateway/docs/xdoc/configuration_language.xml` files provide general documentation on extending the Synapse API and its configuration language.   These documents explain how to write custom mediators and use XPath expressions to extract properties from the message context, which would be relevant for making PSU context data available to the OPA policy. \\n\\n## Notes\\n\\nThe provided snippets indicate that the `wso2/product-apim` repository, specifically through its OPA policy integration, offers a mechanism to include custom request context properties in validation flows. The `additionalProperties` attribute in `opaPolicy_v1.json` is the direct configuration point for this.  The ability to extract these properties from the message context, potentially including transport headers, is supported by the underlying Synapse mediation engine.  However, the exact implementation of how `PSU-IP-Address` and `PSU-User-Agent` would be mapped to message context properties for the OPA policy would depend on the specific API gateway configuration and any custom mediators or extensions in place. The snippets do not provide explicit examples of configuring `PSU-IP-Address` or `PSU-User-Agent` as `additionalProperties`.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-i_2875370d-cacb-442d-9f39-e720faf08a8f\\n', 'id': 'lc_a66d4128-b4f0-4917-bfca-bf37851c83f5'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0150",
      "requirement": {
        "requirement_id": "ATOM_044",
        "requirement_text": "The Content-Type header MUST be set to application/json when using NextGenPSD2 specific error information",
        "strength": "MANDATORY",
        "capability": "Error Handling",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0150_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, contains integration tests that demonstrate how `Content-Type: application/json` is used in various API interactions, particularly for error responses and data exchange. While there\\'s no direct mention of \"NextGenPSD2 specific error information,\" the codebase extensively uses `application/json` for communication with REST APIs and for handling error responses in a JSON format.   \\n\\n### Implementation Details\\n\\nThe integration tests in `wso2/product-is` frequently set the `Content-Type` header to `application/json` when making API requests and expecting JSON responses. For instance, in `SCIM2GroupTestCase.java`, when creating a group, the `HttpPost` request explicitly sets the `Content-Type` header to `application/json` . Similarly, when creating a group with charset encoding, it\\'s set to `application/json; charset=utf-8` .\\n\\nThe `OAuth2RestClient.java` also demonstrates setting the `Content-Type` to `application/json` for requests involving bearer tokens .\\n\\nFor error responses, the `RESTTestBase.java` class includes methods like `validateErrorResponse` and `validateErrorResponseWithoutTraceId` . These methods are designed to validate JSON error responses, checking for specific fields like `code`, `message`, `description`, and `traceId` . This implies that error responses are expected to be in `application/json` format.\\n\\n### Configuration Options\\n\\nThe codebase does not explicitly show configuration options for enforcing `Content-Type: application/json` for NextGenPSD2 errors. However, the consistent use of `application/json` in the integration tests suggests that this is the expected and default behavior for REST API interactions and error handling within the system.\\n\\n### API Endpoints or Features\\n\\nThe `SCIM2GroupTestCase.java` demonstrates API interactions for creating, retrieving, and deleting groups, where `application/json` is consistently used for the `Content-Type` header   . The `scim2.yaml` Swagger definition also indicates that SCIM 2.0 API endpoints produce and consume `application/scim+json`, which is a specific JSON media type  .\\n\\nThe `RESTTestBase.java` provides a generic framework for testing REST APIs, including methods for `POST`, `PATCH`, and `DELETE` requests, all of which default to `ContentType.JSON`   . This further reinforces the expectation of JSON for API communication.\\n\\n### Documentation References\\n\\nThe provided context includes a wiki page on \"Integration Tests\" . This wiki page describes the overall testing framework and mentions \"REST API Tests\" as a category . While it doesn\\'t specifically detail NextGenPSD2 error handling, it confirms that REST API interactions are a core part of the integration testing, and as seen in the code, these interactions heavily rely on `application/json`.\\n\\n## Notes\\n\\nThe query specifically asks about \"NextGenPSD2 specific error information.\" While the codebase demonstrates a strong adherence to `application/json` for error responses in general, there is no explicit mention or implementation related to \"NextGenPSD2\" within the provided snippets. Therefore, while the system supports `Content-Type: application/json` for error responses, it\\'s not possible to confirm if there are specific implementations or configurations tailored for NextGenPSD2 error formats based solely on the given context. The `RESTTestBase.java`  shows a generic JSON error response structure.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0f432d9f-8af6-4927-9733-94b8e56fed94\\n', 'id': 'lc_212f0cf5-d5d9-48f0-a98c-08faaf95aca8'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0150_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support setting the `Content-Type` header to `application/json` for error responses, particularly within its Synapse configurations. This is evident in the `_throttle_out_handler_.xml` and `fault.xml` sequences, which explicitly set this header for JSON-formatted error payloads. The OpenAPI specifications also indicate that `application/json` is the default and expected content type for various API responses and error scenarios.\\n\\n## Implementation Details\\n\\nThe core implementation for setting the `Content-Type: application/json` header for error responses is found within the Synapse configurations, specifically in the `_throttle_out_handler_.xml` and `fault.xml` sequences.\\n\\n### `_throttle_out_handler_.xml`\\nIn `_throttle_out_handler_.xml`, when a throttling event occurs and the message format is not SOAP, the system constructs a JSON payload for the error response . For HTTP methods other than POST, PUT, or PATCH, the `messageType` property is explicitly set to `application/json` within the `axis2` scope . This ensures that the `Content-Type` header of the outgoing response will be `application/json`. The `_throttle_out_handler_.xml` file was last modified by `kasunsw` in commit [1222232a](https://github.com/wso2/product-apim/commit/1222232a21122112211221122112211221122112) on `2020-03-10`.\\n\\n### `fault.xml`\\nSimilarly, in `fault.xml`, for non-SOAP fault scenarios, a JSON payload is created for the error response . A filter checks the HTTP method, and if it\\'s not POST, PUT, or PATCH, the `messageType` property is set to `application/json` in the `axis2` scope . This also ensures the `Content-Type` header is `application/json`. The `fault.xml` file was last modified by `kasunsw` in commit [1222232a](https://github.com/wso2/product-apim/commit/1222232a21122112211221122112211221122112) on `2020-03-10`.\\n\\n### `main.xml`\\nThe `main.xml` sequence also demonstrates setting `Content-Type` for error responses. For instance, when a `TRANSPORT_DENIED` error occurs, a JSON payload is generated, and the `ContentType` property is explicitly removed from the `axis2` scope, implying that the `messageType` property (which is set to `application/json` for certain HTTP methods) will dictate the final `Content-Type` header . The `main.xml` file was last modified by `kasunsw` in commit [1222232a](https://github.com/wso2/product-apim/commit/1222232a21122112211221122112211221122112) on `2020-03-10`.\\n\\n## Configuration Options\\n\\nThe Synapse configuration files (`_throttle_out_handler_.xml`, `fault.xml`, `main.xml`) directly control the `Content-Type` header for error responses. The `payloadFactory` mediator is used to construct the JSON error messages  . The `property name=\"messageType\" value=\"application/json\" scope=\"axis2\"`  is the explicit configuration that sets the `Content-Type` header.\\n\\n## API Endpoints or Features\\n\\nThe OpenAPI specification files, such as `openapi.yaml` in various client directories, consistently define `application/json` as the content type for both successful responses and error responses across different API endpoints.\\n\\nFor example, in `all-in-one-apim/modules/integration/tests-common/clients/admin/api/openapi.yaml`, many response definitions, including error responses like `406 Not Acceptable` and `404 Not Found`, specify `application/json` as their content type              . This indicates a consistent expectation for JSON error responses.\\n\\nSimilar patterns are observed in other OpenAPI definitions:\\n*   `all-in-one-apim/modules/integration/tests-common/clients/publisher/api/openapi.yaml`  \\n*   `all-in-one-apim/modules/integration/tests-common/clients/service-catalog/api/openapi.yaml`       \\n*   `all-in-one-apim/modules/integration/tests-common/clients/service-catalog/src/main/resources/service-catalog-api.yaml`   \\n*   `all-in-one-apim/modules/integration/tests-common/clients/store/api/openapi.yaml`        \\n\\nThese OpenAPI definitions serve as documentation and contracts for the APIs, indicating that `application/json` is the standard content type for error responses.\\n\\n## Documentation References\\n\\nThe OpenAPI specification files themselves act as documentation for the API endpoints and their expected request/response formats, including the `Content-Type` header. For instance, the `Content-Type` header is explicitly described in the OpenAPI definitions for various operations       .\\n\\n## Notes\\n\\nThe prompt specifically mentions \"NextGenPSD2 specific error information\". While the provided code snippets clearly show support\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_34784550-b49b-42f4-bf00-c61ca8e9f0e1\\n', 'id': 'lc_80f613d5-3438-48eb-be4f-f7d8c1205a27'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0151",
      "requirement": {
        "requirement_id": "ATOM_091",
        "requirement_text": "TPP should follow OAuth Security Best Practice definitions as defined in OA-SecTop reference",
        "strength": "RECOMMENDED",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0151_1",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0151_2",
          "text": "### Authorization Request\n\nWSO2 Open Banking Accelerator supports the following security features and fulfil FAPI requirements \nduring Authorization flows:\n\n  - OIDC Hybrid Flow\n    - Request object verification\n    - Pushed Authorization Request validation\n    - Pairwise Identifier support for ID tokens\n  - Authorization Code Flow\n    - When a request object is not available, support authentication mechanisms such as PKCE\n\nYou can use the provided extension points and customize the authorization flows. For more information, refer to the\n[Authorization Flow Customization](../develop/keyid-provider.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0151_3",
          "text": "# API Security Open Banking allows API consumers to access financial data through open APIs, which requires greater API security. Therefore, open banking standards provide guidelines for security implementations so that only the intended party can access information that the customer has given prior consent. To achieve this, different specifications mandate security requirements via the relevant specification, which is built upon existing standards defined in OAuth 2.0 and OpenID specifications. The diagram below provides a brief idea of how certain specifications are built upon these specifications. ![fapi_strcutre](../assets/img/learn/api-security/fapi-structure.png) While some open banking specifications, such as the Open Banking Standard - UK and Consumer Data Standards - Australia mandated FAPI, others do not. However, regardless of your regional specification, WSO2 Open Banking Accelerator provides FAPI security standards because of the robust security standards offered by FAPI. ###MTLS enforcement Authentication is a crucial requirement in open banking to verify the authenticity of an API consumer before sharing the customer\u2019s banking information. When an API consumer invokes APIs, their private credentials can be shared in the requests, and it leads to credential leakages and data thefts. Therefore, Mutual Transport Layer Security (MTLS) is introduced as an authentication protocol where the API consumers do not need to send their private credentials. MTLS handshake at the transport layer ensures that the corresponding API consumer possesses a secret key that is associated with the X509 certificate issued by a trusted Certificate Authority (CA). In WSO2 Open Banking Accelerator, MTLS is enforced at the API Manager level to check if - the message context contains the transport certificate to make sure that the MTLS handshake is successful at the gateway - the transport certificate bound to the application when invoking the APIs There are two scenarios to consider for the MTLS validation: 1. If the client directly initiates an MTLS connection with the WSO2 API Manager Gateway, the issuer of the certificate needs to be present in the truststore of the gateway. 2. If the MTLS terminates at the load balancer prior to the gateway, the WSO2 API Manager Gateway expects the load balancer to send the client certificate as a header. In such scenarios, the WSO2 API Manager gateway expects the load balancer to perform the issuer validation. ###Certificate Revocation Validation A certificate is issued by a trusted organization commonly known as a CA. It is also known as a Trust Service Provider (TSP). These certificates are expected to be in use for their entire validity period. However, certain circumstances may cause a certificate to become invalid prior to the expiration of the validity period. For example, a compromise or suspected compromise of the corresponding private key may cause a certificate to become invalid prior to the expiration. A revocation request can originate from the National Competent Authority (NCA), which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0151_4",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0151_5",
          "text": "## Configure Transport Layer Security (TLS) Parameters\n\n1. Open the `<APIM_HOME>/repository/conf/deployment.toml` file.\n2. Add the following configurations:\n\n    ``` toml\n    [transport.https.sslHostConfig.properties]\n    ciphers=\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n3. Add the `PreferredCiphers` configurations under the `[transport.passthru_https.listener.parameters]` tag:\n\n    ``` toml\n    [transport.passthru_https.listener.parameters]\n    PreferredCiphers = \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"\n    ```\n\n4. Restart the API Manager.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0151_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'WSO2 Identity Server (product-is) supports OAuth Security Best Practices, including aspects relevant to Third-Party Providers (TPPs) as outlined in the OA-SecTop reference. The platform demonstrates this through its support for Financial-grade API (FAPI) conformance and specific security features like Demonstrating Proof of Possession (DPoP) and PKCE. \\n\\n## Implementation Details\\n\\n### FAPI Conformance\\nWSO2 Identity Server undergoes regular FAPI conformance testing, which includes FAPI1 Advanced, FAPI1 Baseline, FAPI2 Security, and FAPI2 Message Signing profiles.  This indicates a commitment to financial-grade security standards, which are often aligned with best practices for TPPs. \\n\\n### DPoP (Demonstrating Proof of Possession)\\nThe platform supports DPoP tokens, which enhance security by binding access tokens to a specific client\\'s cryptographic key.  The `OAuth2DPopTestCase.java` file contains integration tests for DPoP, demonstrating how DPoP proofs are generated and used in token requests and resource access.  For instance, the `genarateDPoPProof` method is used to create DPoP proofs for token requests. \\n\\n### PKCE (Proof Key for Code Exchange)\\nWSO2 Identity Server supports PKCE, a security extension for the OAuth 2.0 Authorization Code Flow, which mitigates authorization code interception attacks.  The `OAuth2PKCETestCase.java` demonstrates testing for PKCE implementation, including scenarios with plain and S256 challenge methods. \\n\\n## Configuration Options\\n\\n### Access Token Binding Type\\nThe `oidc-metadata.json` file shows that `DPoP` is a supported `accessTokenBindingType` option, alongside `None`, `cookie`, `sso-session`, `device-flow`, and `certificate`.  This allows for configuring how access tokens are bound to enhance security. \\n\\n### Client Authentication Methods\\nThe platform supports various `tokenEndpointAuthMethod` options, including `client_secret_post`, `private_key_jwt`, `tls_client_auth` (Mutual TLS), and `client_secret_basic`.  These options provide flexibility in securing client authentication at the token endpoint. \\n\\n### Request Object Security\\nConfiguration options for request objects include `requestObjectSigningAlg` and `encryption` settings (algorithm and method).  This allows for securing authorization requests by signing and encrypting them. \\n\\n## API Endpoints or Features\\n\\n### OAuth2/OIDC Endpoints\\nWSO2 Identity Server exposes standard OAuth2/OIDC endpoints such as `/oauth2/authorize`, `/oauth2/token`, `/oauth2/revoke`, `/oauth2/userinfo`, and `/oauth2/jwks`.  These endpoints are fundamental for implementing secure OAuth2 and OpenID Connect flows. \\n\\n### DPoP Header\\nThe `DPoP` header is used in DPoP-enabled token requests and resource access.  The `OAuth2DPopTestCase` demonstrates sending this header with a generated DPoP proof. \\n\\n## Documentation References\\n\\nThe wiki page \"OAuth2 and OpenID Connect\" provides a comprehensive overview of the implementation, including supported grant types, token handling, and conformance with standards like FAPI.  The `README.md` also highlights \"Best API security available anywhere, using the powerful FAPI standard\" as a key feature. \\n\\n## Notes\\n\\nThe user\\'s query specifically mentions \"OA-SecTop reference\". While the codebase explicitly references FAPI conformance, which aligns with many OAuth Security Best Practices, there is no direct mention or specific implementation details tied to an \"OA-SecTop reference\" document within the provided snippets. However, the strong emphasis on FAPI conformance, DPoP, and PKCE indicates a robust adherence to general OAuth security best practices.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_1f458e89-660b-49c6-bc1b-e71e17a50e7e\\n', 'id': 'lc_b5c8872a-15fc-485f-b5ad-43158ba81ff2'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0151_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports OAuth Security Best Practices, particularly concerning the configuration and implementation of OAuth 2.0 for API endpoint security. The system allows for various OAuth grant types and provides configuration options for token management, including revocation and encryption. \\n\\n## Implementation Details\\n\\nThe WSO2 API Manager (`wso2/product-apim`) provides mechanisms to secure API endpoints using OAuth 2.0. This is demonstrated through integration tests that configure endpoint security for different OAuth grant types. \\n\\n### OAuth Grant Types\\nThe system explicitly supports `CLIENT_CREDENTIALS` and `PASSWORD` grant types for securing API endpoints. \\n\\n*   **Client Credentials Grant Type**: The `testAddEndpointSecurityForOauthForClientCredentialsGrantType` method in `AddEndPointSecurityPerTypeTestCase.java` illustrates how to configure an API to use the `CLIENT_CREDENTIALS` grant type for endpoint security.  This involves setting the `endpoint_security` configuration with `type: \"OAUTH\"` and `grantType: \"CLIENT_CREDENTIALS\"`. \\n*   **Password Grant Type**: Similarly, `testAddEndpointSecurityForOauthForPasswordGrantType` demonstrates the configuration for the `PASSWORD` grant type, including `username` and `password` parameters in the `endpoint_security` configuration. \\n\\nThe `velocity_template.xml` and `endpoint_template.xml` files show how these OAuth security configurations are applied to endpoints, including the use of secure vault for client secrets and passwords. \\n\\n### Token Management\\nThe system supports token revocation and encryption. \\n*   **Token Revocation**: The `RevokeAPIURL` property in `api-manager.xml` configurations points to the endpoint for token revocation. \\n*   **Token Encryption**: The `EncryptPersistedTokens` setting in `api-manager.xml` and `identity.xml` indicates whether tokens are encrypted when stored in the database.  When enabled, the `TokenPersistenceProcessor` is set to `org.wso2.carbon.identity.oauth.tokenprocessor.EncryptionDecryptionPersistenceProcessor`. \\n\\n## Configuration Options\\n\\nOAuth-related configurations are primarily found in `deployment.toml` and various `api-manager.xml` and `identity.xml` files. \\n\\n### `deployment.toml`\\nThe `[apim.oauth_config]` section in `deployment.toml` contains general OAuth configurations. \\n*   `enable_outbound_auth_header`: Controls whether an outbound authorization header is enabled. \\n*   `auth_header`: Specifies the authorization header name. \\n*   `revoke_endpoint`: The endpoint for token revocation. \\n*   `enable_token_encryption`: Enables or disables token encryption. \\n*   `enable_token_hashing`: Enables or disables token hashing. \\n\\n### `api-manager.xml`\\nWithin `api-manager.xml` files, the `<OAuthConfigurations>` section provides further OAuth-related settings. \\n*   `TokenEndPointName`: Defines the name of the token API, typically `/oauth2/token`. \\n*   `RevokeAPIURL`: Specifies the URL for the token revocation API. \\n*   `EncryptPersistedTokens`: A boolean flag to enable or disable encryption of tokens stored in the database. \\n*   `EnableTokenHashMode`: A boolean flag to enable or disable hashing of tokens stored in the database. \\n\\n### `identity.xml`\\nThe `<OAuth>` section in `identity.xml` contains detailed configurations for OAuth, including token validity periods, caching, and supported grant types. \\n*   `AccessTokenDefaultValidityPeriod`: Default validity period for application access tokens. \\n*   `RefreshTokenValidityPeriod`: Validity period for refresh tokens. \\n*   `TokenPersistenceProcessor`: Specifies the class responsible for processing tokens before storage, such as `EncryptionDecryptionPersistenceProcessor` for encryption. \\n*   `SupportedGrantTypes`: Lists the supported OAuth grant types and their respective handler implementations, including `authorization_code`, `password`, `refresh_token`, and `client_credentials`. \\n\\n## API Endpoints or Features\\n\\nThe WSO2 API Manager exposes several endpoints related to OAuth and security.\\n*   `/oauth2/authorize`: The authorization endpoint. \\n*   `/oauth2/token`: The token endpoint for obtaining OAuth tokens. \\n*   `/revoke`: The endpoint for revoking OAuth tokens. \\n\\nThe system also supports Mutual TLS (mTLS) for APIs, which can be enabled or disabled via the `<EnableMTLSForAPIs>` configuration in `api-manager.xml`. \\n\\n## Documentation References\\n\\nWhile explicit documentation references to an \"OA-SecTop reference document\" are not directly present in the provided code snippets, the configuration parameters and implementation details suggest adherence to common OAuth security best practices. The presence of configurations for token encryption, hashing, and revocation, along with support for various grant types, aligns with general security recommendations for OAuth 2.0. <cite repo=\"wso2/product-\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ca25242c-8635-4888-b583-f55a6f388975\\n', 'id': 'lc_da67da56-6310-4524-9a82-329b3ef36d9c'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0152",
      "requirement": {
        "requirement_id": "ATOM_045",
        "requirement_text": "The Content-Type header MUST be set to application/problem+json when using standardised RFC7807 error information",
        "strength": "MANDATORY",
        "capability": "Error Handling",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0152_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not explicitly support setting the `Content-Type` header to `application/problem+json` for RFC7807 error information. The existing error handling mechanisms primarily validate the HTTP status code, error code, message, and description within the response body, but do not specifically check the `Content-Type` header for `application/problem+json`    .\\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository uses a standardized error response format that includes `code`, `message`, `description`, and `traceId` . This format is validated in various integration tests across different API modules .\\n\\nThe `validateErrorResponse` method in `RESTTestBase.java` is a core utility for verifying error responses . It checks the HTTP status code, the error `code`, the presence of a `traceId`, and the `message` and `description` against predefined properties . However, there is no explicit check for the `Content-Type` header being `application/problem+json` within this validation logic .\\n\\nFor example, in `ApplicationManagementFailureTest.java`, error responses are validated using `validateErrorResponse` . Similarly, `IdPFailureTest.java` and `ApplicationManagementOAuthFailureTest.java` also rely on this method for error validation  .\\n\\nThe `validateFailedBasicAuthenticationResponseBody` method in `ApplicationNativeAuthentication2FATestCase.java` explicitly checks for the presence of `CODE`, `MESSAGE`, `DESCRIPTION`, and `TRACE_ID` keys in the JSON response body, but again, it does not validate the `Content-Type` header .\\n\\n### Configuration Options\\n\\nThere are no explicit configuration options visible in the provided snippets that would allow enabling or disabling the `application/problem+json` content type for error responses. The `web.xml` configuration for Server APIs defines exception mappers like `APIErrorExceptionMapper` and `InputValidationExceptionMapper` . These mappers are responsible for handling exceptions and formatting error responses, but their specific output `Content-Type` is not directly configurable through the provided context.\\n\\n### API Endpoints or Features\\n\\nThe Server APIs, as described in the \"Server APIs\" wiki page, use RESTful interfaces and JSON as the primary data format for requests and responses . While the API architecture includes error handling mechanisms through exception mappers , there is no specific API endpoint or feature mentioned that explicitly guarantees or allows configuration of `application/problem+json` for error responses.\\n\\n### Documentation References\\n\\nThe \"Server APIs\" wiki page describes the error handling mechanism through exception mappers . However, it does not specify the `Content-Type` header for these error responses. The `scim2.yaml` file defines schemas for various error types like `ErrorIvalidInput`, `ErrorUnauthorized`, `ErrorForbidden`, and `ErrorUserNotAvailable` . These schemas describe the structure of the error *body* but do not dictate the `Content-Type` header. The `produces` field in `scim2.yaml` for successful responses is `application/scim+json` , but it does not specify the `Content-Type` for error responses.\\n\\n## Notes\\n\\nThe provided codebase context primarily focuses on the structure and content of error response bodies, along with the HTTP status codes. There is no direct evidence within the snippets to confirm or deny support for the `Content-Type: application/problem+json` header as per RFC7807. The existing test cases and API definitions do not include assertions or specifications for this particular header in error scenarios. To verify this, one would need to examine the actual implementation of the exception mappers and the HTTP response generation logic.\\n\\nWiki pages you might want to explore:\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n- [Server APIs (wso2/product-is)](/wiki/wso2/product-is#4.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_9c6991d3-9bcc-494f-979a-4fe0359ae339\\n', 'id': 'lc_27c093c7-81b6-4a2d-b71d-65f3a0f27863'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0152_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, the repository does not explicitly support setting the `Content-Type` header to `application/problem+json` for RFC7807 error information. The `openapi.yaml` files define error responses with `application/json` as the `Content-Type`   .\\n\\n### Implementation Details\\nThe `ApiClient.mustache` file contains a `isJsonMime` function that checks if a given MIME type is JSON. This function uses a regular expression `(?i)^(application/json|[^;/ \\\\t]+/[^;/ \\\\t]+[+]json)[ \\\\t]*(;.*)?$` to identify JSON MIME types, which includes `application/json` and any MIME type ending with `+json` . This indicates that the client-side code is capable of recognizing `application/problem+json` as a JSON MIME type.\\n\\nHowever, the `deserialize` method in `ApiClient.mustache` defaults to `application/json` if the `Content-Type` header is not present in the response . It then uses the `isJsonMime` function to determine if the content should be deserialized as JSON .\\n\\n### Configuration Options\\nThere are no explicit configuration options visible in the provided snippets to enforce `application/problem+json` for error responses. The `openapi.yaml` files consistently define error responses with `content: application/json`   .\\n\\n### API Endpoints or Features\\nThe `openapi.yaml` files for the Admin, Store, and Publisher APIs define various error responses (e.g., 400, 401, 404, 406, 415, 500)   . In all these cases, the `Content-Type` is specified as `application/json`, and the error schema references a common `#/components/schemas/Error`   . There is no indication that any API endpoint explicitly returns `application/problem+json` for error information.\\n\\n### Documentation References\\nThe `openapi.yaml` files serve as API documentation . These documents consistently specify `application/json` for error responses, not `application/problem+json` .\\n\\n## Notes\\nThe `ApiClient.mustache` file, which is a template for an API client, does include logic to recognize MIME types ending with `+json` as JSON . This suggests that while the server-side API definitions (in `openapi.yaml`) currently specify `application/json` for errors, the client-side code has the capability to handle `application/problem+json` if the server were to implement it. However, based on the provided snippets, the server-side implementation does not appear to be configured to return `application/problem+json` for RFC7807 error information.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_42163823-dcec-4b2e-b84c-09fe4aabe32b\\n', 'id': 'lc_2095fd51-d0d5-43fb-8b58-2c4d9d2878d6'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0153",
      "requirement": {
        "requirement_id": "ATOM_028",
        "requirement_text": "URIs provided by TPPs in TPP-Redirect-URI or TPP-Nok-Redirect-URI SHOULD comply with the domain secured by the eIDAS QWAC certificate of the TPP in the field CN or SubjectAltName.",
        "strength": "SHOULD",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0153_1",
          "text": "Certificate (QWAC) and Qualified Certificates for Electronic Seals (QSealC) to secure the transport layer and application layer with the API consumer. ####Qualified Web Authentication Certificate (QWAC) QWAC validates the identity and the role of the [API consumer](#role-validation). During API invocations, API consumers can use their eIDAS QWAC to establish a secure TLS channel and protect the transport layer communication from potential attackers on the network. WSO2 Open Banking Accelerator validates the following aspects of the QWAC if it is used for an API invocation: - The certificate is qualified, technically correct, and is not expired. - The PSD2 information in the certificate such as PSD2 roles, Authorization Number matches with the API being invoked. - The certificate is not revoked using CRL or Online OCSP validations. ####Qualified e-Seal Certificate (QSealC) QSealC seals application data and sensitive information to ensure that the origin of the document is trusted. WSO2 Open Banking Accelerator allows using QSealC as the signing certificates in application layer security to ensure protecting the data or messages from potential attackers during or after the communication. <hr> Generally, open banking flows always consist of 3 different types of API requests by the client applications. The following section lists the different security measures taken at each of the request types.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_2",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_3",
          "text": "#Details for Tsteing Purposes\n\nSSA SoftwareId - oQ4KoaavpOuoE7rvQsZEOV\nSSA Redirect Uri - https://www.google.com/redirects/redirect1\n\n\nSample Keystore information:\n- Signing Kid = sCekNgSWIauQ34klRhDGqfwpjc4\n\n- Signing keystore alias = signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - ztDjNGnLwZ48M1ibdMNOiQwQLsQ\n\n- Transport keystore alias = transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_4",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_5",
          "text": "#Using Sample Resources\n\nFollowing configs can be used in test-config.xml to use sample SSA and keystores for DCR tests.\n\n    <DCR>\n        <SSAPath>Path.To.Directory/ssa.txt</SSAPath>\n        <!-- SSA SoftwareId -->\n        <SoftwareId>jFQuQ4eQbNCMSqdCog21nF</SoftwareId>\n        <!-- SSA Redirect Uri -->\n        <RedirectUri>https://www.google.com/redirects/redirect1</RedirectUri>\n    </DCR>\n\nUse signing.jks in 'signing-keystore' directory as the Application Keystore, and transport.jks in 'transport-keystore'\ndirectory as the Transport Keystore.\n\nSample Keystore information:\n\n- Signing Kid = 7eJ8S_ZgvlYxFAFSghV9xMJROvk\n\n- Signing keystore alias = tpp7-signing\n\n- Signing keystore password = wso2carbon\n\n- Transport Kid - 7x6UrhU-Yj1Aa9Ird03JJCcDurs\n\n- Transport keystore alias = tpp7-transport\n\n- Transport keystore password = wso2carbon",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the specific requirement of verifying TPP-Redirect-URI or TPP-Nok-Redirect-URI compliance with eIDAS QWAC certificate domains (CN or SubjectAltName fields) <cite/>. While the codebase handles OAuth2 and OpenID Connect redirect URIs, there\\'s no explicit implementation or configuration option found in the provided snippets that links redirect URI validation to eIDAS QWAC certificate domain checks <cite/>.\\n\\n### Implementation Details\\nThe codebase includes mechanisms for managing and validating redirect URIs within the context of OAuth2 and OpenID Connect applications . For instance, the `OpenIDConnectConfiguration` class defines `callbackURLs` as a list of authorized redirect URIs .\\n\\nThe system performs checks to ensure that redirect URIs are registered and valid . For example, in the OIDC conformance tests, there are scenarios like `oidcc-ensure-registered-redirect-uri` that verify if a redirect URI is registered . If an invalid redirect URI is provided, the system returns a `BAD_REQUEST` status . The `OAuth2PushedAuthRequestTestCase` includes a test case `testSendParWithInvalidRedirectURI` which asserts a `400 Bad Request` for an invalid redirect URI .\\n\\nHowever, the provided code snippets do not show any explicit implementation for validating redirect URIs against eIDAS QWAC certificate fields like CN or SubjectAltName <cite/>. The validation appears to be primarily focused on whether the URI is registered and syntactically correct, rather than cryptographically linked to a TPP\\'s certificate .\\n\\n### Configuration Options\\nThe `OpenIDConnectConfiguration` class allows for the configuration of `callbackURLs` for an application . These are the authorized redirect URIs that the Identity Server will accept .\\n\\nDuring Dynamic Client Registration (DCR), redirect URIs are provided as part of the application registration request . The `OAuth2CommonClient` class demonstrates how `redirect_uris` can be set in a DCR request . The `DCRTestCase` also validates the `redirect_uris` provided in the registration request against the response .\\n\\nThere is no explicit configuration option in the provided snippets to enable or configure eIDAS QWAC certificate-based domain validation for redirect URIs <cite/>.\\n\\n### API Endpoints or Features\\nThe relevant API endpoint for managing OAuth2/OIDC applications and their redirect URIs is likely part of the Dynamic Client Registration (DCR) endpoint . The `DCRTestCase` uses `/api/identity/oauth2/dcr/v1.1/register` for registering applications .\\n\\nThe `OAuth2PushedAuthRequestTestCase` interacts with the `PAR_ENDPOINT` (Pushed Authorization Request endpoint) and validates redirect URIs in that context .\\n\\nThe `ClientAuthenticationConfiguration` class includes a `tlsClientAuthSubjectDn` property, which suggests support for TLS client authentication and the use of subject DNs from certificates . However, this is related to client authentication itself, not specifically to validating redirect URIs against the domain in a TPP\\'s QWAC certificate <cite/>.\\n\\n### Documentation References\\nThe wiki page \"OAuth2 and OpenID Connect\" provides a general overview of OAuth2 and OIDC implementation in WSO2 Identity Server . It mentions \"Standards Compliance\" and \"FAPI Conformance\" . While FAPI (Financial-grade API) standards often involve stricter security requirements, including certificate-based authentication, the provided snippets do not detail how FAPI conformance specifically addresses the eIDAS QWAC certificate domain validation for redirect URIs <cite/>. The `oidc-fapi-conformance-tests/constants_fapi.py` file defines configurations for FAPI applications, including `redirect_uris` and `token_endpoint_auth_method` like `tls_client_auth` . This indicates that TLS client authentication is supported, which is a prerequisite for eIDAS QWAC certificate usage, but the direct link to redirect URI domain validation is not present <cite/>.\\n\\n## Notes\\nThe query specifically asks about eIDAS QWAC certificate validation for redirect URIs. While the codebase supports OAuth2/OIDC, Dynamic Client Registration, and TLS client authentication, there is no direct evidence in the provided snippets of an implementation that performs the requested domain validation against eIDAS QWAC certificate fields (CN or SubjectAltName) <cite/>. The existing redirect URI validation primarily focuses on registration and basic format checks . It\\'s possible this functionality exists elsewhere in the codebase or as an extension, but it is not visible in the provided context <cite/>.\\n\\nWiki pages you might want to explore:\\n- [OAuth2 and OpenID Connect (wso2/product-is)](/wiki/wso2/product-is#3.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-u_29381e66-864f-4a31-b2a8-6831d08bef5f\\n', 'id': 'lc_7fd16295-8d51-454b-81f8-af6567ed6f89'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0153_7",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, does not appear to directly support the specific requirement of verifying TPP-Redirect-URI or TPP-Nok-Redirect-URI against eIDAS QWAC certificate domains (CN or SubjectAltName fields). The provided code snippets primarily deal with general certificate information and API endpoint certificates, rather than the validation of redirect URIs based on TPP QWAC certificates.\\n\\n## Implementation Details, Configuration Options, API Endpoints, and Documentation References\\n\\nBased on the provided codebase context, there are no explicit implementation details, configuration options, API endpoints, or documentation references that directly address the validation of redirect URIs against eIDAS QWAC certificate domains.\\n\\nThe `CertificateInfoDTO` class   contains fields like `subject`   which could potentially store certificate subject information, including the Common Name (CN). However, this DTO is used in the context of API endpoint certificates, as seen in `APIEndpointCertificateTestCase.java` , and not for validating TPP redirect URIs.\\n\\nFor example, in `APIEndpointCertificateTestCase.java`, the `testSearchEndpointCertificates` method  retrieves and asserts the subject of endpoint certificates  . This indicates that certificate subject information is accessible and used within the system, but its application is for API endpoint validation, not TPP redirect URI validation.\\n\\nThe `deployment.toml` file  shows configuration related to keystores , which are used for TLS, but there are no configurations specifically for TPP QWAC certificate validation or redirect URI matching.\\n\\nThe `SubscriptionWFHTTPRedirectTest.java`  demonstrates testing for HTTP redirects in subscription workflows, but this is a general redirect mechanism and not tied to TPP QWAC certificate validation.\\n\\n## Notes\\n\\nThe query specifically asks about eIDAS QWAC certificates and TPP-Redirect-URI/TPP-Nok-Redirect-URI validation. While the codebase contains references to certificates and redirect URIs, the context of these references does not align with the specific requirements of eIDAS QWAC certificate validation for TPP redirect URIs. The existing certificate handling appears to be for internal API endpoint security rather than external TPP compliance. Therefore, based on the provided snippets, this repository does not seem to implement the described functionality.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-u_256ee989-85b3-4987-91a6-1211b15a7386\\n', 'id': 'lc_d03ecede-081e-4c08-b4cb-ca6dc5c14272'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0154",
      "requirement": {
        "requirement_id": "ATOM_033",
        "requirement_text": "ASPSPs MAY tokenise card-account-id parameters such that actual card account or card numbers like IBANs or PANs are not part of the path definitions for data protection reasons",
        "strength": "MAY",
        "capability": "Security",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0154_1",
          "text": "## Assumptions\n- User's mobile number should be configured.\n- Users will receive the notification as web links to authenticate and authorize the consent.\n- For multiple users involved scenarios, Identity server will assume only one user is authenticated (ID Token will contain the details of only one user (Ex: Primary user) ) and the OB consent tables will contain the authentication status of other users. (This user's identity can be customised by extending and overriding `OBCibaResponseTypeHandler.issue()` method.)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0154_2",
          "text": "### Configuring a custom validator\n\n1. Once you implement the custom validator, build a JAR file for the project and place it in the \n`<IS_HOME>/repository/components/dropins` directory.\n\n2. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n\n3. Add the following tags and configure your validator using its Fully Qualified Name (FQN):\n    ``` toml\n    [[open_banking.identity.token_filter_validators]] \n    class = <CUSTOM_VALIDATOR_FQN>\n    ```\n4. Save the configurations and restart the Identity Server.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0154_3",
          "text": "# API Security Open Banking allows API consumers to access financial data through open APIs, which requires greater API security. Therefore, open banking standards provide guidelines for security implementations so that only the intended party can access information that the customer has given prior consent. To achieve this, different specifications mandate security requirements via the relevant specification, which is built upon existing standards defined in OAuth 2.0 and OpenID specifications. The diagram below provides a brief idea of how certain specifications are built upon these specifications. ![fapi_strcutre](../assets/img/learn/api-security/fapi-structure.png) While some open banking specifications, such as the Open Banking Standard - UK and Consumer Data Standards - Australia mandated FAPI, others do not. However, regardless of your regional specification, WSO2 Open Banking Accelerator provides FAPI security standards because of the robust security standards offered by FAPI. ###MTLS enforcement Authentication is a crucial requirement in open banking to verify the authenticity of an API consumer before sharing the customer\u2019s banking information. When an API consumer invokes APIs, their private credentials can be shared in the requests, and it leads to credential leakages and data thefts. Therefore, Mutual Transport Layer Security (MTLS) is introduced as an authentication protocol where the API consumers do not need to send their private credentials. MTLS handshake at the transport layer ensures that the corresponding API consumer possesses a secret key that is associated with the X509 certificate issued by a trusted Certificate Authority (CA). In WSO2 Open Banking Accelerator, MTLS is enforced at the API Manager level to check if - the message context contains the transport certificate to make sure that the MTLS handshake is successful at the gateway - the transport certificate bound to the application when invoking the APIs There are two scenarios to consider for the MTLS validation: 1. If the client directly initiates an MTLS connection with the WSO2 API Manager Gateway, the issuer of the certificate needs to be present in the truststore of the gateway. 2. If the MTLS terminates at the load balancer prior to the gateway, the WSO2 API Manager Gateway expects the load balancer to send the client certificate as a header. In such scenarios, the WSO2 API Manager gateway expects the load balancer to perform the issuer validation. ###Certificate Revocation Validation A certificate is issued by a trusted organization commonly known as a CA. It is also known as a Trust Service Provider (TSP). These certificates are expected to be in use for their entire validity period. However, certain circumstances may cause a certificate to become invalid prior to the expiration of the validity period. For example, a compromise or suspected compromise of the corresponding private key may cause a certificate to become invalid prior to the expiration. A revocation request can originate from the National Competent Authority (NCA), which has authorised or registered an API consumer. The TSP revokes the certificate based on a verifiable and authentic revocation request. There are circumstances where the issuing CA needs to revoke the certificate prior to the scheduled expiry date so that the certificate would no longer be trusted. Therefore, it",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0154_4",
          "text": "### Authorization Request\n\nWSO2 Open Banking Accelerator supports the following security features and fulfil FAPI requirements \nduring Authorization flows:\n\n  - OIDC Hybrid Flow\n    - Request object verification\n    - Pushed Authorization Request validation\n    - Pairwise Identifier support for ID tokens\n  - Authorization Code Flow\n    - When a request object is not available, support authentication mechanisms such as PKCE\n\nYou can use the provided extension points and customize the authorization flows. For more information, refer to the\n[Authorization Flow Customization](../develop/keyid-provider.md) topic in the Develop section.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0154_5",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not explicitly support the tokenization of card-account-id parameters in API paths to prevent exposure of sensitive card numbers like IBANs or PANs. The provided context primarily focuses on OAuth 2.0, OpenID Connect, SAML 2.0, and general identity management features, but lacks specific implementation details, configuration options, or API endpoints related to card account tokenization for data protection in API paths.\\n\\nThe \"Features and Capabilities\" wiki page mentions \"Financial-grade API (FAPI) Support\"  within the API Security section, which is relevant to financial services and data protection. However, the provided context does not elaborate on how FAPI support specifically addresses the tokenization of card-account-id parameters in API paths.\\n\\nThe `OAuth2PushedAuthRequestTestCase.java` file  demonstrates testing for Pushed Authorization Requests (PAR) with invalid client IDs and response types, which is a security feature for OAuth 2.0, but it does not directly relate to tokenizing card account IDs in API paths.\\n\\nThe various `identity.xml` configuration files        show configurations for OAuth2 token persistence, OpenID Connect, and scope validators, but none of these directly address the tokenization of sensitive card account identifiers in API paths.\\n\\nThe `constants_fapi.py` file  defines endpoints like `DCR_ENDPOINT` and `TOKEN_ENDPOINT`, and mentions FAPI conformance tests, which suggests an awareness of financial API security requirements. However, it does not provide details on how card account IDs are handled or tokenized within API paths.\\n\\nBased on the provided codebase context, there is no explicit support or mechanism described for tokenizing card-account-id parameters in API paths to protect sensitive card numbers like IBANs or PANs. While the system supports general API security and FAPI, the specific implementation for this requirement is not detailed.\\n\\n## Notes\\n\\nThe prompt asks about tokenizing `card-account-id` parameters in API paths. While the codebase mentions \"Financial-grade API (FAPI) Support\" , which is related to secure financial transactions, the provided snippets do not contain any specific code or configuration directly implementing or demonstrating the tokenization of card account identifiers within API paths. The existing API definitions, such as those for SCIM2 endpoints , do not show examples of tokenized identifiers in their paths. Therefore, without further information or specific code related to this functionality, it cannot be confirmed that this repository supports the requested feature.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_ad12ac49-e834-4c22-9a86-da034e3304da\\n', 'id': 'lc_5841b067-2e53-49ad-a79a-479f55d09067'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0154_6",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the tokenization of identifiers in API paths, specifically by using UUIDs for `apiId`, `applicationId`, and `documentId` parameters. This approach helps prevent the exposure of sensitive information like actual card numbers or IBANs in API path definitions.  \\n\\n### Implementation Details\\n\\nThe API definitions in `publisher-api.yaml` and `store-api.yaml` define parameters like `apiId`, `applicationId`, and `documentId` as strings that are expected to be UUIDs.   For instance, `apiId` is described as \"API ID consisting of the UUID of the API. Using the UUID in the API call is recommended.\"  Similarly, `applicationId` is defined as \"Application Identifier consisting of the UUID of the Application.\"  These parameters are marked as `in: path`, indicating they are part of the URL path. \\n\\nThe use of UUIDs as identifiers serves as a form of tokenization, as they are opaque and do not directly expose the underlying sensitive data. \\n\\n### Configuration Options\\n\\nThe `x-encoded: true` attribute for `apiId` parameters in both path and query string contexts suggests that these identifiers might undergo some form of encoding or tokenization.   While the exact mechanism of `x-encoded` is not detailed in the provided snippets, its presence implies a capability for handling encoded or tokenized values. \\n\\n### API Endpoints or Features\\n\\nSeveral API endpoints utilize these tokenized identifiers. For example, the `/apis/copy-api` endpoint uses `apiId` as a query parameter , and various individual API and application endpoints use `apiId` and `applicationId` as path parameters  . The `StarbucksOutletServiceImpl.java` file also shows an example of using an `id` parameter in path for operations like `lockOrder` and `removeOrder`  , although it doesn\\'t explicitly state that these `id`s are UUIDs or tokenized. However, the `payment` object in `doPayment` method contains `cardNumber` and `expiryDate` fields, which are sensitive data, but these are passed in the request body, not in the path .\\n\\n### Documentation References\\n\\nThe `README.md` for the store client provides documentation for API endpoints, listing methods that use `apiId` and `applicationId` in their paths, reinforcing the use of these identifiers. \\n\\n## Notes\\n\\nThe provided snippets strongly suggest that the system uses UUIDs as identifiers for various resources (`apiId`, `applicationId`, `documentId`) in API paths and queries.   This practice aligns with the requirement to tokenize card-account-id parameters to avoid exposing sensitive information. <cite/> The `x-encoded: true` attribute further supports the idea of tokenization or encoding of these identifiers.  While there isn\\'t explicit mention of \"card-account-id\" or \"IBANs/PANs\" being tokenized, the general approach of using UUIDs for critical identifiers in API paths demonstrates a design principle that supports data protection through tokenization. <cite/> The `StarbucksOutletServiceImpl.java` file, while dealing with payments, passes sensitive card information in the request body rather than the path, which is another good practice for data protection. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_62524790-da0f-458d-92e0-fd66a77d2d47\\n', 'id': 'lc_59e04c5f-e9e1-455f-bea4-ccec54dd0051'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0155",
      "requirement": {
        "requirement_id": "ATOM_005",
        "requirement_text": "ASPSP may require TPP to sign request messages at application layer",
        "strength": "MAY",
        "capability": "Security",
        "section_id": "eef9ab97432c - 4.2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0155_1",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_2",
          "text": "# allowed_auth_url_parameters parameter is used to filter the Auth WebLink URL parameters.\nallowed_auth_url_parameters = [\"client_id\", \"scope\", \"response_type\", \"nonce\", \"redirect_uri\", \"binding_message\"]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_3",
          "text": "## Assumptions\n- User's mobile number should be configured.\n- Users will receive the notification as web links to authenticate and authorize the consent.\n- For multiple users involved scenarios, Identity server will assume only one user is authenticated (ID Token will contain the details of only one user (Ex: Primary user) ) and the OB consent tables will contain the authentication status of other users. (This user's identity can be customised by extending and overriding `OBCibaResponseTypeHandler.issue()` method.)",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_4",
          "text": "## DefaultTokenFilter \n\nCustomize the following class to modify the token request, response, or error handling. \n``` java\ncom.wso2.openbanking.accelerator.identity.token.DefaultTokenFilter\n```\n\n!!! note \n    \n    If the WSO2 Identity Server is fronted by a load-balancer, a mutual TLS handshake needs to be ensured. Since a \n    certificate cannot be passed through the request header with the default configuration, disable the default \n    functionality as follows:\n    \n    1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n    2. Set the following configuration to `false`. By default, this is set to `true`. \n    \n    ``` toml\n    [open_banking.identity]\n    client_transport_cert_as_header_enabled=false\n    ```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_5",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the optional enforcement of application layer message signing for OAuth 2.0/OpenID Connect request objects. This functionality allows an ASPSP (Account Servicing Payment Service Provider) to require a TPP (Third Party Provider) to sign request messages and reject unsigned messages if configured to do so.  \\n\\n## Implementation Details\\n\\nThe core implementation for enforcing request object signature validation is demonstrated in the `OAuth2RequestObjectSignatureValidationTestCase.java` integration test case.  This test case verifies the ability to enable and disable the validation of signed request objects. \\n\\nThe process involves:\\n1.  **Generating Service Provider Keys**: The `testGenerateServiceProviderKeys()` method initializes RSA private keys and X.509 public certificates for the service provider.  These keys are crucial for signing and verifying request objects. \\n2.  **Registering an OAuth2 Application**: An OAuth2 application is registered, and its `consumerKey` and `consumerSecret` are obtained. \\n3.  **Updating Service Provider Certificate**: The public certificate of the service provider is updated, which is used by the Identity Server to validate signed request objects. \\n4.  **Enforcing Request Object Signature Validation**: The `testEnforceRequestObjectSignatureValidation()` method sets the `validateRequestObjectSignature` property to `true` within the application\\'s OIDC inbound configuration.  This configuration is then updated for the application. \\n\\n## Configuration Options\\n\\nThe primary configuration option for enforcing application layer message signing is `validateRequestObjectSignature`.  This boolean flag, when set to `true`, instructs the Identity Server to validate the signature of incoming request objects. \\n\\nOther related configuration options, as seen in test resources, include:\\n*   `requestObjectSigningAlg`: Specifies the signing algorithm for the request object (e.g., \"PS256\"). \\n*   `encryption.algorithm` and `encryption.method`: These are for request object encryption, which can be used in conjunction with signing.  \\n\\n## API Endpoints or Features\\n\\nThe functionality is exposed through the application management REST API. Specifically, the OIDC inbound configuration of an application can be updated to enforce request object signature validation. \\n\\nThe `updateApplicationInboundConfig()` method is used to modify the OIDC configuration of an application, including the `validateRequestObjectSignature` property.  The `getOIDCInboundDetailsOfApplication()` method can retrieve the current OIDC configuration. \\n\\nThe `ApplicationManagementOAuthSuccessTest.java` test further illustrates how these configurations are managed via REST API calls, specifically for `requestObject.requestObjectSigningAlg`. \\n\\n## Documentation References\\n\\nThe \"Features and Capabilities\" wiki page mentions \"OAuth 2.0\" and \"OpenID Connect\" as core authentication protocols, and \"Advanced OAuth Features\" include \"Pushed Authorization Requests (PAR)\" and \"Rich Authorization Requests\".   While not explicitly mentioning \"request object signature validation,\" this feature is a security enhancement often associated with these advanced OAuth/OIDC flows, particularly in financial-grade APIs (FAPI). The wiki also mentions \"Financial-grade API (FAPI) Support\" under API Security. \\n\\n## Test Criteria\\n\\nThe `OAuth2RequestObjectSignatureValidationTestCase.java` provides a clear example of how to verify this functionality. \\n\\nThe test `testEnforceRequestObjectSignatureValidation()` enables the `validateRequestObjectSignature` flag.  A subsequent test would typically attempt to send an unsigned request object and assert that it is rejected, and then send a properly signed request object and assert that it is accepted. The `sendAuthorizationGrantRequestWithPlainJWTRequestObject()` method demonstrates sending an unsigned request object, which is expected to be rejected if validation is enforced. \\n\\n## Notes\\n\\nThe provided snippets primarily focus on the WSO2 Identity Server\\'s capabilities related to OAuth 2.0 and OpenID Connect, particularly around request object handling and signature validation.  The term \"ASPSP\" and \"TPP\" are not directly found in the code, but the functionality described (enforcing signed request messages at the application layer) is a common requirement in financial-grade APIs (FAPI) which ASPSPs often implement.  The `oidc-fapi-conformance-tests/constants_fapi.py` file further indicates support for FAPI related configurations. \\n\\nOther snippets related to SAML signing (`SAML2.EnableRequestSigning` in `travelocity.properties`   and `doValidateSignatureInRequests` in `TestServer.xml` ) and Passive STS (`enableRequestSigning` in `ConfigSuccessTest.java` ) are for different protocols and, while related to message signing, are not directly applicable to the user\\'s query about application layer message signing for ASPSP/TPP interactions, which typically refers to OAuth/OIDC request objects.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_5c6b7d57-43ad-4236-9fea-b25880d21344\\n', 'id': 'lc_34049d8a-aa6b-4c4e-8863-304ca2649335'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0155_6",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports application layer message signing through WS-Security policies.  This functionality allows for the signing and encryption of messages exchanged with proxy services. \\n\\n## Implementation Details\\n\\nThe implementation relies on WS-Security with policy attachments for proxy services.  The core mechanism involves defining a security policy, such as `sec_policy`, which specifies the security requirements for messages.  This policy is then attached to a proxy service using the `<policy>` and `<enableSec/>` elements within the Synapse configuration. \\n\\nWhen a security policy is engaged, the Apache Rampart module is responsible for enforcing the specified security requirements.  If an incoming request message does not conform to the policy (e.g., it\\'s not signed when signing is required), Rampart will reject it before it reaches the `inSequence` for processing. \\n\\nThe security policies can specify various aspects, including:\\n*   **Signed Parts**: The `<sp:SignedParts>` element indicates which parts of the message, such as the `<sp:Body/>`, must be signed. \\n*   **Algorithm Suite**: The `<sp:AlgorithmSuite>` defines the cryptographic algorithms to be used for signing and encryption. \\n*   **Layout**: The `<sp:Layout>` element specifies the order of security headers. \\n*   **Timestamp Inclusion**: The `<sp:IncludeTimestamp/>` element indicates whether a timestamp should be included in the security header. \\n*   **Entire Headers and Body Signing**: The `<sp:OnlySignEntireHeadersAndBody/>` element ensures that the entire headers and body are signed. \\n\\nFor example, `scenario2-policy.xml` demonstrates a policy for signature-only security using asymmetric binding.   This policy requires the body of the message to be signed. \\n\\n## Configuration Options\\n\\nConfiguration involves defining WS-Security policies in XML files.  These policy files are then referenced as `localEntry` within the Synapse configuration. \\n\\nAn example of a policy definition is found in `qos_proxy_samples.xml`, where `sec_policy` is loaded from `file:repository/samples/resources/policy/policy_3.xml`.  The policy is applied to a proxy service named `StockQuoteProxy`. \\n\\nVarious sample policy files demonstrate different security scenarios, such as:\\n*   `scenario2-policy.xml`: Signature only. \\n*   `scenario5-policy.xml`: Signature and encryption. \\n*   `scenario9-policy.xml`: Secure conversation with signature only. \\n\\nThese policy files use XML elements from the `http://schemas.xmlsoap.org/ws/2005/07/securitypolicy` namespace to define security requirements. \\n\\n## API Endpoints or Features\\n\\nThe primary feature enabling application layer message signing is the integration of WS-Security policies with proxy services within the WSO2 API Manager.  The `enableSec` element in the proxy service configuration is crucial for activating WS-Security. \\n\\nThe system can be configured to remove the `wsse:Security` header from outgoing messages if the backend service does not require WS-Security, ensuring compatibility. \\n\\n## Documentation References\\n\\nThe `qos_proxy_samples.xml` file serves as a documentation reference, providing a sample configuration and explanation for using WS-Security with policy attachments.  It details the objective, prerequisites, and steps to execute a client that sends signed and encrypted messages. \\n\\nThe documentation also refers to Apache Rampart and Axis2 documentation for details on the policy file format. \\n\\n## Notes\\n\\nThe provided snippets primarily focus on WS-Security for SOAP-based services, as indicated by the use of `wsse:Security` headers and WS-Policy.   While the prompt mentions \"application layer message signing,\" which can be a broader concept, the codebase context strongly suggests that the supported mechanism here is specifically WS-Security for SOAP messages. \\n\\nThe various `scenarioXX-policy.xml` files in `all-in-one-apim/modules/integration/tests-integration/tests-backend/src/test/resources/security/policies/` further illustrate different WS-Security policy configurations for testing purposes.   These files were added by Abimaran Kugathasan on [2015-01-29](https://github.com/wso2/product-apim/commit/897dfc4c). \\n\\nThe `qos_mediation_samples.xml` and `store_n_forward_samples.xml` files discuss message mediation, reliable messaging, and store-and-forward patterns, which are related to quality of service but do not directly address application layer message signing.  \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_5198f29c-fdcd-46de-a684-fdba97649356\\n', 'id': 'lc_f0933083-055a-486d-a274-58cb70fcba3c'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0156",
      "requirement": {
        "requirement_id": "ATOM_030",
        "requirement_text": "All methods submitted by a TPP that address dynamically created resources in this API MAY only apply to resources which have been created by the same TPP before.",
        "strength": "MAY",
        "capability": "Security",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0156_1",
          "text": "### Resource Request\n\nAfter an API consumer application obtains an access token, it is used to invoke a resource endpoint. In this request, \nthe following validations will be performed:\n\n- Token validity verification\n- Token type verification (User Access Token/Application Access Token)\n- Scopes/roles validation\n- Token-bound certificate validation\n- Consent validation\n\nThe resource requests go through token-bound certificate validations according to\n[rfc8705](https://datatracker.ietf.org/doc/html/rfc8705)\nThe MTLS token binding happens once a token is issued to a particular client. This ensures that at the resource endpoint,\nthe provided MTLS certificate can be validated against the certificate bound to the token. Self-contained tokens are\nused for this purpose and are bound to the tokens via a claim named `cnf`. For more information,\nsee [Token Authentication](token-authentication.md#certificate-bound-access-tokens).\n\nConsent validation ensures that the API consumer application's resource requests adhere to the consent provided \nby the bank customers. This is a custom implementation as the behaviour of consent is defined by an open banking \nspecification. You can use the [Consent Validate](../develop/consent-management-validate.md) endpoint and define the \nconsent validations by comparing the resource requests against the user-provided consent.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_2",
          "text": "## Configure applications\n\nThe conformance suite has to run from the perspective of 2 clients. Therefore, two applications are required. Follow the\nsteps and create applications:\n\n1. Create 2 applications using [Dynamic Client Registration](../learn/dynamic-client-registration-try-out.md) under\n   the same API Consumer/Third Party Provider (TPP).\n\n    !!! note\n        For the application certificate, use the client certificates (public key) signed by the root CA/Issuer \n        CA (prior acquired or generated). For example, `tpp.com.crt`.\n\n2. Generate production keys and take note of the consumer key and secret.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_3",
          "text": "### How to use mediation artifacts \n\n1. Once the maven build is successful, navigate to the **fs-apim-mediation-artifacts/target** folder to get the zip file containing all the mediation policies,custom sequences and class mediators & handlers to copy in to WSO2 API Manager.\n\n2. Extract the zip 'fs-apim-mediation-artifacts-1.0.0.zip' and you will notice the following folder structure.\n    - Policy .j2 files - The mediation policy files which need to upload in API Publisher UI and engage to APIs. Below mediation policies are available in this repository.\n    - Custom sequences- Synapse based custom sequence files which need to copy in to `<APIM_Home>/repository/deployment/synapse-cofngis/default/sequences` folder.\n    - lib - This folder contains the jars need to copy in to `<APIM_Home>/repository/lib` folder. It contains jars of the class mediator implementations refer from the policies and custom synapse handler implementations.\n        \n3. Restart the API Manager Server.\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require JWS request header processing. Find the details to create the policy below.",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_4",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, supports the requirement that Third-Party Providers (TPPs) can only access and modify resources they created, specifically for dynamically created OAuth applications. This is primarily enforced through tenant isolation and API resource management with associated permissions.\\n\\n### Implementation Details\\n\\nThe WSO2 Identity Server\\'s architecture includes a modular design with core identity services and an API layer . The system uses a multi-tenant architecture, which inherently provides isolation between different organizations or tenants . This means that resources created within one tenant are generally not accessible or modifiable by another tenant.\\n\\nSpecifically for OAuth applications, the `OAuthAppsWithSameClientIdTestCase.java` integration test demonstrates this isolation. It shows that when two OAuth applications are created with the same client ID in different tenants, they are treated as distinct entities . The test verifies that updating inbound configurations for an application in one tenant does not affect an application with the same client ID in another tenant . Similarly, deleting an application or its inbound configurations in one tenant does not impact the other tenant\\'s application  .\\n\\nThe `testOAuthApplicationLoginIncorrectTenant` test further confirms that a user from one tenant cannot authenticate against an application created in another tenant, even if the client ID is the same . This indicates strong access control enforcement based on tenant ownership.\\n\\n### Configuration Options\\n\\nResource access control is defined in configuration files like `default-identity.xml`  and `saml-assertion-query-enabled-identity.xml` . These files use `<ResourceAccessControl>` elements to define permissions required for specific API endpoints and HTTP methods .\\n\\nFor dynamically created resources, such as OAuth applications, the Dynamic Client Registration (DCR) endpoints are secured with permissions like `/permission/admin/manage/identity/applicationmgt/create`, `/permission/admin/manage/identity/applicationmgt/delete`, `/permission/admin/manage/identity/applicationmgt/update`, and `/permission/admin/manage/identity/applicationmgt/view` . These permissions ensure that only authorized entities (TPPs with the necessary roles) can perform operations on applications. The system also uses `<TenantContextsToRewrite>` to handle tenant-aware URLs for various APIs, including DCR endpoints .\\n\\n### API Endpoints or Features\\n\\nThe relevant API endpoints for managing dynamically created OAuth applications are part of the Dynamic Client Registration (DCR) API. These include:\\n*   `/(.*)/api/identity/oauth2/dcr/v1.1/register(.*)` for POST (create), DELETE, PUT (update), and GET (view) operations .\\n*   A more general endpoint `/(.*)/api/identity/oauth2/dcr/(.*)` also exists, secured with the broader `/permission/admin/manage/identity/applicationmgt` permission .\\n\\nThese endpoints are used by TPPs to register and manage their OAuth applications. The underlying implementation ensures that operations performed through these APIs are scoped to the tenant of the TPP making the request.\\n\\n### Documentation References\\n\\nThe \"Overview\" wiki page mentions that WSO2 Identity Server supports OAuth 2.0/OpenID Connect and provides capabilities for role-based authorization and fine-grained authorization with XACML . It also highlights the \"API Layer\" which provides REST APIs for both administrative and end-user operations . The \"Organization Management\" feature further emphasizes the multi-tenant architecture and isolation between organizations, which is key to enforcing resource ownership for TPPs .\\n\\n## Notes\\n\\nThe provided context strongly suggests that WSO2 Identity Server enforces resource ownership for dynamically created resources, particularly OAuth applications, through its multi-tenancy and API authorization mechanisms. The integration tests explicitly validate that operations on OAuth applications are isolated per tenant, preventing one tenant (or TPP) from affecting resources created by another. The configuration files show how permissions are mapped to API endpoints to control access.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-is)](/wiki/wso2/product-is#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_4d20f4f5-8e36-4c9c-9818-23c7d262344e\\n', 'id': 'lc_18d3d68d-1e8d-42cf-8ee1-104c076246a4'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0156_5",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, WSO2 API Manager, supports the concept of a Third-Party Provider (TPP) only being able to access and modify resources they created, primarily through its multi-tenancy and role-based access control features. The system enforces this by restricting API visibility, application policy usage, and subscription creation across different tenants and user roles.\\n\\n## Implementation Details\\n\\nWSO2 API Manager (WSO2 API-M) is an open-source, full lifecycle API management platform that includes components for securing and controlling APIs  . The platform\\'s architecture supports modularity and independent components, which is crucial for enforcing access control in multi-tenant environments .\\n\\nThe core of this functionality is demonstrated through:\\n\\n*   **Tenant Isolation**: The system ensures that resources created within one tenant are not directly accessible or modifiable by users or applications from another tenant, unless explicitly made public or shared . For example, `CrossTenantSubscriptionTestCase.java` includes tests that verify the visibility of APIs and application policies across different tenants . Specifically, `testDirectAPIAvailability` and `testDirectAPIAvailability2` assert that an API created in one tenant is visible to another tenant, which implies that visibility can be controlled . However, `testApplicationPolicyAvailabilityInTenant2` and `testApplicationPolicyAvailabilityInTenant1` show that application policies are tenant-specific and not visible across tenants .\\n\\n*   **Role-Based Access Control (RBAC)**: WSO2 API Manager uses roles and permissions to control what actions users can perform and what resources they can access . The `APICreationForTenantsTestCase.java` demonstrates how permissions are assigned to roles, such as `API_CREATOR`, to restrict API creation capabilities  . The test `testScope` verifies that a user with restricted permissions cannot create an API .\\n\\n*   **Restricted API Visibility**: APIs can be configured with restricted access control, meaning only users belonging to specific roles can view and interact with them . The `PublisherAccessControlTestCase.java` shows how an API can be made visible only to `FIRST_ROLE` and not to `SUBSCRIBER_USER` if they are not in the allowed roles . Similarly, `ContentSearchTestCase.java` illustrates that content search results respect access control settings, preventing users without the necessary roles from finding restricted APIs  .\\n\\n*   **Throttling Policy Ownership**: Throttling policies, which control API usage, are also subject to ownership and access restrictions. The `AdvancedThrottlingPolicyTestCase.java` demonstrates that an admin user cannot delete an advanced throttling policy created by a different admin user if it\\'s assigned to a resource . This indicates that resources, including policies, are tied to their creators or specific administrative domains.\\n\\n## Configuration Options\\n\\nThe `resource.access_control` section in `default.json` defines access control rules for various API endpoints . These configurations specify whether an endpoint is secure, the allowed HTTP methods, required permissions, and scopes. For instance, the `/keymanager-operations/dcr/register` endpoint, used for dynamic client registration, requires `internal_application_mgt_create` scope and `/permission/admin/manage/identity/applicationmgt/create` permission . This implies that only TPPs with the necessary permissions can register applications, which are then associated with that TPP.\\n\\n## API Endpoints or Features\\n\\nThe WSO2 API Manager provides features for:\\n\\n*   **API Publishing and Governance**: APIs can be published to external consumers and partners, with capabilities to manage API versions, deployment status, and lifecycle . This includes provisioning and managing API keys and tracking consumers per API .\\n*   **Developer Portal**: The Developer Portal allows developers to discover and subscribe to APIs, with self-registration and role-based access to manage public and private APIs . Subscriptions can be managed on a per-application basis .\\n*   **Security Enforcement**: The platform relies on the OAuth2 standard for API access, allowing restriction of API access tokens to domains/IPs and blocking subscriptions or entire applications .\\n\\n## Documentation References\\n\\nThe `Overview` wiki page provides a high-level technical overview of the WSO2 API Manager codebase organization, core components, and architecture . It details the API Control Plane, Gateway, and Traffic Manager components, which collectively manage API lifecycle, security, and traffic . The `README.md` also outlines key features such as designing and prototyping APIs, creating a Developer Portal, publishing and governing API use, and controlling access and enforcing security .\\n\\n## Test Criteria Verification\\n\\nThe integration tests within the `wso2/product-apim` repository directly verify that TPPs (represented by different tenants or users with specific roles) can only access and modify resources they created.\\n\\n*   **Cross-Tenant Resource Access**: `CrossTenantSubscriptionTestCase.java` explicitly tests scenarios where tenants attempt to access or modify resources (APIs, application policies, subscription policies) created by other tenants . For instance, `testCreateApplicationInTenant1FromTenant2UserNegative` and `testCreateApplicationInTenant2FromTenant1UserNegative` assert that an application cannot be created using an application policy from another tenant, resulting in a `400` HTTP status code (Bad Request) . Similarly, attempts to subscribe to an API with a restricted policy from another tenant result in a `403` HTTP status code (Forbidden)  .\\n\\n*   **Role-Based Permissions**: `APICreationForTenantsTestCase.java` confirms that users without the `api/create` permission cannot create APIs, even within their own tenant . This demonstrates fine-grained control over resource creation based on assigned roles.\\n\\n*   **API Visibility by Domain**: `APIVisibilityByDomainTestCase.java` tests ensure that APIs with private visibility are not accessible to users in other domains (tenants), reinforcing the isolation of resources  .\\n\\n## Notes\\n\\nThe term \"TPP\" (Third-Party Provider) is not explicitly used as a code identifier in the provided snippets. However, the concepts of \"tenants\" and \"users with specific roles\" are directly analogous to TPPs in the context of resource ownership and access control. The WSO2 API Manager\\'s multi-tenancy and RBAC features are designed to enforce the principle that entities (like TPPs) can only manage resources they have created or have been explicitly granted access to. The integration tests provided serve as concrete examples of this enforcement.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/product-apim)](/wiki/wso2/product-apim#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_c7ac2fc0-e1c2-46d5-87ea-7f43f02181c2\\n', 'id': 'lc_2e7af492-29a2-4782-b9f2-c9d2cbb40edb'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0157",
      "requirement": {
        "requirement_id": "ATOM_049",
        "requirement_text": "Error responses may include additional error details limited to 500 characters",
        "strength": "MAY",
        "capability": "Error Handling",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0157_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, includes mechanisms for validating error responses, but it does not explicitly enforce a 500-character limit on the `detail` field within error responses. The codebase defines a standard error response structure that includes `code`, `message`, and `description` fields, and for SCIM2 APIs, a `detail` field. However, there are no direct implementation details or configuration options found in the provided snippets that would limit the character count of the `detail` field to 500 characters.\\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository uses a consistent structure for error responses in its REST APIs. The `RESTTestBase.java` class contains methods for validating error responses, which expect a JSON format including `code`, `message`, `description`, and optionally `traceId` . Specifically, the `validateErrorResponse` method checks for the presence and content of these fields . The `validateErrorDescription` method, which is called by `validateErrorResponse`, uses `validateElementAgainstErrorProperties` to compare the response's `description` field against predefined error properties .\\n\\nFor SCIM2 APIs, the `scim2.yaml` OpenAPI definition specifies error response objects like `ErrorIvalidInput`, `ErrorUserNotAvailable`, and `ErrorInternalServerError`, which all include a `detail` field   . These definitions indicate that the `detail` field is of `type: string` , but they do not specify any length constraints for this string.\\n\\nThe `validateElementAgainstErrorProperties` method in `RESTTestBase.java` retrieves expected error messages and descriptions from a properties file and formats them . This method is used by `B2BRESTTestBase.java` for validating error messages . While this mechanism ensures consistency in error messages, it does not inherently enforce a character limit on the `detail` field.\\n\\n### Configuration Options\\n\\nBased on the provided code snippets, there are no explicit configuration options to set a character limit for the `detail` field in error responses. The error messages and descriptions are retrieved from properties files , but the content of these properties is not shown to have length restrictions.\\n\\n### API Endpoints or Features\\n\\nThe API endpoints, particularly those defined in `scim2.yaml`, include error responses with a `detail` field . For example, the `/Users` endpoint for `PUT` operations can return a `404` error with a `detail` field . Similarly, the `/Users/.search` endpoint can return a `404` error with a `detail` field . However, the OpenAPI definitions do not specify any character limits for these `detail` fields.\\n\\n### Documentation References\\n\\nThe provided wiki pages and code comments describe the general structure and validation of error responses. For instance, the `Organization Management` wiki page mentions API authentication and core endpoints, but does not delve into the specifics of error response content limits . The `Features and Capabilities` wiki page also discusses various features but does not provide details on error response character limits .\\n\\nThe `RESTTestBase.java` class comments describe the desired format of error responses , but these comments do not mention any character limits for the `description` or `detail` fields.\\n\\n## Notes\\n\\nThe provided code snippets primarily focus on the structure and validation of error responses, ensuring that expected fields like `code`, `message`, and `description` (or `detail` for SCIM2) are present and match predefined values. While the `detail` field is part of the error response schema for SCIM2 APIs, there is no explicit code or configuration shown that would enforce a 500-character limit on its content. The validation methods check for the presence and content of these fields but do not perform length checks. Therefore, based on the provided context, the repository does not appear to support the specific requirement of limiting the `detail` field to 500 characters.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n- [Organization Management (wso2/product-is)](/wiki/wso2/product-is#3.4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_cc07a7a3-1e8d-432a-9d54-e0b167268c1b\\n\", 'id': 'lc_08ba0408-c850-4d2d-beef-441bc0d1d689'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0157_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository defines an `Error` object in its OpenAPI specifications that includes a `description` field for detailed error messages. While the schema defines this field, there is no explicit character limit of 500 characters enforced within the provided OpenAPI definitions or the generated Java DTOs for the `description` field itself. However, a `maxLength` of 512 is specified for the `content` field of a `Comment` object, which is a separate entity from the general `Error` object. \\n\\n### Implementation Details\\n\\nThe `Error` object is consistently defined across various OpenAPI specification files within the `wso2/product-apim` repository.    This object includes a `description` field of type `string` intended for a detailed explanation of the error message. \\n\\nFor example, in `all-in-one-apim/sample-scenarios/clients/store/src/main/resources/store-api.yaml`, the `Error` definition includes:\\n```yaml\\n  Error:\\n    title: Error object returned with 4XX HTTP status\\n    required:\\n      - code\\n      - message\\n    properties:\\n      code:\\n        type: integer\\n        format: int64\\n      message:\\n        type: string\\n        description: Error message.\\n      description:\\n        type: string\\n        description: |\\n          A detail description about the error message.\\n      moreInfo:\\n        type: string\\n        description: |\\n          Preferably an url with more details about the error.\\n      error:\\n        type: array\\n        description: |\\n          If there are more than one error list them out.\\n          For example, list out validation errors by each field.\\n        items:\\n          $ref: \\'#/definitions/ErrorListItem\\'\\n``` \\nThe `description` field is consistently described as \"A detail description about the error message.\" \\n\\nGenerated Java DTOs, such as `ErrorDTO.java`, also reflect this structure, with a `description` property of type `String`. \\n\\n### Configuration Options\\n\\nThe OpenAPI specifications do not explicitly define a `maxLength` constraint of 500 characters for the `description` field within the `Error` object.   \\n\\nHowever, a `maxLength` of 512 is defined for the `content` field of a `Comment` object in `all-in-one-apim/modules/integration/tests-common/clients/store/api/openapi.yaml`.  This indicates that character limits can be specified in the OpenAPI definitions, but it is not applied to the general `Error` object\\'s `description` field.\\n\\n### API Endpoints or Features\\n\\nError responses are returned across various API endpoints, as seen in the `openapi.yaml` files for different clients (e.g., `service-catalog`, `store`, `admin`, `publisher`).    These responses typically include `code`, `message`, `description`, and `moreInfo` fields, and sometimes a list of `error` items. \\n\\nFor example, a 500 Internal Server Error response in `service-catalog-api.yaml` includes a `description` field:\\n```yaml\\n        \"500\":\\n          content:\\n            application/json:\\n              example:\\n                code: 500\\n                message: Internal Server Error\\n                description: The server encountered an internal error. Please contact\\n                  administrator.\\n                moreInfo: \"\"\\n                error: []\\n              schema:\\n                $ref: \\'#/components/schemas/Error\\'\\n          description: Internal Server Error.\\n``` \\n\\n### Documentation References\\n\\nThe OpenAPI specification files themselves serve as documentation for the structure of error responses. The `description` field within the `Error` schema is consistently documented as providing \"A detail description about the error message.\" \\n\\n## Notes\\n\\nThe prompt specifically asks about a 500-character limit for the `detail` field in error responses. Based on the provided code snippets, the `Error` object has a `description` field, which seems to correspond to \"additional error details\". However, there is no explicit `maxLength` constraint set to 500 characters for this `description` field in any of the `Error` schema definitions. A `maxLength` of 512 characters is found for the `content` field of a `Comment` object, which is a different entity and not directly related to the general error response `description`. Therefore, based on the provided context, there is no direct support for limiting the `description` field of error responses to 500 characters.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_b16590de-9c77-4903-9605-19b165acdde7\\n', 'id': 'lc_6fafdfb2-1fa3-4bb7-b70d-010d290743cf'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0158",
      "requirement": {
        "requirement_id": "ATOM_090",
        "requirement_text": "ASPSP should inform TPP to notify PSU about decoupled authentication requirement via PSU Message",
        "strength": "SHOULD",
        "capability": "Event Notification",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Event Notification",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0158_1",
          "text": "#Real Time Event Notification\n\nReal Time Event Notification is a method where banks will immediately notify the TPP about any events that occur, without waiting for a request from the TPP. This functionality ensures that TPPs stay informed about relevant events in real-time, enhancing their ability to effectively manage and utilize the consents.\n\nTo avail themselves of real time event notifications, TPPs are required to provide a callback URL during the subscription process for event notifications. Once the bank activates the Real time Event Notification feature, any relevant events pertaining to the TPP's consent resources trigger an HTTP POST request, which is subsequently sent to the callback URL specified by the TPP. Consequently, the TPP must establish a listening mechanism at the provided URL to capture and process these notifications effectively. \n\nYou can customize the Real Time Event Notification Flow according to your requirements. For more information, see [Customizing Event Notification](../develop/custom-event-notification.md).\n\nIn order to enable Real Time Event Notification, TPPs must subscribe to receive event notifications using Event Subscription feature. TPPs must provide a callback URl which they have established to receive the event notifications. To create an Event Notification Subscription use the below request. \n\n```tab=\"Request\"\ncurl --location 'https://localhost:9446/api/fs/event-notifications/subscription/' \\\n--header 'Authorization: Basic YWRtaW5Ad3NvMi5jb206d3NvMjEyMw==' \\\n--header 'x-wso2-client_id: L5Ao9g7ZgzBifPSDKyr8vDZlllca' \\\n--header 'Content-Type: application/json' \\\n--data '{\n        \"callbackUrl\": \"https://tpp.com/open-banking/v3.1/event-notifications\",\n        \"eventTypes\":[\n            \"urn_uk_org_openbanking_events_resource-update\",\n            \"urn_uk_org_openbanking_events_consent-authorization-revoked\",\n            \"urn:ietf:params:scim:event:create\"\n        ],\n        \"version\": \"3.1\"\n}'\n```\n\n```json tab=\"Response\"\n{\n        \"callbackUrl\": \"https://tpp.com/open-banking/v3.1/event-notifications\",\n        \"subscriptionId\": \"77654c28-3c0f-4406-8ff3-7aa04efcbd33\",\n        \"eventTypes\": [\n            \"urn_uk_org_openbanking_events_resource-update\",\n            \"urn_uk_org_openbanking_events_consent-authorization-revoked\",\n            \"urn:ietf:params:scim:event:create\"\n        ],\n        \"version\": \"3.1\"\n}\n```\n\nTo verify whther Real Time EVent Notification is working for the given callback URL, send an event with subscribed event types. A sample Event Creation request and response are as follows:\n\n   ```\n    curl --location --request POST 'https://localhost:9446/api/fs/event-notifications/create-events' \\\n    --header 'Authorization: Basic YWRtaW5Ad3NvMi5jb206d3NvMjEyMw==' \\\n    --header 'x-wso2-client_id: cli342efefvsgdsfv' \\\n    --header 'x-wso2-resource_id: vfjskenfksdnvfkkfdfd' \\\n    --header 'Content-Type: application/x-www-form-urlencoded' \\\n    --data-urlencode 'request=ewogICAidXJuX3VrX29yZ19vcGVuYmFua2luZ19ldmVudHNfcmVzb3VyY2UtdXBkYXRlIjp7CiAgICAgICJrZXkxIjoidmFsdWUiLAogICAgICAia2V5MiI6InZhbHVlIiwKICAgICAgImtleTMiOiJ2YWx1ZSIKICAgfSwKICAgInVybl91a19vcmdfb3BlbmJhbmtpbmdfZXZlbnRzX2NvbnNlbnQtYXV0aG9yaXphdGlvbi1yZXZva2VkIjp7CiAgICAgICJrZXkxIjoidmFsdWUiLAogICAgICAia2V5MiI6InZhbHVlIiwKICAgICAgImtleTMiOiJ2YWx1ZSIKICAgfQp9'\n   ```\n   \nGiven below is the decoded format of a sample request payload:\n\n``` \n{\n   \"urn_uk_org_openbanking_events_resource-update\":{\n      \"resourceID\":\"vfjskenfksdnvfkkfdfd'\",\n      \"ref\":\"https://scim.example.com/Users/44f6142df96bd6ab61e7521d9\"\n   },\n   \"urn_uk_org_openbanking_events_consent-authorization-revoked\":{\n      \"ref\":\"https://scim.example.com/Users/44f6142df96bd6ab61e7521d9\",\n      \"attributes\":[\n         \"id\",\n         \"name\",\n         \"userName\",\n         \"password\",\n         \"emails\"\n      ]\n   },\n   \"urn:ietf:params:scim:event:create\":{\n      \"ref\":\"https://scim.example.com/Users/44f6142df96bd6ab61e7521d9\",\n      \"attributes\":[\n         \"id\",\n         \"name\",\n         \"userName\",\n         \"password\",\n         \"emails\"\n      ],\n      \"resourceID\":\"9046c276-100f-40ed-b123-2d9f2bcb3e8e\"\n   }\n}\n```",
          "capability": "Event Notification",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0158_2",
          "text": "### Data \nThe following table explains the data available in `NotificationCreationDTO`.\n\n| Name      | Type                  | Description  |\n| ----------|-----------------------| -------------|\n| clientId      | String            | The client ID of the application that made the request. This application is bound to the request from the gateway insequence based on the token used. |\n| resourceId    | String    | Unique identifier of the consent resource related to the event. |\n| events      | Map<String, JSONObject>   | Map of events to be persisted. |",
          "capability": "Event Notification",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0158_3",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, WSO2 Identity Server, appears to have capabilities related to sending notifications, but there is no direct evidence within the provided snippets to confirm explicit support for an ASPSP informing a TPP to notify a PSU about a decoupled authentication requirement via a \"PSU Message\" as described in the prompt. The system supports various notification mechanisms, including email and SMS templates, and a push notification framework. \\n\\n### Implementation Details and API Endpoints\\n\\nThe WSO2 Identity Server includes a notification push framework, indicated by dependencies such as `org.wso2.carbon.identity.notification.push.provider`, `org.wso2.carbon.identity.notification.push.common`, `org.wso2.carbon.identity.notification.push.device.handler`, and `org.wso2.carbon.identity.notification.push.feature` . Additionally, there are local authentication push-related components like `org.wso2.carbon.identity.local.auth.push.authenticator`, `org.wso2.carbon.identity.local.auth.push.servlet`, and `org.wso2.carbon.identity.local.auth.push.feature` . These suggest the presence of a system capable of sending push notifications and handling local authentication flows that might involve such notifications.\\n\\nThe system also provides REST API endpoints for managing notification templates, specifically for email and SMS. The `Constants.java` file defines `EMAIL_TEMPLATES_PATH` and `SMS_TEMPLATES_PATH` as `/notification/email` and `/notification/sms` respectively, under the base path `/api/server/v1` . These APIs allow for the management of notification templates, including operations like adding and resetting template types .\\n\\nWhile the system supports various notification types, there is no explicit mention of a \"PSU Message\" or a specific mechanism for an ASPSP to instruct a TPP to notify a PSU about decoupled authentication within the provided code snippets. The existing notification framework could potentially be extended or configured to support such a requirement, but this would likely involve custom implementation. <cite />\\n\\n### Configuration Options\\n\\nConfiguration related to notifications can be inferred from the `pom.xml` file, which lists versions for `identity.notification.push.version` and `identity.local.auth.push.version` . This indicates that these notification features are modular and configurable within the WSO2 Identity Server.\\n\\nThe `identity.xml` configuration files, such as `encrypt-decrypt-persistence-enabled-identity.xml`, `identity-original-530-cache-disabled.xml`, and `identity-mgt-listener-enabled.xml`, show a `<NotificationEndpoint>` configuration under `<SSOService>` . This endpoint is used for SAML SSO notifications, suggesting a general capability for the system to send notifications related to authentication events. However, this is not directly tied to the specific \"ASPSP informing TPP to notify PSU about decoupled authentication\" scenario. <cite />\\n\\n### Documentation References\\n\\nThe provided context includes a wiki page on \"Architecture\" . This page describes the high-level architecture of WSO2 Identity Server, including its modular design and components like \"Core Identity Services\" and \"Protocol Support\" . While it mentions an \"Event Framework\"  that could be relevant for triggering notifications, it does not specifically detail the \"PSU Message\" concept or the interaction between ASPSP, TPP, and PSU for decoupled authentication. <cite />\\n\\n## Notes\\n\\nThe query specifically asks about \"ASPSP should inform TPP to notify PSU about decoupled authentication requirement via PSU Message\". While the WSO2 Identity Server has a robust notification system and authentication framework, the provided snippets do not contain explicit code or configuration that directly implements or refers to the \"PSU Message\" concept or the specific ASPSP-TPP-PSU interaction for decoupled authentication. The existing notification capabilities (email, SMS, push notifications) could potentially be leveraged or extended to meet this requirement, but this would require further development or specific configuration not evident in the given context. <cite />\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_a10f048a-384a-44d6-bc7e-b228961bae70\\n', 'id': 'lc_b4070b29-9bc4-47e8-af12-9f0eba5e67e4'}]",
          "capability": "Event Notification",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0158_4",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, this repository, `wso2/product-apim`, does not appear to directly support the specific requirement of an ASPSP informing a TPP to notify a PSU about decoupled authentication via a PSU Message. The snippets primarily focus on API management functionalities such as API versioning, rate limiting, and API lifecycle management.\\n\\nThere are no explicit implementation details, configuration options, or API endpoints related to \"ASPSP\", \"TPP\", \"PSU\", \"decoupled authentication\", or \"PSU Message\" within the provided context.\\n\\n## Notes\\nThe provided snippets discuss API versioning and notification of API consumers about new API versions  . While this involves notifications, it is in the context of API lifecycle management and not related to the specific financial services concepts mentioned in your query. Similarly, API rate limiting  and API creation/publishing utilities   are general API management features and do not address the specific requirements of decoupled authentication in a financial context. The `deployment.toml` files   contain configuration settings but none are relevant to the query.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_63b7df5a-6abe-4167-b05c-b6013b2bf095\\n', 'id': 'lc_e979ce66-59d7-426f-bfe2-0093c24aaf7d'}]",
          "capability": "Event Notification",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0159",
      "requirement": {
        "requirement_id": "ATOM_174",
        "requirement_text": "The PSU-IP-Address header SHOULD be included when the request was actively initiated by the PSU, containing the forwarded IP address between PSU and TPP.",
        "strength": "SHOULD",
        "capability": "Security",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Security",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0159_1",
          "text": "# SMS service request headers can be defined as below.\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Accept\"\nvalue = \"application/json\"\n[[open_banking.identity.ciba.auth_web_link.sms_notification.header]]\nname = \"Authorization\"\nvalue = \"**\"\n```",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0159_2",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the forwarding of client IP addresses through the use of a `RemoteIpValve` in its Tomcat configuration, which can be configured to read the `PSU-IP-Address` header. \\n\\n### Implementation Details\\nThe `wso2/product-is` repository uses a `RemoteIpValve` within its Tomcat `catalina-server.xml.j2` template.  This valve is designed to get the real client IP addresses via request headers.  The `RemoteIpValve` is configured with properties such as `internalProxies`, `remoteIpHeader`, `protocolHeader`, `proxiesHeader`, and `trustedProxies`. \\n\\n### Configuration Options\\nThe `RemoteIpValve` can be enabled and configured through the `catalinaValves.remoteIpValve` section in the configuration.  To support the `PSU-IP-Address` header, you would configure the `remoteIpHeader` property of the `RemoteIpValve` to `PSU-IP-Address`.  This would allow the system to extract the client IP from this specific header. \\n\\nAn example of how this might be configured in a `deployment.toml` file (which is used for dynamic configuration in WSO2 Identity Server ) would involve setting the `remoteIpHeader` property under `catalinaValves.remoteIpValve`. \\n\\n### API Endpoints or Features\\nThe `RemoteIpValve` itself is a low-level component of the Tomcat server and does not expose specific API endpoints.  Its function is to process incoming request headers before they reach the application logic.  Therefore, any API endpoint within the WSO2 Identity Server that receives requests would implicitly benefit from this configuration, as the client IP address would be correctly identified and forwarded. \\n\\n### Documentation References\\nThe provided context includes a wiki page on \"Architecture\"  which mentions the \"Configuration System\"  and specifically references `catalina-server.xml.j2` as part of the \"Runtime Configuration\".  This indicates that the `catalina-server.xml.j2` file is a key part of how the server is configured at runtime.  Further documentation on configuring Tomcat valves in WSO2 Identity Server would be relevant for detailed setup. \\n\\n## Notes\\nThe `RemoteIpValve` is a standard Apache Tomcat component.  Its presence in `catalina-server.xml.j2`  suggests that WSO2 Identity Server leverages this functionality for IP address handling. The `non_unique_user_disable.toml`  and `EmailOTPTestCase.java`  files are not directly related to the `PSU-IP-Address` header functionality. <cite/>\\n\\nWiki pages you might want to explore:\\n- [Architecture (wso2/product-is)](/wiki/wso2/product-is#1.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ac4eef53-f3ec-4768-a53f-92d22cfede30\\n', 'id': 'lc_ba0b39fe-f919-4934-8249-ce55556348a9'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0159_3",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': \"This repository does not appear to directly support the automatic inclusion of a `PSU-IP-Address` header containing the forwarded IP address when a request is initiated by a PSU. The provided code snippets primarily discuss general HTTP transport properties, IP-based blocking conditions, and mediation statistics, but none specifically address the `PSU-IP-Address` header or its automatic population with forwarded IP information.\\n\\n## Implementation Details, Configuration Options, and API Endpoints/Features\\n\\nBased on the provided context, there are no explicit implementation details, configuration options, or API endpoints/features that directly support the automatic inclusion and population of a `PSU-IP-Address` header. The `properties_guide.xml` files in various modules like `traffic-manager` , `all-in-one-apim` , `api-control-plane` , and `gateway`  describe various properties related to message processing, WS-Addressing, and HTTP transport, but none of them mention a `PSU-IP-Address` header or a mechanism to automatically forward client IP addresses in such a header.\\n\\nThe `IPConditionDTO.java` file  and `APIDenyPolicyTestCase.java`  indicate that IP addresses are used for defining blocking conditions and policies, but this is for access control rather than header manipulation for forwarded IPs.\\n\\nThe `preserveProcessedHeaders` property     is mentioned, which, when set to `true`, attempts to preserve SOAP headers of incoming requests. However, this is a general mechanism for SOAP headers and does not specifically address the creation or population of a `PSU-IP-Address` header for forwarded IP addresses in the context of PSU-initiated requests.\\n\\n## Documentation References\\n\\nThe provided documentation snippets do not contain any references to a `PSU-IP-Address` header or its functionality. The `properties_guide.xml` files list various configurable properties, but none match the described requirement.\\n\\n## Test Criteria\\n\\nWithout explicit support for the `PSU-IP-Address` header, it is not possible to verify its presence or the correctness of the forwarded IP address based on the provided codebase context.\\n\\n## Notes\\n\\nThe codebase contains references to IP addresses in the context of clustering   and IP-based access control , but these are distinct from the requirement of including a `PSU-IP-Address` header for forwarded IP addresses in requests. The `SERVER_IP` property  refers to the IP address of the ESB host, not a client's forwarded IP.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_94c675ee-cfe3-41ef-aefd-e84817fe3cae\\n\", 'id': 'lc_a3b0b6b8-96b1-4f50-b233-a819550824e9'}]",
          "capability": "Security",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0160",
      "requirement": {
        "requirement_id": "ATOM_176",
        "requirement_text": "The Authorization header SHOULD be included when OAuth2 based authentication was performed in a pre-step or OAuth2 based SCA was performed in the related consent authorization.",
        "strength": "SHOULD",
        "capability": "Authentication",
        "section_id": "f4b3933a3ed2",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0160_1",
          "text": "During the consent authorization process, the banks redirect customers to provide consent for API consumers to access their banking information. The process is as follows: 1. API consumer requests to access the banking information of a customer. 2. Bank validates the API consumer\u2019s request. 3. The bank redirects the requested information (containing the information the API consumer application wants to access) to the customer. 4. The bank authenticates the customer. See below for the default login page of the consent page: ![login-consent-page](../assets/img/develop/customizing-consent-page/login-of-consent-page.png) 5. A list of bank accounts and the information that the API consumer wishes to access are displayed. ![select accounts](../assets/img/learn/consent-manager/consent-page-select-accounts.png) 6. The customer can view the information before consenting or denying it. For example, ![grant consent](../assets/img/learn/consent-manager/consent-page-confirm.png) ##Consent Authorization in WSO2 Open Banking Accelerator Following components perform the consent authorization: ###Authorization endpoint Before the API consumer application accesses the customer's banking information, the API consumer sends an authorization request to get the customer's consent for it. The authorization request contains a request object. This request object is a self-contained JWT, which helps banks to validate the API consumer. The method of sending the authorization request can vary as follows: - **Send the authorization details in the authorization URL** The API consumers share the request object containing the authorization details to the authorization server and obtain the authorization URL. - **Send the authorization details as a reference in the authorization URL** The API consumers push authorization details directly to the authorization server and obtain a reference. This method is also known as **Pushed Authorization**. The reference is notated by the claim; `request_uri`. Thereby, it prevents: - Intruders from intercepting the authorization information sent in the request_object - Authorization request calls becoming bulky with the authorization details signed in the JWT and protects the confidentiality and integrity of the authorization details when passing through an API consumer application. ###Pushed Authorization web application The API consumers obtain `request_uri` which is a reference to the authentication and authorization details sent in the pushed authorization request. - **Pushed Authorization - /par endpoint** Upon successful invocation of the `/par` endpoint, API consumers will receive a `request_uri` value with an expiration time. Therefore, the reference is only valid until the expiration time for the subsequent authorization invocation. Given below is a successful response: ``` { \"request_uri\": \"urn:ietf:params:oauth:request_uri:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` This same `request_uri` value is used in the subsequent authorization request as well. WSO2 Open Banking Accelerator allows you to perform custom validations for the pushed authorization request. For more information, see [writing a Custom Pushed Auth Request Validator](../develop/custom-pushed-auth-request-validator.md). ??? tip \"Click here to see configurations related to the Pushed Authorization web application...\" 1. Open the `<IS_HOME>/repository/conf/deployment.toml` file. 2. Add the following configurations that allow you to change the format and the expiration time of the `request_uri` reference: ``` [open_banking.push_authorisation] expiry_time=60 request_uri_sub_string=\"substring\" ``` !!! note You can change the format of the request_uri using the `request_uri_sub_string` tag. ``` { \"request_uri\": \"urn:<substring>:bwc4JK-ESC0w8acc191e-Y1LTC2\", \"expires_in\": 60 } ``` ###Authorization web application The API consumers obtain an authorization URL that redirects the customer to a web interface hosted by the bank.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_2",
          "text": "### push-auth/authenticate endpoint\n\nThe SDK invokes the `push-auth/authenticate` endpoint within the `sendAuthRequest()` method to send the consent \nauthorization status (approved/denied) to the authorization server/WSO2 Identity Server.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_3",
          "text": "### Step 2: Initiate a consent\n\nIn this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. \n\nA sample consent initiation request looks as follows. You can try out this sample flow with the transport certificates \navailable [here](../assets/attachments/transport-certs):\n\n!!!note\n      Replace the <AUTH_HEADER_VALUE> with Base64 encoded \"admin_username:admin_password\" value.\n               `Eg: Base64(admin_username:admin_password)`\n\n```\ncurl --location --request POST 'https://localhost:9446/api/fs/consent/manage/account-access-consents' \\\n--header 'Authorization: Basic <AUTH_HEADER_VALUE>' \\\n--header 'x-wso2-client-id: <CLIENT_ID>' \\\n--header 'Content-Type: application/json' \\\n--cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n--data '{\n   \"Data\":{\n      \"Permissions\":[\n         \"ReadAccountsBasic\",\n         \"ReadAccountsDetail\",\n         \"ReadBalances\",\n         \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\",\n      \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\"\n   },\n   \"Risk\":{\n   }\n}'\n```\nThe response contains a Consent ID. A sample response looks as follows:\n```\n{\n    \"Risk\": {\n        \n    },\n    \"Data\": {\n        \"ConsentId\": \"12a4ebc8-b98c-4f80-9a37-44679363b97b\",\n        \"StatusUpdateDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Status\": \"AwaitingAuthorisation\",\n        \"CreationDateTime\": \"2025-06-04T10:57:06+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsBasic\",\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ExpirationDateTime\": \"2026-01-02T00:00:00+00:00\",\n        \"TransactionToDateTime\": \"2025-12-01T00:00:00+00:00\",\n        \"TransactionFromDateTime\": \"2025-06-03T00:00:00+00:00\"\n    }\n}\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_4",
          "text": "## Authorization Request\n\nBefore a third-party API consumer application accesses the customer's banking information, the API consumer sends an \nauthorization request to get the customer's consent for it. The authorization request contains a request object. This \nrequest object is a self-contained JWT, which helps banks to validate the API consumer.\n\nGiven below are sample authorization requests for banks ABC and DBC.\n\n``` tab=\"Bank ABC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMSIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkQmFsYW5jZXMiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.Bd7ZN9aR53Qwfln3uqf2UR_QKXlA2-Yb75VCf3zTCYG_9pqLL_uOro4_iz5GKLwIkABoVpMlmWHz5ZwiiuAdoRPdsPUSCqoBfI5oEqhs6R6s9FwC8cnXWY6PVr-22RQx9bTlMPvx-y45JO3yhJgjwjfZHSwiEufzASJnr_3k3OS6dH2_ICIUAx86MwrReWg-AZFq9oQGFP0PghTAiSegV81sj0Cuxp0AkSSAXg7_2sY7FO6HfjPwx-n6JgF3sR8fjiikYpeh3NZCcivR-srwLKXBOZ4w_M27_EeMr0OTvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g\n```\n\n``` tab=\"Bank DBC\"\nhttps://localhost:9446/oauth2/authorize?response_type=code%20id_token&client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa&redirect_uri=https://wso2.com&scope=accounts%20openid&state=af0ifjsldkj&nonce=n-0S6_WzA2Mj&request=eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtnanciLCJ0eXAiOiJKV1QiLCJhbGciOiJQUzI1NiJ9.eyJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo5NDQ2L29hdXRoMi90b2tlbiIsIm1heF9hZ2UiOjg2NDAwLCJjcml0IjpbImI2NCIsImh0dHA6Ly9vcGVuYmFua2luZy5vcmcudWsvaWF0IiwiaHR0cDovL29wZW5iYW5raW5nLm9yZy51ay9pc3MiLCJodHRwOi8vb3BlbmJhbmtpbmcub3JnLnVrL3RhbiJdLCJzY29wZSI6ImFjY291bnRzIG9wZW5pZCIsImV4cCI6MTk1NDcwODcxMCwiY2xhaW1zIjp7ImlkX3Rva2VuIjp7ImFjciI6eyJ2YWx1ZXMiOlsidXJuOm9wZW5iYW5raW5nOnBzZDI6Y2EiLCJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiXSwiZXNzZW50aWFsIjp0cnVlfX19LCJpc3MiOiJ4MFVpMkdpN2E1QjRqdXE3V3B3ZHBXck45bEVhIiwicmVzcG9uc2VfdHlwZSI6ImNvZGUgaWRfdG9rZW4iLCJyZWRpcmVjdF91cmkiOiJodHRwczovL3dzbzIuY29tIiwic3RhdGUiOiIwcE4wTkJUSGN2Iiwibm9uY2UiOiJqQlhoT21PS0NCIiwiY2xpZW50X2lkIjoieDBVaTJHaTdhNUI0anVxN1dwd2RwV3JOOWxFYSIsImJhbmtfY29kZSI6IjAwMiIsImNvbnNlbnQiOnsiRGF0YSI6eyJQZXJtaXNzaW9ucyI6WyJSZWFkQWNjb3VudHNEZXRhaWwiLCJSZWFkVHJhbnNhY3Rpb25zRGV0YWlsIl0sIkV4cGlyYXRpb25EYXRlVGltZSI6IjIwMjItMTItMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uVG9EYXRlVGltZSI6IjIwMjEtMDMtMjJUMDY6MTk6MDguMzI2WiIsIlRyYW5zYWN0aW9uRnJvbURhdGVUaW1lIjoiMjAyMS0wMy0yMlQwNjoxOTowOC4zMjZaIn0sIlJpc2siOnt9fX0.KAcHZ3HG1aV7q8Rp633a1aWaVqYXaIujkE9cXOqoVV4U36oDdzV81ZGMXW22EsqGWSUPURluxzO7lBJeB2Vv8w7-FNoz59QX32qh5LROepdtpay45iwz4wP3IR_ebOifv7Zd1OeaCP9KhsTgD_x-jc5KmIvXFm9Y9iDXUmjB9TynqtTwzGV1bD2_g_ye_ybuXzwtwpkAlwRUnpHoJqiqacmWvatDWdxzJUjrOcOWvD0aRbAvSJ2KoRi5bXncufH4eBiTxiHaztvReg-QjXSadFm6fc_BcNuezQQYENWJ8U__HKOufGSbEN9lWK5r9heFkGLGt7XaTixti0eVDDYEGg\n```\n\n??? \"Click here to see a description of each parameter in the authorization request\"\n    |Parameter |Description |Parameter type |Sample Value|\n    |--------- |------------|------------- | ------------|\n    |response_type |OIDC Response Type value | Query | code id_token|\n    |client_id |Client ID of the application registered via DCR |Query |x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |redirect_uri |Registered Callback URL |Query |https://wso2.com|\n    |scope |OIDC scopes value | Query |accounts openid|\n    |state |OIDC state value |Query |0pN0NBTHcv|\n    |nonce |OIDC nonce object |Query |jBXhOmOKCB|\n    |request |OIDC Request Object | Query |eyJraWQiOiJHcWhLVlRBTm5MTVlwR0dmQXRKMU5oZGtna\u2026\u2026.TvDqzojXHm4_P_cHXOmX6GCBcpAqhTXRH0ew8mrNBJ1Bh_g|\n    \nThe OIDC Request Object contains a header and a payload in the format below:\n\n``` json  \n{\n  \"kid\": \"GqhKVTANnLMYpGGfAtJ1Nhdkgjw\",\n  \"typ\": \"JWT\",\n  \"alg\": \"PS256\"\n}\n\n{\n  \"aud\": \"https://localhost:9446/oauth2/token\",\n  \"max_age\": 86400,\n  \"crit\": [\n    \"b64\",\n    \"http://openbanking.org.uk/iat\",\n    \"http://openbanking.org.uk/iss\",\n    \"http://openbanking.org.uk/tan\"\n  ],\n  \"scope\": \"accounts openid\",\n  \"exp\": 1954708710,\n  \"claims\": {\n    \"id_token\": {\n      \"acr\": {\n        \"values\": [\n          \"urn:openbanking:psd2:ca\",\n          \"urn:openbanking:psd2:sca\"\n        ],\n        \"essential\": true\n      }\n    }\n  },\n  \"iss\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"response_type\": \"code id_token\",\n  \"redirect_uri\": \"https://wso2.com\",\n  \"state\": \"0pN0NBTHcv\",\n  \"nonce\": \"jBXhOmOKCB\",\n  \"client_id\": \"x0Ui2Gi7a5B4juq7WpwdpWrN9lEa\",\n  \"bank_code\": \"001\",\n  \"consent\": {\n    \"Data\": {\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n        \"ReadBalances\",\n        \"ReadTransactionsDetail\"\n      ],\n      \"ExpirationDateTime\": \"2022-12-22T06:19:08.326Z\",\n      \"TransactionToDateTime\": \"2021-03-22T06:19:08.326Z\",\n      \"TransactionFromDateTime\": \"2021-03-22T06:19:08.326Z\"\n    },\n    \"Risk\": {}\n  }\n}\n```\n\n??? \"Click here to see a description of each parameter in the OIDC Request Object\"\n    |Parameter |Description |\n    |--------- |------------|\n    |aud |Audience value. The `aud` value needs to match with the Audience value of the Identity Server\u2019s Resident IDP|\n    |scope |OIDC scopes value | \n    |iss |Issuer of the JWT Token. This value should be similar to the client ID of the requesting application|\n    |response_type |OIDC Response Type value | \n    |redirect_uri |Registered Callback URL | \n    |state |OIDC state value |\n    |nonce |OIDC nonce object |\n    |client_id |Client ID of the application registered via DCR |\n    |bank_code |Unique identifier for the bank. In this scenario, the bank code for ABC is `001` and DBC is `002`|\n    |consent |Information about the requested consent|",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0160_5",
          "text": "## Populate Consent Authorization Screen\n\nThe OpenAPI extension for populate consent authorization screen provides the extendibility to validate and populate the consent grant screen with Open Banking\nspecification specific consent data and consumer data. The data setting from this extension point will be sent to the consent \npage to display to the user. \n!!! note \n    This information that is sent and displayed on the consent page depends on the specification that you adhere to. The default consent page in WSO2 Open Banking\naccelerator do support showing consent data and accounts data binding to the permissions.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0161",
      "requirement": {
        "requirement_id": "ATOM_145",
        "requirement_text": "The ASPSP may require explicit consent extension by PSU to deliver account owner name",
        "strength": "MAY",
        "capability": "Consent Management",
        "section_id": "2035ed10aab6",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0161_1",
          "text": "#### Add ConsentPortalRole Role\n\nConsentPortalRole is required for users to log into the Consent Manager Portal and search for the consents granted by them.\n\nSimilarly create another role named as **ConsentPortalRole** and assign **consents:read_self** scope to the role.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0161_2",
          "text": "#### Add CustomerCareOfficerRole Role\n\nCustomerCareOfficerRole is required for bank users to log into the Consent Manager Portal and search for the consents granted by any user.\n\n1. Go to **Roles** under the **User Management** tab in the left pane.\n\n2. Click on **+ New Role**.<br/> \n![roles](../assets/img/learn/consent-manager/roles.png)\n\n3. Enter following details and click on Next button.\n    - Role Name: CustomerCareOfficerRole\n    - Role audience: Organization<br/> \n![create-cc-role](../assets/img/learn/consent-manager/create-cc-role.png)\n\n4. Select the created **API Resource** under the **Permission Selection** section.\n\n5. Add the **consents:read_all** permission from the API resource separately.<br/> \n![create-role-step2](../assets/img/learn/consent-manager/create-role-step2.png)\n\n6. Click on the **Finish** button.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0161_3",
          "text": "## Using Consent Manager\n\n1. Go to the Consent Manager application at `https://<IS_HOST>:9446/consentmgr`.\n\n2. Sign in with the credentials of the users created in [Create Users](../learn/consent-manager.md#add-new-user) section.\n\n3. The **consentmgr** application requests access to your profile. To grant access, click **Continue**.<br/> \n![consent-approval](../assets/img/learn/consent-manager/consent-approval.png)\n\n4. You are redirected to the homepage of the Consent Manager portal.\n\n\nThe three tabs are as follows:\n\n   - **Active**: Lists active consents that can access your account/payment information.\n   - **Expired**: Lists expired consent that cannot access your account/payment information anymore.\n   - **Withdrawn**: Lists the consents that you have revoked.\n\n!!! tip\n    Use the **Search** button to search consents.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0161_4",
          "text": "#### Add New User\n\n1. Go to **Users** under the **User Management** tab in the left pane.<br/> \n![users](../assets/img/learn/consent-manager/users.png)\n\n2. Click on **Add User** \u2192 **Single User**.\n\n3. Create the user by providing necessary details.<br/> \n![create-user](../assets/img/learn/consent-manager/create-user.png)\n\n4. Click on the Next button.\n\n!!! note\n    Select the admin group, If you want to add the user to the admin group. Otherwise proceed the step without selecting the admin group.\n\n5. Then click on the Close button.\n\n6. Go to the **Roles** under the **User Management** tab in the left pane.\n\n7. Select **CustomerCareOfficerRole** role.\n\n8. Go to **Users** tab and assign the created user to the **CustomerCareOfficerRole** role.\n\nSimilarly assign the **ConsentPortalRole** to the users who have a consumer role.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0161_5",
          "text": "### Error Handling\nIn any of the consent extensions, if an error scenario occurs and you need to send an error response make sure to throw \na `ConsentException`.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0161_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports explicit consent for sharing user attributes, including the account owner name, through its consent management features. This is primarily handled via the `/api/identity/consent-mgt/v1.0/consents` API endpoint and related configurations.  The system allows for defining PII categories, purposes, and collecting explicit consent from the user (PSU) for these purposes. \\n\\n## Implementation Details\\n\\nThe consent management functionality is implemented through a REST API.  The `ConsentMgtTestCase.java` integration test demonstrates how to interact with this API to manage consent. \\n\\nKey aspects of the implementation include:\\n*   **PII Categories**: Personal Identifiable Information (PII) categories can be defined, such as `http://wso2.org/claims/organization`.  These categories represent the types of data for which consent might be required. The `testAddPIICategory` method in `ConsentMgtTestCase` illustrates adding a PII category. \\n*   **Purpose Categories**: Purposes for data collection are grouped into categories, like \"Financial\".  The `testAddPurposeCategory` method shows how to add a purpose category. \\n*   **Purposes**: Specific purposes for collecting PII are defined, such as \"Financial 01\" for a \"SIGNUP\" group.  When adding a purpose, specific PII categories can be associated with it and marked as mandatory.  The `addPurpose` method in `ConsentMgtTestCase` demonstrates this. \\n*   **Consent Receipts**: When a user provides consent, a \"receipt\" is generated, capturing details like the PII principal ID, service, consent type, and associated purposes and PII categories.  The `addReceipt` method in `ConsentMgtTestCase` shows how to create such a receipt. \\n*   **Self-Registration with Consent**: The `SelfSignUpConsentTest` demonstrates how consent is integrated into the self-registration flow.  During self-registration, the system can prompt for consent for specific purposes and PII categories. \\n\\n## Configuration Options\\n\\nThe system provides configuration options to enable or disable consent management and to specify which grant types require user consent.\\n*   **Enable SSO Consent Management**: The `EnableSSOConsentManagement` element in `default-identity.xml` can be set to `true` to enable consent management during Single Sign-On (SSO). \\n*   **User Consent Enabled Grant Types**: The `UserConsentEnabledGrantTypes` section in `default-identity.xml` specifies which OAuth2 grant types (e.g., `authorization_code`, `implicit`) will filter user claims based on user consent in their responses. \\n*   **Skip User Consent**: For OpenID Connect, there is a `SkipUserConsent` flag which can be set to `false` to ensure user consent is not skipped. \\n\\n## API Endpoints or Features\\n\\nThe primary API endpoint for consent management is `/api/identity/consent-mgt/v1.0/consents`. \\nThis endpoint supports:\\n*   Adding PII categories: `POST /api/identity/consent-mgt/v1.0/consents/pii-categories` \\n*   Adding purpose categories: `POST /api/identity/consent-mgt/v1.0/consents/purpose-categories` \\n*   Adding purposes: `POST /api/identity/consent-mgt/v1.0/consents/purposes` \\n*   Adding consent receipts: `POST /api/identity/consent-mgt/v1.0/consents` \\n*   Retrieving consent receipts: `GET /api/identity/consent-mgt/v1.0/consents/receipts/{receiptId}` \\n\\nThe `Utils.java` class contains helper methods for handling consent messages, such as `sendPOSTConsentMessage` and `getConsentRequiredClaimsFromResponse`, which are used in integration tests to simulate user consent flows.  \\n\\n## Documentation References\\n\\nThe provided wiki page on \"Integration Tests\" mentions \"Self-Registration and Consent Tests\" as a category, indicating that consent management is a tested feature within the WSO2 Identity Server. \\n\\n## Notes\\n\\nThe provided code snippets are primarily integration tests, which demonstrate the functionality and how to interact with the consent management system. They do not expose the internal implementation details of the consent management core, but rather how to use its exposed APIs. The term \"ASPSP\" (Account Servicing Payment Service Provider) and \"PSU\" (Payment Services User) are not explicitly found in the provided code, but the consent management system is generic enough to be used by an ASPSP to obtain explicit consent from a PSU for sharing data like the account owner name. The \"account owner name\" would likely be represented as a PII category or a claim that requires consent. \\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_32049ba5-eaaa-4785-8811-ca9666e556c9\\n', 'id': 'lc_10879cdf-4b11-471e-85dc-03dd8302f0ef'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0161_7",
          "text": "[wso2-extensions/identity-consent-mgt]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-consent-mgt to index it.', 'id': 'lc_8b156d4e-2b95-4d65-a7d6-e04cfd8aabfd'}]",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0162",
      "requirement": {
        "requirement_id": "ATOM_035",
        "requirement_text": "The GET consents/{consentId} endpoint SHALL be mandatory for reading the exact definition of a given consent resource including validity status",
        "strength": "MANDATORY",
        "capability": "Consent Management",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0162_1",
          "text": "### getDetailedConsent method\n \nThis method lets you retrieve detailed consent for a given consent ID. A detailed consent includes the following in \naddition to consent resource-specific data: \n\n - Relative consent authorization data\n - Relative consent account mapping data \n - Relative consent attributes\n \n``` java\nDetailedConsentResource getDetailedConsent(String consentID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0162_2",
          "text": "### getConsent method\n\nThis method lets you retrieve a consent with or without its attributes by performing the following: \n\n- Retrieves the consent for status validation\n- Optionally retrieves consent attributes according to the value of the withConsentAttributes flag\n- Checks whether the retrieved consent involves a file\n  \n``` java\nConsentResource getConsent(String consentID, boolean withConsentAttributes) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0162_3",
          "text": "### Consent Enforcement Policy\n\nConsent Enforcement Policy is a policy designed to be engaged in the request flow of any request that requires the consent to be validated prior to an API resource call. It will perform the below tasks.\n\n- Creates a payload for the consent validation service\n- Makes an HTTP POST call to the consent validation service\n- Handles the response from the consent validation service\n- Will let the API pass through if consent is valid, else respond with an error\n\nCreate an API Level Policy by following the [Creating API Level Policy](../learn/create-policies.md) and add to all API resources which require consent enforcement. Find the details to create the policy below.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0162_4",
          "text": "## Consent REST API\n    \nWhen interacting with the consent module, you can use the [Consent REST API](../references/consent-rest-api.md) exposed \nby WSO2 Open Banking Accelerator.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0162_5",
          "text": "### getConsentFile method\n\nThis method lets you retrieve the consent file for a given consent.\n  \n``` java\nConsentFile getConsentFile(String consentID) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0163",
      "requirement": {
        "requirement_id": "ATOM_114",
        "requirement_text": "For XML encoded Payment Initiation Requests, the ASPSP MAY return status as pain.002 structure or JSON structure",
        "strength": "MAY",
        "capability": "Payment Initiation",
        "section_id": "a4a84452c1ef",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0163_1",
          "text": "obWritePaymentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"PaymentId\"\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            PaymentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the payment resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 40\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the message was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of the payment information group.\"\n              type: \"string\"\n              enum:\n                - \"AcceptedCreditSettlementCompleted\"\n                - \"AcceptedSettlementCompleted\"\n                - \"AcceptedSettlementInProcess\"\n                - \"AcceptedWithoutPosting\"\n                - \"Pending\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Refund:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Account\"\n              description: \"Unambiguous identification of the refund account to which a refund will be made as a result of the transaction.\"\n              properties:\n                Account:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Provides the details to identify an account.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"Name of the account, as assigned by the account servicing institution.\\nUsage: The account name is the name or names of the account owner(s) represented at an account level. The account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            MultiAuthorisation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"Status\"\n              description: \"The multiple authorisation flow response from the ASPSP.\"\n              properties:\n                Status:\n                  description: \"Specifies the status of the authorisation flow in code form.\"\n                  type: \"string\"\n                  enum:\n                    - \"Authorised\"\n                    - \"AwaitingFurtherAuthorisation\"\n                    - \"Rejected\"\n                NumberRequired:\n                  description: \"Number of authorisations required for payment order (total required at the start of the multi authorisation journey).\"\n                  type: \"integer\"\n                NumberReceived:\n                  description: \"Number of authorisations received.\"\n                  type: \"integer\"\n                LastUpdateDateTime:\n                  description: \"Last date and time at the authorisation flow was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                ExpirationDateTime:\n                  description: \"Date and time at which the requested authorisation flow must be completed.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0163_2",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0163_3",
          "text": "obWriteConsent4:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"Initiation\"\n          properties:\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0163_4",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0163_5",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0163_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the processing of XML and JSON payloads for payment initiation requests. The system\\'s idempotency validation mechanism, implemented in `IdempotencyValidator.java`, explicitly handles both JSON and XML formats for comparing request payloads . While the `payment-initiation-openapi.yaml` defines API endpoints primarily for JSON and JOSE+JWE content types in its `requestBody` and `responses` sections, the presence of XML payload comparison logic suggests a capability to process XML-encoded requests and potentially return responses in either XML (pain.002) or JSON format, depending on the ASPSP\\'s configuration and external service integration  .\\n\\n## Implementation Details\\n\\nThe core implementation detail supporting both XML and JSON payload handling is found within the `IdempotencyValidator` class . This class contains two private methods:\\n*   `isJSONPayloadSimilar(String incomingPayload, String storedConsentReceipt)`: This method compares two JSON payloads by parsing them into `JsonNode` objects using `ObjectMapper` and then checking for equality .\\n*   `isXMLPayloadSimilar(String incomingPayload, String storedPayload)`: This method compares two XML payloads. It uses `DocumentBuilderFactory` and `DocumentBuilder` to parse the XML strings into `Document` objects and then uses `isEqualNode()` for comparison . This method also includes features to prevent XML External Entity (XXE) vulnerabilities .\\n\\nThe presence of these methods indicates that the system is designed to handle both JSON and XML content types for idempotency validation, which is a crucial part of processing payment initiation requests . The `IdempotencyValidator` is used within the `DefaultConsentManageHandler` for consent operations, which includes payment-related consents .\\n\\n## Configuration Options\\n\\nThe `IdempotencyValidator` supports configurable time windows for idempotency validation and can be enabled or disabled via the `isIdempotencyValidationEnabled()` configuration property . The specific configuration for enabling or disabling idempotency validation and setting the idempotency header name is managed through the `FinancialServicesConfigParser` .\\n\\n## API Endpoints or Features\\n\\nThe `payment-initiation-openapi.yaml` file defines the API endpoints for payment initiation . Specifically, the `/payments` endpoint handles `POST` requests for creating payments . The `requestBody` for this endpoint specifies `application/json; charset=utf-8`, `application/json`, and `application/jose+jwe` as supported content types for the `obWritePayment2` schema .\\n\\nThe responses for successful payment creation (`201PaymentsCreated`) and payment retrieval (`200PaymentsPaymentIdRead`) are also defined to support `application/json; charset=utf-8`, `application/json`, and `application/jose+jwe` content types, using the `obWritePaymentResponse5` schema  .\\n\\nWhile the OpenAPI specification primarily lists JSON and JOSE+JWE for requests and responses, the presence of XML payload comparison in `IdempotencyValidator.java` suggests that the underlying system has the capability to process XML. The `MAY` requirement strength in your query implies flexibility for the ASPSP. This flexibility would likely be handled through external service integrations, where the `ServiceExtensionUtils` could be configured to communicate with external systems that return `pain.002` XML structures . The `ExternalAPIUtil` class is responsible for handling external API communication and mapping between internal and external data formats .\\n\\n## Documentation References\\n\\nThe \"Consent Management\" wiki page provides an overview of the consent management system, including its architecture and external service integration capabilities . It highlights how external services can be invoked for various consent operations, which would be the mechanism for an ASPSP to return different response formats . The \"Overview\" wiki page also mentions the modular architecture and the role of the `financial-services.xml` for configuration .\\n\\n## Test Criteria\\n\\nThe `IdempotencyValidatorTests.java` file contains tests for the `IdempotencyValidator` class, including a test case that uses an XML payload for file upload . This test demonstrates the system\\'s ability to handle XML content, specifically a `pain.001.001.08` XML structure . While this is for a file upload and not directly a payment initiation response, it confirms the underlying XML processing capability.\\n\\nThe `PaymentsInitiationRequestHeaderValidationTests.groovy` also includes a test case that attempts to send a request with `ContentType.XML`, which results in a `415 Unsupported Media Type` error . This test, however, is specifically for request content type validation at the API gateway level and does not directly address the response format flexibility. The comment `//TODO: https://github.com/wso2/financial-services-accelerator/issues/681` suggests that there might be ongoing work or a known limitation regarding XML content types for initiation requests .\\n\\nTo verify that the ASPSP can choose to return either `pain.002` XML or JSON for XML-initiated payments, you would need to:\\n1.  **Configure an external service**: This external service would be responsible for generating the `pain.002` XML response. The `ServiceExtensionUtils` and `ExternalAPIUtil` would be used to integrate this service  .\\n2.  **Modify API Gateway policies**: Depending on the specific integration, the API Gateway might need policies to transform the incoming XML request into a format understood by the internal services, and then transform the external service\\'s `pain.002` XML response back into the desired format for the TPP.\\n3.  **Extend the `payment-initiation-openapi.yaml`**: To explicitly support XML responses, the `content` types in the `responses` section of the `payment-initiation-openapi.yaml` would need to be updated to include `application/xml` or specific `pain.002` media types .\\n\\n## Notes\\n\\nThe codebase demonstrates a strong capability for handling both JSON and XML payloads internally, particularly for idempotency validation . However, the public-facing API definitions in `payment-initiation-openapi.yaml` primarily specify JSON and JOSE+JWE content types for requests and responses  . To fully support the `MAY` requirement for returning `pain.002` XML or JSON for XML-initiated payments, additional configuration and potential extensions would be needed, likely involving the external service integration framework to handle the transformation and routing of XML responses from an ASPSP. The `Constants.java` file defines `JSON` as `application/json` , which is used in various parts of the system, indicating a default preference for JSON.\\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [Consent Management (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#3)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-f_473657f0-24ca-40a8-9925-cba24f1c291e\\n', 'id': 'lc_8c4c259c-da5d-412c-9c58-76bc89d34b69'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0164",
      "requirement": {
        "requirement_id": "ATOM_051",
        "requirement_text": "Error responses may include an additionalErrors array for multiple related errors",
        "strength": "MAY",
        "capability": "Error Handling",
        "section_id": "d029f87e3d80",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0164_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not explicitly support an `additionalErrors` array for multiple related errors in its API responses based on the provided context. The error response structure observed in the integration tests and Swagger definitions primarily includes a single error `code`, `message`, and `description`  .\\n\\n### Implementation Details\\n\\nThe `wso2/product-is` repository uses a consistent error response format for its REST APIs. The `validateErrorResponse` method in `RESTTestBase.java` is central to how error responses are validated in integration tests . This method expects a response with a `code`, `message`, `description`, and optionally a `traceId` .\\n\\nThe `validateErrorResponse` method calls `validateHttpStatusCode` to check the HTTP status code , `validateResponseElement` to verify the `code` and `traceId` , `validateErrorMessage` for the error message , and `validateErrorDescription` for the error description . These validation methods retrieve expected error messages and descriptions from the `RESTAPIErrors.properties` file based on the error code .\\n\\nFor example, in `AuthenticatorFailureTest.java`, an invalid authenticator name results in a `400 Bad Request` with a specific `code` (\"AUT-60014\"), `message` (\"Authenticator name is invalid.\"), and `description` . Similarly, `IdPFailureTest.java` shows a `400 Bad Request` for duplicated properties, also with a single `message` and `description` .\\n\\nThe `RESTAPIErrors.properties` file contains key-value pairs for error codes, messages, and descriptions, but does not define a structure for multiple errors within a single response .\\n\\n### API Endpoints or Features\\n\\nThe API endpoints tested in the provided snippets, such as those for authenticator management , IDP management , and organization management , all adhere to the single error object structure. The SCIM2 Swagger definition also defines error responses with a single `detail` field, not an array .\\n\\n### Configuration Options\\n\\nThere are no explicit configuration options visible in the provided context that would enable or disable an `additionalErrors` array in API responses. The error handling mechanism appears to be standardized to a single error object.\\n\\n### Documentation References\\n\\nThe \"Features and Capabilities\" wiki page provides a high-level overview of the product\\'s features but does not delve into the specifics of API error response formats . The provided code snippets, particularly the integration tests, serve as the primary documentation for the expected error response structure.\\n\\n## Notes\\n\\nThe `ApplicationNativeAuthentication2FATestCase.java` file shows a `messages` array within the `nextStep` object for failed authentication responses . Each object in this `messages` array contains `type`, `messageId`, `message`, and `i18nKey` fields . While this is an array of messages, it is specifically for authentication flow messages and not a general `additionalErrors` array for API error responses as described in the prompt. This is a distinct use case within the authentication flow and does not indicate a general API error response pattern.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_ddd9b542-cefd-449e-a807-06978716aaf5\\n', 'id': 'lc_939d93e6-f053-4dc2-9f41-f8b85e1ee7ce'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0164_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Yes, this repository supports error responses that may include an `additionalErrors` array for multiple related errors.    This is defined within the OpenAPI specifications for various APIs in the `wso2/product-apim` repository. \\n\\n## Implementation Details\\n\\nThe core of this functionality is defined by two schema objects: `Error` and `ErrorListItem`. \\n\\n### Error Object\\nThe `Error` object is the primary structure for error responses.  It includes the following properties:\\n*   `code`: An integer representing the error code. \\n*   `message`: A string providing a general error message. \\n*   `description`: A detailed description of the error message. \\n*   `moreInfo`: An optional URL with more details about the error. \\n*   `error`: An array of `ErrorListItem` objects, used to list out multiple individual errors, such as validation errors by field. \\n\\n### ErrorListItem Object\\nThe `ErrorListItem` object describes individual errors within the `error` array of the `Error` object.  It has the following properties:\\n*   `code`: A string representing the error code for the individual item. \\n*   `message`: A string describing the individual error. \\n*   `description`: A detailed description about the error message. \\n\\nThese schema definitions are consistently found across various OpenAPI specification files, indicating a standardized error handling mechanism.    \\n\\n## API Endpoints and Features\\n\\nThe `Error` schema is referenced in the responses of various API endpoints. For example, in the `service-catalog-api.yaml`, a `BadRequest` response (HTTP 400) explicitly references the `Error` schema.  This indicates that when a bad request occurs, the API will return an `Error` object, which can contain the `error` array for multiple issues. \\n\\nSimilar references to the `Error` schema are found in other API definitions for various HTTP status codes (e.g., 400, 403, 404, 409, 500), confirming that this error structure is a common pattern across the API.  \\n\\n## Documentation References\\n\\nThe OpenAPI specification files themselves serve as documentation for these error structures. The `description` fields within the `Error` and `ErrorListItem` schemas explicitly state their purpose. For instance, the `error` property in the `Error` object has the description: \"If there are more than one error list them out. For example, list out validation errors by each field.\" \\n\\nAdditionally, generated Java DTOs (Data Transfer Objects) like `ErrorDTO.java` and `ErrorListItemDTO.java` in various client modules reflect these definitions.   These generated classes include Javadoc comments that mirror the descriptions from the OpenAPI specifications, further documenting the structure and purpose of the error responses. \\n\\n## Test Criteria\\n\\nTo verify that responses contain an `additionalErrors` array with each error having `title`, `detail`, and `code` fields, you would look for the `error` array within the main `Error` object.  Each item in this array would be an `ErrorListItem`, which contains `code` and `message` fields.  The `title` and `detail` fields mentioned in your test criteria correspond to the `message` and `description` fields respectively within the `ErrorListItem` and the main `Error` object.  \\n\\n## Notes\\n\\nThe term \"additionalErrors\" used in the prompt corresponds to the `error` array property within the `Error` schema object in the codebase.  The `ErrorListItem` schema defines the structure for individual errors within this array, including `code`, `message`, and `description` fields.  While the prompt uses \"title\" and \"detail\", these map directly to the `message` and `description` fields found in the `ErrorListItem` schema. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-e_476dad7d-4190-4a7d-8489-dc59b1a1fa15\\n', 'id': 'lc_752bb00d-cf77-44ed-a187-f6e1a315edcb'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0165",
      "requirement": {
        "requirement_id": "ATOM_151",
        "requirement_text": "The system MAY include booking balance in account details when withBalance query parameter is true and PSU consent permits balance access",
        "strength": "MAY",
        "capability": "Account Information",
        "section_id": "fcc6292f816f",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Account Information",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0165_1",
          "text": "Note, the account name is not the product name or the nickname of the\n      account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  SecondaryIdentification:\n    description: >-\n      This is secondary identification of the account, as assigned by the\n      account servicing institution.\n\n      This can be used by building societies to additionally identify accounts\n      with a roll number (in addition to a sort code and account number\n      combination).\n    type: string\n    minLength: 1\n    maxLength: 34\n  OBBranchAndFinancialInstitutionIdentification5:\n    type: object\n    required:\n      - SchemeName\n      - Identification\n    description: >-\n      Party that manages the account on behalf of the account owner, that is\n      manages the registration and booking of entries on the account, calculates\n      balances on the account and provides information about the account.\n    properties:\n      SchemeName:\n        $ref: '#/definitions/OBExternalFinancialInstitutionIdentification4Code'\n      Identification:\n        $ref: '#/definitions/Identification'\n  OBExternalFinancialInstitutionIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BICFI\n  OBCreditDebitCode:\n    description: |-\n      Indicates whether the balance is a credit or a debit balance.\n      Usage: A zero balance is considered to be a credit balance.\n    type: string\n    enum:\n      - Credit\n      - Debit\n  OBBalanceType1Code:\n    description: 'Balance type, in a coded form.'\n    type: string\n    enum:\n      - ClosingAvailable\n      - ClosingBooked\n      - ClosingCleared\n      - Expected\n      - ForwardAvailable\n      - Information\n      - InterimAvailable\n      - InterimBooked\n      - InterimCleared\n      - OpeningAvailable\n      - OpeningBooked\n      - OpeningCleared\n      - PreviouslyClosedBooked\n  OBActiveCurrencyAndAmount_SimpleType:\n    description: >-\n      A number of monetary units specified in an active currency where the unit\n      of currency is explicit and compliant with ISO 4217.\n    type: string\n    pattern: '^\\d{1,13}\\.\\d{1,5}$'\n  TransactionId:\n    description: >-\n      Unique identifier for the transaction within an servicing institution.\n      This identifier is both unique and immutable.\n    type: string\n    minLength: 1\n    maxLength: 210\n  TransactionInformation:\n    description: |-\n      Further details of the transaction.\n      This is the transaction narrative, which is unstructured text.\n    type: string\n    minLength: 1\n    maxLength: 500\n  TransactionReference:\n    description: >-\n      Unique reference for the transaction. This reference is optionally\n      populated, and may as an example be the FPID in the Faster Payments\n      context.\n    type: string\n    minLength: 1\n    maxLength: 35\n  StatementReference:\n    description: >-\n      Unique reference for the statement. This reference may be optionally\n      populated if available.\n    type: string\n    minLength: 1\n    maxLength: 35\n  OBEntryStatus1Code:\n    description: Status of a transaction entry on the books of the account servicer.\n    type: string\n    enum:\n      - Booked\n      - Pending\n  BookingDateTime:\n    description: >-\n      Date and time when a transaction entry is posted to an account on the\n      account servicer's books.\n\n      Usage: Booking date is the expected booking date, unless the status is\n      booked, in which case it is the actual booking date.All dates in the JSON\n      payloads are represented in ISO 8601 date-time format.\n\n      All date-time fields in responses must include the timezone. An example is\n      below:\n\n      2017-04-05T10:43:07+00:00\n    type: string\n    format: date-time\n  ValueDateTime:\n    description: >-\n      Date and time at which assets become available to the account owner in\n      case of a credit entry, or cease to be available to the account owner in\n      case of a debit transaction entry.\n\n      Usage: If transaction entry status is pending and value date is present,\n      then the value date refers to an expected/requested value date.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0165_2",
          "text": "### Consent Initiation\n- In this step, the API consumer creates a request to get the consent of the customer to access the accounts and its \ninformation from the bank. A sample consent initiation request looks as follows:\n\n    ```\n    curl --location --request POST 'https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents' \\\n    --header 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n    --header 'Content-Type: application/json' \\\n    --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n    --data-raw '{\n    \"Data\":{\n      \"Permissions\": [\n        \"ReadAccountsDetail\",\n       \"ReadTransactionsDetail\",\n       \"ReadBalances\"\n     ],\n      \"ExpirationDateTime\":\"2021-09-02T00:00:00+00:00\",\n      \"TransactionFromDateTime\":\"2021-01-01T00:00:00+00:00\",\n      \"TransactionToDateTime\":\"2021-03-03T00:00:00+00:00\"\n    },\n    \"Risk\":{\n\n     }\n    }'\n    ```\n  \n- The response contains a Consent ID. A sample response looks as follows:\n\n    ``` json\n    {\n        \"consentId\": \"3e31f726-b9ad-43a7-897d-fcdf5e6d8cd0\",\n        \"Risk\": {},\n        \"Data\": {\n            \"TransactionToDateTime\": \"2021-03-03T00:00:00+00:00\",\n            \"ExpirationDateTime\": \"2021-09-02T00:00:00+00:00\",\n            \"Permissions\": [\n                \"ReadAccountsDetail\",\n                \"ReadTransactionsDetail\",\n                \"ReadBalances\"\n            ],\n            \"TransactionFromDateTime\": \"2021-01-01T00:00:00+00:00\"\n        }\n    }     \n    ```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0165_3",
          "text": "Usage: If not present, credit line is not included in\n                          the balance amount of the account.\n                        type: boolean\n                      Type:\n                        description: 'Limit type, in a coded form.'\n                        type: string\n                        enum:\n                          - Available\n                          - Credit\n                          - Emergency\n                          - Pre-Agreed\n                          - Temporary\n                      Amount:\n                        type: object\n                        required:\n                          - Amount\n                          - Currency\n                        description: Amount of money of the credit line.\n                        properties:\n                          Amount:\n                            $ref: '#/definitions/OBActiveCurrencyAndAmount_SimpleType'\n                          Currency:\n                            $ref: '#/definitions/ActiveOrHistoricCurrencyCode'\n            minItems: 1\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadTransaction5:\n    type: object\n    required:\n      - Data\n    properties:\n      Data:\n        $ref: '#/definitions/OBReadDataTransaction5'\n      Links:\n        $ref: '#/definitions/Links'\n      Meta:\n        $ref: '#/definitions/Meta'\n  OBReadDataTransaction5:\n    type: object\n    properties:\n      Transaction:\n        type: array\n        items:\n          $ref: '#/definitions/OBTransaction5'\n  OBTransaction5:\n    type: object\n    description: Provides further details on an entry in the report.\n    required:\n      - AccountId\n      - CreditDebitIndicator\n      - Status\n      - BookingDateTime\n      - Amount\n    properties:\n      AccountId:\n        $ref: '#/definitions/AccountId'\n      TransactionId:\n        $ref: '#/definitions/TransactionId'\n      TransactionReference:\n        $ref: '#/definitions/TransactionReference'\n      StatementReference:\n        type: array\n        items:\n          $ref: '#/definitions/StatementReference'\n      CreditDebitIndicator:\n        $ref: '#/definitions/OBCreditDebitCode'\n      Status:\n        $ref: '#/definitions/OBEntryStatus1Code'\n      BookingDateTime:\n        $ref: '#/definitions/BookingDateTime'\n      ValueDateTime:\n        $ref: '#/definitions/ValueDateTime'\n      TransactionInformation:\n        $ref: '#/definitions/TransactionInformation'\n      AddressLine:\n        $ref: '#/definitions/AddressLine'\n      Amount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      ChargeAmount:\n        $ref: '#/definitions/OBActiveOrHistoricCurrencyAndAmount'\n      CurrencyExchange:\n        $ref: '#/definitions/OBCurrencyExchange5'\n      BankTransactionCode:\n        $ref: '#/definitions/OBBankTransactionCodeStructure1'\n      ProprietaryBankTransactionCode:\n        $ref: '#/definitions/ProprietaryBankTransactionCodeStructure1'\n      Balance:\n        $ref: '#/definitions/OBTransactionCashBalance'\n      MerchantDetails:\n        $ref: '#/definitions/OBMerchantDetails1'\n      CreditorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      CreditorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      DebtorAgent:\n        $ref: '#/definitions/OBBranchAndFinancialInstitutionIdentification6'\n      DebtorAccount:\n        $ref: '#/definitions/OBCashAccount6'\n      CardInstrument:\n        $ref: '#/definitions/OBTransactionCardInstrument1'\n      SupplementaryData:\n        $ref: '#/definitions/OBSupplementaryData1'\n  AccountId:\n    description: >-\n      A unique and immutable identifier used to identify the account resource.\n      This identifier has no meaning to the account owner.\n    type: string\n    minLength: 1\n    maxLength: 40\n  OBAccountStatus1Code:\n    description: Specifies the status of account resource in code form.\n    type: string\n    enum:\n      - Deleted\n      - Disabled\n      - Enabled\n      - Pending\n      - ProForma\n  ActiveOrHistoricCurrencyCode:\n    description: >-\n      Identification of the currency in which the account is held.\n\n      Usage: Currency should only be used in case one and the same account\n      number covers several currencies\n\n      and the initiating party needs to identify which currency needs to be used\n      for settlement on the account.\n    type: string\n    pattern: '^[A-Z]{3,3}$'\n  OBExternalAccountType1Code:\n    description: Specifies the type of account (personal or business).\n    type: string\n    enum:\n      - Business\n      - Personal\n  OBExternalAccountSubType1Code:\n    description: Specifies the sub type of account (product family group).\n    type: string\n    enum:\n      - ChargeCard\n      - CreditCard\n      - CurrentAccount\n      - EMoney\n      - Loan\n      - Mortgage\n      - PrePaidCard\n      - Savings\n  Description:\n    description: Specifies the description of the account type.\n    type: string\n    minLength: 1\n    maxLength: 35\n  Nickname:\n    description: >-\n      The nickname of the account, assigned by the account owner in order to\n      provide an additional means of identification of the account.\n    type: string\n    minLength: 1\n    maxLength: 70\n  OBExternalAccountIdentification4Code:\n    description: >-\n      Name of the identification scheme, in a coded form as published in an\n      external list.\n    type: string\n    x-namespaced-enum:\n      - UK.OBIE.BBAN\n      - UK.OBIE.IBAN\n      - UK.OBIE.PAN\n      - UK.OBIE.Paym\n      - UK.OBIE.SortCodeAccountNumber\n  Identification:\n    description: >-\n      Identification assigned by an institution to identify an account. This\n      identification is known by the account owner.\n    type: string\n    minLength: 1\n    maxLength: 256\n  Name:\n    description: >-\n      The account name is the name or names of the account owner(s) represented\n      at an account level, as displayed by the ASPSP's online channels.",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0165_4",
          "text": "### Retrieve a consent \n- An API consumer can retrieve a consent resource that they have created to check its status. In order to make this request, \nthe API consumer must have an access token issued by the bank using the client credentials grant.\n\n??? tip \"Click here to find how to generate an application access token...\"\n    - Generate an application access token using the following command: \n      ```\n      curl -X POST \\\n      https://<IS_HOST>:9446/oauth2/token \\\n      --cert <TRANSPORT_PUBLIC_KEY_FILE_PATH> --key <TRANSPORT_PRIVATE_KEY_FILE_PATH> \\\n      -d 'grant_type=client_credentials&scope=accounts%20openid&client_assertion=eyJraWQiOiJEd01LZFdNbWo3UFdpbnZvcWZReVhWe\n      nlaNlEiLCJhbGciOiJQUzI1NiJ9.eyJzdWIiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6OT\n      Q0Ni9vYXV0aDIvdG9rZW4iLCJpc3MiOiJIT1VrYVNieThEeWRuYmVJaEU3bHljYmtJSThhIiwiZXhwIjoxNjg0MDk5ODEyLCJpYXQiOjE2ODQwOTk4\n      MTMsImp0aSI6IjE2ODQwOTk4MTIifQ.EMZ2q3jciJ4MmrsH93kH_VGacrt2izbLaCBchGWiyUltdWwj3GwDMKfhpeMHtThd0DszwV8LUPKZaMT3wUS\n      oH3adY2IBC8aa2GKeb_vaQB5b0ZO6WpYQ45y_xIttAVj56d6oPli8wN4MlJoJsFPUlaxQohCLunN43BxSr-kFgeFMj7ynEsVbQvuYuEiTppwTSyXlt\n      Jmv70-nwpGU9UyuPCkXUsU53ShICrY0nC-3NUhY6oNpZclJP4MwG8mP4ZOvUIez_PSoP3AiaNithWhPCfLuKd68OLAReTBGdItqidsWWnn8lPVbM2F\n      LvehukHDCJhf9-ev1pdWIiwDSVDV7uQ&redirect_uri=www.wso2.com'\n      ```\n      - The request payload contains a client assertion in the following format:\n      ```\n      {\n      \"alg\": \"<<The algorithm used for signing>>\",\n      \"kid\": \"<<The KID value of the signing jwk set>>\",\n      \"typ\": \"JWT\"\n      }\n        \n      {\n      \"iss\": \"<<This is the issuer of the token. For example, client ID of your application>>\",\n      \"sub\": \"<<This is the subject identifier of the issuer. For example, client ID of your application>>\",\n      \"exp\": <<This is epoch time of the token expiration date/time>>,\n      \"iat\": <<This is epoch time of the token issuance date/time>>,\n      \"jti\": \"<<This is an incremental unique value>>\",\n      \"aud\": \"<<This is the audience that the ID token is intended for. For example, https://<APIM_HOST>:8243/token>>\"\n      }\n        \n      <signature: For DCR, the client assertion is signed by the private key of the signing certificate. Otherwise the private\n      signature of the application certificate is used.>\n      ```\n      - Upon successful token generation, you obtain a token as follows:\n      ```\n      {\n         \"access_token\":\"aa8ce78b-d81e-3385-81b1-a9fdd1e71daf\",\n         \"scope\":\"accounts payments  openid\",\n         \"id_token\":\"eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZyIsImtpZCI6Ik16WXhNbUZrT0dZd01XSTBaV05tTkRjeE5HWXdZbU00WlRBM01XSTJOREF6WkdRek5HTTBaR1JsTmpKa09ERmtaRFJpT1RGa01XRmhNelUyWkdWbE5nX1JTMjU2IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiaHVBcS1GbzB0N2pFZmtiZ1A4TkJwdyIsImF1ZCI6WyJrYkxuSkpfdVFMMlllNjh1YUNSYlBJSk9SNFVhIiwiaHR0cDpcL1wvb3JnLndzbzIuYXBpbWd0XC9nYXRld2F5Il0sInN1YiI6ImFkbWluQHdzbzIuY29tQGNhcmJvbi5zdXBlciIsIm5iZiI6MTYwMTk5MzA5OCwiYXpwIjoia2JMbkpKX3VRTDJZZTY4dWFDUmJQSUpPUjRVYSIsImFtciI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwic2NvcGUiOlsiYW1fYXBwbGljYXRpb25fc2NvcGUiLCJvcGVuaWQiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo4MjQzXC90b2tlbiIsImV4cCI6MTYwMTk5NjY5OCwiaWF0IjoxNjAxOTkzMDk4fQ.cGdQ-9qK5JvKW32lK_PqhyJZyRb3r_86UPRFI2hlgiScnLYD8RsXDBNalmmnHiAbfb06e69QHQnmEKa6pcSSFWor0OAuzisBb6C5V51E9vH0eCr4hIa_lBtmjvLmsSue7puRUaYcyptwiuUkwjLFb-3_cpeuzWH29Knwne6zVD8gav_FPi1ub4vkrkX8ktLZH_JQG20fim1Ai5j2Q7jcnaMIHShYnC9sLBP5usp3thFLdQEyH8KCHJK79yNKzaruUntkq9yqqO_MQvY7VevLlDEDPllniRVih0r4TICdGrgJ0Ibr4wh_xFksVhYqa2_6x71ed_K9SX3hG-6T6pBUVA\",\n         \"token_type\":\"Bearer\",\n         \"expires_in\":3600\n      }\n      ```\n- A sample request to retrieve a consent looks as follows:\n```\ncurl GET \\\n  https://<APIM_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID> \\\n  -H 'x-fapi-financial-id: open-bank' \\\n  -H 'Authorization: Bearer <APPLICATION_ACCESS_TOKEN>' \\\n  -H 'Accept: application/json' \\\n  -H 'charset: UTF-8' \\\n  -H 'Content-Type: application/json; charset=UTF-8' \\\n  --cert <PUBLIC_KEY_FILE_PATH> --key <PRIVATE_KEY_FILE_PATH>\n```\n- A sample response looks as follows:\n```\n{\n    \"Meta\": {\n        \"TotalPages\": 1\n    },\n    \"Risk\": {},\n    \"Links\": {\n        \"Self\": \"https://<IS_HOST>:8243/open-banking/v3.1/aisp/account-access-consents/<CONSENT_ID>\"\n    },\n    \"Data\": {\n        \"Status\": \"Authorised\",\n        \"StatusUpdateDateTime\": \"2020-10-07T12:46Z\",\n        \"CreationDateTime\": \"2020-10-07T09:29Z\",\n        \"TransactionToDateTime\": \"2020-10-09T10:28:49+05:30\",\n        \"ExpirationDateTime\": \"2020-10-11T10:28:49+05:30\",\n        \"Permissions\": [\n            \"ReadAccountsDetail\",\n            \"ReadBalances\",\n            \"ReadTransactionsDetail\"\n        ],\n        \"ConsentId\": \"41042513-fa45-4da8-93be-1513b3caffac\",\n        \"TransactionFromDateTime\": \"2020-10-06T10:28:49+05:30\"\n    }\n}\n```",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0165_5",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'The WSO2 Financial Services Accelerator supports including booking balance in account details when the `withBalance` query parameter is true and PSU consent permits balance access. This functionality is primarily handled through the Account Information APIs, specifically the `/accounts` and `/accounts/{AccountId}/balances` endpoints, and is governed by consent management.  \\n\\n## Implementation Details\\n\\nThe system defines API endpoints for retrieving account information and balances. The `account-info-swagger.yaml` file specifies the OpenAPI definition for these endpoints.  \\n\\nThe `/accounts/{AccountId}/balances` endpoint is specifically designed to retrieve balance information for a given account.  The response for this endpoint is defined by `OBReadBalance1`, which includes an array of `Balance` objects, each containing details like `AccountId`, `Amount`, `CreditDebitIndicator`, and `Type`. \\n\\nConsent for accessing balances is managed through permissions such as `ReadBalances`.  The `permissionDataLanguage.js` file in the self-care portal frontend also indicates that \"ReadBalances\" permission corresponds to \"All your balance information\". \\n\\nThe `AccountService.java` in the demo backend provides a sample implementation for the `/accounts/{AccountId}/balances` endpoint, returning a hardcoded JSON response with balance details.  This demonstrates how the balance information would be structured in a response. \\n\\n## API Endpoints and Features\\n\\nThe relevant API endpoints are:\\n*   `/accounts`: Used to get a list of accounts. \\n*   `/accounts/{AccountId}`: Used to get details of a specific account. \\n*   `/accounts/{AccountId}/balances`: Used to retrieve balance information for a specific account. \\n\\nThe `x-scope: accounts` is associated with these endpoints, indicating the required OAuth scope for access.   \\n\\n## Test Criteria\\n\\nIntegration tests confirm the functionality of retrieving account balances. The `EndToEndAccountFlowTest.groovy` includes a test case \"Verify Accounts balances Retrieval Request for a Authorised Consent\" which asserts a 200 status code for a request to the `/accounts/{AccountId}/balances` endpoint after a consent has been authorized. \\n\\nThe `FSConnectorTest.groovy` and `FSAPIMConnectorTest.groovy` files contain methods like `doDefaultInitiationWithoutReadBalances()` which are used to test scenarios where consent for reading balances is not provided.   These tests ensure that the system correctly handles cases where balance access is not permitted. \\n\\n## Notes\\n\\nThe provided codebase snippets do not explicitly show a `withBalance` query parameter in the OpenAPI definition for the `/accounts` endpoint.  However, the existence of a dedicated `/accounts/{AccountId}/balances` endpoint  and the `ReadBalances` permission  strongly suggest that balance information is accessible, and its inclusion in account details would be governed by consent. The system\\'s modular architecture and extension framework, as described in the \"Overview\" wiki page, would allow for customization to include such a parameter if not directly supported by the current API definition. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_2ae2126e-39f7-4e63-9832-200c36118ce6\\n', 'id': 'lc_496ba3f7-2aaf-4770-a384-c82e0d697c8a'}]",
          "capability": "Account Information",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0166",
      "requirement": {
        "requirement_id": "ATOM_037",
        "requirement_text": "The POST funds-confirmations endpoint SHALL be mandatory for checking whether a specific amount is available at point of time of the request on an account",
        "strength": "MANDATORY",
        "capability": "Funds Confirmation",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Funds Confirmation",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0166_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'Based on the provided codebase context, there is no direct support for a `POST /funds-confirmations` endpoint for checking fund availability on an account <cite/>. The snippets provided primarily relate to authentication, authorization, and identity management within the WSO2 Identity Server project   .\\n\\n## Implementation Details\\nThe codebase snippets do not contain any implementation details related to a `POST /funds-confirmations` endpoint <cite/>. The `AuthorizationDetailsType` class, for instance, defines a schema that includes `payment_initiation` as a type, and `instructedAmount` as a property within that schema . However, this appears to be part of an authorization details schema and not an API endpoint for funds confirmation .\\n\\n## Configuration Options\\nThere are no configuration options visible in the provided code snippets that would enable or configure a `POST /funds-confirmations` endpoint <cite/>.\\n\\n## API Endpoints or Features\\nThe provided code snippets do not expose any API endpoints or features directly related to `POST /funds-confirmations` <cite/>. The `getResponseOfJSONPost` method is a utility for sending JSON POST requests to a given `endpointUri` . While it demonstrates how POST requests are made, it does not indicate the existence of the specific `funds-confirmations` endpoint . Similarly, the test cases like `testSendInitAuthRequestPost` and `testSendFederatedAuthRequestPost` involve sending POST requests to authorization endpoints, which are distinct from funds confirmation  .\\n\\n## Documentation References\\nNo documentation references within the provided snippets point to a `POST /funds-confirmations` endpoint <cite/>. The `AuthorizationDetailsType` class does reference JSON Schema documents, but this is for defining the structure of authorization details, not for an API endpoint specification .\\n\\n## Notes\\nThe provided code snippets are primarily from integration tests and model definitions within the `wso2/product-is` repository   . While some snippets mention \"payment_initiation\" and \"instructedAmount\" , these are within the context of authorization details types and not indicative of a dedicated funds confirmation API . The codebase does not appear to contain the specific `POST /funds-confirmations` endpoint you are looking for <cite/>.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_4b801873-16d2-4e39-ae4f-d7448f6eebfb\\n', 'id': 'lc_d8f805ca-584b-4062-99b4-90c95b1a8d32'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0166_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'Based on the provided code snippets, the repository `wso2/product-apim` does not appear to directly support a `POST /funds-confirmations` endpoint for checking fund availability on an account. The snippets primarily show examples of API management, backend service implementations for a coffee sample, and API validation.\\n\\nHowever, there is a `doPayment` method in `StarbucksOutletServiceImpl.java` that includes a check for \"Insufficient Funds\" . This method is part of a sample JAX-RS application and demonstrates a payment processing flow, not a dedicated funds confirmation endpoint.\\n\\n### Implementation Details\\n\\nThe `StarbucksOutletServiceImpl.java` file contains a `doPayment` method that takes an `id` and a `Payment` object as parameters . Inside this method, there\\'s a check `!order.isAmountAcceptable(amount)` . If this condition is true, a `PaymentStatus` with the message \"Insufficient Funds\" is returned . This suggests a basic form of fund availability check within a payment context.\\n\\n### API Endpoints or Features\\n\\nWhile there isn\\'t a direct `POST /funds-confirmations` endpoint, the `StarbucksOutletServiceImpl` class defines several JAX-RS endpoints related to order and payment processing . The `doPayment` method handles payment requests and includes a check for sufficient funds .\\n\\nOther snippets show general API definitions and validation, such as `ValidationApi.java` for validating API endpoints  and `store-api.yaml` which describes various API collection operations like retrieving and searching APIs . These are not directly related to funds confirmation.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests and sample applications within the `wso2/product-apim` repository. The `StarbucksOutletServiceImpl.java` file, which contains the `doPayment` method with a fund check, is part of a \"coffeesample\" JAX-RS application . This suggests it\\'s an example of a backend service that could be exposed via the API Manager, rather than a core component of the API Manager itself providing a generic `funds-confirmations` endpoint. Therefore, while a fund check mechanism exists in a sample, there is no explicit `POST /funds-confirmations` endpoint in the core API Manager functionality based on the provided context.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_ee9934f2-b2e5-4085-bb6d-70256e507856\\n', 'id': 'lc_8318175e-a281-4279-a90c-dab67b99dd12'}]",
          "capability": "Funds Confirmation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0167",
      "requirement": {
        "requirement_id": "ATOM_076",
        "requirement_text": "The system may add additional data attributes to response messages and shall document these extensions in ASPSP XS2A interface documentation",
        "strength": "MAY",
        "capability": "General",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0167_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, supports the addition of data attributes to response messages through its API layer, particularly within the context of SCIM2 schemas and application management. The system allows for defining and extending attributes, which can then be included in API responses. Documentation of these extensions would typically be handled through the API\\'s Swagger/OpenAPI definitions.\\n\\n### Implementation Details\\n\\nThe WSO2 Identity Server\\'s API Layer is built using Apache CXF and JAX-RS, with API definitions managed in `web.xml` . This framework allows for the definition of various API endpoints and their corresponding service classes.\\n\\nFor extending data attributes in response messages, the SCIM2 API is a relevant component. The `scim2.yaml` file defines the structure of SCIM schemas, including attributes and sub-attributes . This schema includes properties like `displayName`, `description`, `type`, `required`, `mutability`, and `returned`, which dictate how attributes are handled and presented in API responses .\\n\\nIn the context of application management, the `AdvancedApplicationConfiguration.java` model includes a list of `AdditionalSpProperties` . This suggests a mechanism to add custom properties to service provider configurations, which could be reflected in API responses. Similarly, the `UserObject.java` model includes extensions for SCIM schemas, such as `ScimSchemaExtensionEnterprise` and `ScimSchemaExtensionSystem` . These extensions allow for additional, custom attributes to be associated with user objects and potentially returned in API responses.\\n\\n### Configuration Options\\n\\nThe `web.xml` configuration for the API layer specifies `jaxrs.serviceClasses` and `jaxrs.providers` . To add new data attributes, you would typically extend existing API models or create new ones, and then ensure these are correctly registered as `jaxrs.serviceClasses` or handled by custom `jaxrs.providers`.\\n\\nFor SCIM2, the `scim2.yaml` defines the schema, and any extensions would involve modifying or extending this schema definition to include new attributes .\\n\\n### API Endpoints or Features\\n\\nThe API Layer supports various API categories, including Server APIs and User APIs, with versioning in the URL path (e.g., `/api/server/v1/applications`) . The `ExtensionManagementBaseTest` and `ExtensionManagementSuccessTest` classes indicate the presence of an Extension Management API, accessible via `/extensions` . This API likely provides mechanisms to manage and retrieve information about extensions, including those related to data attributes.\\n\\nThe `ApplicationManagementAPI` and `UserApplicationAPI` are key endpoints that could return extended data attributes related to applications and users respectively. For instance, the `ApplicationResponseModel` would be the structure for responses from the Application Management API .\\n\\n### Documentation References\\n\\nThe API Layer wiki page mentions that \"This document describes the architecture, components, and functionality of the API Layer\" . It also states that \"For information about specific API implementations, see Identity and Access Management Core\" . This suggests that detailed documentation for API extensions would be found within the project\\'s documentation, likely generated from Swagger/OpenAPI definitions like `scim2.yaml` . The presence of `swaggerDefinition` in `ExtensionManagementBaseTest` further supports the use of Swagger for API documentation .\\n\\n## Notes\\n\\nThe provided snippets indicate that the system has mechanisms for defining and managing extensions, particularly within the SCIM2 context and application configurations. While the snippets don\\'t explicitly detail a generic \"data attribute extension\" mechanism for all response messages, the presence of `AdditionalSpProperties` in application models  and SCIM schema extensions  suggests that the architecture is designed to be extensible. The documentation of these extensions would typically be part of the API\\'s Swagger/OpenAPI specification, which is used to generate client-side documentation.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_6e1945b2-20c5-45f7-ac85-4a5df65241c7\\n', 'id': 'lc_005bb793-bd9e-4dd4-a7e5-4972b71a63a0'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0167_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, supports adding additional data attributes to response messages through its XPath Extension Framework and provides documentation for these extensions. The system allows for defining custom XPath variables and functions to expose dynamic values from the message context, which can be used to add data attributes to responses.   \\n\\n## Implementation Details\\n\\nThe core mechanism for extending data attributes in response messages is the XPath Extension Framework.    This framework allows for the creation of custom XPath variable expressions and XPath function expressions.   \\n\\n### Custom XPath Variables\\n\\nTo implement a custom XPath variable, you need to implement the `org.apache.synapse.util.xpath.ext.SynapseXpathVariableResolver` interface.    This interface has two methods: `#getResolvingQName` to define the variable name and `#resolve` to provide the logic for resolving the variable\\'s value.    An example provided in the documentation shows how to implement a `HELLO_WORLD` custom XPath variable that returns an XML message.   \\n\\n### Custom XPath Functions\\n\\nThe framework also supports custom XPath functions.    The documentation mentions `synapse:get-property()` as an example of an XPath function that can retrieve information from the message context.    This function can access properties set by mediators, or information from Synapse or Axis2 message contexts, or transport headers.   \\n\\n## Configuration Options\\n\\nExtensions are loaded by the Synapse runtime using the J2SE Service Provider model.  This involves placing JAR files containing the extension implementations in the `ESB_HOME/repository/components/dropins` folder.  The JAR files should contain a `META-INF/services` directory with text files named `org.apache.synapse.config.xml.MediatorFactory` and `org.apache.synapse.config.xml.MediatorSerializer`, listing the fully qualified class names of the implementations. \\n\\n## API Endpoints or Features\\n\\nThe `wso2/product-apim` repository, specifically within the `all-in-one-apim/modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/am/integration/tests/oas/OASBaseUtils.java` file, demonstrates the validation of Swagger extension data in the Publisher.  This includes checking for custom extensions like `x-wso2-auth-header`, `x-throttling-tier`, `x-wso2-basePath`, `x-wso2-cors`, `x-wso2-production-endpoints`, `x-wso2-sandbox-endpoints`, and `x-wso2-transports`.  These `x-wso2` extensions indicate that the system supports adding custom attributes to API definitions, which can then influence response messages. \\n\\n## Documentation References\\n\\nThe documentation for these extensions is primarily found in the `extensions_guide.xml` files across different modules:\\n*   `wso2/product-apim/all-in-one-apim/docs/xdoc/extensions_guide.xml`  \\n*   `wso2/product-apim/api-control-plane/docs/xdoc/extensions_guide.xml`   \\n*   `wso2/product-apim/gateway/docs/xdoc/extensions_guide.xml`   \\n*   `wso2/product-apim/traffic-manager/docs/xdoc/extensions_guide.xml`  \\n\\nThese documents detail how to write custom mediator implementations, configure mediators, and specifically how to use the XPath Extension Framework to define custom variables and functions.   \\n\\n## Notes\\n\\nThe provided context primarily focuses on the WSO2 ESB (Enterprise Service Bus) and Synapse, which are underlying technologies used within WSO2 API Manager. The \"ASPSP XS2A interface documentation\" mentioned in the prompt is not directly found in the provided snippets. However, the general extension mechanisms described, particularly the XPath Extension Framework, would be the means by which such specific data attributes could be added and documented within the broader WSO2 API Management context. The `OASBaseUtils.java` file provides concrete examples of how custom extensions (`x-wso2-*`) are validated, suggesting that these are indeed part of the system\\'s capabilities and would be documented. \\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_0b2535de-83f7-41cf-ae8b-4c9b3c2b0c0a\\n', 'id': 'lc_a53bd17b-bcea-4874-a30e-90f9a5586685'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0168",
      "requirement": {
        "requirement_id": "ATOM_036",
        "requirement_text": "The DELETE consents/{consentId} endpoint SHALL be mandatory for terminating the addressed consent",
        "strength": "MANDATORY",
        "capability": "Consent Management",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Consent Management",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0168_1",
          "text": "## **Usage** **>> consent-cleanup.sql** This is a consent data cleanup script with batch wise delete, This procedure includes the cleanup of consents from the respective tables of *FS_CONSENT* , *FS_CONSENT_AUTH_RESOURCE* , *FS_CONSENT_MAPPING* , *FS_CONSENT_FILE* , *FS_CONSENT_ATTRIBUTE* , *FS_CONSENT_STATUS_AUDIT* 1. Compile the stored procedure. 2. Execute the compiled store procedure. **Data retention feature:** - If enabled, all the purged consents will be stored in temporary retention tables in the consent database. *- Logical condition and configs used for consent purging and data retention.* *CONSENT DATA PURGING PARAMETERS* - `consentTypes` - consent_types which should be eligible for purging. (ex : 'accounts,payments', leave as empty to skip) - `clientIds` - client_ids which should be eligible for purging. (leave as empty to skip) - `consentStatuses` - consent_statuses which should be eligible for purging. (ex : 'expired,revoked') - `purgeConsentsOlderThanXNumberOfDays` - time period to delete consents older than `n` days. (check below for more info.) - `lastUpdatedTime` - last_updated_time for purging, (if consent's updated time is older than this value then it's eligible for purging, check below for more info.) - Here if we wish to purge consents with last updated_time older than 31 days (1 month), we can configure `purgeConsentsOlderThanXNumberOfDays` = `31` this value is in no. of days. - If we wish to configure exact timestamp of the `lastUpdatedTime` rather than a time period, we can ignore configuring `purgeConsentsOlderThanXNumberOfDays` = `NULL`, and only configure lastUpdatedTime with exact unix timestamp. - `ex : lastupdatedtime = 1660737878;` *CONSENT DATA RETENTION PARAMETERS* - `enableDataRetention` - set true for enable data retention (archive purged data, default : false) - Note: When running backup procedure (consent-cleanup-restore.sql) to restore back the purged data with the retention feature enabled, make sure to clean retention tables to avoid duplicates when purging again. Note: below data retention parameters need to set in the scripts before compiling, Ignore if data retention is not enabled. - `enableDataRetentionForAuthResourceAndMapping` - enable storing auth resource and consent mapping tables for retention data. - `enableDataRetentionForFsConsentFile` - enable storing fs_consent_file table for retention data. - `enableDataRetentionForFsConsentAttribute` - enable storing fs_consent_attribute table for retention data. - `enableDataRetentionForFsConsentStatusAudit` - enable storing fs_consent_status_audit table for retention data. *OTHER PARAMETERS* - `backupTables` - enable the backup table to restore later at a later stage. (Please note this backup tables will be overwritten every time you run the cleanup script.). - Also, this would not capture the consents which were created in between the backup task and the cleanup iteration, hence if consents created after the backup task will not be able to restore if its get deleted from the cleanup iteration. - `enableAudit` - By setting this parameter to true, will log each of deleted consents in the auditlog_fs_consent_cleanup table for track them in a later time. Once compiled the stored procedure, We can execute the procedure with input parameters as in below example. (for mysql) ``` WSO2_FS_CONSENT_CLEANUP_SP( consentTypes, clientIds, consentStatuses, purgeConsentsOlderThanXNumberOfDays, lastUpdatedTime, backupTables, enableAudit, analyzeTables, enableDataRetention ); ``` ``` Ex: mysql> call WSO2_FS_CONSENT_CLEANUP_SP('accounts,payments', 'clientId1,clientId2', 'expired,revoked', 31, NULL, TRUE, TRUE, TRUE, FALSE); ``` Please refer the README.md file on each DB type for more information. *CONFIGURABLE",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0168_2",
          "text": "### deleteConsentAttributes method\n\nThis method lets you delete a provided list of consent attributes for a particular consent.\n\n``` java\nboolean deleteConsentAttributes(String consentID, ArrayList<String> attributeKeysList) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0168_3",
          "text": "### revokeExistingApplicableConsents method\n\nThis method lets you revoke existing consents for a given combination of `clientID`, `userID`, `consent type`, and \n`status` parameters. It also revokes any tokens related to the consents if the `shouldRevokeTokens` flag is set to `true`.\n\n``` java\nboolean revokeExistingApplicableConsents(String clientID, String userID, String consentType, String applicableStatusToRevoke, String revokedConsentStatus, boolean shouldRevokeTokens) throws ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0168_4",
          "text": "## **Data retention**\n\nThis feature is used for archival purposes of the data that we purge using the consent purging scripts.\n  \n**Instructions for enabling data retention**\n\n- Configure in the consent data purging script with types of data to be archived as below,\n```\n    SET enableDataRetentionForAuthResourceAndMapping = TRUE;\n    SET enableDataRetentionForFsConsentFile = FALSE;\n    SET enableDataRetentionForFsConsentAttribute = FALSE;\n    SET enableDataRetentionForFsConsentStatusAudit = TRUE; \n```\n- Execute purging script with data retention enabled,\n\n```\nWSO2_FS_CONSENT_CLEANUP_SP(\n                consentTypes,\n                clientIds,\n                consentStatuses,\n                purgeConsentsOlderThanXNumberOfDays,\n                lastUpdatedTime,\n                backupTables,\n                enableAudit,\n                analyzeTables,\n                enableDataRetention\n);\n```\n\n- This will create temporary retention consent tables in consent DB with `RET_` prefix and store the purged data temporary to these tables.",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0168_5",
          "text": "### createExclusiveConsent method\n\nThis method lets you create an exclusive consent by performing the following:\n\n - Updates existing consent statuses and deactivate their account mappings\n - Creates an audit record for the consent update\n - Creates a new authorizable consent\n - If a periodical job for consent expiration is enabled, in order to make a consent eligible for expiration,\n    - Append the `ExpirationDateTime` UTC timestamp attribute to `consentResource.getConsentAttributes()`.\n\n``` java\nDetailedConsentResource createExclusiveConsent(ConsentResource consentResource, \n  String userID, String authStatus,\n  String authType, String applicableExistingConsentsStatus,\n  String newExistingConsentStatus, boolean isImplicitAuth)\nthrows ConsentManagementException;\n```",
          "capability": "Consent Management",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0169",
      "requirement": {
        "requirement_id": "ATOM_081",
        "requirement_text": "The TPP MAY send an SCA status request to follow the SCA process during implicit authorisation",
        "strength": "MAY",
        "capability": "Payment Initiation",
        "section_id": "648825991d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Payment Initiation",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0169_1",
          "text": "PSUOAuth2Security:\n      type: \"oauth2\"\n      description: \"OAuth flow, it is required when the PSU needs to perform SCA with the ASPSP when a TPP wants to access an ASPSP resource owned by the PSU\"\n      flows:\n        authorizationCode:\n          authorizationUrl: \"https://authserver.example/authorization\"\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"\n\n    default:\n      type: \"oauth2\"\n      flows:\n        implicit:\n          authorizationUrl: \"https://test.com\"\n          scopes:\n            payments: \"Generic payment scope\"\n          x-scopes-bindings:\n            payments: \"Internal/consumer\"\n  schemas:\n    secondaryIdentification:\n      description: \"This is secondary identification of the account, as assigned by the account servicing institution. \\nThis can be used by building societies to additionally identify accounts with a roll number (in addition to a sort code and account number combination).\"\n      type: \"string\"\n      minLength: 1\n      maxLength: 34\n\n    activeOrHistoricCurrencyCode:\n      description: \"A code allocated to a currency by a Maintenance Agency under an international identification scheme, as described in the latest edition of the international standard ISO 4217 \\\"Codes for the representation of currencies and funds\\\".\"\n      type: \"string\"\n      pattern: \"^[A-Z]{3,3}$\"\n\n    isoDateTime:\n      description: \"All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n      type: \"string\"\n      format: \"date-time\"\n\n    meta:\n      title: \"MetaData\"\n      type: \"object\"\n      additionalProperties: false\n      description: \"Meta Data relevant to the payload\"\n      properties:\n        TotalPages:\n          type: \"integer\"\n          format: \"int32\"\n        FirstAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n        LastAvailableDateTime:\n          $ref: \"#/components/schemas/isoDateTime\"\n\n    obActiveCurrencyAndAmount_SimpleType:\n      description: \"A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217.\"\n      type: \"string\"\n      pattern: \"^\\\\d{1,13}$|^\\\\d{1,13}\\\\.\\\\d{1,5}$\"\n\n    obError1:\n      type: object\n      properties:\n        code:\n          description: 'error code'\n          type: string\n        message:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 500\n        description:\n          description: >-\n            A description of the error that occurred. e.g., 'A mandatory field\n            isn't supplied' or 'RequestedExecutionDateTime must be in future'\n          type: string\n          minLength: 1\n          maxLength: 1000\n      required:\n        - code\n        - message\n        - description\n      additionalProperties: false\n      minProperties: 1\n    obErrorResponse1:\n      type: object\n      properties:\n        errors:\n          type: array\n          items:\n            $ref: '#/components/schemas/obError1'\n          minItems: 1\n    obWriteFundsConfirmationResponse1:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          properties:\n            FundsAvailableResult:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"FundsAvailableDateTime\"\n                - \"FundsAvailable\"\n              description: \"Result of a funds availability check.\"\n              properties:\n                FundsAvailableDateTime:\n                  description: \"Date and time at which the funds availability check was generated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n                  type: \"string\"\n                  format: \"date-time\"\n                FundsAvailable:\n                  description: \"Flag to indicate the availability of funds given the Amount in the consent request.\"\n                  type: \"boolean\"\n            SupplementaryData:\n              $ref: \"#/components/schemas/obSupplementaryData1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"\n\n    obExternalLocalInstrument1Code:\n      description: \"User community specific instrument.\\nUsage: This element is used to specify a local instrument, local clearing option and/or further qualify the service or service level.\"\n      type: \"string\"\n      x-namespaced-enum:\n        - \"UK.OBIE.BACS\"\n        - \"UK.OBIE.BalanceTransfer\"\n        - \"UK.OBIE.CHAPS\"\n        - \"UK.OBIE.Euro1\"\n        - \"UK.OBIE.FPS\"\n        - \"UK.OBIE.Link\"\n        - \"UK.OBIE.MoneyTransfer\"\n        - \"UK.OBIE.Paym\"\n        - \"UK.OBIE.SEPACreditTransfer\"\n        - \"UK.OBIE.SEPAInstantCreditTransfer\"\n        - \"UK.OBIE.SWIFT\"\n        - \"UK.OBIE.Target2\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0169_2",
          "text": "The **API Consumer Validation** service in WSO2 Open Banking allows banks to validate API consumers from the National \nCompetent Authorities (NCAs). This is done by validating the transport layer certificate an API consumer has obtained. \n\n!!!note\n    By default, WSO2 Open Banking Accelerator supports a sample API flow to get account information and to initiate a \n    payment. Therefore, the following configuration exists in `<APIM_HOME>/repository/conf/deployment.toml` by default:\n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = false\n    implementation_path = \"\"\n    cache_expiry = 3600\n    [open_banking.gateway.tpp_management.psd2_role_validation]\n    enabled = true\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"accounts\"\n    roles = \"AISP, PISP\"\n    [[open_banking.gateway.tpp_management.allowed_scopes]]\n    name = \"payments\"\n    roles = \"PISP\"\n    ```\n\nAccording to your requirements, you can extend and override the methods in the `TPPValidationService` class.\n\nTo write a custom API consumer validation executor, extend the following class:\n```java\ncom.wso2.openbanking.accelerator.gateway.executor.service.TPPValidationService\n```\n\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###validate method\n\nValidates the roles and returns a boolean response as follows:\n\n- If the roles match with the roles in the transport certificate, the returned value is `true`.\n- Else, the returned value is `false`.\n\nGiven below is the method signature:\n```java\nboolean validate(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n###getCacheKey method\n\nReturns the cache key used for caching the responses and an ID that is unique to the API flow. Given below is the method \nsignature:\n```java\nString getCacheKey(X509Certificate peerCertificate,\n  List < PSD2RoleEnum > requiredPSD2Roles, Map < String, Object > metadata)\nthrows TPPValidationException;\n```\n\n##Configuration\n\n- Open `<APIM_HOME>/repository/conf/deployment.toml` and locate the following to configure your custom API Consumer \nValidation class:\n    1. Set the `enabled` tag to `true`.\n    2. Add the implemented class under `implementation_path`.\n    \n    ```toml\n    [open_banking.gateway.tpp_management.tpp_validation]\n    enabled = true\n    implementation_path = \"<FQN of the extended class>\"\n    cache_expiry = 3600\n    ```",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0169_3",
          "text": "x-fapi-interaction-id:\n      in: \"header\"\n      name: \"x-fapi-interaction-id\"\n      required: false\n      description: \"An RFC4122 UID used as a correlation id.\"\n      schema:\n        type: \"string\"\n\n    authorization:\n      in: \"header\"\n      name: \"authorization\"\n      required: true\n      description: \"An Authorisation Token as per https://tools.ietf.org/html/rfc6750\"\n      schema:\n        type: \"string\"\n\n    x-idempotency-key:\n      name: \"x-idempotency-key\"\n      in: \"header\"\n      description: \"Every request will be processed only once per x-idempotency-key.  The\\nIdempotency Key will be valid for 24 hours.\\n\"\n      required: true\n      schema:\n        type: \"string\"\n        maxLength: 40\n        pattern: \"^(?!\\\\s)(.*)(\\\\S)$\"\n\n  responses:\n\n    201PaymentsCreated:\n      description: \"Payments Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentsPaymentIdRead:\n      description: \"Payments Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentResponse5\"\n\n    200PaymentConsentsConsentIdRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    200PaymentConsentsConsentIdFundsConfirmationRead:\n      description: \"Payment Consents Read\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWriteFundsConfirmationResponse1\"\n\n    201PaymentConsentsCreated:\n      description: \"Payment Consents Created\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obWritePaymentConsentResponse5\"\n\n    400Error:\n      description: \"Bad request\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    401Error:\n      description: \"Unauthorized\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    403Error:\n      description: \"Forbidden\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n    404Error:\n      description: \"Not found\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    405Error:\n      description: \"Method Not Allowed\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    406Error:\n      description: \"Not Acceptable\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    415Error:\n      description: \"Unsupported Media Type\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    429Error:\n      description: \"Too Many Requests\"\n      headers:\n        Retry-After:\n          description: \"Number in seconds to wait\"\n          schema:\n            type: \"integer\"\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n    500Error:\n      description: \"Internal Server Error\"\n      headers:\n        x-fapi-interaction-id:\n          description: \"An RFC4122 UID used as a correlation id.\"\n          required: true\n          schema:\n            type: \"string\"\n      content:\n        application/json; charset=utf-8:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/json:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n        application/jose+jwe:\n          schema:\n            $ref: \"#/components/schemas/obErrorResponse1\"\n\n  securitySchemes:\n    TPPOAuth2Security:\n      type: \"oauth2\"\n      description: \"TPP client credential authorisation flow with the ASPSP\"\n      flows:\n        clientCredentials:\n          tokenUrl: \"https://authserver.example/token\"\n          scopes:\n            payments: \"Generic payment scope\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0169_4",
          "text": "obWritePaymentConsentResponse5:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"CreationDateTime\"\n            - \"Status\"\n            - \"StatusUpdateDateTime\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            CreationDateTime:\n              description: \"Date and time at which the resource was created.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Status:\n              description: \"Specifies the status of consent resource in code form.\"\n              type: \"string\"\n              enum:\n                - \"Authorised\"\n                - \"AwaitingAuthorisation\"\n                - \"Consumed\"\n                - \"Rejected\"\n            StatusUpdateDateTime:\n              description: \"Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            CutOffDateTime:\n              description: \"Specified cut-off date and time for the payment consent.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedExecutionDateTime:\n              description: \"Expected execution date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            ExpectedSettlementDateTime:\n              description: \"Expected settlement date and time for the payment resource.All dates in the JSON payloads are represented in ISO 8601 date-time format. \\nAll date-time fields in responses must include the timezone. An example is below:\\n2017-04-05T10:43:07+00:00\"\n              type: \"string\"\n              format: \"date-time\"\n            Charges:\n              type: \"array\"\n              items:\n                type: \"object\"\n                additionalProperties: false\n                description: \"Set of elements used to provide details of a charge for the payment initiation.\"\n                required:\n                  - \"ChargeBearer\"\n                  - \"Type\"\n                  - \"Amount\"\n                properties:\n                  ChargeBearer:\n                    $ref: \"#/components/schemas/obChargeBearerType1Code\"\n                  Type:\n                    $ref: \"#/components/schemas/obExternalPaymentChargeType1Code\"\n                  Amount:\n                    $ref: \"#/components/schemas/obActiveOrHistoricCurrencyAndAmount\"\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n            Debtor:\n              $ref: \"#/components/schemas/obCashAccountDebtor4\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"\n        Links:\n          $ref: \"#/components/schemas/links\"\n        Meta:\n          $ref: \"#/components/schemas/meta\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0169_5",
          "text": "obWritePayment2:\n      type: \"object\"\n      additionalProperties: false\n      required:\n        - \"Data\"\n        - \"Risk\"\n      properties:\n        Data:\n          type: \"object\"\n          additionalProperties: false\n          required:\n            - \"ConsentId\"\n            - \"Initiation\"\n          properties:\n            ConsentId:\n              description: \"OB: Unique identification as assigned by the ASPSP to uniquely identify the consent resource.\"\n              type: \"string\"\n              minLength: 1\n              maxLength: 128\n            Initiation:\n              type: \"object\"\n              additionalProperties: false\n              required:\n                - \"InstructionIdentification\"\n                - \"EndToEndIdentification\"\n                - \"InstructedAmount\"\n                - \"CreditorAccount\"\n              description: \"The Initiation payload is sent by the initiating party to the ASPSP. It is used to request movement of funds from the debtor account to a creditor for a single payment.\"\n              properties:\n                InstructionIdentification:\n                  description: \"Unique identification as assigned by an instructing party for an instructed party to unambiguously identify the instruction.\\nUsage: the  instruction identification is a point to point reference that can be used between the instructing party and the instructed party to refer to the individual instruction. It can be included in several messages related to the instruction.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                EndToEndIdentification:\n                  description: \"Unique identification assigned by the initiating party to unambiguously identify the transaction. This identification is passed on, unchanged, throughout the entire end-to-end chain.\\nUsage: The end-to-end identification can be used for reconciliation or to link tasks relating to the transaction. It can be included in several messages related to the transaction.\\nOB: The Faster Payments Scheme can only access 31 characters for the EndToEndIdentification field.\"\n                  type: \"string\"\n                  minLength: 1\n                  maxLength: 35\n                LocalInstrument:\n                  $ref: \"#/components/schemas/obExternalLocalInstrument1Code\"\n                InstructedAmount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"Amount\"\n                    - \"Currency\"\n                  description: \"Amount of money to be moved between the debtor and creditor, before deduction of charges, expressed in the currency as ordered by the initiating party.\\nUsage: This amount has to be transported unchanged through the transaction chain.\"\n                  properties:\n                    Amount:\n                      $ref: \"#/components/schemas/obActiveCurrencyAndAmount_SimpleType\"\n                    Currency:\n                      $ref: \"#/components/schemas/activeOrHistoricCurrencyCode\"\n                DebtorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                  description: \"Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level, as displayed by the ASPSP's online channels.\\nNote, the account name is not the product name or the nickname of the account.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                CreditorAccount:\n                  type: \"object\"\n                  additionalProperties: false\n                  required:\n                    - \"SchemeName\"\n                    - \"Identification\"\n                    - \"Name\"\n                  description: \"Unambiguous identification of the account of the creditor to which a credit entry will be posted as a result of the payment transaction.\"\n                  properties:\n                    SchemeName:\n                      $ref: \"#/components/schemas/obExternalAccountIdentification4Code\"\n                    Identification:\n                      $ref: \"#/components/schemas/identification_0\"\n                    Name:\n                      description: \"The account name is the name or names of the account owner(s) represented at an account level.\\nNote, the account name is not the product name or the nickname of the account.\\nOB: ASPSPs may carry out name validation for Confirmation of Payee, but it is not mandatory.\"\n                      type: \"string\"\n                      minLength: 1\n                      maxLength: 350\n                    SecondaryIdentification:\n                      $ref: \"#/components/schemas/secondaryIdentification\"\n                SupplementaryData:\n                  $ref: \"#/components/schemas/obSupplementaryData1\"\n        Risk:\n          $ref: \"#/components/schemas/obRisk1\"",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0169_6",
          "text": "[wso2/financial-services-accelerator]\n[{'type': 'text', 'text': 'This repository, `wso2/financial-services-accelerator`, supports the concept of Strong Customer Authentication (SCA) during authorization, including implicit authorization. The configuration for SCA is primarily managed through the `financial-services.xml` file, which allows for the definition of primary authenticators and identity provider steps for SCA.  The API specifications for Accounts, Payments, and Confirmation of Funds also indicate the requirement for PSU (Payment Service User) to perform SCA during OAuth flows.   \\n\\n## Implementation Details\\n\\nThe WSO2 Financial Services Accelerator extends WSO2 Identity Server to handle SCA.  The `financial-services.xml` configuration file, specifically within the `<AppRegistration>` section, defines SCA-related settings.  This includes specifying a `<PrimaryAuthenticator>` and optionally an `<IdpName>` and `<IdpStep>` for multi-factor authentication. \\n\\nThe `ConsentCoreService` interface, particularly the `createAuthorizableConsent` and `createExclusiveConsent` methods, includes a `isImplicitAuth` parameter.   This flag indicates whether the authorization is implicit, which is relevant to the SCA process during implicit authorization. \\n\\n## Configuration Options\\n\\nSCA configuration is managed within the `financial-services.xml` file. \\n\\n*   **Primary Authenticator**: You can configure the primary authenticator for SCA under `<AppRegistration><SCA><PrimaryAuthenticator>`.  By default, `BasicAuthenticator` is used. \\n*   **Identity Provider (IdP) for SCA**: The `<IdpName>` and `<IdpStep>` elements allow you to specify a particular Identity Provider and the step in the authentication flow for SCA.  These are optional configurations. \\n\\nThese configurations can be set in the `financial-services.xml.j2` template file, which is then used to generate the final `financial-services.xml`.  The `wso2is-7.0.0-deployment.toml` and `wso2is-7.1.0-deployment.toml` files also contain commented-out sections for these SCA configurations, indicating their availability.  \\n\\n## API Endpoints or Features\\n\\nThe OpenAPI specifications for Accounts, Payments, and Confirmation of Funds APIs define `PSUOAuth2Security` as an OAuth flow where the PSU needs to perform SCA.    This indicates that the API gateway is designed to handle SCA requirements during the authorization process for these financial services. \\n\\nThe `ConsentCoreService` interface, specifically the `createAuthorizableConsent` and `createExclusiveConsent` methods, includes a boolean parameter `isImplicitAuth`.   This parameter directly relates to handling implicit authorization flows, which would involve SCA if configured. \\n\\n## Documentation References\\n\\nThe \"Overview\" wiki page for the `wso2/financial-services-accelerator` repository mentions that the solution implements regulatory standards for consent management, secure API access, and Third Party Provider (TPP) onboarding, while maintaining compliance with financial industry requirements.  It also refers to \"Identity Extensions\" for OAuth/OIDC customizations and TPP onboarding, which would encompass SCA.  The \"WSO2 Extensions\" wiki page further details how the accelerator extends WSO2 Identity Server through configuration management and custom components, including OAuth and OIDC extensions. \\n\\n## Notes\\n\\nThe provided code snippets and wiki pages indicate strong support for SCA within the WSO2 Financial Services Accelerator, particularly during authorization flows, including implicit authorization. The configuration options allow for customization of the authentication mechanisms used for SCA. While the snippets confirm the *capability* to support SCA during implicit authorization, they do not explicitly detail an API endpoint specifically for an \"SCA status request.\" However, the presence of `PSUOAuth2Security` in the OpenAPI specifications implies that the authorization flow itself would handle the SCA process, and the status would be part of the overall authorization response. \\n\\nWiki pages you might want to explore:\\n- [Overview (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#1)\\n- [WSO2 Extensions (wso2/financial-services-accelerator)](/wiki/wso2/financial-services-accelerator#2.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_45432ce9-7e1c-4228-ae3f-c579d0ff74a0\\n', 'id': 'lc_ec6f2244-a98f-48f8-abe3-8dcab4323b4a'}]",
          "capability": "Payment Initiation",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0170",
      "requirement": {
        "requirement_id": "ATOM_018",
        "requirement_text": "ASPSPs MAY offer the signing-baskets endpoint to support grouping several transactions for one common authorisation process.",
        "strength": "MAY",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0170_1",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0170_2",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0170_3",
          "text": "## Java based extensions (Old approach)\n\n- [Open Banking Gateway](open-banking-gateway.md)\n- [Open Banking Event Executor](custom-event-executor.md)\n- [Data Publishing](authentication-flow-for-data-publishing.md)",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0170_4",
          "text": "### Account Information Service\n\nIf the API consumer application is aggregating account information on behalf of the bank user, the APP-to-APP redirection \nflow is as follows: \n\n[ ![](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Account Information Service, it is known as an Account Information Service Provider (AISP).\n\n| Implementation | Requirement | Participant |\n|----------------|-------------|-------------|\n| A- AISP requests the bank customer to identify the bank. | Required | AISP |\n| B- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | bank |\n| C- The customer consents to the accounts, which the AISP is allowed to have access | Required | Bank |\n| D- Confirms the completion of AIS request | Recommended | AISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0170_5",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0170_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support a \"signing-baskets endpoint\" for grouping several transactions for a common authorization process as described in your query. The provided code snippets and wiki page primarily focus on OAuth2/OIDC, SAML, Passive STS, user management, and consent management within the context of WSO2 Identity Server . There is no explicit mention or implementation of a \"signing-baskets\" concept or related API endpoints.\\n\\nThe closest related concepts found are:\\n*   **Consent Management**: The system handles consent for user self-registration  and can be enabled during SSO . However, this is for managing user consent for data usage, not for grouping transactions for authorization.\\n*   **OAuth2/OIDC**: The repository includes extensive integration tests for various OAuth2 flows like authorization code grant, implicit grant, and device flow . While OAuth2 is used for authorization, there\\'s no indication of a \"signing-baskets\" feature within these implementations.\\n\\nTherefore, based on the provided context, the repository does not seem to offer the specific \"signing-baskets endpoint\" functionality you are looking for.\\n\\n## Notes\\nThe provided context primarily consists of integration tests and configuration files for WSO2 Identity Server. While these files cover various authentication and authorization mechanisms, they do not contain any references to a \"signing-baskets\" endpoint or similar functionality for grouping transactions for common authorization. The `SelfSignUpConsentTest.java` file  and the `default-identity.xml` configuration  mention \"consent,\" but this refers to user consent for data sharing and self-registration, not transaction authorization grouping. The `OAuth2CommonClient.java` file  deals with OAuth2 application creation, which is a prerequisite for authorization but does not implement the \"signing-baskets\" concept.\\n\\nWiki pages you might want to explore:\\n- [Integration Tests (wso2/product-is)](/wiki/wso2/product-is#6.1)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_eaa491ab-ea94-4554-9e92-731c8855a395\\n', 'id': 'lc_9b00d6e7-00d4-4258-b5e0-a34afe05c863'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0170_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_31203a42-a25c-47d1-b8c2-37185ee91af1'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0171",
      "requirement": {
        "requirement_id": "ATOM_043",
        "requirement_text": "Additional error information with messageCode field SHALL be mandatory when using NextGenPSD2 specific error solution",
        "strength": "MANDATORY",
        "capability": "Error Handling",
        "section_id": "b3c635de3d1c",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Error Handling",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0171_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, appears to support the inclusion of error information, including a `messageCode` field, within API error responses. The provided code snippets indicate a standardized approach to error handling across various REST APIs, where error responses typically include `code`, `message`, `description`, and `traceId` fields. While there\\'s no explicit mention of \"NextGenPSD2\" or \"tppMessageInformation\" in the provided context, the existing error handling framework could potentially be extended or configured to meet such a requirement.\\n\\n## Implementation Details\\n\\nThe core error handling mechanism is implemented within the `RESTTestBase.java` file . This base class provides a `validateErrorResponse` method that asserts the structure and content of error responses .\\n\\nThe `validateErrorResponse` method checks for the presence of the following fields in an error response:\\n*   `code`: This corresponds to an error code, which is likely what the user refers to as `messageCode` .\\n*   `message`: A human-readable error message .\\n*   `description`: A more detailed explanation of the error .\\n*   `traceId`: A correlation ID for tracing the request .\\n\\nThe `validateErrorResponse` method internally calls `validateResponseElement` to check individual fields and `validateErrorMessage` and `validateErrorDescription` to retrieve expected messages and descriptions from a properties file .\\n\\nAn example of how error responses are validated can be seen in `IdPFailureTest.java`, where `validateErrorResponse` is used to check for specific error codes and HTTP statuses . Similarly, `AuthenticatorFailureTest.java` also uses `validateErrorResponse` to verify error scenarios, including the presence of a `code` field .\\n\\nThe `ApplicationNativeAuthentication2FATestCase.java` file also demonstrates validation of error responses, specifically checking for the presence of `CODE`, `MESSAGE`, `DESCRIPTION`, and `TRACE_ID` in a JSON response body . The constants for these field names are defined in `Constants.java` .\\n\\n## Configuration Options\\n\\nError messages and descriptions are configurable through the `RESTAPIErrors.properties` file . This file maps error codes to their corresponding messages and descriptions . Dynamic values within error descriptions can be specified using placeholders (`%s`) .\\n\\nThe `validateElementAgainstErrorProperties` method in `RESTTestBase.java` is responsible for retrieving these configured error messages and descriptions .\\n\\n## API Endpoints or Features\\n\\nThe error handling mechanism is integrated across various REST APIs within the `wso2/product-is` repository. Examples include:\\n*   **Identity Provider Management API**: Errors related to adding or retrieving Identity Providers are handled, as seen in `IdPFailureTest.java` .\\n*   **Authenticator Management API**: Errors during the creation or update of authenticators are validated in `AuthenticatorFailureTest.java` .\\n*   **Claim Management API**: Errors related to claim operations are tested in `ClaimManagementNegativeTest.java` .\\n*   **Organization Management API**: Errors related to organization filtering are validated in `OrganizationManagementFailureTest.java` .\\n*   **Tenant Management API**: Errors related to tenant operations are handled in `TenantFailureTest.java` .\\n\\nThe `code` field in these error responses serves as a `messageCode` and is consistently present in the validated error structures.\\n\\n## Documentation References\\n\\nThe wiki page \"Features and Capabilities\" provides a high-level overview of the WSO2 Identity Server\\'s features, including API Security and Extensibility <wiki_page repo_name=\"wso2/product-is\" id=\"1.2\" page_name=\"Features and Capabilities\" />. While it doesn\\'t specifically detail \"NextGenPSD2\" error solutions, it highlights the platform\\'s ability to support various authentication protocols and API security measures, which would be relevant for implementing such a solution <wiki_page repo_name=\"wso2/product-is\" id=\"1.2\" page_name=\"Features and Capabilities\" />. The \"API Security\" section mentions \"Financial-grade API (FAPI) Support\" <wiki_page repo_name=\"wso2/product-is\" id=\"1.2\" page_name=\"Features and Capabilities\" start=\"400\" end=\"400\" />, which suggests a focus on financial industry standards that might align with NextGenPSD2 requirements.\\n\\n## Notes\\n\\nThe provided code snippets are primarily from integration tests, which demonstrate how error responses are expected to be structured and validated. The `code` field in the error responses, as seen in `RESTTestBase.java`  and `Constants.java` , directly corresponds to the user\\'s requirement for a `messageCode` field. The system\\'s current error handling framework is robust enough to include such a field in its error responses. However, the specific mapping to \"NextGenPSD2\" and \"tppMessageInformation\" would require further investigation into the application\\'s business logic and how these error codes are generated and consumed.\\n\\nWiki pages you might want to explore:\\n- [Features and Capabilities (wso2/product-is)](/wiki/wso2/product-is#1.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_a7076d25-5a44-48a3-8ce2-613784fbeb3b\\n', 'id': 'lc_5ac0aca6-5818-4a19-8367-68642af209f4'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0171_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support error responses with a `code` and `message` field, but there is no explicit mention or implementation of a \"NextGenPSD2 specific error solution\" or a mandatory `messageCode` field within a `tppMessageInformation` structure.   \\n\\n### Implementation Details\\n\\nThe codebase defines a generic `Error` object and `ErrorListItem` that include `code` and `message` fields.    These are used across various API definitions within the repository.  \\n\\nSpecifically, the `_throttle_out_handler_.xml` sequence, which handles throttling errors, constructs JSON error payloads with `code`, `message`, and `description` fields.  The `ERROR_CODE` and `ERROR_MESSAGE` Synapse properties are used to populate these fields.   \\n\\n### Configuration Options\\n\\nThe error handling in the `_throttle_out_handler_.xml` sequence is configured to use Synapse properties like `ERROR_CODE`, `ERROR_MESSAGE`, and `ERROR_DETAIL`.  These properties are standard Synapse message context properties that can be set during fault handling. \\n\\n### API Endpoints or Features\\n\\nThe API definitions in `openapi.yaml` files across various modules (e.g., `service-catalog`, `gateway`, `publisher`, `store`, `admin`) define common error response structures.   These definitions consistently include `code` and `message` as required fields for error objects. \\n\\n### Documentation References\\n\\nDocumentation for Synapse properties like `ERROR_CODE` and `ERROR_MESSAGE` can be found in `traffic-manager/docs/xdoc/properties_guide.xml` and `traffic-manager/docs/xdoc/configuration_language.xml`.   These documents describe how these properties are used to convey error information. \\n\\n## Notes\\n\\nThe current codebase does not explicitly support a \"NextGenPSD2 specific error solution\" or a mandatory `messageCode` field within a `tppMessageInformation` structure. The existing error handling mechanisms provide generic `code` and `message` fields. To meet the specified requirement, modifications would be needed to introduce the `tppMessageInformation` structure and the mandatory `messageCode` field, potentially through custom Synapse configurations or API definition updates.\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-a_1e7d96eb-0666-4a04-97fa-b2a8035856c0\\n', 'id': 'lc_518450f4-e93e-4a87-8717-4c4bc836a64c'}]",
          "capability": "Error Handling",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0172",
      "requirement": {
        "requirement_id": "ATOM_221",
        "requirement_text": "OAuth2 response type \"code\" and grant types \"authorization_code\" and \"refresh_token\" SHOULD be used",
        "strength": "SHOULD",
        "capability": "Authentication",
        "section_id": "13",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0172_1",
          "text": "## User Access Token\n\nWe need to obtain an access token from the retrieved access token. For that we are using `authorization_code` grant type \nas follows:\n\n!!! tip\n    You must send the registered transport certificate along with the following HTTP Post request.\n\n```\ncurl --location --request POST 'https://localhost:9446/oauth2/token' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--header 'cache-control: no-cache' \\\n--data-urlencode 'grant_type=authorization_code' \\\n--data-urlencode 'code=ac15285e-17d7-3560-94ea-239b6c5b88bf' \\\n--data-urlencode 'scope=openid accounts' \\\n--data-urlencode 'redirect_uri=https://wso2.com' \\\n--data-urlencode 'client_id=x0Ui2Gi7a5B4juq7WpwdpWrN9lEa'\n```\n\n??? \"Click here to see a description of each parameter in the request\"\n    |Parameter | Parameter Type | Description |Sample Value|\n    |--------- | -------------- | ----------- |------------|\n    |grant_type |HTTP Body - x-www-form-urlencoded |OIDC Grant Type |authorization_code|\n    |code |HTTP Body - x-www-form-urlencoded |Obtained authorization code |1390032d-622f-3977-a976-923505035571|\n    |scope |HTTP Body - x-www-form-urlencoded |Scopes that will be used (should be a subset of what sent during the authorization request)| openid accounts|\n    |redirect_uri |HTTP Body - x-www-form-urlencoded | Registered callback URL| https://wso2.com|\n    |client_id | HTTP Body - x-www-form-urlencoded | Client ID of the application (same value as the authorization request)| x0Ui2Gi7a5B4juq7WpwdpWrN9lEa|\n    |content-type | header | Specify the content type |application/x-www-form-urlencoded|\n\n!!! note\n    In this request, we have used Transport Layer Security as the token authentication mechanism. In order to do that, \n    you should register your application with that authentication mechanism by specifying setting the\n    `token_endpoint_auth_method` parameter to `tls_client_auth` in the DCR request. Otherwise, you need to use the \n    particular authentication mechanism you specified.\n\nA successful request will generate an access token with a `200 OK`.\n\n    ``` \n    {\n      \"access_token\":\"eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJhYmN1c2VyQGNhcmJvbi5zdXBlciIsImF1dCI6IkFQUExJQ0FUSU9OX1VTRVIiLCJiYW5rX2NvZGUiOiIwMDEiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0Ojk0NDZcL29hdXRoMlwvdG9rZW4iLCJhY2Nlc3NfdG9rZW4iOiJiZTQzOGI1YS03NzQ3LTM1OGYtOWM5Yi1mNjU3YjJiZmFlZDUiLCJhdWQiOiIxcmhFamZpUFcxOW1Sd0dCZVpWYmxZdktuVGdhIiwibmJmIjoxNjUzNDgyNzkwLCJhenAiOiIxcmhFamZpUFcxOW1Sd0dCZVpWYmxZdktuVGdhIiwic2NvcGUiOiJhY2NvdW50cyBvcGVuaWQiLCJjbmYiOnsieDV0I1MyNTYiOiIyaHlmMEF0a2Q2Rmo0cnpuLXZzRDdHT244aUtnY2JiSEpVSlhMbG1yMUlzIn0sImV4cCI6MTY1MzQ4NjM5MCwiaWF0IjoxNjUzNDgyNzkwLCJqdGkiOiJhYzk5NTUxYy0wNWE4LTQzY2MtYTQ4MC05ODVkMmQxNjJlMWMiLCJjb25zZW50X2lkIjoiYzI2Mzk2OWEtMDlmNC00Y2MwLTlhMTctZjlkMWY2NGI2NWIwIn0.nLU8J1JrPbVmAs66zSAeThrRiiWnKBHYt_3dZwdgPSKxBtMAsM7-h8PeGSwi1uIwc4f7XqVjQeZjQtO6Uj0Us5iYqBb8CBmJHK8d2IZfJqWeq8N23yqj14Y43AMmJqy7pGSebaeNclwbwqdq22SJX-x4GdSPLffD8U2F5anCkUeyae4R4kq1JAs4BctSzjs5MXIjSf3_UsSFwDqOCoH0dagEFkAvYc2r1_NzJeKsXw3shTh8a1LXdHLT2Qq8mbgTIpcJlmzcwvSKWo1F6kT1FK1-jNmuiH9xYMkm1AZ8g0iTubnyuMZq7Wr_7s3vsmRDiklNTZjf60blm3KFAYdKiQ\",\n      \"refresh_token\":\"b4da9c69-3f87-334b-adf3-bdef5d768ebe\",\n      \"scope\":\"accounts openid\",\n      \"id_token\":\"eyJ4NXQiOiJOVGRtWmpNNFpEazNOalkwWXpjNU1tWm1PRGd3TVRFM01XWXdOREU1TVdSbFpEZzROemM0WkEiLCJraWQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hOR1l3WW1NNFpUQTNNV0kyTkRBelpHUXpOR00wWkdSbE5qSmtPREZrWkRSaU9URmtNV0ZoTXpVMlpHVmxOZ19SUzI1NiIsImFsZyI6IlJTMjU2In0.eyJhdF9oYXNoIjoiS2hWal9oc3dGZDRTYVdQLVJiODBJQSIsInN1YiI6ImFiY3VzZXJAY2FyYm9uLnN1cGVyIiwiYmFua19jb2RlIjoiMDAxIiwiYW1yIjpbIkN1c3RvbUZlZGVyYXRlZEF1dGhlbnRpY2F0b3IiXSwiaXNzIjoiaHR0cHM6XC9cL2xvY2FsaG9zdDo5NDQ2XC9vYXV0aDJcL3Rva2VuIiwibm9uY2UiOiJqQlhoT21PS0NCIiwiYWNjZXNzX3Rva2VuIjoiYmU0MzhiNWEtNzc0Ny0zNThmLTljOWItZjY1N2IyYmZhZWQ1IiwiYXVkIjoiMXJoRWpmaVBXMTltUndHQmVaVmJsWXZLblRnYSIsImNfaGFzaCI6IlZhbS1CSlNJUE9jNHBrZXh6RjhEZkEiLCJuYmYiOjE2NTM0ODI3OTEsImF6cCI6IjFyaEVqZmlQVzE5bVJ3R0JlWlZibFl2S25UZ2EiLCJleHAiOjE2NTM0ODYzOTEsImlhdCI6MTY1MzQ4Mjc5MX0.GK4NYUZSXNnGTwpXd30pcTN04I9Nl15inQz-CM_cwaHA4e7hEqnBEbaA9UcbPvwm8fOL_xl6V-HTj3lHFIJRTShNQ_TPkVnOhvllwYABSP499AMW_6exBvJ33IZjMXIh3b2FJaA5CxEfQ9O86WQenc918vFd77Xy8bPJwBd5D_DKxE_rHsMfIt9uOg-i63gtjEO9JCqV9cFaPKdreN87j06i4A0hl1tyBzHPo145GVJ4_ykGlRzGxmEhDMvybEQm4BEQSA3PW7ML56Tkj-Jtkp_zvi8QuJ0Ddpb6qibHsJ-3Q11Uu5xhPah3iS2NJRk95smzBANMoca9CzEmnzGuRw\",\n      \"token_type\":\"Bearer\",\n      \"expires_in\":3600\n    }\n    ```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0172_2",
          "text": "##Writing a Custom Response Type Handler\n\nThe Response Type handler contains an extension. According to your requirements, you can extend and override the methods \nin the `OBResponseTypeHandler` class to support the following functions:\n\n   - Set a new refresh token validity period\n   - Set a new scope\n\n!!!tip \"Before you begin:\"\n    - Make sure the following configurations exist in `<IS_HOME>/repository/conf/deployment.toml`:\n    ``` xml\n    [[oauth.custom_response_type]]\n    name = \"code\"\n    class = \"com.wso2.openbanking.accelerator.identity.auth.extensions.response.handler.OBCodeResponseTypeHandlerExtension\"\n    \n    [[oauth.custom_response_type]]\n    name = \"code id_token\"\n    class = \"com.wso2.openbanking.accelerator.identity.auth.extensions.response.handler.OBHybridResponseTypeHandlerExtension\"\n    ```\n\nTo write a custom Response Type handler, extend the following class:\n``` java\ncom.wso2.openbanking.accelerator.identity.auth.extensions.response.handler.OBResponseTypeHandler\n```\nTo extend the validation capabilities according to your requirements, override relevant methods of this class. Given \nbelow is a brief description of each method.\n\n###updateRefreshTokenValidityPeriod method\nThis method allows you to set validity period for the refresh tokens. For example:\n``` java\npublic long updateRefreshTokenValidityPeriod(OAuthAuthzReqMessageContext oAuthAuthzReqMessageContext) {\nreturn 3600;\n}\n```\n\n###updateApprovedScopes method\nThis method lets you set a new scope to the authorization request. See the below example to append any prefix to the scope,\n``` java\npublic String[] updateApprovedScopes(OAuthAuthzReqMessageContext oAuthAuthzReqMessageContext) {\n  String[] scopes = oAuthAuthzReqMessageContext.getApprovedScope()\n  String sessionDataKey = oAuthAuthzReqMessageContext.getAuthorizationReqDTO().getSessionDataKey();\n  String consentID = getConsentIDFromSessionData(sessionDataKey);\n  if (consentID.isEmpty()) {\n    log.error(\"Consent-ID retrieved from request object claims is empty\");\n    return scopes;\n  }\n  String consentScope = OB_CONSENT_ID_PREFIX + consentID;\n  String[] updatedScopes = (String[]) ArrayUtils.addAll(scopes, new String[] {\n    consentScope\n  });\n  if (log.isDebugEnabled()) {\n    log.debug(\"Updated scopes: \" + Arrays.toString(updatedScopes));\n  }\n  return updatedScopes;\n}\n```\n\n##Configuring a custom Response Type handler\n1. Open the `<IS_HOME>/repository/conf/deployment.toml` file.\n2. Add the following tag and configure the classpath of the extended class.\n``` xml\n[open_banking.identity.extensions]\nresponse_type_handler=\"your.extended.class.class\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0172_3",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0172_4",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0172_5",
          "text": "# supported types : Basic-Auth or OAuth2\ntype = \"Basic-Auth\"\nusername = \"\"\npassword = \"\"\n```",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0173",
      "requirement": {
        "requirement_id": "ATOM_019",
        "requirement_text": "When offering the signing basket function, ASPSPs MAY restrict the grouping to specific types such as payments only, individual payments, or the same payment product.",
        "strength": "MAY",
        "capability": "Authentication",
        "section_id": "508687390798",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "Authentication",
      "support_level": "not_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0173_1",
          "text": "### Payment Initiation Service\n\nIf the API consumer application is initiating a credit transfer on behalf of the bank customer, the App-to-App redirection \nflow is as follows:\n\n[ ![](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/pis-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Payment Initiation Service, it is known as a Payment Initiation Services Provider (PISP).\n\n| Implementation | Requirement | Participant |\n| -------------- | ------------| ------------|\n| A- The customer enters/selects the account associated with their bank | Required | PISP |\n| B- Shares the information to obtain customer's consent before initiating a payment | Required | PISP |\n| C- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | Bank |\n| D- Display the minimum payment amount, currency, and payee account name to the customer | Required | Bank |\n| E- The bank's app-based authentication must not be more than the number of steps the customer would go through when directly accessing the bank interface | Required | Bank |\n| F- The customer needs to be directed back to the API consumer\u2019s interface displaying the confirmation of successful payment initiation. | Required | PISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0173_2",
          "text": "## Manual Client Registration\n\nManual Client Registration or Signup Workflow is the process of on boarding the TPPs through the Dev Portal Signuo process. In this method, you can configure workflows to approve TPPs who signup and the applications that are registered.\n\n![signup-workfloe](../assets/img/learn/client-registration/signup-workflow.png)\n\nExamples of Manual Client Registration\n\n1. The ASPSP requests TPP information using a customised signup form during the signup process. \n2. The ASPSP requests basic information of the TPP during the signup process and lets the TPPs try out the production/sandbox environment. The ASPSP requests more details during the (production/sandbox) application access key generation process.\n\nIn both of these scenarios, the ASPSPs will approve the TPP based on its information and let the applications use the APIs. For more information, refer [Manual Client Registration](../learn/manual-client-registration.md).",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0173_3",
          "text": "### Account Information Service\n\nIf the API consumer application is aggregating account information on behalf of the bank user, the APP-to-APP redirection \nflow is as follows: \n\n[ ![](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png) ](../assets/img/learn/app-to-app-redirection/ais-app-based-flow.png)\n\nAccording to the [Customer Experience Guidelines, Open Banking Standard - UK](https://www.openbanking.org.uk/wp-content/uploads/Customer-Experience-Guidelines-V1.3.0.pdf), \nthe following implementation steps are described explicitly:\n\n!!! note\n    According to [Open Banking Standard - UK](https://www.openbanking.org.uk/about-us/glossary/), when an API consumer \n    application provides the Account Information Service, it is known as an Account Information Service Provider (AISP).\n\n| Implementation | Requirement | Participant |\n|----------------|-------------|-------------|\n| A- AISP requests the bank customer to identify the bank. | Required | AISP |\n| B- The bank application loads for authentication (If the bank app resides in the same mobile device, or else redirect to the browser) | Required | bank |\n| C- The customer consents to the accounts, which the AISP is allowed to have access | Required | Bank |\n| D- Confirms the completion of AIS request | Recommended | AISP |",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0173_4",
          "text": "## Dynamic Client Registration\n\nWith the Open Banking OpenID Dynamic Client Registration API, TPPs can register with ASPSPs in a seamless and a fully automated basis. To use DCR, a TPP has to register at a competent authority and obtain SSA and relevant certificates.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0173_5",
          "text": "## Stakeholders in Open Banking / Open Finance\n   \nThe open banking ecosystem comprises 4 main stakeholders.\n   \n   * **Customer** - The owner of a bank account who can grant access to the API consumer applications to retrieve \n   account information or initiate payments on their behalf. With open banking in the picture, the owner can use a \n   single application to manage the accounts and initiate a payment on behalf of them. The customers have more control \n   over their data as they can manage and revoke the API consumer applications\u2019 access to the financial information.\n   \n   * **API consumer application** - An authorized third-party financial service provider that uses standard APIs to \n   access customer\u2019s accounts. API consumer applications play several roles such as retrieving account information, \n   initiating payments on behalf of the customers, and checking available funds.  \n   \n   * **Financial institution** - An entity such as a bank that provides and maintains a payment account for a customer. \n   With customer consent, they share account and transaction data via API endpoints and let API consumer applications \n   make payments on behalf of the customer. \n   \n   * **Merchant** - A vendor who accepts online payments in exchange for their products or services. A merchant can \n   use a single API consumer application to accept payments easily from multiple banks. Unless the customer wants to \n   make a payment from their bank account, the role of a merchant is not available in all open banking use cases.\n   \n There are other stakeholders such as the government, technology providers, and consultancy service providers that \n are involved in open banking.",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0173_6",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': 'This repository, `wso2/product-is`, does not appear to directly support the \"signing basket function\" or the restriction of grouping payments as described in your query. The provided context primarily focuses on User APIs for identity management, including user profile management, authentication, authorization, and account recovery   .\\n\\nThe `AuthorizationDetailsType` and `AuthorizationDetailsTypesCreationModel` classes   contain fields like `type` and `schema` with examples such as `\"payment_initiation\"`  . While these might seem related to payments, they are part of a testing module for API resources and define authorization details types, not payment grouping restrictions  .\\n\\n## Notes\\n\\nThe provided codebase context primarily focuses on identity and access management functionalities within WSO2 Identity Server. There is no direct evidence or explicit mention of a \"signing basket function\" or mechanisms to restrict payment grouping within the provided snippets. The `AuthorizationDetailsType` and `AuthorizationDetailsTypesCreationModel` classes, despite containing \"payment_initiation\" as an example, are part of API resource testing and do not indicate support for the specific payment grouping restrictions you are asking about.\\n\\nWiki pages you might want to explore:\\n- [User APIs (wso2/product-is)](/wiki/wso2/product-is#4.2)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-w_d469b650-9612-4b53-85fd-e8a121819620\\n', 'id': 'lc_cae2edf6-390f-446e-8b20-c6dde4ea4d47'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0173_7",
          "text": "[wso2-extensions/identity-inbound-auth-oauth]\n[{'type': 'text', 'text': 'Error processing question: Repository not found. Visit https://deepwiki.com/wso2-extensions/identity-inbound-auth-oauth to index it.', 'id': 'lc_33afafd0-a187-41e4-9f38-32915a470f0d'}]",
          "capability": "Authentication",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    },
    {
      "gap_id": "GAP_0174",
      "requirement": {
        "requirement_id": "ATOM_074",
        "requirement_text": "The system should use relative links in hyperlink steering to save space",
        "strength": "SHOULD",
        "capability": "General",
        "section_id": "da818bb5b9ae",
        "source_ref": "data\\uploads\\c11d1a51-22fa-4934-a589-afb65d38f081\\Berlin Group.pdf"
      },
      "capability": "General",
      "support_level": "partially_supported",
      "confidence_score": 1.0,
      "supporting_evidence": [
        {
          "evidence_id": "EV_0174_1",
          "text": "[wso2/product-is]\n[{'type': 'text', 'text': \"This repository, `wso2/product-is`, supports the use of relative links in API responses, particularly for pagination links. The API Layer is designed to provide consistent responses, and this includes how links are constructed. The system dynamically generates these links, and in certain contexts, it uses relative paths to refer to subsequent or previous pages of results.\\n\\n### Implementation Details\\nThe implementation of relative links can be observed in the test cases for API pagination. For instance, in the `UserDiscoverableApplicationSuccessTest.java` file, the `assertNextLink` and `assertPreviousLink` methods explicitly construct and validate pagination links. These methods use a base path and append query parameters for `offset` and `limit` to form the next or previous page URLs  . The `basePath` used in these methods can be a tenant-qualified or organization-qualified relative path, as determined by the `convertToOrgBasePath` method .\\n\\nSimilarly, in the `OrganizationManagementSuccessTest.java` file, methods like `validateOrganizationDiscoveryOffsetLinks` and `validateOrganizationDiscoveryOffsetIsInLinks` are used to verify the correctness of `next` and `previous` links in paginated responses  . These tests confirm that the system generates relative links containing `offset` and `limit` parameters for navigation within paginated results. The `getLink` utility method extracts the relevant part of the URL, which can be a relative path, from the `href` attribute of the link object .\\n\\n### API Endpoints or Features\\nThe API Layer's pagination feature, as described in the wiki, explicitly includes `links` in the response for navigating through result sets . These links, such as `next` and `previous`, are designed to be relative to the current API endpoint. For example, a `next` link might appear as `/api/server/v1/applications?offset=10&limit=10` .\\n\\nThe `ISIntegrationTest.java` utility class provides methods like `getTenantedRelativePath` and `getTenantedOrgRelativePath`  . These methods are used to construct tenant-qualified or organization-qualified relative URLs, indicating that the system is built to handle and generate relative paths for various API interactions.\\n\\n### Configuration Options\\nWhile the `encrypt-decrypt-persistence-enabled-identity.xml` file shows full URLs for OAuth endpoints , these are typically for external-facing endpoints or internal configurations where a full URL might be necessary. The pagination links, however, are generated dynamically and are relative to the API context. The wiki also mentions that for tenants, these URLs will be modified to include the tenant domain, implying a dynamic construction that can result in relative paths within the tenant's context .\\n\\n## Notes\\nThe provided code snippets primarily consist of integration tests. These tests demonstrate that the API responses, particularly for paginated results, contain relative links for navigation. The `href` attribute of the `links` object in the API response is checked to ensure it contains the correct relative path with `offset` and `limit` parameters. The presence of utility methods for constructing tenant-qualified relative paths further supports the idea that the system is designed to use relative links where appropriate.\\n\\nWiki pages you might want to explore:\\n- [API Layer (wso2/product-is)](/wiki/wso2/product-is#4)\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_031c2f07-a66b-4154-8780-6f8f05dd93b6\\n\", 'id': 'lc_94dd0ba4-d67f-4baa-acbe-c0c0ca1f85f3'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        },
        {
          "evidence_id": "EV_0174_2",
          "text": "[wso2/product-apim]\n[{'type': 'text', 'text': 'This repository, `wso2/product-apim`, appears to support the use of relative links in API responses, particularly for `Location` headers and pagination links. The `RelativeUrlLocationHeaderTestCase.java` integration test explicitly verifies this behavior . Additionally, OpenAPI definitions for various APIs within the system indicate that `Location` headers and pagination links (`next`, `previous`) are expected to contain string values that can represent relative URLs    .\\n\\n## Implementation Details\\n\\nThe core implementation detail supporting relative URLs is demonstrated in the `RelativeUrlLocationHeaderTestCase.java` file . This test case specifically checks for a `Location` header in an HTTP response that contains a relative URL, such as `/abc/domain` . The test uses `assertEquals` and `assertTrue` to verify that the HTTP status code is `OK` and that the `Location` header\\'s value contains the expected relative path . This indicates that the system is designed to return relative URLs in certain scenarios.\\n\\nThe `publisher-api.yaml` and `api.yaml` OpenAPI definitions also provide insight into the expected behavior of API responses  . For example, when a document is updated, the `Location` header is described as \"The URL of the updated content of the document\" . Similarly, for newly created resources, the `Location` header is described as \"The URL of the newly created resource\" . While these descriptions don\\'t explicitly state \"relative URL,\" the examples provided for pagination links in `APIList` and `Pagination` objects, such as `\"/apis?limit=1&offset=2&query=\"`, clearly show relative paths  .\\n\\n## Configuration Options\\n\\nThere are no explicit configuration options found in the provided snippets that directly control whether the system uses relative or absolute links for hyperlink steering. The `api-manager.xml` file contains configurations for API startup and CORS, but nothing related to link generation .\\n\\n## API Endpoints or Features\\n\\nThe API endpoints and features that support relative links primarily involve:\\n\\n*   **`Location` Headers**: When resources are created or updated, the `Location` header in the HTTP response can contain a relative URL pointing to the new or updated resource   . This is explicitly tested in `RelativeUrlLocationHeaderTestCase.java` .\\n*   **Pagination Links**: API responses that return lists of resources, such as `APIList`, include `next` and `previous` links within a `Pagination` object   . These links are defined as strings and examples show them as relative paths (e.g., `\"/apis?limit=1&offset=2&query=\"`) . The `PaginationDTO.java` files in both `admin` and `store` clients also define these `next` and `previous` fields as strings, with examples showing empty strings for when no more resources are available, implying relative links when present  .\\n\\n## Documentation References\\n\\nThe OpenAPI specification files (`publisher-api.yaml`, `api.yaml`, `openapi.yaml`) serve as documentation for the API endpoints and their expected responses   . These files describe the `Location` header and pagination links, indicating that they are of type `string` and providing examples that are relative URLs  . Specifically, `openapi.yaml` mentions that for \"URL type\" documents, \"The client will recieve the URL of the document as the Location header with the response with - `303 See Other`\" . The example for the `Location` header in this context is also a string .\\n\\n## Notes\\n\\nThe `advanced_mediation_samples.xml` file contains examples of URL rewrite rules . While this demonstrates URL manipulation, it is within the context of mediation policies and not directly related to the generation of relative links in API responses for hyperlink steering . Therefore, it is not considered a direct implementation detail for the user\\'s query. The `SoapToRestTestCase.java` and `TagsRatingTestCase.java` files are integration tests for other functionalities and do not directly address relative links  .\\n\\nView this search on DeepWiki: https://deepwiki.com/search/does-this-repository-support-t_52debbb7-adaf-4c41-b98f-9705452b9119\\n', 'id': 'lc_d90382a4-a984-4378-9ac3-20fec623a168'}]",
          "capability": "General",
          "source": "gap_detection",
          "confidence": 0.8,
          "metadata": {}
        }
      ],
      "missing_features": [],
      "is_remediable": false,
      "estimated_effort": null,
      "remediation_hints": []
    }
  ],
  "fully_supported_count": 0,
  "partially_supported_count": 112,
  "not_supported_count": 61,
  "configuration_needed_count": 0,
  "remediable_gaps_count": 0
}